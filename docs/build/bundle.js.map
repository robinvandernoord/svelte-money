{"version":3,"file":"bundle.js","sources":["../../node_modules/svelte/internal/index.mjs","../../node_modules/nerdamer/nerdamer.core.js","../../node_modules/nerdamer/Calculus.js","../../node_modules/nerdamer/Algebra.js","../../node_modules/nerdamer/Solve.js","../../node_modules/nerdamer/Extra.js","../../node_modules/nerdamer/all.js","../../src/stackoverflow.js","../../src/magic.js","../../node_modules/svelte/store/index.mjs","../../node_modules/svelte/easing/index.mjs","../../node_modules/svelte/motion/index.mjs","../../src/Field.svelte","../../src/debounce.js","../../src/Center.svelte","../../src/Group.svelte","../../src/GroupReadonly.svelte","../../src/Logo.svelte","../../src/App.svelte","../../src/main.js"],"sourcesContent":["function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction is_promise(value) {\n    return value && typeof value === 'object' && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nlet src_url_equal_anchor;\nfunction src_url_equal(element_src, url) {\n    if (!src_url_equal_anchor) {\n        src_url_equal_anchor = document.createElement('a');\n    }\n    src_url_equal_anchor.href = url;\n    return element_src === src_url_equal_anchor.href;\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn) {\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\nfunction get_all_dirty_from_scope($$scope) {\n    if ($$scope.ctx.length > 32) {\n        const dirty = [];\n        const length = $$scope.ctx.length / 32;\n        for (let i = 0; i < length; i++) {\n            dirty[i] = -1;\n        }\n        return dirty;\n    }\n    return -1;\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\nfunction start_hydrating() {\n    is_hydrating = true;\n}\nfunction end_hydrating() {\n    is_hydrating = false;\n}\nfunction upper_bound(low, high, key, value) {\n    // Return first index of value larger than input value in the range [low, high)\n    while (low < high) {\n        const mid = low + ((high - low) >> 1);\n        if (key(mid) <= value) {\n            low = mid + 1;\n        }\n        else {\n            high = mid;\n        }\n    }\n    return low;\n}\nfunction init_hydrate(target) {\n    if (target.hydrate_init)\n        return;\n    target.hydrate_init = true;\n    // We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n    let children = target.childNodes;\n    // If target is <head>, there may be children without claim_order\n    if (target.nodeName === 'HEAD') {\n        const myChildren = [];\n        for (let i = 0; i < children.length; i++) {\n            const node = children[i];\n            if (node.claim_order !== undefined) {\n                myChildren.push(node);\n            }\n        }\n        children = myChildren;\n    }\n    /*\n    * Reorder claimed children optimally.\n    * We can reorder claimed children optimally by finding the longest subsequence of\n    * nodes that are already claimed in order and only moving the rest. The longest\n    * subsequence subsequence of nodes that are claimed in order can be found by\n    * computing the longest increasing subsequence of .claim_order values.\n    *\n    * This algorithm is optimal in generating the least amount of reorder operations\n    * possible.\n    *\n    * Proof:\n    * We know that, given a set of reordering operations, the nodes that do not move\n    * always form an increasing subsequence, since they do not move among each other\n    * meaning that they must be already ordered among each other. Thus, the maximal\n    * set of nodes that do not move form a longest increasing subsequence.\n    */\n    // Compute longest increasing subsequence\n    // m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n    const m = new Int32Array(children.length + 1);\n    // Predecessor indices + 1\n    const p = new Int32Array(children.length);\n    m[0] = -1;\n    let longest = 0;\n    for (let i = 0; i < children.length; i++) {\n        const current = children[i].claim_order;\n        // Find the largest subsequence length such that it ends in a value less than our current value\n        // upper_bound returns first greater value, so we subtract one\n        // with fast path for when we are on the current longest subsequence\n        const seqLen = ((longest > 0 && children[m[longest]].claim_order <= current) ? longest + 1 : upper_bound(1, longest, idx => children[m[idx]].claim_order, current)) - 1;\n        p[i] = m[seqLen] + 1;\n        const newLen = seqLen + 1;\n        // We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n        m[newLen] = i;\n        longest = Math.max(newLen, longest);\n    }\n    // The longest increasing subsequence of nodes (initially reversed)\n    const lis = [];\n    // The rest of the nodes, nodes that will be moved\n    const toMove = [];\n    let last = children.length - 1;\n    for (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n        lis.push(children[cur - 1]);\n        for (; last >= cur; last--) {\n            toMove.push(children[last]);\n        }\n        last--;\n    }\n    for (; last >= 0; last--) {\n        toMove.push(children[last]);\n    }\n    lis.reverse();\n    // We sort the nodes being moved to guarantee that their insertion order matches the claim order\n    toMove.sort((a, b) => a.claim_order - b.claim_order);\n    // Finally, we move the nodes\n    for (let i = 0, j = 0; i < toMove.length; i++) {\n        while (j < lis.length && toMove[i].claim_order >= lis[j].claim_order) {\n            j++;\n        }\n        const anchor = j < lis.length ? lis[j] : null;\n        target.insertBefore(toMove[i], anchor);\n    }\n}\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction append_styles(target, style_sheet_id, styles) {\n    const append_styles_to = get_root_for_style(target);\n    if (!append_styles_to.getElementById(style_sheet_id)) {\n        const style = element('style');\n        style.id = style_sheet_id;\n        style.textContent = styles;\n        append_stylesheet(append_styles_to, style);\n    }\n}\nfunction get_root_for_style(node) {\n    if (!node)\n        return document;\n    const root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n    if (root && root.host) {\n        return root;\n    }\n    return node.ownerDocument;\n}\nfunction append_empty_stylesheet(node) {\n    const style_element = element('style');\n    append_stylesheet(get_root_for_style(node), style_element);\n    return style_element.sheet;\n}\nfunction append_stylesheet(node, style) {\n    append(node.head || node, style);\n}\nfunction append_hydration(target, node) {\n    if (is_hydrating) {\n        init_hydrate(target);\n        if ((target.actual_end_child === undefined) || ((target.actual_end_child !== null) && (target.actual_end_child.parentElement !== target))) {\n            target.actual_end_child = target.firstChild;\n        }\n        // Skip nodes of undefined ordering\n        while ((target.actual_end_child !== null) && (target.actual_end_child.claim_order === undefined)) {\n            target.actual_end_child = target.actual_end_child.nextSibling;\n        }\n        if (node !== target.actual_end_child) {\n            // We only insert if the ordering of this node should be modified or the parent node is not target\n            if (node.claim_order !== undefined || node.parentNode !== target) {\n                target.insertBefore(node, target.actual_end_child);\n            }\n        }\n        else {\n            target.actual_end_child = node.nextSibling;\n        }\n    }\n    else if (node.parentNode !== target || node.nextSibling !== null) {\n        target.appendChild(node);\n    }\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction insert_hydration(target, node, anchor) {\n    if (is_hydrating && !anchor) {\n        append_hydration(target, node);\n    }\n    else if (node.parentNode !== target || node.nextSibling != anchor) {\n        target.insertBefore(node, anchor || null);\n    }\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction trusted(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.isTrusted)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction init_claim_info(nodes) {\n    if (nodes.claim_info === undefined) {\n        nodes.claim_info = { last_index: 0, total_claimed: 0 };\n    }\n}\nfunction claim_node(nodes, predicate, processNode, createNode, dontUpdateLastIndex = false) {\n    // Try to find nodes in an order such that we lengthen the longest increasing subsequence\n    init_claim_info(nodes);\n    const resultNode = (() => {\n        // We first try to find an element after the previous one\n        for (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                return node;\n            }\n        }\n        // Otherwise, we try to find one before\n        // We iterate in reverse so that we don't go too far back\n        for (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                else if (replacement === undefined) {\n                    // Since we spliced before the last_index, we decrease it\n                    nodes.claim_info.last_index--;\n                }\n                return node;\n            }\n        }\n        // If we can't find any matching node, we create a new one\n        return createNode();\n    })();\n    resultNode.claim_order = nodes.claim_info.total_claimed;\n    nodes.claim_info.total_claimed += 1;\n    return resultNode;\n}\nfunction claim_element_base(nodes, name, attributes, create_element) {\n    return claim_node(nodes, (node) => node.nodeName === name, (node) => {\n        const remove = [];\n        for (let j = 0; j < node.attributes.length; j++) {\n            const attribute = node.attributes[j];\n            if (!attributes[attribute.name]) {\n                remove.push(attribute.name);\n            }\n        }\n        remove.forEach(v => node.removeAttribute(v));\n        return undefined;\n    }, () => create_element(name));\n}\nfunction claim_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, element);\n}\nfunction claim_svg_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, svg_element);\n}\nfunction claim_text(nodes, data) {\n    return claim_node(nodes, (node) => node.nodeType === 3, (node) => {\n        const dataStr = '' + data;\n        if (node.data.startsWith(dataStr)) {\n            if (node.data.length !== dataStr.length) {\n                return node.splitText(dataStr.length);\n            }\n        }\n        else {\n            node.data = dataStr;\n        }\n    }, () => text(data), true // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n    );\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction find_comment(nodes, text, start) {\n    for (let i = start; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n            return i;\n        }\n    }\n    return nodes.length;\n}\nfunction claim_html_tag(nodes) {\n    // find html opening tag\n    const start_index = find_comment(nodes, 'HTML_TAG_START', 0);\n    const end_index = find_comment(nodes, 'HTML_TAG_END', start_index);\n    if (start_index === end_index) {\n        return new HtmlTagHydration();\n    }\n    init_claim_info(nodes);\n    const html_tag_nodes = nodes.splice(start_index, end_index - start_index + 1);\n    detach(html_tag_nodes[0]);\n    detach(html_tag_nodes[html_tag_nodes.length - 1]);\n    const claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n    for (const n of claimed_nodes) {\n        n.claim_order = nodes.claim_info.total_claimed;\n        nodes.claim_info.total_claimed += 1;\n    }\n    return new HtmlTagHydration(claimed_nodes);\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    if (value === null) {\n        node.style.removeProperty(key);\n    }\n    else {\n        node.style.setProperty(key, value, important ? 'important' : '');\n    }\n}\nfunction select_option(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n    select.selectedIndex = -1; // no option should be selected\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked') || select.options[0];\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail, bubbles = false) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, bubbles, false, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nclass HtmlTag {\n    constructor() {\n        this.e = this.n = null;\n    }\n    c(html) {\n        this.h(html);\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            this.e = element(target.nodeName);\n            this.t = target;\n            this.c(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\nclass HtmlTagHydration extends HtmlTag {\n    constructor(claimed_nodes) {\n        super();\n        this.e = this.n = null;\n        this.l = claimed_nodes;\n    }\n    c(html) {\n        if (this.l) {\n            this.n = this.l;\n        }\n        else {\n            super.c(html);\n        }\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert_hydration(this.t, this.n[i], anchor);\n        }\n    }\n}\nfunction attribute_to_object(attributes) {\n    const result = {};\n    for (const attribute of attributes) {\n        result[attribute.name] = attribute.value;\n    }\n    return result;\n}\nfunction get_custom_elements_slots(element) {\n    const result = {};\n    element.childNodes.forEach((node) => {\n        result[node.slot || 'default'] = true;\n    });\n    return result;\n}\n\n// we need to store the information for multiple documents because a Svelte application could also contain iframes\n// https://github.com/sveltejs/svelte/issues/3624\nconst managed_styles = new Map();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_style_information(doc, node) {\n    const info = { stylesheet: append_empty_stylesheet(node), rules: {} };\n    managed_styles.set(doc, info);\n    return info;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = get_root_for_style(node);\n    const { stylesheet, rules } = managed_styles.get(doc) || create_style_information(doc, node);\n    if (!rules[name]) {\n        rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        managed_styles.forEach(info => {\n            const { stylesheet } = info;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            info.rules = {};\n        });\n        managed_styles.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail);\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n        }\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\nfunction getAllContexts() {\n    return get_current_component().$$.context;\n}\nfunction hasContext(key) {\n    return get_current_component().$$.context.has(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        // @ts-ignore\n        callbacks.slice().forEach(fn => fn.call(this, event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\n// flush() calls callbacks in this order:\n// 1. All beforeUpdate callbacks, in order: parents before children\n// 2. All bind:this callbacks, in reverse order: children before parents.\n// 3. All afterUpdate callbacks, in order: parents before children. EXCEPT\n//    for afterUpdates called during the initial onMount, which are called in\n//    reverse order: children before parents.\n// Since callbacks might update component values, which could trigger another\n// call to flush(), the following steps guard against this:\n// 1. During beforeUpdate, any updated components will be added to the\n//    dirty_components array and will cause a reentrant call to flush(). Because\n//    the flush index is kept outside the function, the reentrant call will pick\n//    up where the earlier call left off and go through all dirty components. The\n//    current_component value is saved and restored so that the reentrant call will\n//    not interfere with the \"parent\" flush() call.\n// 2. bind:this callbacks cannot trigger new flush() calls.\n// 3. During afterUpdate, any updated components will NOT have their afterUpdate\n//    callback called a second time; the seen_callbacks set, outside the flush()\n//    function, guarantees this behavior.\nconst seen_callbacks = new Set();\nlet flushidx = 0; // Do *not* move this inside the flush() function\nfunction flush() {\n    const saved_component = current_component;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        while (flushidx < dirty_components.length) {\n            const component = dirty_components[flushidx];\n            flushidx++;\n            set_current_component(component);\n            update(component.$$);\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        flushidx = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    seen_callbacks.clear();\n    set_current_component(saved_component);\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            started = true;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config();\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config();\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = (program.b - t);\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            if (info.blocks[i] === block) {\n                                info.blocks[i] = null;\n                            }\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\nfunction update_await_block_branch(info, ctx, dirty) {\n    const child_ctx = ctx.slice();\n    const { resolved } = info;\n    if (info.current === info.then) {\n        child_ctx[info.value] = resolved;\n    }\n    if (info.current === info.catch) {\n        child_ctx[info.error] = resolved;\n    }\n    info.block.p(child_ctx, dirty);\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\n// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes = new Set([\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n]);\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, attrs_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (attrs_to_add) {\n        const classes_to_add = attrs_to_add.classes;\n        const styles_to_add = attrs_to_add.styles;\n        if (classes_to_add) {\n            if (attributes.class == null) {\n                attributes.class = classes_to_add;\n            }\n            else {\n                attributes.class += ' ' + classes_to_add;\n            }\n        }\n        if (styles_to_add) {\n            if (attributes.style == null) {\n                attributes.style = style_object_to_string(styles_to_add);\n            }\n            else {\n                attributes.style = style_object_to_string(merge_ssr_styles(attributes.style, styles_to_add));\n            }\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${value}\"`;\n        }\n    });\n    return str;\n}\nfunction merge_ssr_styles(style_attribute, style_directive) {\n    const style_object = {};\n    for (const individual_style of style_attribute.split(';')) {\n        const colon_index = individual_style.indexOf(':');\n        const name = individual_style.slice(0, colon_index).trim();\n        const value = individual_style.slice(colon_index + 1).trim();\n        if (!name)\n            continue;\n        style_object[name] = value;\n    }\n    for (const name in style_directive) {\n        const value = style_directive[name];\n        if (value) {\n            style_object[name] = value;\n        }\n        else {\n            delete style_object[name];\n        }\n    }\n    return style_object;\n}\nconst escaped = {\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;'\n};\nfunction escape(html) {\n    return String(html).replace(/[\"'&<>]/g, match => escaped[match]);\n}\nfunction escape_attribute_value(value) {\n    return typeof value === 'string' ? escape(value) : value;\n}\nfunction escape_object(obj) {\n    const result = {};\n    for (const key in obj) {\n        result[key] = escape_attribute_value(obj[key]);\n    }\n    return result;\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots, context) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(context || (parent_component ? parent_component.$$.context : [])),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, { $$slots = {}, context = new Map() } = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, $$slots, context);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    return ` ${name}${value === true && boolean_attributes.has(name) ? '' : `=${typeof value === 'string' ? JSON.stringify(escape(value)) : `\"${value}\"`}`}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\nfunction style_object_to_string(style_object) {\n    return Object.keys(style_object)\n        .filter(key => style_object[key])\n        .map(key => `${key}: ${style_object[key]};`)\n        .join(' ');\n}\nfunction add_styles(style_object) {\n    const styles = style_object_to_string(style_object);\n    return styles ? ` style=\"${styles}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor, customElement) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    if (!customElement) {\n        // onMount happens before the initial afterUpdate\n        add_render_callback(() => {\n            const new_on_destroy = on_mount.map(run).filter(is_function);\n            if (on_destroy) {\n                on_destroy.push(...new_on_destroy);\n            }\n            else {\n                // Edge case - component was destroyed immediately,\n                // most likely as a result of a binding initialising\n                run_all(new_on_destroy);\n            }\n            component.$$.on_mount = [];\n        });\n    }\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, append_styles, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        on_disconnect: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(options.context || (parent_component ? parent_component.$$.context : [])),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false,\n        root: options.target || parent_component.$$.root\n    };\n    append_styles && append_styles($$.root);\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, options.props || {}, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            start_hydrating();\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor, options.customElement);\n        end_hydrating();\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            const { on_mount } = this.$$;\n            this.$$.on_disconnect = on_mount.map(run).filter(is_function);\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        disconnectedCallback() {\n            run_all(this.$$.on_disconnect);\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\n/**\n * Base class for Svelte components. Used when dev=false.\n */\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.46.4' }, detail), true));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction append_hydration_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append_hydration(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction insert_hydration_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert_hydration(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\n/**\n * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.\n */\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\n/**\n * Base class to create strongly typed Svelte components.\n * This only exists for typing purposes and should be used in `.d.ts` files.\n *\n * ### Example:\n *\n * You have component library on npm called `component-library`, from which\n * you export a component called `MyComponent`. For Svelte+TypeScript users,\n * you want to provide typings. Therefore you create a `index.d.ts`:\n * ```ts\n * import { SvelteComponentTyped } from \"svelte\";\n * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}\n * ```\n * Typing this makes it possible for IDEs like VS Code with the Svelte extension\n * to provide intellisense and to use the component like this in a Svelte file\n * with TypeScript:\n * ```svelte\n * <script lang=\"ts\">\n * \timport { MyComponent } from \"component-library\";\n * </script>\n * <MyComponent foo={'bar'} />\n * ```\n *\n * #### Why not make this part of `SvelteComponent(Dev)`?\n * Because\n * ```ts\n * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}\n * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;\n * ```\n * will throw a type error, so we need to separate the more strictly typed class.\n */\nclass SvelteComponentTyped extends SvelteComponentDev {\n    constructor(options) {\n        super(options);\n    }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, HtmlTagHydration, SvelteComponent, SvelteComponentDev, SvelteComponentTyped, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_styles, add_transform, afterUpdate, append, append_dev, append_empty_stylesheet, append_hydration, append_hydration_dev, append_styles, assign, attr, attr_dev, attribute_to_object, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_html_tag, claim_space, claim_svg_element, claim_text, clear_loops, component_subscribe, compute_rest_props, compute_slots, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, end_hydrating, escape, escape_attribute_value, escape_object, escaped, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, getAllContexts, getContext, get_all_dirty_from_scope, get_binding_group_value, get_current_component, get_custom_elements_slots, get_root_for_style, get_slot_changes, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, hasContext, has_prop, identity, init, insert, insert_dev, insert_hydration, insert_hydration_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, listen, listen_dev, loop, loop_guard, merge_ssr_styles, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_data, set_data_dev, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, spread, src_url_equal, start_hydrating, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, trusted, update_await_block_branch, update_keyed_each, update_slot, update_slot_base, validate_component, validate_each_argument, validate_each_keys, validate_slots, validate_store, xlink_attr };\n","/*\r\n * Author : Martin Donk\r\n * Website : http://www.nerdamer.com\r\n * Email : martin.r.donk@gmail.com\r\n * Source : https://github.com/jiggzson/nerdamer\r\n */\r\n\r\n/* global trig, trigh, Infinity, define, arguments2Array, NaN */\r\n//externals ====================================================================\r\n/* BigInterger.js v1.6.40 https://github.com/peterolson/BigInteger.js/blob/master/LICENSE */\r\n//var nerdamerBigInt = typeof nerdamerBigInt !== 'undefined' ? nerdamerBigInt : require(\"big-integer\");\r\n/* big.js v5.2.2 https://github.com/MikeMcl/big.js/LICENCE */\r\n//var nerdamerBigDecimal = typeof nerdamerBigDecimal !== 'undefined' ? nerdamerBigDecimal : require('big.js');\r\n\r\nvar nerdamer = (function (imports) {\r\n    \"use strict\"; \r\n\r\n//version ======================================================================\r\n    var version = '1.1.13';\r\n\r\n//inits ========================================================================\r\n    var _ = new Parser(); //nerdamer's parser\r\n\r\n    //import bigInt\r\n    var bigInt = imports.bigInt;\r\n    var bigDec = imports.bigDec;\r\n\r\n    //set the precision to js precision\r\n    bigDec.set({\r\n        precision: 250\r\n    });\r\n\r\n    var Groups = {};\r\n\r\n    //container of pregenerated primes\r\n    var PRIMES = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113\r\n                , 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251,\r\n        257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397,\r\n        401, 409, 419, 421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523, 541, 547, 557,\r\n        563, 569, 571, 577, 587, 593, 599, 601, 607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701,\r\n        709, 719, 727, 733, 739, 743, 751, 757, 761, 769, 773, 787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857, 859, 863,\r\n        877, 881, 883, 887, 907, 911, 919, 929, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997, 1009, 1013, 1019, 1021, 1031,\r\n        1033, 1039, 1049, 1051, 1061, 1063, 1069, 1087, 1091, 1093, 1097, 1103, 1109, 1117, 1123, 1129, 1151, 1153, 1163, 1171,\r\n        1181, 1187, 1193, 1201, 1213, 1217, 1223, 1229, 1231, 1237, 1249, 1259, 1277, 1279, 1283, 1289, 1291, 1297, 1301, 1303,\r\n        1307, 1319, 1321, 1327, 1361, 1367, 1373, 1381, 1399, 1409, 1423, 1427, 1429, 1433, 1439, 1447, 1451, 1453, 1459, 1471,\r\n        1481, 1483, 1487, 1489, 1493, 1499, 1511, 1523, 1531, 1543, 1549, 1553, 1559, 1567, 1571, 1579, 1583, 1597, 1601, 1607,\r\n        1609, 1613, 1619, 1621, 1627, 1637, 1657, 1663, 1667, 1669, 1693, 1697, 1699, 1709, 1721, 1723, 1733, 1741, 1747, 1753,\r\n        1759, 1777, 1783, 1787, 1789, 1801, 1811, 1823, 1831, 1847, 1861, 1867, 1871, 1873, 1877, 1879, 1889, 1901, 1907, 1913, 1931,\r\n        1933, 1949, 1951, 1973, 1979, 1987, 1993, 1997, 1999, 2003, 2011, 2017, 2027, 2029, 2039, 2053, 2063, 2069, 2081, 2083];\r\n\r\n//Settings =====================================================================\r\n    var CUSTOM_OPERATORS = {};\r\n\r\n    var Settings = {\r\n        //Enables/Disables call peekers. False means callPeekers are disabled and true means callPeekers are enabled.\r\n        callPeekers: false,\r\n\r\n        //the max number up to which to cache primes. Making this too high causes performance issues\r\n        init_primes: 1000,\r\n\r\n        exclude: [],\r\n        //If you don't care about division by zero for example then this can be set to true.\r\n        //Has some nasty side effects so choose carefully.\r\n        suppress_errors: false,\r\n        //the global used to invoke the libary to parse to a number. Normally cos(9) for example returns\r\n        //cos(9) for convenience but parse to number will always try to return a number if set to true.\r\n        PARSE2NUMBER: false,\r\n        //this flag forces the a clone to be returned when add, subtract, etc... is called\r\n        SAFE: false,\r\n        //the symbol to use for imaginary symbols\r\n        IMAGINARY: 'i',\r\n        //the modules used to link numeric function holders\r\n        FUNCTION_MODULES: [Math],\r\n        //Allow certain characters\r\n        ALLOW_CHARS: ['π'],\r\n        //Allow nerdamer to convert multi-character variables\r\n        USE_MULTICHARACTER_VARS: true,\r\n        //Allow changing of power operator\r\n        POWER_OPERATOR: '^',\r\n        //The variable validation regex\r\n        //VALIDATION_REGEX: /^[a-z_][a-z\\d\\_]*$/i\r\n        VALIDATION_REGEX: /^[a-z_αAβBγΓδΔϵEζZηHθΘιIκKλΛμMνNξΞoOπΠρPσΣτTυϒϕΦχXψΨωΩ∞][0-9a-z_αAβBγΓδΔϵEζZηHθΘιIκKλΛμMνNξΞoOπΠρPσΣτTυϒϕΦχXψΨωΩ]*$/i,\r\n        // The regex used to determine which characters should be included in implied multiplication\r\n        IMPLIED_MULTIPLICATION_REGEX: /([\\+\\-\\/\\*]*[0-9]+)([a-z_αAβBγΓδΔϵEζZηHθΘιIκKλΛμMνNξΞoOπΠρPσΣτTυϒϕΦχXψΨωΩ]+[\\+\\-\\/\\*]*)/gi,\r\n        //Aliases\r\n        ALIASES: {\r\n            'π': 'pi',\r\n            '∞': 'Infinity'\r\n        },\r\n        POSITIVE_MULTIPLIERS: false,\r\n        //Cached items\r\n        CACHE: {},\r\n        //Print out warnings or not\r\n        SILENCE_WARNINGS: false,\r\n        // Precision\r\n        PRECISION: 21,\r\n        // The Expression defaults to this value for decimal places\r\n        EXPRESSION_DECP: 19,\r\n        // The text function defaults to this value for decimal places\r\n        DEFAULT_DECP: 16,\r\n        //function mappings\r\n        VECTOR: 'vector',\r\n        PARENTHESIS: 'parens',\r\n        SQRT: 'sqrt',\r\n        ABS: 'abs',\r\n        FACTORIAL: 'factorial',\r\n        DOUBLEFACTORIAL: 'dfactorial',\r\n        //reference pi and e\r\n        LONG_PI: '3.14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214' +\r\n                '808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196',\r\n        LONG_E: '2.718281828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427427466' +\r\n                '39193200305992181741359662904357290033429526059563073813232862794349076323382988075319525101901',\r\n        PI: Math.PI,\r\n        E: Math.E,\r\n        LOG: 'log',\r\n        LOG10: 'log10',\r\n        LOG10_LATEX: 'log_{10}',\r\n        MAX_EXP: 200000,\r\n        //The number of scientific place to round to\r\n        SCIENTIFIC_MAX_DECIMAL_PLACES: 14,\r\n        //True if ints should not be converted to\r\n        SCIENTIFIC_IGNORE_ZERO_EXPONENTS: true\r\n    };\r\n\r\n    (function () {\r\n        Settings.CACHE.roots = {};\r\n        var x = 40,\r\n                y = 40;\r\n        for(var i = 2; i <= x; i++) {\r\n            for(var j = 2; j <= y; j++) {\r\n                var nthpow = bigInt(i).pow(j);\r\n                Settings.CACHE.roots[nthpow + '-' + j] = i;\r\n            }\r\n        }\r\n    })();\r\n\r\n    //Add the groups. These have been reorganized as of v0.5.1 to make CP the highest group\r\n    //The groups that help with organizing during parsing. Note that for FN is still a function even\r\n    //when it's raised to a symbol, which typically results in an EX\r\n    var N = Groups.N = 1, // A number\r\n            P = Groups.P = 2, // A number with a rational power e.g. 2^(3/5).\r\n            S = Groups.S = 3, // A single variable e.g. x.\r\n            EX = Groups.EX = 4, // An exponential\r\n            FN = Groups.FN = 5, // A function\r\n            PL = Groups.PL = 6, // A symbol/expression having same name with different powers e.g. 1/x + x^2\r\n            CB = Groups.CB = 7, // A symbol/expression composed of one or more variables through multiplication e.g. x*y\r\n            CP = Groups.CP = 8; // A symbol/expression composed of one variable and any other symbol or number x+1 or x+y\r\n\r\n    var CONST_HASH = Settings.CONST_HASH = '#';\r\n\r\n    var PARENTHESIS = Settings.PARENTHESIS;\r\n\r\n    var SQRT = Settings.SQRT;\r\n\r\n    var ABS = Settings.ABS;\r\n\r\n    var FACTORIAL = Settings.FACTORIAL;\r\n\r\n    var DOUBLEFACTORIAL = Settings.DOUBLEFACTORIAL;\r\n\r\n    //the storage container \"memory\" for parsed expressions\r\n    var EXPRESSIONS = [];\r\n\r\n    //variables\r\n    var VARS = {};\r\n\r\n    //the container used to store all the reserved functions\r\n    var RESERVED = [];\r\n\r\n    var WARNINGS = [];\r\n\r\n    /**\r\n     * Use this when errors are suppressible\r\n     * @param {String} msg\r\n     * @param {object} ErrorObj\r\n     */\r\n    var err = function (msg, ErrorObj) {\r\n        if(!Settings.suppress_errors) {\r\n            if(ErrorObj)\r\n                throw new ErrorObj(msg);\r\n            else\r\n                throw new Error(msg);\r\n        }\r\n    };\r\n\r\n//Utils ========================================================================\r\n    var customError = function (name) {\r\n        var E = function (message) {\r\n            this.name = name;\r\n            this.message = message !== undefined ? message : '';\r\n            var error = new Error(this.message);\r\n            error.name = this.name;\r\n            this.stack = error.stack;\r\n        }; //create an empty error\r\n        E.prototype = Object.create(Error.prototype);\r\n        return E;\r\n    };\r\n\r\n    /**\r\n     * Checks to see if value is one of nerdamer's reserved names\r\n     * @param {String} value\r\n     * @return boolean\r\n     */\r\n    var isReserved = function (value) {\r\n        return RESERVED.indexOf(value) !== -1;\r\n    };\r\n\r\n    /**\r\n     * Checks to see that all symbols in array are the same\r\n     * @param {Symbol[]} arr\r\n     * @returns {bool}\r\n     */\r\n    var allSame = function (arr) {\r\n        var last = arr[0];\r\n        for(var i = 1, l = arr.length; i < l; i++)\r\n            if(!arr[i].equals(last))\r\n                return false;\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Used to pass warnings or low severity errors about the library\r\n     * @param msg\r\n     */\r\n    var warn = function (msg) {\r\n        WARNINGS.push(msg);\r\n        if(Settings.SHOW_WARNINGS && console && console.warn) {\r\n            console.warn(msg);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Enforces rule: \"must start with a letter or underscore and\r\n     * can have any number of underscores, letters, and numbers thereafter.\"\r\n     * @param name The name of the symbol being checked\r\n     * @param {String} typ - The type of symbols that's being validated\r\n     * @throws {Exception}  - Throws an exception on fail\r\n     */\r\n    var validateName = function (name, typ) {\r\n        typ = typ || 'variable';\r\n        if(Settings.ALLOW_CHARS.indexOf(name) !== -1)\r\n            return;\r\n        var regex = Settings.VALIDATION_REGEX;\r\n        if(!(regex.test(name))) {\r\n            throw new InvalidVariableNameError(name + ' is not a valid ' + typ + ' name');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Convert number from scientific format to decimal format\r\n     * @param {Number} num\r\n     */\r\n    var scientificToDecimal = function (num) {\r\n        var nsign = Math.sign(num);\r\n        //remove the sign\r\n        num = Math.abs(num);\r\n        //if the number is in scientific notation remove it\r\n        if(/\\d+\\.?\\d*e[\\+\\-]*\\d+/i.test(num)) {\r\n            var zero = '0',\r\n                    parts = String(num).toLowerCase().split('e'), //split into coeff and exponent\r\n                    e = parts.pop(), //store the exponential part\r\n                    l = Math.abs(e), //get the number of zeros\r\n                    sign = e / l,\r\n                    coeff_array = parts[0].split('.');\r\n            if(sign === -1) {\r\n                l = l - coeff_array[0].length;\r\n                if(l < 0) {\r\n                    num = coeff_array[0].slice(0, l) + '.' + coeff_array[0].slice(l) + (coeff_array.length === 2 ? coeff_array[1] : '');\r\n                }\r\n                else {\r\n                    num = zero + '.' + new Array(l + 1).join(zero) + coeff_array.join('');\r\n                }\r\n            }\r\n            else {\r\n                var dec = coeff_array[1];\r\n                if(dec)\r\n                    l = l - dec.length;\r\n                if(l < 0) {\r\n                    num = coeff_array[0] + dec.slice(0, l) + '.' + dec.slice(l);\r\n                }\r\n                else {\r\n                    num = coeff_array.join('') + new Array(l + 1).join(zero);\r\n                }\r\n            }\r\n        }\r\n\r\n        return nsign < 0 ? '-' + num : num;\r\n    };\r\n    /**\r\n     * Checks if number is a prime number\r\n     * @param {Number} n - the number to be checked\r\n     */\r\n    var isPrime = function (n) {\r\n        var q = Math.floor(Math.sqrt(n));\r\n        for(var i = 2; i <= q; i++) {\r\n            if(n % i === 0)\r\n                return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Generates an object with known variable value for evaluation\r\n     * @param {String} variable\r\n     * @param {any} value Any stringifyable object\r\n     * @returns {Object} \r\n     */\r\n    var knownVariable = function (variable, value) {\r\n        var o = {};\r\n        o[variable] = value;\r\n        return o;\r\n    };\r\n\r\n    /**\r\n     * Checks if n is a number\r\n     * @param {any} n\r\n     */\r\n    var isNumber = function (n) {\r\n        return /^\\d+\\.?\\d*$/.test(n);\r\n    };\r\n\r\n    /**\r\n     * Checks to see if an array contains only numeric values\r\n     * @param {Array} arr\r\n     */\r\n    var allNumeric = function (arr) {\r\n        for(var i = 0; i < arr.length; i++)\r\n            if(!isNumber(arr[i]))\r\n                return false;\r\n        return true;\r\n    };\r\n    /**\r\n     * Checks to see if a number or Symbol is a fraction\r\n     * @param {Number|Symbol} num\r\n     * @returns {boolean}\r\n     */\r\n    var isFraction = function (num) {\r\n        if(isSymbol(num))\r\n            return isFraction(num.multiplier.toDecimal());\r\n        return (num % 1 !== 0);\r\n    };\r\n\r\n    /**\r\n     * Checks to see if the object provided is a Symbol\r\n     * @param {Object} obj\r\n     */\r\n    var isSymbol = function (obj) {\r\n        return (obj instanceof Symbol);\r\n    };\r\n\r\n    /**\r\n     * Checks to see if the object provided is an Expression\r\n     * @param {Object} obj\r\n     */\r\n    var isExpression = function (obj) {\r\n        return (obj instanceof Expression);\r\n    };\r\n\r\n    /**\r\n     * This method traverses the symbol structure and grabs all the variables in a symbol. The variable\r\n     * names are then returned in alphabetical order.\r\n     * @param {Symbol} obj\r\n     * @param {Boolean} poly\r\n     * @param {Object} vars - An object containing the variables. Do not pass this in as it generated\r\n     * automatically. In the future this will be a Collector object.\r\n     * @returns {String[]} - An array containing variable names\r\n     */\r\n    var variables = function (obj, poly, vars) {\r\n        vars = vars || {\r\n            c: [],\r\n            add: function (value) {\r\n                if(this.c.indexOf(value) === -1 && isNaN(value))\r\n                    this.c.push(value);\r\n            }\r\n        };\r\n\r\n        if(isSymbol(obj)) {\r\n            var group = obj.group,\r\n                    prevgroup = obj.previousGroup;\r\n            if(group === EX)\r\n                variables(obj.power, poly, vars);\r\n\r\n            if(group === CP || group === CB || prevgroup === CP || prevgroup === CB) {\r\n                for(var x in obj.symbols) {\r\n                    variables(obj.symbols[x], poly, vars);\r\n                }\r\n            }\r\n            else if(group === S || prevgroup === S) {\r\n                //very crude needs fixing. TODO\r\n                if(!(obj.value === 'e' || obj.value === 'pi' || obj.value === Settings.IMAGINARY))\r\n                    vars.add(obj.value);\r\n            }\r\n            else if(group === PL || prevgroup === PL) {\r\n                variables(firstObject(obj.symbols), poly, vars);\r\n            }\r\n            else if(group === EX) {\r\n                if(!isNaN(obj.value))\r\n                    vars.add(obj.value);\r\n                variables(obj.power, poly, vars);\r\n            }\r\n            else if(group === FN && !poly) {\r\n                for(var i = 0; i < obj.args.length; i++) {\r\n                    variables(obj.args[i], poly, vars);\r\n                }\r\n            }\r\n        }\r\n\r\n        return vars.c.sort();\r\n    };\r\n\r\n    /**\r\n     * Returns the sum of an array\r\n     * @param {Array} arr\r\n     * @param {boolean} toNumber\r\n     * @returns {Symbol}\r\n     */\r\n    var arraySum = function (arr, toNumber) {\r\n        var sum = new Symbol(0);\r\n        for(var i = 0; i < arr.length; i++) {\r\n            var x = arr[i];\r\n            // Convert to symbol if not\r\n            sum = _.add(sum, !isSymbol(x) ? _.parse(x) : x);\r\n        }\r\n\r\n        return toNumber ? Number(sum) : sum;\r\n    };\r\n\r\n    /**\r\n     * Separates out the variables into terms of variabls.\r\n     * e.g. x+y+x*y+sqrt(2)+pi returns\r\n     * {x: x, y: y, x y: x*y, constants: sqrt(2)+pi\r\n     * @param {type} symbol\r\n     * @param {type} o\r\n     * @returns {undefined}\r\n     * @throws {Error} for expontentials\r\n     */\r\n    var separate = function (symbol, o) {\r\n        symbol = _.expand(symbol);\r\n        o = o || {};\r\n        var insert = function (key, sym) {\r\n            if(!o[key])\r\n                o[key] = new Symbol(0);\r\n            o[key] = _.add(o[key], sym.clone());\r\n        };\r\n        symbol.each(function (x) {\r\n            if(x.isConstant('all')) {\r\n                insert('constants', x);\r\n            }\r\n            else if(x.group === S) {\r\n                insert(x.value, x);\r\n            }\r\n            else if(x.group === FN && (x.fname === ABS || x.fname === '')) {\r\n                separate(x.args[0]);\r\n            }\r\n            else if(x.group === EX || x.group === FN) {\r\n                throw new Error('Unable to separate. Term cannot be a function!');\r\n            }\r\n            else {\r\n                insert(variables(x).join(' '), x);\r\n            }\r\n        });\r\n\r\n        return o;\r\n    };\r\n\r\n    /**\r\n     * Fills holes in an array with zero symbol or generates one with n zeroes\r\n     * @param {Array} arr\r\n     * @param {Number} n\r\n     */\r\n    var fillHoles = function (arr, n) {\r\n        n = n || arr.length;\r\n        for(var i = 0; i < n; i++) {\r\n            var sym = arr[i];\r\n            if(!sym)\r\n                arr[i] = new Symbol(0);\r\n        }\r\n        return arr;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * Checks to see if the object provided is a Vector\r\n     * @param {Object} obj\r\n     */\r\n    var isVector = function (obj) {\r\n        return (obj instanceof Vector);\r\n    };\r\n\r\n    /**\r\n     * Checks to see if the object provided is a Matrix\r\n     * @param {Object} obj\r\n     */\r\n    var isMatrix = function (obj) {\r\n        return (obj instanceof Matrix);\r\n    };\r\n\r\n    var isSet = function (obj) {\r\n        return (obj instanceof Set);\r\n    };\r\n\r\n    /**\r\n     * Checks to see if a symbol is in group N\r\n     * @param {Symbol} symbol\r\n     */\r\n    var isNumericSymbol = function (symbol) {\r\n        return symbol.group === N || symbol.group === P;\r\n    };\r\n\r\n    /**\r\n     * Checks to see if a symbol is a variable with no multiplier nor power\r\n     * @param {Symbol} symbol\r\n     */\r\n    var isVariableSymbol = function (symbol) {\r\n        return symbol.group === S && symbol.multiplier.equals(1) && symbol.power.equals(1);\r\n    };\r\n\r\n    /**\r\n     * Checks to see if the object provided is an Array\r\n     * @param {Object} arr\r\n     */\r\n    var isArray = function (arr) {\r\n        return Array.isArray(arr);\r\n    };\r\n\r\n    /**\r\n     * Checks to see if a number is an integer\r\n     * @param {Number} num\r\n     */\r\n    var isInt = function (num) {\r\n        return /^[-+]?\\d+e?\\+?\\d*$/gim.test(num.toString());\r\n    };\r\n\r\n    /**\r\n     * @param {Number|Symbol} obj\r\n     * @returns {boolean}\r\n     */\r\n    var isNegative = function (obj) {\r\n        if(isSymbol(obj)) {\r\n            obj = obj.multiplier;\r\n        }\r\n        return obj.lessThan(0);\r\n    };\r\n    /**\r\n     * Safely stringify object\r\n     * @param o\r\n     */\r\n    var stringify = function (o) {\r\n        if(!o)\r\n            return o;\r\n        return String(o);\r\n    };\r\n\r\n    /**\r\n     * @param {String} str\r\n     * @returns {String} - returns a formatted string surrounded by brackets\r\n     */\r\n    var inBrackets = function (str) {\r\n        return '(' + str + ')';\r\n    };\r\n\r\n    /**\r\n     * A helper function to replace parts of string\r\n     * @param {String} str - The original string\r\n     * @param {Integer} from - The starting index\r\n     * @param {Integer} to - The ending index\r\n     * @param {String} with_str - The replacement string\r\n     * @returns {String} - A formatted string\r\n     */\r\n    var stringReplace = function (str, from, to, with_str) {\r\n        return str.substr(0, from) + with_str + str.substr(to, str.length);\r\n    };\r\n\r\n    /**\r\n     * the Parser uses this to check if it's allowed to convert the obj to type Symbol\r\n     * @param {Object} obj\r\n     * @returns {boolean}\r\n     */\r\n    var customType = function (obj) {\r\n        return obj !== undefined && obj.custom;\r\n    };\r\n\r\n    /**\r\n     * Checks to see if numbers are both negative or are both positive\r\n     * @param {Number} a\r\n     * @param {Number} b\r\n     * @returns {boolean}\r\n     */\r\n    var sameSign = function (a, b) {\r\n        return (a < 0) === (b < 0);\r\n    };\r\n\r\n    /**\r\n     * A helper function to replace multiple occurences in a string. Takes multiple arguments\r\n     * @example format('{0} nice, {0} sweet', 'something')\r\n     * //returns 'something nice, something sweet'\r\n     */\r\n    var format = function () {\r\n        var args = [].slice.call(arguments),\r\n                str = args.shift();\r\n        var new_str = str.replace(/{(\\d+)}/g, function (match, index) {\r\n            var arg = args[index];\r\n            return typeof arg === 'function' ? arg() : arg;\r\n        });\r\n\r\n        return new_str;\r\n    };\r\n\r\n    /**\r\n     * Generates an array with values within a range. Multiplies by a step if provided\r\n     * @param {Number} start\r\n     * @param {Number} end\r\n     * @param {Number} step\r\n     */\r\n    var range = function (start, end, step) {\r\n        var arr = [];\r\n        step = step || 1;\r\n        for(var i = start; i <= end; i++)\r\n            arr.push(i * step);\r\n        return arr;\r\n    };\r\n\r\n    /**\r\n     * Returns an array of all the keys in an array\r\n     * @param {Object} obj\r\n     * @returns {Array}\r\n     */\r\n    var keys = Object.keys;\r\n\r\n    /**\r\n     * Returns the first encountered item in an object. Items do not have a fixed order in objects\r\n     * so only use if you need any first random or if there's only one item in the object\r\n     * @param {Object} obj\r\n     * @param {String} key Return this key as first object\r\n     * @param {Boolean} both\r\n     * @returns {*}\r\n     */\r\n    var firstObject = function (obj, key, both) {\r\n        for(var x in obj)\r\n            break;\r\n        if(key)\r\n            return x;\r\n        if(both)\r\n            return {\r\n                key: x,\r\n                obj: obj[x]\r\n            };\r\n        return obj[x];\r\n    };\r\n\r\n    /**\r\n     * Substitutes out variables for two symbols, parses them to a number and them compares them numerically\r\n     * @param {Symbol} sym1\r\n     * @param {Symbol} sym2\r\n     * @param {String[]} vars - an optional array of variables to use\r\n     * @returns {bool}\r\n     */\r\n    var compare = function (sym1, sym2, vars) {\r\n        var n = 5; //a random number between 1 and 5 is good enough\r\n        var scope = {}; // scope object with random numbers generated using vars\r\n        var comparison;\r\n        for(var i = 0; i < vars.length; i++)\r\n            scope[vars[i]] = new Symbol(Math.floor(Math.random() * n) + 1);\r\n        block('PARSE2NUMBER', function () {\r\n            comparison = _.parse(sym1, scope).equals(_.parse(sym2, scope));\r\n        });\r\n        return comparison;\r\n    };\r\n\r\n    /**\r\n     * Is used to set a user defined function using the function assign operator\r\n     * @param {String} name\r\n     * @param {String[]} params_array\r\n     * @param {String} body\r\n     * @returns {Boolean}\r\n     */\r\n    var setFunction = function (name, params_array, body) {\r\n        validateName(name);\r\n        if(!isReserved(name)) {\r\n            params_array = params_array || variables(_.parse(body));\r\n            // The function gets set to PARSER.mapped function which is just\r\n            // a generic function call.\r\n            _.functions[name] = [_.mapped_function, params_array.length, {\r\n                    name: name,\r\n                    params: params_array,\r\n                    body: body\r\n                }];\r\n\r\n            return body;\r\n        }\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * Returns the minimum number in an array\r\n     * @param {Array} arr\r\n     * @returns {Number}\r\n     */\r\n    var arrayMax = function (arr) {\r\n        return Math.max.apply(undefined, arr);\r\n    };\r\n\r\n    /**\r\n     * Returns the maximum number in an array\r\n     * @param {Array} arr\r\n     * @returns {Number}\r\n     */\r\n    var arrayMin = function (arr) {\r\n        return Math.min.apply(undefined, arr);\r\n    };\r\n\r\n    /**\r\n     * Checks to see if two arrays are equal\r\n     * @param {Array} arr1 \r\n     * @param {Array} arr2 \r\n     */\r\n    var arrayEqual = function (arr1, arr2) {\r\n        arr1.sort();\r\n        arr2.sort();\r\n\r\n        // The must be of the same length\r\n        if(arr1.length === arr2.length) {\r\n            for(var i = 0; i < arr1.length; i++) {\r\n                // If any two items don't match we're done\r\n                if(arr1[i] !== arr2[i]) {\r\n                    return false;\r\n                }\r\n            }\r\n            // Otherwise they're equal\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * Clones array with clonable items\r\n     * @param {Array} arr\r\n     * @returns {Array}\r\n     */\r\n    var arrayClone = function (arr) {\r\n        var new_array = [], l = arr.length;\r\n        for(var i = 0; i < l; i++)\r\n            new_array[i] = arr[i].clone();\r\n        return new_array;\r\n    };\r\n\r\n    /**\r\n     * Fills numbers between array values\r\n     * @param {Numbers[]} arr\r\n     * @param {Integer} slices\r\n     */\r\n    var arrayAddSlices = function (arr, slices) {\r\n        slices = slices || 20;\r\n        var retval = [];\r\n        var c, delta, e;\r\n        retval.push(arr[0]); //push the beginning\r\n        for(var i = 0; i < arr.length - 1; i++) {\r\n            c = arr[i];\r\n            delta = arr[i + 1] - c; //get the difference\r\n            e = delta / slices; //chop it up in the desired number of slices\r\n            for(var j = 0; j < slices; j++) {\r\n                c += e; //add the mesh to the last slice\r\n                retval.push(c);\r\n            }\r\n        }\r\n\r\n        return retval;\r\n    };\r\n\r\n    /**\r\n     * Gets nth roots of a number\r\n     * @param {Symbol} symbol\r\n     * @returns {Vector}\r\n     */\r\n    var nroots = function (symbol) {\r\n        var a, b;\r\n\r\n        if(symbol.group === FN && symbol.fname === '') {\r\n            a = Symbol.unwrapPARENS(_.parse(symbol).toLinear());\r\n            b = _.parse(symbol.power);\r\n        }\r\n        else if(symbol.group === P) {\r\n            a = _.parse(symbol.value);\r\n            b = _.parse(symbol.power);\r\n        }\r\n\r\n        if(a && b && (a.group === N) && b.group === N && a.multiplier.isNegative()) {\r\n            var _roots = [];\r\n\r\n            var parts = Symbol.toPolarFormArray(evaluate(symbol));\r\n            var r = parts[0];\r\n\r\n            //var r = _.parse(a).abs().toString();\r\n\r\n            //https://en.wikipedia.org/wiki/De_Moivre%27s_formula\r\n            var x = _.arg(a);\r\n            var n = b.multiplier.den.toString();\r\n            var p = b.multiplier.num.toString();\r\n\r\n            var formula = '(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})';\r\n\r\n            for(var i = 0; i < n; i++) {\r\n                var t = evaluate(_.parse(format(\"(({0})+2*pi*({1}))/({2})\", x, i, n))).multiplier.toDecimal();\r\n                _roots.push(evaluate(_.parse(format(formula, r, n, Settings.IMAGINARY, t, p))));\r\n            }\r\n            return Vector.fromArray(_roots);\r\n        }\r\n        else if(symbol.isConstant(true, true)) {\r\n            var sign = symbol.sign();\r\n            var x = evaluate(symbol.abs());\r\n            var root = _.sqrt(x);\r\n\r\n            var _roots = [root.clone(), root.negate()];\r\n\r\n            if(sign < 0)\r\n                _roots = _roots.map(function (x) {\r\n                    return _.multiply(x, Symbol.imaginary());\r\n                });\r\n\r\n        }\r\n        else {\r\n            _roots = [_.parse(symbol)];\r\n        }\r\n\r\n        return Vector.fromArray(_roots);\r\n    };\r\n\r\n    /**\r\n     * Sorts and array given 2 parameters\r\n     * @param {String} a\r\n     * @param {String} b\r\n     */\r\n    var comboSort = function (a, b) {\r\n        var l = a.length,\r\n                combined = []; //the linker\r\n        for(var i = 0; i < a.length; i++) {\r\n            combined.push([a[i], b[i]]); //create the map\r\n        }\r\n\r\n        combined.sort(function (x, y) {\r\n            return x[0] - y[0];\r\n        });\r\n\r\n        var na = [], nb = [];\r\n\r\n        for(i = 0; i < l; i++) {\r\n            na.push(combined[i][0]);\r\n            nb.push(combined[i][1]);\r\n        }\r\n\r\n        return [na, nb];\r\n    };\r\n    /**\r\n     * TODO: Pick a more descriptive name and better description\r\n     * Breaks a function down into it's parts wrt to a variable, mainly coefficients\r\n     * Example a*x^2+b wrt x\r\n     * @param {Symbol} fn\r\n     * @param {String} wrt\r\n     * @param {bool} as_obj\r\n     */\r\n    var decompose_fn = function (fn, wrt, as_obj) {\r\n        wrt = String(wrt); //convert to string\r\n        var ax, a, x, b;\r\n        if(fn.group === CP) {\r\n            var t = _.expand(fn.clone()).stripVar(wrt);\r\n            ax = _.subtract(fn.clone(), t.clone());\r\n            b = t;\r\n        }\r\n        else\r\n            ax = fn.clone();\r\n        a = ax.stripVar(wrt);\r\n        x = _.divide(ax.clone(), a.clone());\r\n        b = b || new Symbol(0);\r\n        if(as_obj)\r\n            return {\r\n                a: a,\r\n                x: x,\r\n                ax: ax,\r\n                b: b\r\n            };\r\n        return [a, x, ax, b];\r\n    };\r\n    /**\r\n     * Rounds a number up to x decimal places\r\n     * @param {Number} x\r\n     * @param {Number} s\r\n     */\r\n    var nround = function (x, s) {\r\n        if(isInt(x)) {\r\n            if(x >= Number.MAX_VALUE)\r\n                return x.toString();\r\n            return Number(x);\r\n        }\r\n\r\n        s = typeof s === 'undefined' ? 14 : s;\r\n        return Math.round(x * Math.pow(10, s)) / Math.pow(10, s);\r\n    };\r\n\r\n    /**\r\n     * Is used for u-substitution. Gets a suitable u for substitution. If for\r\n     * instance a is used in the symbol then it keeps going down the line until\r\n     * one is found that's not in use. If all letters are taken then it\r\n     * starts appending numbers.\r\n     * IMPORTANT! It assumes that the substitution will be undone\r\n     * beore the user gets to interact with the object again.\r\n     * @param {Symbol} symbol\r\n     */\r\n    var getU = function (symbol) {\r\n        //start with u\r\n        var u = 'u', //start with u\r\n                v = u, //init with u\r\n                c = 0, //postfix number\r\n                vars = variables(symbol);\r\n        //make sure this variable isn't reserved and isn't in the variable list\r\n        while(!(RESERVED.indexOf(v) === - 1 && vars.indexOf(v) === - 1))\r\n            v = u + c++;\r\n        //get an empty slot. It seems easier to just push but the\r\n        //problem is that we may have some which are created by clearU\r\n        for(var i = 0, l = RESERVED.length; i <= l; i++)\r\n            //reserved cannot equals false or 0 so we can safely check for a falsy type\r\n            if(!RESERVED[i]) {\r\n                RESERVED[i] = v; //reserve the variable\r\n                break;\r\n            }\r\n        return v;\r\n    };\r\n\r\n    /**\r\n     * Clears the u variable so it's no longer reserved\r\n     * @param {String} u\r\n     */\r\n    var clearU = function (u) {\r\n        var indx = RESERVED.indexOf(u);\r\n        if(indx !== -1)\r\n            RESERVED[indx] = undefined;\r\n    };\r\n\r\n    /**\r\n     * Loops through each item in object and calls function with item as param\r\n     * @param {Object|Array} obj\r\n     * @param {Function} fn\r\n     */\r\n    var each = function (obj, fn) {\r\n        if(isArray(obj)) {\r\n            var l = obj.length;\r\n            for(var i = 0; i < l; i++)\r\n                fn.call(obj, i);\r\n        }\r\n        else {\r\n            for(var x in obj)\r\n                if(obj.hasOwnProperty(x))\r\n                    fn.call(obj, x);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Checks to see if a number is an even number\r\n     * @param {Number} num\r\n     * @returns {boolean}\r\n     */\r\n    var even = function (num) {\r\n        return num % 2 === 0;\r\n    };\r\n\r\n    /**\r\n     * Checks to see if a fraction is divisible by 2\r\n     * @param {Number} num\r\n     * @returns {boolean}\r\n     */\r\n    var evenFraction = function (num) {\r\n        return 1 / (num % 1) % 2 === 0;\r\n    };\r\n\r\n    /**\r\n     * Strips duplicates out of an array\r\n     * @param {Array} arr\r\n     */\r\n    var arrayUnique = function (arr) {\r\n        var l = arr.length, a = [];\r\n        for(var i = 0; i < l; i++) {\r\n            var item = arr[i];\r\n            if(a.indexOf(item) === -1)\r\n                a.push(item);\r\n        }\r\n        return a;\r\n    };\r\n\r\n    /**\r\n     * Gets all the variables in an array of Symbols\r\n     * @param {Symbol[]} arr \r\n     */\r\n    var arrayGetVariables = function (arr) {\r\n        var vars = variables(arr[0], null, null, true);\r\n\r\n        //get all variables\r\n        for(var i = 1, l = arr.length; i < l; i++)\r\n            vars = vars.concat(variables(arr[i]));\r\n        //remove duplicates\r\n        vars = arrayUnique(vars).sort();\r\n\r\n        //done\r\n        return vars;\r\n    };\r\n\r\n    /**\r\n     * Removes duplicates from an array. Returns a new array\r\n     * @param {Array} arr\r\n     * @param {Function} condition\r\n     */\r\n    var removeDuplicates = function (arr, condition) {\r\n        var conditionType = typeof condition;\r\n\r\n        if(conditionType !== 'function' || conditionType === 'undefined') {\r\n            condition = function (a, b) {\r\n                return a === b;\r\n            };\r\n        }\r\n\r\n        var seen = [];\r\n\r\n        while(arr.length) {\r\n            var a = arr[0];\r\n            //only one element left so we're done\r\n            if(arr.length === 1) {\r\n                seen.push(a);\r\n                break;\r\n            }\r\n            var temp = [];\r\n            seen.push(a); //we already scanned these\r\n            for(var i = 1; i < arr.length; i++) {\r\n                var b = arr[i];\r\n                //if the number is outside the specified tolerance\r\n                if(!condition(a, b))\r\n                    temp.push(b);\r\n            }\r\n            //start over with the remainder\r\n            arr = temp;\r\n        }\r\n\r\n        return seen;\r\n    };\r\n\r\n    /**\r\n     * Reserves the names in an object so they cannot be used as function names\r\n     * @param {Object} obj\r\n     */\r\n    var reserveNames = function (obj) {\r\n        var add = function (item) {\r\n            if(RESERVED.indexOf(item) === -1)\r\n                RESERVED.push(item);\r\n        };\r\n\r\n        if(typeof obj === 'string')\r\n            add(obj);\r\n        else {\r\n            each(obj, function (x) {\r\n                add(x);\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Removes an item from either an array or an object. If the object is an array, the index must be\r\n     * specified after the array. If it's an object then the key must be specified\r\n     * @param {Object|Array} obj\r\n     * @param {Integer} indexOrKey\r\n     */\r\n    var remove = function (obj, indexOrKey) {\r\n        var result;\r\n        if(isArray(obj)) {\r\n            result = obj.splice(indexOrKey, 1)[0];\r\n        }\r\n        else {\r\n            result = obj[indexOrKey];\r\n            delete obj[indexOrKey];\r\n        }\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Creates a temporary block in which one of the global settings is temporarily modified while\r\n     * the function is called. For instance if you want to parse directly to a number rather than have a symbolic\r\n     * answer for a period you would set PARSE2NUMBER to true in the block.\r\n     * @example block('PARSE2NUMBER', function(){//symbol being parsed to number}, true);\r\n     * @param {String} setting - The setting being accessed\r\n     * @param {Function} f\r\n     * @param {boolean} opt - The value of the setting in the block\r\n     * @param {String} obj - The obj of interest. Usually a Symbol but could be any object\r\n     */\r\n    var block = function (setting, f, opt, obj) {\r\n        var current_setting = Settings[setting];\r\n        Settings[setting] = opt === undefined ? true : !!opt;\r\n        var retval = f.call(obj);\r\n        Settings[setting] = current_setting;\r\n        return retval;\r\n    };\r\n\r\n    /**\r\n     * provide a mechanism for accessing functions directly. Not yet complete!!!\r\n     * Some functions will return undefined. This can maybe just remove the\r\n     * function object at some point when all functions are eventually\r\n     * housed in the global function object. Returns ALL parser available\r\n     * functions. Parser.functions may not contain all functions\r\n     */\r\n    var importFunctions = function () {\r\n        var o = {};\r\n        for(var x in _.functions)\r\n            o[x] = _.functions[x][0];\r\n        return o;\r\n    };\r\n\r\n    /**\r\n     * Converts function arguments to an array. Now used by gcd and lcm in Algebra.js :)\r\n     * @param {Array|object} obj\r\n     */\r\n    var arguments2Array = function (obj) {\r\n        return [].slice.call(obj);\r\n    };\r\n\r\n    /**\r\n     * Returns the coefficients of a symbol given a variable. Given ax^2+b^x+c, it divides\r\n     * each nth term by x^n.\r\n     * @param {Symbol} symbol\r\n     * @param {Symbol} wrt\r\n     */\r\n    var getCoeffs = function (symbol, wrt, info) {\r\n        var coeffs = [];\r\n        //we loop through the symbols and stick them in their respective\r\n        //containers e.g. y*x^2 goes to index 2\r\n        symbol.each(function (term) {\r\n            if(term.contains(wrt)) {\r\n                //we want only the coefficient which in this case will be everything but the variable\r\n                //e.g. a*b*x -> a*b if the variable to solve for is x\r\n                var coeff = term.stripVar(wrt),\r\n                        x = _.divide(term.clone(), coeff.clone()),\r\n                        p = x.power.toDecimal();\r\n            }\r\n            else {\r\n                coeff = term;\r\n                p = 0;\r\n            }\r\n            var e = coeffs[p];\r\n            //if it exists just add it to it\r\n            coeffs[p] = e ? _.add(e, coeff) : coeff;\r\n\r\n        }, true);\r\n\r\n        for(var i = 0; i < coeffs.length; i++)\r\n            if(!coeffs[i])\r\n                coeffs[i] = new Symbol(0);\r\n        //fill the holes\r\n        return coeffs;\r\n    };\r\n\r\n    /**\r\n     * As the name states. It forces evaluation of the expression\r\n     * @param {Symbol} symbol\r\n     * @param {Symbol} o\r\n     */\r\n    var evaluate = function (symbol, o) {\r\n        return block('PARSE2NUMBER', function () {\r\n            return _.parse(symbol, o);\r\n        }, true);\r\n    };\r\n\r\n    /**\r\n     * Converts an array to a vector. Consider moving this to Vector.fromArray\r\n     * @param {String[]|String|Symbol|Number|Number[]} x\r\n     */\r\n    var convertToVector = function (x) {\r\n        if(isArray(x)) {\r\n            var vector = new Vector([]);\r\n            for(var i = 0; i < x.length; i++)\r\n                vector.elements.push(convertToVector(x[i]));\r\n            return vector;\r\n        }\r\n        //Ensure that a nerdamer ready object is returned\r\n        if(!isSymbol(x))\r\n            return _.parse(x);\r\n        return x;\r\n    };\r\n\r\n    /**\r\n     * Generates prime numbers up to a specified number\r\n     * @param {Number} upto\r\n     */\r\n    var generatePrimes = function (upto) {\r\n        //get the last prime in the array\r\n        var last_prime = PRIMES[PRIMES.length - 1] || 2;\r\n        //no need to check if we've already encountered the number. Just check the cache.\r\n        for(var i = last_prime; i < upto; i++) {\r\n            if(isPrime(i))\r\n                PRIMES.push(i);\r\n        }\r\n    };\r\n    /**\r\n     * Checks to see if all arguments are numbers\r\n     * @param {object} args\r\n     */\r\n    var allNumbers = function (args) {\r\n        for(var i = 0; i < args.length; i++)\r\n            if(args[i].group !== N)\r\n                return false;\r\n        return true;\r\n    };\r\n    /*\r\n     * Checks if all arguments aren't just all number but if they\r\n     * are constants as well e.g. pi, e.\r\n     * @param {object} args\r\n     */\r\n    var allConstants = function (args) {\r\n        for(var i = 0; i < args.length; i++) {\r\n            if(args[i].isPi() || args[i].isE())\r\n                continue;\r\n            if(!args[i].isConstant(true))\r\n                return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Used to multiply two expression in expanded form\r\n     * @param {Symbol} a\r\n     * @param {Symbol} b\r\n     */\r\n    var mix = function (a, b, opt) {\r\n        // Flip them if b is a CP or PL and a is not\r\n        if(b.isComposite() && !a.isComposite() || b.isLinear() && !a.isLinear()) {\r\n            [a, b] = [b, a];\r\n        }\r\n        // A temporary variable to hold the expanded terms\r\n        var t = new Symbol(0);\r\n        if(a.isLinear()) {\r\n            a.each(function (x) {\r\n                // If b is not a PL or a CP then simply multiply it\r\n                if(!b.isComposite()) {\r\n                    var term = _.multiply(_.parse(x), _.parse(b));\r\n                    t = _.add(t, _.expand(term, opt));\r\n                }\r\n                // Otherwise multiply out each term.\r\n                else if(b.isLinear()) {\r\n                    b.each(function (y) {\r\n                        var term = _.multiply(_.parse(x), _.parse(y));\r\n                        var expanded = _.expand(_.parse(term), opt);\r\n                        t = _.add(t, expanded);\r\n                    }, true);\r\n                }\r\n                else {\r\n                    t = _.add(t, _.multiply(x, _.parse(b)));\r\n                }\r\n            }, true);\r\n        }\r\n        else {\r\n            // Just multiply them together\r\n            t = _.multiply(a, b);\r\n        }\r\n\r\n        // The expanded function is now t\r\n        return t;\r\n    };\r\n\r\n//Exceptions ===================================================================\r\n    //Is thrown for division by zero\r\n    var DivisionByZero = customError('DivisionByZero');\r\n    // Is throw if an error occured during parsing\r\n    var ParseError = customError('ParseError');\r\n    // Is thrown if the expression results in undefined\r\n    var UndefinedError = customError('UndefinedError');\r\n    // Is throw input is out of the function domain\r\n    var OutOfFunctionDomainError = customError('OutOfFunctionDomainError');\r\n    // Is throw if a function exceeds x amount of iterations\r\n    var MaximumIterationsReached = customError('MaximumIterationsReached');\r\n    // Is thrown if the parser receives an incorrect type\r\n    var NerdamerTypeError = customError('NerdamerTypeError');\r\n    // Is thrown if bracket parity is not correct\r\n    var ParityError = customError('ParityError');\r\n    // Is thrown if an unexpectd or incorrect operator is encountered\r\n    var OperatorError = customError('OperatorError');\r\n    // Is thrown if an index is out of range.\r\n    var OutOfRangeError = customError('OutOfRangeError');\r\n    // Is thrown if dimensions are incorrect. Mostly for matrices\r\n    var DimensionError = customError('DimensionError');\r\n    // Is thrown if variable name violates naming rule\r\n    var InvalidVariableNameError = customError('InvalidVariableNameError');\r\n    // Is thrown if the limits of the library are exceeded for a function\r\n    // This can be that the function become unstable passed a value\r\n    var ValueLimitExceededError = customError('ValueLimitExceededError');\r\n    // Is throw if the value is an incorrect LH or RH value\r\n    var NerdamerValueError = customError('NerdamerValueError');\r\n    // Is thrown if the value is an incorrect LH or RH value\r\n    var SolveError = customError('SolveError');\r\n    // Is thrown for an infinite loop\r\n    var InfiniteLoopError = customError('InfiniteLoopError');\r\n    // Is thrown if an operator is found when there shouldn't be one\r\n    var UnexpectedTokenError = customError('UnexpectedTokenError');\r\n\r\n    var exceptions = {\r\n        DivisionByZero: DivisionByZero,\r\n        ParseError: ParseError,\r\n        OutOfFunctionDomainError: OutOfFunctionDomainError,\r\n        UndefinedError: UndefinedError,\r\n        MaximumIterationsReached: MaximumIterationsReached,\r\n        NerdamerTypeError: NerdamerTypeError,\r\n        ParityError: ParityError,\r\n        OperatorError: OperatorError,\r\n        OutOfRangeError: OutOfRangeError,\r\n        DimensionError: DimensionError,\r\n        InvalidVariableNameError: InvalidVariableNameError,\r\n        ValueLimitExceededError: ValueLimitExceededError,\r\n        NerdamerValueError: NerdamerValueError,\r\n        SolveError: SolveError,\r\n        InfiniteLoopError: InfiniteLoopError,\r\n        UnexpectedTokenError: UnexpectedTokenError\r\n    };\r\n//Math2 ========================================================================\r\n    //This object holds additional functions for nerdamer. Think of it as an extension of the Math object.\r\n    //I really don't like touching objects which aren't mine hence the reason for Math2. The names of the\r\n    //functions within are pretty self-explanatory.\r\n    //NOTE: DO NOT USE INLINE COMMENTS WITH THE MATH2 OBJECT! THIS BREAK DURING COMPILATION OF BUILDFUNCTION.\r\n    var Math2 = {\r\n        csc: function (x) {\r\n            return 1 / Math.sin(x);\r\n        },\r\n        sec: function (x) {\r\n            return 1 / Math.cos(x);\r\n        },\r\n        cot: function (x) {\r\n            return 1 / Math.tan(x);\r\n        },\r\n        acsc: function (x) {\r\n            return Math.asin(1 / x);\r\n        },\r\n        asec: function (x) {\r\n            return Math.acos(1 / x);\r\n        },\r\n        acot: function (x) {\r\n            return (Math.PI / 2) - Math.atan(x);\r\n        },\r\n        // https://gist.github.com/jiggzson/df0e9ae8b3b06ff3d8dc2aa062853bd8\r\n        erf: function (x) {\r\n            var t = 1 / (1 + 0.5 * Math.abs(x));\r\n            var result = 1 - t * Math.exp(-x * x - 1.26551223 +\r\n                    t * (1.00002368 +\r\n                            t * (0.37409196 +\r\n                                    t * (0.09678418 +\r\n                                            t * (-0.18628806 +\r\n                                                    t * (0.27886807 +\r\n                                                            t * (-1.13520398 +\r\n                                                                    t * (1.48851587 +\r\n                                                                            t * (-0.82215223 +\r\n                                                                                    t * (0.17087277)))))))))\r\n                    );\r\n            return x >= 0 ? result : -result;\r\n        },\r\n        diff: function (f) {\r\n            var h = 0.001;\r\n\r\n            var derivative = function (x) {\r\n                return (f(x + h) - f(x - h)) / (2 * h);\r\n            };\r\n\r\n            return derivative;\r\n        },\r\n        median: function (...values) {\r\n            values.sort(function (a, b) {\r\n                return a - b;\r\n            });\r\n\r\n            var half = Math.floor(values.length / 2);\r\n\r\n            if(values.length % 2)\r\n                return values[half];\r\n\r\n            return (values[half - 1] + values[half]) / 2.0;\r\n        },\r\n        /*\r\n         * Reverses continued fraction calculation\r\n         * @param {obj} contd\r\n         * @returns {Number}\r\n         */\r\n        fromContinued: function (contd) {\r\n            var arr = contd.fractions.slice();\r\n            var e = 1 / arr.pop();\r\n            for(var i = 0, l = arr.length; i < l; i++) {\r\n                e = 1 / (arr.pop() + e);\r\n            }\r\n            return contd.sign * (contd.whole + e);\r\n        },\r\n        /*\r\n         * Calculates continued fractions\r\n         * @param {Number} n\r\n         * @param {Number} x The number of places\r\n         * @returns {Number}\r\n         */\r\n        continuedFraction: function (n, x) {\r\n            x = x || 20;\r\n            var sign = Math.sign(n); /*store the sign*/\r\n            var absn = Math.abs(n); /*get the absolute value of the number*/\r\n            var whole = Math.floor(absn); /*get the whole*/\r\n            var ni = absn - whole; /*subtract the whole*/\r\n            var c = 0; /*the counter to keep track of iterations*/\r\n            var done = false;\r\n            var epsilon = 1e-14;\r\n            var max = 1e7;\r\n            var e, w;\r\n            var retval = {\r\n                whole: whole,\r\n                sign: sign,\r\n                fractions: []\r\n            };\r\n            /*start calculating*/\r\n            while(!done && ni !== 0) {\r\n                /*invert and get the whole*/\r\n                e = 1 / ni;\r\n                w = Math.floor(e);\r\n                if(w > max) {\r\n                    /*this signals that we may have already gone too far*/\r\n                    var d = Math2.fromContinued(retval) - n;\r\n                    if(d <= Number.EPSILON)\r\n                        break;\r\n                }\r\n                /*add to result*/\r\n                retval.fractions.push(w);\r\n                /*move the ni to the decimal*/\r\n                ni = e - w;\r\n                /*ni should always be a decimal. If we have a whole number then we're in the rounding errors*/\r\n                if(ni <= epsilon || c >= x - 1)\r\n                    done = true;\r\n                c++;\r\n            }\r\n            /*cleanup 1/(n+1/1) = 1/(n+1) so just move the last digit one over if it's one*/\r\n            var idx = retval.fractions.length - 1;\r\n            if(retval.fractions[idx] === 1) {\r\n                retval.fractions.pop();\r\n                /*increase the last one by one*/\r\n                retval.fractions[--idx]++;\r\n            }\r\n            return retval;\r\n        },\r\n        bigpow: function (n, p) {\r\n            if(!(n instanceof Frac))\r\n                n = Frac.create(n);\r\n            if(!(p instanceof Frac))\r\n                p = Frac.create(p);\r\n            var retval = new Frac(0);\r\n            if(p.isInteger()) {\r\n                retval.num = n.num.pow(p.toString());\r\n                retval.den = n.den.pow(p.toString());\r\n            }\r\n            else {\r\n                var num = Frac.create(Math.pow(n.num, p.num));\r\n                var den = Frac.create(Math.pow(n.den, p.num));\r\n\r\n                retval.num = Math2.nthroot(num, p.den.toString());\r\n                retval.den = Math2.nthroot(den, p.den);\r\n            }\r\n            return retval;\r\n        },\r\n        //http://stackoverflow.com/questions/15454183/how-to-make-a-function-that-computes-the-factorial-for-numbers-with-decimals\r\n        gamma: function (z) {\r\n            var g = 7;\r\n            var C = [\r\n                0.99999999999980993,\r\n                676.5203681218851,\r\n                -1259.1392167224028,\r\n                771.32342877765313,\r\n                -176.61502916214059,\r\n                12.507343278686905,\r\n                -0.13857109526572012,\r\n                9.9843695780195716e-6,\r\n                1.5056327351493116e-7]\r\n                    ;\r\n\r\n            if(z < 0.5)\r\n                return Math.PI / (Math.sin(Math.PI * z) * Math2.gamma(1 - z));\r\n            else {\r\n                z -= 1;\r\n\r\n                var x = C[0];\r\n                for(var i = 1; i < g + 2; i++)\r\n                    x += C[i] / (z + i);\r\n\r\n                var t = z + g + 0.5;\r\n                return Math.sqrt(2 * Math.PI) * Math.pow(t, (z + 0.5)) * Math.exp(-t) * x;\r\n            }\r\n        },\r\n        //factorial\r\n        bigfactorial: function (x) {\r\n            var retval = new bigInt(1);\r\n            for(var i = 2; i <= x; i++)\r\n                retval = retval.times(i);\r\n            return new Frac(retval);\r\n        },\r\n        //https://en.wikipedia.org/wiki/Logarithm#Calculation\r\n        bigLog: function (x) {\r\n            var CACHE = [\"-253631954333118718762629409109262279926288908775918712466601196032/39970093576053625963957478139049824030906352922262642968060706375\", \"0\", \"24553090145869607172412918483124184864289170814122579923404694986469653261608528681589949629750677407356463601998534945057511664951799678336/35422621391945757431676178435630229283255250779216421054188228659061954317501699707236864189383591478024245495110561124597124995986978302375\", \"369017335340917140706044240090243368728616279239227943871048759140274862131699550043150713059889196223917527172547/335894053932612728969975338549993764554481173661218585876475837409922537622385232776657791604345125227005476864000\", \"24606853025626737903121303930100462245506322607985779603220820323211395607931699126390918477501325805513849611930008427268176602460462988972957593458726734897129954728102144/17750092415977639787139561330326170936321452137635322313122938207611787444311735251389066106937796085669460151963285086542745859461943369606018450213014148175716400146484375\", \"399073568781976806715759409052286641738926636328983929439450824555613704676637191564699164303012247386095942144825603522401740680808466858044/247958349743620302021733249049411604982786755454514947379317600613433680222511897950658049325685140346169718465773927872179874971908848116625\", \"1468102989495846944084741146947295378041808701256909016224309866143294556551407470861354311593351276612463858816796714569499021375899793849136855085849133702029337910502448189055357182595424959360/819363879309286303497217527375463120404739098260200279520788950777458900438307356738082930586032462601215802636320993648007907724899611296693997216938989854861043298494990214825163523387600982777\", \"5896704855274661767824574093605344871722790278354431422729640950821239030785642943033153793245906863203822369276271050164634206965056233097479117980782641839669/3030306850569309344013726745100070601277982132543905537366562638553198167007159067544789592089960911065181606283478843359856123992707598685058297067179343872000\", \"76631772943534985713873427262830314617912556928476573358548256872141516989538374761909611879922349479420014771499018155447198112155515453671128814488139633810493264352294560043912066253026059140653027326566801398784/36852092933388988649396042883218509607503204211148493545892849595498822817623842579026942621098851631842754395231561679671400197056377380063233740202370686144673585955581403046886083948450136247134308381940165804875\", \"3159076083816399509754948610929467278257473888282947311280653574634802580912280940686954763313882823327077171624015737719617373932318151594325834524000275847475866299387913048/1437757485694188822758304467756419845842037623148461107362957994816554782989250555362514354661961482939226272309026092009962414616417412938087494467254146002233028411865234375\", \"22266067259907364984531611601870291368272674573653403965630628996687370994139884833897773468149149664829922302484782423514167405397665098388400450149078982462318781750661005833037235183394221496186539779712428265837926417581952/9670030144664428565128962309657100138096047028794689249320859276197340398920725569428532293373676415359965773460364494998334259893079003125373872108770534788283842907318071170285038777091588292539102269617376180390982915567375\", \"14604654564989239958569331443385369522850975185358647132770022716433280072271007767111036877803328768910274400515590151934676819262085211828028638417329558229123989556376108454497813055/6090614019162516693013973409650613208227889078878781039105047015752493519149314227721984436973374032279421344818329285207124280297611253861173835238379831004010748379874393292231671808\", \"1901241885407696031217292877862925220917660047127261026827869027159993239567933534052663335498281439239753018507182016153657409777749792228538380379703411298411623469292891476969894084838876001545818141543890273256985768690847587711270930688/765116019778838839812655402103512685695769161212360553099732689795578904762091216998790589926057819838537805856579109910198553330075924857419395160755642371550113347465300208422126945265887065434116781678702741657275181694851670325469434625\", \"139459806786604751793737926146840623607010208216289543036026206208962059593900745886202214788747453279179283344350478734275973878932538430194363355795823581315329311220701640235653288975569812161436/54371368534412517053056101353618694718215711767266376573138772968257303578467926450212293233332401067673270853953399269852376592855992724934941173346260129257754416412476202526978443681584633116375\", \"1045669091124493070709683241190022970908640501171378776604126771144008324358233819560649021940145166254659028524319517244711645162132513416238958170819347361185944945680269442845829390112062101255500836072082817820950448463314034677353723256969344/396228259004446234921310936915931611736815598535963504660076315228798989932959459406702091180060429080345146735173591749448509810270759531977278642135591672189002006272326131885315743181289970885337574780897529347356567086535505950450897216796875\", \"9912919238915437302006264477931031611447467070103973106567538528951878797932559935860738745374437522819124347510590800370471910492338584284092534264608801221235029062881964101996762011296996851893455828946521/3660537472668264151218961634689665210933936249986285290553357254224360417386515311493310199319523687171757653216994741150377508234317025158302057758196429623723072084157928224798322861732880034847243894784000\", \"9263710175433181746575186369318246002919895649622127410824041370079225200282403368319370743363303164313395723904510539050157032684710468364067204876434546848634842333436957245275217583248805993142227630297924119330553308466662488683624783307023014909360640/3341177182697517248552428837661919299725031035849865632511882688786226888137634168024976033652753689210700218163621739078534353578510364301481093730054725078138658805025014615651043313990684347632166030359086885561104034510990826655289288319840595753002771\", \"5116082230713622171832327542439052727465114322479570603905499496221224653983960598946033081212909066917137546065542953865612718836914393275681318667667521726785633638189373998191090501201427906618075889744489190209584/1805752553736060443820406101277706970767657006346276183748749630179442318063568286372320188433843729960294965366346522303898609655762491623098453269916163621089005711823488749297418113474056676109581110715068124438875\", \"246569125619713282434448566970352231845414317018379160824176638351574938993535464763890962336882760882398479702237564384291290459961036068916857265499633061660562532011248501476114401629839742058389195725393702000011860799793778295606988057303225493814005789533570432/85307063020836305797178273029353623060860009152114361453434032434699636078115114412588719432277441055049132559782203988387794711585368296817222565434951256788867244687081233632650953850383220864394261763844194948389861147622944651546912394593164406926489862036343375\", \"133672026303452911046163998480860917119290576658330909785707604886881155606725822685088929236266583416708668502760907677019598002175122453170574729028452721476464728566191464897928696630979863154661704374206171469014225143/45398130975270785045482567762871405072140548998125471025451666500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\", \"6041693953360002800224091673336562508913199995987479264605216252220579740134601435770085920869376641180763419907442721705887169884230643795126568815123647603047739799302562095542459344811429882053086550900803768964612193941424128649976704727183797495759082741166938351872/2016766992122395667828553277997478570503475626107286343497917705446132017125079612756035254750822860815515899557855166824523851779156336235294914777307802256439645525835223691751931866188957324792276149549076500784191791380803500156776088683900346065830066370370083309875\", \"705868391597244582764749229356331441978820024796066870551110486625729826111158236686696326058778874201639006234449557592353247542995871491078308187261304930042019640830629526023972693107193897009168955674240659026247094657679060/231848642748474339277532000336338632910990823562381469441716922006107433404523316252618490265927265734670539384485699132080062215196462178933963957679882342083893417545858074378754089719547920901917516016346211301054206383643383\", \"101832160604157943093944673541651013907278188571533075311673249923948856034633446617630054761681006062910980371900782781226979391765818325065031889334563981235894369036439929651260587335544056975715076598739977065390678221999918899003881778449092038750712969437519295878491018112/32944277910571666002449086492515464541550138004002141571670657643770713783329063548790202120805341989608877739811787937782240802963962520261844114327432160788193314874913687387269408387417806176202979244637915812905426565263196954203487934225589622864145960079736633434831996625\", \"10655703119271468913597640479490594180964700448340778168715956712130636958373270202484276402718566314881119559090842449610957974112230306343486091910217340665146602598568991520563987490686996746558858366002301982443029430290679385551/3398412687366638541233365137084722368200311117891192348532156645374786104142009695796409107380345795998400850838706661851176885183144928701608654514812261697598380070746520197171576610572921007069104300695592751543563472456384512000\", \"1903039332876763837419920240543738799531131775028971323439870868730321221615515008394327723508670975623498588291298064320786970626232668956372004004897872810230178526101184611242511193415796638694370503100219710864543168952682617801833318493436174387568067811938490953495819438108686336/598806534367503338307287246320963280558134937382149405305466709787179429317914803617527827862441615350396864359976273212272586892074799651088317544101755361439294687323233086696182687664637422796995789967075271448560870681210580691574924544896656175563265378514188341796398162841796875\", \"525573915563826130963525826191411949262846916750432019596028344808298471293378917508549164993368392834023782480702893643486699787870059946429810070222126260200026332874480239090370088123833491499400991181659445914352500247596757005142623368/163278727324937389095822405034435687776345799835442022795533783889356344755225815267819508608559076191292900367982490827396869405536484846115955581043091229202052407483776587687967125885665493681707461345895999542381476164157058393971431375\", \"9263815657177858787273494705338516861045771674838057329170239610953039987023429736752079544014780707408666628475997291124805562998227296677616204140605356257712022384368492575381355563976330347792504605666631512343447560301417325154003481040250148561839861837778597346623630046623751094400/2843321709948499955095590862256744532227698001408929142548057792217790532624003190447363578048562448168721539177458065482170148482375585867230123873178100117094533143052886527452665480614620123764036974180917207421482431983407742154634391264619615289225747664532332469783301704643254076601\", \"407959339726114455622180187758753007349209016396248763075759257357925636039752474207685682218422721827857994768023399625060206708378433960993946156803948655098667156937949174400873748557248801874735834957795040139401560494087476967548060208243867/123780218751812156744401121690996305978134694678934447237402511116731459214498784497436358160964198336874043702652746834763131444030185151143987331404604087778514863973633941401826334750268416015224906056576641018962863645043976537664227639296000\", \"2547676391598917379516698439971914695230548782904479778605691338364453606537643088857116141939170899135026552016969320061900926954008522781162186995856580955090548471448276736878300717869625651893741316530109438876067419826217901657017506157997588944233677467357220316084583383623602865379325184/764562034757392298786420374672266498815021229519853724850874576419885380830752931701831256959159800764672605004880389358601658343203513177084389490286723240185146570925957286083025676875197029662038213216541352875570101363668917766225709569356861275434470568767077844675593176178611021135573625\", \"186545352286463730559933346565311535598243666022232037054735807289501173444103692309735768703898330430135399033529355360391658728987379385732098960609744313878477967971557204207043802935782878745271859468248704012618254203101767841517569443555143252/55399179641621656233589820996143825959365789093262978988289445625153099592463372579496245442338653053662134699646413817866770218574795378644415019944304868289119443774932782235638737888469746745621382139263856603239588594078668393194675445556640625\", \"664884440164786473344854955309049113269357314957985265728106924238588705533437169796551912202931185746193155801905841712503407258166135075966280435780812714252670362202091663287095423712596462690753468682634261029392794173636943978404002804413009590005984736612421172979101972556772005594499779860608/195485517776407145286424460448995460754674039560651791192647586550615878988380153730602665795647187884543361218962125172808792176382956599256188706636727418572541254480798303566840010217729386905041217793614214518363859058348249961790104618910877813067510758225302884815410347238200133693756493703875\", \"2614957283934314904315471338485451166053664494383241929385424599389309215073267052860464009981063483440201193771607520572077231889699858482582363845275452280606276949653970992719332472370351170732899676316967244504534154616036371979031399425846100527685/761493664432749089312665480773496290658029971027686543404885407644062485746072719559288231362060149626237939029641098328278650939665665969011529293869562636656650999759724704272743235210867676873525147820749560155294022488994426729939894753293900972032\", \"124843380518493746761140367283007507854364503961156704095198010255465940085534099747297600085903814014415830785663764373057896014399822131175202342399536439284123918855893825207202244831315575594886675813256448846863723093240955901916229136393454605455444105444987028391748121054399538064686074523506176/36022228212051654395480210378626648518430280334458144892889271272122662467638331091863215146548048144675657239846337165813938424387499358852301016926312083940212100001220180762189978024821166744964908871443681332664798940660421469519997746775275873085770018269706847741064037876137315001228315806659875\", \"827992369063043155578730871896750570951766628472810506926098505028264552046829097082095665194000002802661600196840639204300804225352337632259980703832713031790922485730615305441309917696044954289187837653933158950774246017223571461858939407386087081525130831392/236805932823686534991153393869288530368011574665859226704279685567723830696754821658770176385138917722808377962346690757191122309876922069867472518117628639913077442806147910884267694879089753138429767401700283014143248445966474839193628309668702223994071394625\", \"17347276886878323736540051321582548724378497839789943634071026331001588645519865992773157565595886250230140452154269197770615097377486013097979087647774513500701793885978192218455687078883766086309728287172567466406449372659680040183273634701092561727514713494914793425407149186041796935055187281744386432/4919325621804683623339606849970832094714371903709195539440424738973575902329797546592497378000858196173718145883783709223158260700365224756081275272021856393735663399552166737690038832550853145831185979094979556715294990257315369124065787473707136464772247917156232366320267601622617803514003753662109375\", \"137984231830526866236186357461458917020538108058615632801298091031540729111527734872044790487396302545910108285921421417358113055522725197998483383380192391312304647004240060970929072498293210057120617332323445379424867965764749534125081131327565507524502163460761/38810445792642817561168950890315210470940006613819790543653745327778579787694809782601777514116858514049585074667085399925278459138508514838268321349069481334967221455722811414399738756151414906092225265355449011152267068726417045644222323488445626292574879744000\", \"746567120547823334914136339633766098626636643449144032626270358619125402826113269699709721071135471625588981126637674402048519990010499180844665151971356149292818375448504122545400227696621572263621729512461528550588108384619064912224884465737417596190735966915167530332762203074440688676123756162572829692160/208334337057923929636884170505570363171441147899816815785150954417598643614152856767186132467069365605496210036171429712485182162940460120834349006784956522600679357307849981862006710239311750261522832996877712350330290831638640913932265004107623954913155144975252743257846945609734368518424172846119306643431\", \"64649371728330695076928013661001819989330953381731372450140483779536126948957993261299287753791770622512248630224724990234903928056275080682537641377393210728546364176267034339221558641084730052304770498929958838997239635790469536857863963589118888238069738647239076/17903951498200212327802847425913723358452100686246224008745414214690047078122925247086521362329833307849817944645647750649290248110509395628305970523384831671737569872597295947593410067364379687588919135621621162007748635920864926867870502568935739725312687094047375\", \"2454918942158003099688922026016393688092399295166304634317616773083386087532869193458590448918958337530406410803840837646465522656670050113548208618655070231274778592766244282964463702354872753657766121825196898916725498553882689210280080206627916046484942827487726300822318764058084323314109595329304407466188383616/674880185931325925966586583820010578979699141814417326552629206140252348822939845006845669570885271576698771404162512001549922909048916000017837898649100825976232784446638776021483802989797501705685620612986771521390439936066527738682396560462899753657942715306792783283782238662155922082005591512296007820682995125\", \"74018558041066162916454010680594042518462756234254788158141115244349044958441521749277686851928706433556285971088455226217644009628399441967508838553345152310730562224910795446341601049647392069373970101491741830623078126344928804029524181578945586663110848142571149861/20204153620006780689923328634586091101021423979622170579036140596085566172775051595588438592742563923428900864000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\", \"2127032036758045513335690185608563023954009095206088224487365541995326714285119384743928987635752931664240752323937321097955456543854943206092931247498833001499955456190701695430459583885125382086777607021670447795321669948733328973350279846928613949120929250312666393359442423066212311060931469017737106028339882830848/576612418511902928757340062840968526862381326698309578771238715462180282212422302261044980131594522407066369222998903808960617461164985318633518680304995784614308979881735537678182134128319596636920719106506829571072447362052319438091347699720147003209417806230149598345068078717948025207635448205253184540936478445125\", \"35289653975561083576641954928762116897061274899517309102784750384002335187117263273488751066569234386120759866204372398611196356888479036949053282301027789530999737306501029700128744408015642211359442183943916106790666114870974212159410284751571905275610921784716184508440/9503006066880728386808143045924119024212377150217533250562188228062174064693375135306438120385877320162710918716613546077156389583384656340709638430674364232343609717735574035535102953482366914421205216675248471695111720986346092738728929878538430662191272737183832556131\", \"102633551023964794485575491065909467125458972250222581133681080524371507544152979467328048718122409841060527545925136196267751819689935599599321090571687632103850847605493223603751038996548520557330016046032671961857623066292962260173840972332108111505971231021442896036760967107060309991355545554631003681544611731245475968/27459658121882266328752886605529964804078316737648012166874496015808620265471203512606463219297059547428855195782384236337998738233668399173746663289852416697917397644234441300570212555870401420579737973722145663287124151049692290432756231390864184491891697469874600345958989433125942336757049639797225309327019275689074625\", \"10034393558388390065766795008210457368713365491566387292163814915435906649268119060550511145023450790393353937124495488860451123302412204483570913557762460385297770427946219119911920640306914453207097103853766023934602534502476962159682750262143380527529536498215384467975023/2667919902603322771586358077760621955455470781865624844984169443739075976572061827709528710108877015489050369589117491611045518221354793418884447632063538994046714401229510497599783726376490260140723032102883617341970952663947646017489439179953454964374887388652792446976000\", \"248528145263843375390386172800048509380966183384567983242213959113927668429802237067505890436957693495616107089384741585283620097982859345081736730899912519273262934785992235852866637878831878448348444611412764161078458068549719800733237024285525816723480868704742804077255242682077291713092790250511567621735004237450946304/65676865669148624809340872151906045781446981664561196686217551358486802274698228825404698950974939545099727242259547145392352658637333562345477931951890984276718673618736565926663528625796412420753961231404680876558659735251469326707567479071881966875336951133475135427640218972722939427821842173216282390058040618896484375\", \"7805448718805635696495809414501206964843262114470109146341305656318015059743127114324245035489577134938579856003956861881125856595981500593426840968087618241785931128978516340812066502964561231235073012672356530509663384739132686548934288703179479011016719045530855033205271548/2050525178024039744126592505352202216905491833360272553169520915020715464206141942151086176509423406413311520838568324134077402841030113427309725873344806030836314500267104070131451720947531994814710189000076651895520222646974590481497382830325485174899169093049299764813276375\", \"3355325071293197839434119105039673324264765809771192815982246040415580387729382404624613875653005261578877047405365032178619450963731719777167015959920645055600439987161800547901539269321100559393048973255388860193948274255340335876890491746900991668165565729269698196233805991206691196045182214641935483083662356666996922240/876402579119117579582569839757462461050855174353108858954282915644790659429341853404829661899850841645529640454766173209897510988090318303454542547519850473808789222552969933222203420847859171250332350076509996295844203965564448154484566493395403967626596213792922784509892086361572955175655987334882030766001799867659814117\", \"218871061991045868372866381545267589365410350294028138778572466235486397478028823720846191998825628156716190463263492304639890659254282445466806224943413446008645087186307985343574807361972238230520975439736199291019544576443791916302825193643774360055545186783819367378492631806297/56849560726416896431557940314760680962653658127458002233782028041537121216487790008085876994020812492987733987414743604239935223783349870516284048368761617736127892160849065895223288023531930411718807065209903593668117085505482007061969339237404945180379460053180570404846043136000\", \"5008685108365226931582937964451700746853986170633433728409171904803795018146152804690759530990140552460596075588463394200510044617816085275660078502126507209302951286606953039953843685800941558212440519542602092919776366067720586295390886070120828199562643208637974347390938772070049344991272621102622931576339988103674070876518912/1293888539680354282541277646947380627241979967611883341823378331667976045287311988103163380651334828012840330710760757271860219584371109472132211215957402251594055009937397184768184517621978947384029376766290498101728971145633139541827544539988344772578184316843734267915665730981857376872622787627370859411909330227080697966353375\", \"15388340113525711660227566446101909585796746979396093776960989868457211684028149502578116456785221720682202816140911944661051001675127262774824593420825587319436537346311831003212424497488485098543512314062112948777572038731823948224734505930748371522309451168088057190162878224801232/3954220582960831691377435160890656173654063611768428458807273708040518769541211737927975894584024448193835165167801976423275767590502552964407494549049777006346189436817215329891530811451811864579644894987864267389290848598289794977382504890216219362031324635609053075313568115234375\", \"5099039333987561374222193551155323470675617979816941646196895589439391685938046865391119484510329634015275893520725135141878751153360264368353595348921951280561029028912953500944814771064409611917475818956659775131751121312316084465321917769679881052144364834485866477379437705913911371481828140817759401117780199246301705600020671104/1303503600297679371136943454060319958680553228879031326679449263682048703103464872914972900105569835004878963701599765030590097739639045890060548760692125546754294514068052902543220382104483822438283040090444827980927544440984823535260277595466339403795403200720622852069244768910603820007632395190204569927612348189089161551951106625\", \"4902837141334073026145827027361937996261324349722726869116185158777439337041263482852376194988371853413467559557923410949898048139830183335197992754748294810838187068126867611615800383834975563313220497573778480109264178673389149671194149749735833378557143135481387904961537942569904075/1247045310545991266291285730016853118981099516935251861146038369985109288084420528171217942065832292739130145780833406014673689119563698528225048800794718789218267628507713621235056538202070171596177775095071513194885568843375526804796016261173388452184505503341132236719484809714335744\", \"38114743522716832107917466438257616720476488812538316101658139632867788464381862291240727309611460187159930652186486096300862388591521625093237019662273764387591494074792574929490381910446287947994150655077877204446864004067956087975012773988833339521775463977233068498404144221045837190392670308437391686081418318624745039402145439223552/9647001083383999453668111809775451078976046488746916070976218645431946648087171586252172936600115032316383427265217993193444199863138429602138841976586190525451324093772097241349417938578878934577091671046050326087898259692917931230974174799815198493279413438192301437068820185757869608523761456160341754512329264442115351926967120404125\", \"573695055225225727008803730767518906490704995929177617646275646884555707960986625481944101622708415415988844740028718027554452662358957933526173824325955904005404113684003841990198157072540659184995738719040024647370869010473254071681533880576462368600901824622431045529064651675640055917092/144509482511118816399089096021290587489594541280398871255876563615464628718527634679330291741479135415168539765887291789615790513527330600394937614433502341116068305347468133950204152174094704092402978083370792135432486240914953928188835819767755172666693219213868545854371103120604946200875\", \"23876960329653589647925126180903391687666378233201794403339630995420215267415575142266707357255726330536094448314199602616026935251126469221925945960901748679919435908556550271504767784553484434363646489174587463466333864577705745452492395785557425904735048180164697040313528831173448025400634629163795223739061661461986923675833880378496/5986312408594306954013526197465608559068621248896320652512228238115589875514604632230098997609482248000888567135685167138762172475788060284232459813998201719590208742091697294562538265829954186149162974972471533202880368317237508987477069872431064075005305838801862900501819963793062041081601844759452202282545840716920793056488037109375\", \"58168289917567723171226992383559866214094157894992327555495441698028867727845766488121900626912848698952863438654895252811583144479300382761129433911280049009362667380001406579175563745824368613319103673817094498117944856004415812877213722455299491145649879676787079744410765053845551958756701/14517067289347903655500020160671113450349743650636953726251191692074385521975132268313263723831804150872238173602847065423463131917373356798750100313145228608894881457107689499956903046984443545789053438946050974567665049237414588435796381674590098629779384355275820782532479708807512981504000\", \"728621890568281859295409481422447012528302594365693410763821707074444799793690738137592101239862736313347273167450056625929591960610208335290882047413011571781161008296084630072829079783328937418641417642857196346026366370059522990813537731394823630207433267854616768658990289454635793326766697884798538576055949457122067828153655416688640/181030730759516991863708593747964787874073354051675597050399087612142539517308720603687322924426591889179726492403913356461908748733972707460063017057809060190437917851790767968877215795679844983288935075688219234885360839984681619084834228226744165610073685719017596630302462070188937998558312507638434329299017584329479516410907786681093\", \"86855946923438322218622470067224691860808273886184997065663554841573982963995340977083049132518812923329423480393306918856650577072525633920456721265953575424233701929892019410099166322511413146891121248381648145391642571638857576890568882512129960291171866772665863159474602604647289052079991768/21485753507365901947528588896402264670781310878547726104482740647554738151100954835784115119035980523529677083504495839730499664052882400915208251594384038810917282207449860876251558307288700200910747338758723324686939379138206117634546981163355060740270734146780942696291669461182599512320099625\", \"2158989152301022938148680102142188531448821359505188055264665167313418619665693092337665573150374231484840948447637297247277576415460889296724813940128955070240137590073233263168835678714131062764247434144994737610229909964847568491446606012581370840699582055341626266533733744293929658949697805855362114229666626620766245630122333733703618176/531794915405164005613733454597931482878479882704956110685223892325074211694837836221759995948610212818642789132749082430059593652854659130217225506942675608692701447738732031302987802196501895840510235161825501235133794449421919927396142470196961877376701957829921152848178076410141813926924749057304222282687697297216661687583257901415465125\", \"139432548574396829074586704387656697097760057897628994548358619815052936481650396157428747411173567801047221928593253479330480454469358220685854351236980383914223693722868233819483137401339800304943891968050399345430243790898955416907228948287367356990263740207046902209563417267686591994743547621/34201151688775214071963206765436083445901621442002061707492082843232231754829227303539041286301398668437202547003300396162741375435703188500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\", \"11008517174872833286150985180322584448162884832099344969609291070844193524816852920942383850580217443209402836100467940651581092350600329145627967515818684442171571156446321228596914355704205623857871497315955269266498229823278800717909321269179839084452384509142712677235552103459737790674103994445173074670347080506698168482564009465276165824768/2689223396936080856855299215659204161946704205931885125148201643087176556822542895325191478283706585400237901215485150928036895428721912118467760766508162631903585126377676412573187912443878232521444786090510891599171741773242011017926658231638022943018461086517502584854390836347781674626615709751386455292026775663545470794167629144456268750125\", \"16108638074211260588800537540680707641986073914251424878121255234668558067988171568946079848860335948991834525552515669040163026131919804987340113244760738846884911038097907756220945883750502673899084880578229601870882631165510396775126850307838505063922101682333806284668762825609556049426829531780/3919363961344261777100658318137884299575193089462944554282218278496298610828757650104922583359642384253066896538203596057302203635134833545580869871333892935330950583664400555463557735723364497947986885146043017010159347046389604172186788902608216894094289769850517098027486468084407618748895626853\", \"34420755849180279597302103726180110022640946692592540634353734157479505420320000324260530767186132260970572450489530034440214259559325114511265075416512316229177952140217732655405289808326341696986755141965043719344169685611217958619102774617224847284122901023774956887687026904767714958090256282893003000752947427857703259704682455375442735857024/8342030311716679826889917494957593165464748884572298173556257652389845294530325764837124998293398445804458613956489096007564811101361266196542129764287084823604897187311540561857741285793447174119667215803837719660675298308873496219385226998078648428368061868944322478384684509466965129972030932418920415308276430355882329457342937549162000252625\", \"345888075261020004071220843714060353763382280664960929903544964118831237876694384053904571498830068831026644303797377762345709976595360421502594656308937649239978525713471393570536680412814805076323426256584504251728507416368609420882442293831684681071553766603478479006495757222912500012444787804577811/83505703731469734628961395063481893801938371516752417759131774530720075262459158384433785006689548434701904106312038822969658455364219435022841597243178757423598248565463985786213156556523685666430799283870548238467817226915680747412191245046634279766450629886904716776719219698922088211154187845632000\", \"1061717830619177527082296723099890392273896386613997004874669053445943252046748251883532634529759169500795452576392700472771365240996842610207274128102329096619028487369622001737128463631016494371635687841733644339636164570819431573829173533941056258744442930643735587780907310433371453992062647737259587563398111688659657406089003293576961475848704/255359631537215747979895955806995352799574790340218399351168178555478073997876110889483456972687438702262017800167048243754141722496276537685853311434069991222324039005160057724073156957530106623908696241268268096879569794431919729620178375212905203484165745866913773304319069321426245521467122472046370356725530914587807274074293673038482666015625\", \"274122944106300296738399632684955400761495830361663966466225652918683099779465438024846903286816813856490888796372134557295699980528187779624865098445756013563535339056233912394908544185885547842235097677765325396255649207317018754967666450708249125316192200151505568416495274671679500594656671785202496/65687592621976546250581560102201535533608158256953087745856906437400149205693427285162333502528793675585022025602144243543064185647792948495372442630333800126269123531636800213405254045262127593759539706750242430153456891792533267948231185296091297979933562727112487057234422009426868531651634706262125\", \"7842680480716516803148821198697967237136721860017131244266974996267074742248599085253569637183007740566941125452215834642683053334607896723447140851344501084122965014242091312411884985569341166545074688756440728922408743841592658677792796881188604773469108807869960161395759837407978596679911066586626885830991556090978327508459276025943279064965688960/1872528612245648675720382138045071131304652050696842872529163720558126655075937845539792108048310219395746259570506175902206215101518698490144716531697689534559827422735649881381597761684154409796315455445459537515308174919488497154409643876490472215352056502193150125644288086294418253309947229151074464928874881827227706992859640236086417889990541889\", \"5300824422251242070074569186825929119848111723012841627275830216301188228660779008353049603527567784119877706984722171178137272986345560485784907345500893648715341273841147320288851034078863843374665850852481747000237834238703248634174397792745914847774297223176674917912406659831206869442510948965571661/1261140476013707338477604677428573831791396352814802149994640617701773078174882455512668089072441176857892331468691160991310474734143842336092636848492066592397892638052212250229129355009939118431643425836944282456647571558383755315238500832868535816144280088644939696339160092963629012001958205063168000\", \"2220223718762215584659309059880106334425515875615107369399767892051551634000614327272260081056973863669004224981561870246078120862256383581012183852291444462730018546753183156982897386563561418424093883164027305254176874653780425452987066512563140531367766900610414277825262239199580925879453806414860409441845631158680721091621460775043562065815179617536/526383206607841251253861841374779803798480623722760367843070466043030228662340154304405180907941079883976168609082254331465595267209149963786388600028701073430773581228212441424400748220833542964971495005714483235359479470452593264280645360131482713147116366500300066771223383007216182988263355451923333319170174755334598973202740108032097242475554128875\", \"521891797109626296684891455959263713257353500867652268541535940159815152120871142196535233326890353914761242025931373491906127275561002910157909306979093246574207104081108188995072105948138299097848175016082947174156278439986705241571619793059501724269644447572323501261424770743329858038040685313621446524/123310256826873923765604825413207481739886340225713108649758575106598510022338480189649787216845041382860899099250547657534972156328080736149239332330143771138115695598493059325064119176038137294863053148618656356436332991079150723235214278848602671333076219529535123842212129829931654967367649078369140625\", \"66086044538329677372986118727999622900471937619891337714357792768200341519193500393739322894033303245376225584865369486696276607060432449792893028061817203932068085863800494054274423512956136695211796751845295921015953538329385253280866669403169919614982155350899648626481405781514434761541281229159396787287553493046927448595964103589100429722948913403008/15562137339474350565671240515273666798063901504051979980452491653975250630723677279081058884163396938548780856293034775459223871281049026140999055923743471466471830572672766633086347312178711643724485955576579988182546105048041649947277672869613992334541438784737993706482731696809943027528882927942967419447250586964258807454003775693567366165507144866375\", \"335377615394100148751647837967017467711612297170079949298328061159559939969228226474615711044891085626519877634842694983669611974807129333052471799687426665556738316626171408219730853872410792831871526174987402129691897433888027072807302411474690613948951673562473758814664346259109886876538510453475290967835/78715592752271462306588358880337347638000605031000575876214116610339827495261512281635361568951675037834544811575026718101166562072917855004822606752296233435017284127594847656529606648345533195437635894948829857913798336356647286032372695130461573940500785137424365840081503133157308796505622439791698116608\", \"20090879701618729602554170716780970848925039917987945471322994867171660307998603515745066411687983450400412739285577269751603921163835619296822801840348319742203974023505186187060251544248644338412667631232247108675504629538319425769464277309915502144443973397371136256151336255138506001292355330875114245901820438821732843540725116728866301271466614762497024/4700223519410528857298732096729483544820841497820611795617923063440946097326817340637303431283005509904481323205480729806879570430868897342398783028649633951362398196137429076844504529051072393709154483678349272930361110568616112723747726853614661953537957117231900032044221535502745676310313569997665352252492568100075191900969170979460298189170486601502625\", \"2904778979985524171206573028445379872240558084236464200857594814631031581387804621371822074061289363372523364167184697785570324832815972970658633551879143187709707164796663015180877412717910872234647704536817108676736661804878068078543241390828229923424191204586313620612539678930999769543756218765870513049986792/677408099044823641581658869221044375312077929976719183424865834811543737800956896926637625166844372424044003929341361734886232742770909683021563822987505236295727478159938135467975522336774471915167606673489722102077041330652185811196423400701795791669780695158730756241178262962515917389382302757366325768069625\", \"31270155809329751863885224732454397292230969002004953832354065319735530624996254695453061851449600345977646455072512400760539747054003851289540339425848681804190284451253462663731135337775088379954403740058084949675460445909826322297817535400604180338201322667139062500269285493417563095365899631360901732684124930296643108551710704785906431324876072470231424/7269578038000504017073007978844992319987411732848567116655821196644382777088703228960020894756722675887473977480537577509061256138261063926845643360849217556370868752909531088361229374467207196928745673402380473721018157327193509586295879051411183657185176812738231456253321187419224704301236205478184115996135940848503487199394612616742961108684539794921875\", \"432538822079707760382094121020421735679118830363764570640789368235407853152380328891350816400541189148550353337874309885334920995713154225799660601389784410911658967499100610376065640785585342035058364676314084595283850213942576431310823836792440218271879354669291052589804956435743500204185107215929849054782893113/100246574739326291035824954677502591279343311051719151327066341370995390423713403739043396503785261917771859220535505691760472395306543276314938287868734009582906895763073519374099272340577921671298878837400921045252035507925021904954445172372479744465666760762909731237634082051855588025732494461939980856983552000\", \"1914333673689206389116942789116917579088664511118582610293383428712902211612554212779880638065888518488492298586641997844141510832940409501694726851666478650414191249534733087933879981733561565249818572204932715347752949087800778646065986244657260832234479202201129845117955957242616947361016603702640821256099895469088229339240402478576285854783063612307200/442333801076281757298117784528962837115323835962460661601905131618341609371649347131724700192551574625400701487125984359494804828935577124602622582550626336986871791407398609915208114339012374456785705161994343348351473385887949809051796407340988735853810174589261300681030826392672282630613354461927208579993042968520650313621522933214063366558703422757071\", \"5704691626402072213006354545292364761246893919997531024861408248746241619817955824682639582830486790618668221530365426203424888737658778881721063941495350237419723855000515747725926735319471480027293210991869255971365522170749568996651406002311020883635577590045650037569906001924971041810547543163363976464780729932/1314240362076792592671773873754757443276256223533339004339330559325754574023619698171225777585408160438834449576526997055649849875516310105297894855264038450585295422343454458568152668980131977005808840141079502436391909349182185596381509091427752151860204235071122788499996991078935216686010888734471173124487937875\", \"451219364084386208718456142329444023337343409261545444643031014769484085278440612677813682892926852469540118625738238137458321112005189595703619178533263706811689687213128887082197330137502064260105387500552856851972124172206996205919556553246133218441769325133725631665593372188755090094541462474970525820334385058333756591222492801647110594428922046641945259392/103648250172203340865458115839764297558925693061798169434516001775068769911768281084188883278842546791612199025413573394167639925287068809631958006622842716869211374513136766899877504136929177267362862319748507372147243911522667591375015611312165464514308451222180272935398828092646393830572838772085366567154646425598388620105539619174837489536378605144891769625\", \"1591076564577634575701791393842535460875733974464805197283632670013516183281542903377750304419996681222758401497321278555686661981435637461350320471258386388843198706277657208526372100698700615835733712519332548607115875288787602084336341594576426630670911478276101702119972195558314357975365863803265163991961173/364433108410193393847203348728981296285742202617988970384277162225847256295865554341611171460436362780497179090329831885853324392923449579538286804729856000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\", \"5307507148709435807261229345132535134848030343901300324623409721698217134932866488937772986386501538026693956121121771089740095760486362654754229904633476234090792827930433598453200536551779789049352131005222659995845427680686677324963223653949277037520711609343166926627713758990384011274777087968799793410506391884872456420041494598273703914689586637995139580794368/1212244290381524115082005575105703496583315188540177702780216570265159923654197746388568151706509243638302707511238539845531608313334248788980188054651601536067740709977678222790481348003085034888244447626347312094586389347535167903408519024105748523384932942441843118813819781347089702286481924493361058339731949844620763272778960860509570622673048786968660129650125\", \"3046577098843580578619955603029073328361298436129791931304665777036152915858575282362742008136721284817899542475666054101957899858138590963789072530710775790433466847100422875906866496318804986202089528198912098377828580031852152997907433335176267300286466072997014023120087988748396598176622765923059385876855303940720/693911859077752895978833241338902695755528613729508555938416419864772385336777924892434701804078893822446727762077537955240605927550548046309823051841326355655848406646248595628715185413852040295631448250459076043816328082561248420925930431777502622148019371383254316636979070731427737764160145097293260938978413488819\", \"155310926743873343426312607182060072939030765297630534544899230213054714482456829198485999782086944271490229412707980997432528653509945301574794242118433868747172279224118534460563400440670015323324602117517342201640016853927923976796453577048995243600967202462466681112804476672348206491490513419336308575442086511015101999847896197546900512764233674747415844045184/35278162986589659300679088538176070649273991865663041616088851923111175518405117391134863644540911005782372831496121355954470744169969774540892096320978686548284501139861783292226140413769665461494668479430833892857992401391262903582109993838728281915806394747833588629467613308837196269424421131934859079260185052081536487462257809987002198437182539441349474426375\", \"46729591025621874782758519074451728476386657576036360734358719976400940301493939192083339293779149127132651616972817165172116269307276487158069293114860391502484125554406945249728802484128756924044633825692779783425628292959170597009935305429239702926898931975023598456207165067568919757902764815108751735753431153581849/10585868084079030838651390738371141142245086465033459640458366146849314274285871375459898014414833295804139979016362796357043372316321872357817727821559232353993714062535883074661734509440994664726425399880995133711038483607773782532430879196405793694658185175583691180757783597895616920432527125993118171361116684288000\", \"3736372348124144720852190769710129461145889011598636925228657393934132828633132357232883470466940330848177425542748100211498184494252714616379450272611850068867816250209867530921278645286769418080018709947826876461419654782341309127709703626401211996255743831998918894661053669189312375159058718767082163156988766821194002596331826150321864927832618126580509732359424/844176851007504003627016945212023239308348428094023437269532743221937069345682900884618378849283002998220513307273333096775669556093005637615012750733216460458689282791632437851364674879152695438589692227159038555722539345972833161146108367329370564838671791241431125003401861887477969954740544092178721327724620450947646209914621007186497081420384347438812255859375\", \"1258774755828991281578968023382624723772927642002016270484090409043454336040857926581316994594109169123354553321469500848146015719851609220423736153365139804086413284787598253618361769125996755159571523632747129480387254164008968993734442164892486441152227433281625391753702577143985047832519062595123255569172968685060844/283659859661671181526547833415653453506477950678651675193210969173130116121017723360258249430884213011988678011357458727603413521688184521573094783291496368005697481333739504490647194454695504722542014845706216224432373442438242355188461951883454664693262684873988061018976711201351382163527093784753398257094429403691625\", \"84932063355292829988908961192574710493098897148701473172754949846455626381329456661808566365329266898990829247446356970454502007127269708487563279536825277374133681167235811080298134899629580318813382668399644553111080625918213250223197440426147821225593304993621451053135332451997633132772608233430131400186571793929377129211228689703376067763625568623535588709576320/19089978133324852910950469658566458037096027722326716800113107848115231563787455584278193954518442601810776347091253561956877155673550458955562102935555510392954425196165785410319126098393353878286400877305164869548380670204577544630353859009177051698096136470072137579698473017257397949994722015089768745013713383769765609613514021200888647472804720456494757423299627\", \"802638881530832431828249604040579750916118423833791608589560402449036920165704012070349537114920882938466635598602387718300074733476150548724726460209016834416094317724261857969955414000155807312852092720310159572547644569797512233899495300028159721348599816083166712365215075728968005941610056018023633235372936903015771583/179951197386119079732438617407921535065140503043429174394605652913879982486051627760652197484142547447000508189455126493868229565647284332735552462525598465192073558793335913005459266977086104359621022691931002488052727597513413492393525660272900161375677499228252863529934576881596384036401784035248649026076581302370304000\", \"25208742399375362881099811032135575360109715964024747212026245529087599633280142314962581193303683759605084995818253124445773115574470717199218828756449187055537877478033129862600982068782249943150019637186466260707552416433010545437321814115233841687700051830170191107127799355485920046505591193770164750886037885397478191534797655616745528343172318318678405576430544896/5637713398995569614196397857525646325234056219513202928587580534159596897880731043336790273040813044077153051260989730372846713618900145444802234629922717464041261370803598799826604841654608724727320798324006129524610666235998113655193642594744544226880944882342204407750193512869672849910003246504052298022468012594459974209940607450480609190841893267203392880360823875\", \"732332637178584560220688900268566130246820235956768724845747830959547501950765063982943061181526237061809052444110437930100210105274824607344902764184151030827266142225894655531497849161692760385938786736436977268616029862577293984376170905024712952813234949508186306774257035535805330366742322777611063402455261391021097128/163377988152179636922409938163005948596822656868040662831003991395905185823836089887990201522673196719628247106777881741843786365701135555917263285268753605514812568258179391272113405920369587922702002732667842511108732068683407168090725712401954314293193572654347237716691784386690948494003094992876867763698101043701171875\", \"22391374854299462107923583267570593886002658786775211597896252879708753450794332301142909715845151746786016535157797023153041007263258732991465037648536702217273897876864351559736449481285518249846264600935543582562018874574655740660800634883403597181876364712521253650744197321080655028374602772696770227741610874399454362583980465225235674816785988164157351243193265401728/4983275997188967758382167867656806681565521964135131710678447245984239733544941881418957694612909599261843693554043504855207170782744518943778096768859337980470219783210191765678908537645270392500777411134164918803949155037581108678968701961544979451081836872425574123683574475790997414488641534074873248802450108535183413970057319247033379016606809226547805269752123746375\", \"21252344995592269775107236774689012760750850598567799560343535731251766780016530978663079386453430272698006977668063208502408607227544322945446079708000304179073184745623740466334127867464883762843346619853325415963062181018736410570113171387891518398846617197097407612852037905687899800932343156979591740310928257766081697645/4718515378484509142377558412184183991357747235892194234377932213613746008373918923611236346330189287336493794499188640380975364991548794341177060325509698404571318037298112293926833877103554546466055612498927474225619680186119313129604319096374924037870803554153458104225741255753314955115645304948564151765516183663634546688\", \"76703085666560609319365659209445044957052359500745196718269665234646121134787807938680787341023203786904308047981099228357850016602203539979246579454229078497537148799349353250167621935384193502383187510928609818011142642954550330069991570983902841318203794113898871515702445720207144863877026526025447819537396146822201819435536435835285098485990260677737192230985069824/16989892821104122916312992616665764943723222199277412857053896319814438961475117951904867066845412639236790762432996309717924037467863024360211163971190006272168845197000304328480920483651558672879967350982199768255256753110375467976246339260326422891913564151453729285191351273342206198366624882195135056176502724912849575385576554208844814085228696838834665339811027625\", \"40153831166521391225489894857551838468150576827129133168972859441122728710165233865309084872159583787083130713473702296122465319276461991457173085312407612757280915853584698420083436946976844240063731333638150599017886937783470942007376523947840104246927580254612991191040951001539641947153847776050138532219595746056076776809812/8873576113581065493273519627544307418139908640325227196912114520903505426722086265723900326735989771660987609604507503750212298754414472822477243293638486047313990878348820573874809636084574108909615044524663712495422565151340037564156235745628465172219286664653343193162657374410926171153516871765680561505768223660055617934625\", \"200736374277835272485186523480177159453030082779872429648449412313247640312479214261681899286513818912991945046297334418102711629933437654377760028476767482162031641781499114859553677502002901248124750539270235098492377826240319766677856465093871367817683734079621359186477306173620331748496369122143019303740252461824523590096923561928354020960176605008889579578495073283712/44259440065125442964014453739391594153290923937737136823355312892557975399035370631521014554980129291582486968083228888083079118116286312583989433037097397252506140224404130371160608365777625538148303917306340620019882928744151294738308047800711028158277500317134537540772759486365658024194428796846364486187105343266398338060080611643110071184992193593643605709075927734375\", \"488459049325494693259159444507437983381645757291858092983371672334043029615965882574409808932509285079401239403272414271652617474184321852388397021836909585659327974611273820676128650810907598106588433939541654215766888212287311943387232664417347883717203611092450971786083806323404432266197250919880225892099146722474124874256523/107455855466267410923480140898552598306699341366032095904938430084768624148829473848763761936703072253841751966906142283640379336131083461646777390874405323298406517250231389493084918065243079819898691146841695350589992171102939046740169198394671965069747042621265775948217054519855346617967866614303497258042439052681849864192000\", \"8430374068596413768975326329313648683222744787097373111477788794692418932056901235174019333392845529821722488982447683794746518712070635063397464904489452840169472596494433874412726723065560358405027764015273789053064830528919091414531400589850704395887250756457780868677553068164933299802944396576360356896758745030955907258232257358056931680617626606715393885378887657377280/1850480358582748412767893656294669486390769246349349706200869446679212812264400876685764762211659843658541567071977813110496329850010288179702589501255367345935389050373021591572539260951149696801665953123597521983257852207280970577287472932167362521740230973547070264273850381896786822127290397075758780174083415923482640313277341120938690594859118603017930500014640169211239\", \"58273615882491925540881784328370957720539797010816130007322211512070634295154626813477498607761260613353633996451797686143131893884559909668805628269959901044961666535533876340116728982072626875010391195372759135469446048394835148654407846242721443845351855234347422256700864370273092971804207514736924787577569355949601385705517152/12763172138328432984573837529764902730448666594097466544652830703737195804747682450548488162227364538052585484418491914323658215406327363805353540266048943197822838925184942600367647278764952826664684839953902567694832690683467635727409976388280092262839126779730168889686628630302519063225007497707028600865624133968363921915016625\", \"2685278694947152969468407055109959900160804835228466214479525891103128459065131221736713585038130737099067040196326815283171857977706979990467444622550497565521863441617001097354649972660183038850033950647594754644997436624623325003537308428828750008305464174443210079059253920383411910911594636045517662796811001285984447671371943267419151220518726940455756833040934506414133888/586864816044968996825907488721678304211296267371936463272955488077666796280028127333229453342355554450708284934221461946991556216095213627059047984199091625921432110913096253352065238765240063555347292393427726758010888546427415276046238297382474708612526770055488323003698641493939145624184943388159614111350839555141202024991876221874110644879676602924730506882384603409121625\", \"27700345710264347957758638741952394530538598225904772664391173119594616680996031886665218221392453628824570256438960349220263575741495285780845399187013582169907518462437966962923592601721119258663490655013419675469864809004562272799012227293974254329929404036071055528766397079743200179924243479370594973626764330855493789112414191/6040997839051213541001279276287478343874107660287651711609067205111574718442229224212245187655300348484144001298428958025052162253854676210451657425437588244676589965820312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\", \"80160269787574270953020489212619791839643207793889009503234879683494928396231769167082355143564723274576166638869430572977442020236299319718643894871736539109822173538266278165276591962215927816541165548699380129014840956895931285215480350321259054359835472320394089646764361802445068798451796525897304221529850133401768027469126408090577121172238802281079916258951770135485696/17444957084936455555074876721808241311651668802091828589911310253709517226715880722948267977560381436307152342821304525073651379763144281678911047276389231713860392794975453518107055568765009486973017341479560154792340888780337029481646046233967923289468141293699236815196553819373828280398488966665994092877680860643266914861837639322607761804740256920429518434353839878280875\", \"2352816897072623416220002134476921108405735955266703519252095150412419264317091785317803024028565851487861978477208755211589867803009700996828082850796103789009194767813611798769297617674631277847910238088040257037678126316866517601388289837575778165301828137259948173292658462765645645868094197736382683775415645307647043205988394700/510973411316690313485681833991645423802776865720580280058344111363363091616558230182669376841383375321912553771027107891991318313938505988903735114191313214327683449514676737796942389784957658395806951715454372568523597420866050825822028817422805046287798054682484158011143949412956697442991898914560191411624040490122951328364833797\", \"6403295584873165688372907494046202150046769667837790834896334486679541887567517050446119511695248926941383207478170182650927368177009669717288184903306689332746127845953193587519575304974203099873732502605739219028995266139383163062837007982999189114810534856227848568800302527760100163350814120545587074865568436789021082619398126713943637898657861949091545516403987546145915409024/1387794272010111535893205703999712437783041553900341112488641528986385462810448493444968969845352401058333929711237978223214186693177251566069419805757440174840170213159651962686467523533938145629444468366235554597245713128812532716616087753947246800626006504878203666972651384731498770435755225220796872155249202960801768048854869001310722927230237083418017482134588865244642658875\", \"82993247683514419570466529457059660634483860665557779709153549045427987672829778520201315148149878525274005978368939092115193636113741972236218502664881450367443614971109677363668874484696543982239492409231870942414193419634675024621942196087473557914167832058111113476295926250739099284241826553737074679953551191767148712684157318697/17950946423927357725787689855263532224005643859095168852729513034456208872420513601894508438640531171097082516559962755244698695622824386001219435651555513795509616906355363573638916895074349491513539093024980575852693293474288638209680085037286354050958859425647536735341886663074581909148323105020337857959651624760873736590065664000\", \"584891611376763781852144397260140844977346305541197362434227194779766612939978629636198589818106137319267243431810481928639442343946346034433828599323416877248326356345631611148749005937144684862502198147087702668524450709118588741606955966569427636630159793409544653944608958808602551061186799401212712216156799273254257486955348236914237644151956226336750212957092204830385441792/126256710861549838395499078249922986417488985866522660521294610280820007499099176190820291214370699289977888813109514854178180265382471972583921477022411657285850911270389720508719377071949050253246021921916685716353393018411683757067093259101151481189635423399611625009617884983318141463140199839724797412514785751549277231259345923662499623640886881048572831787168979644775390625\", \"4743054867460856425399742072925732465660626340183690464743217147109403130730445842673866624947360862438925194786600531200056131309608642363389833474026007798643235346104937733349791667694862514383520689594596660275306247615314272223660862212527346572811422915223417783887717426641317921972456913534338708745549252254865615725859881457906376/1021840037832289788284691535543138164288462770384961802287250236519983887262771944174557087207566030730743075334169628971336358708580124427857321953981475719503574867471090607795242192417162791762511940848493176847925838738242153177311649130718886794249673254183907621449520415060660496225939963471753122766421338241291756892571824984344625\", \"3784664074155769467702999785016514468281913375341134899878893061325465790589101335015569840325786070795267055386681356241209412947116340524588831510768864231937929260236754881829005065056310226407358204278658699999612596866156294195316867934035877283950841910726224355461522065773816109849107487214275801829843762482082803559183694631856772777313673086715631547326400170962722842240/813783281473223559981291694175087508812520505931454895884442580280342455516154674683217348039336712901850738745276445107477919518905155156380620466135946654952837573797479076027688866326359448543065305071605591497778941561986579230698384305536224430794233462949056326864499827444363206162251104552740175503996670997705423888382328014210171324376593090187604268086334796245552762333\", \"1946671258536842642381655747294621776070051525209940130115769153666368932042152311477746728678182920842238801763565726086459485050237860693394471644023999467670017470376746609892484192072297938254898880354014176373253875722410186683852253828299669530022166361304397631667133689128358365296701757782382475692465977794960109690362462330857/417774039698408581013003883929127512062321623871486379101498968145670269174833505080260389860863417408848209525427705249526516766731427603641806256289098209429110794311660844125377702016056984573671024035213045475132134896835814746425864304907974005950155657789157496389234919107772201305672421982198984613601511388413381215220924416000\", \"328578487723377153600821813410631465225159589727320893988991729306688663770697528156625398176929288628930496338036815910669579019719633124832162035588583242320537435554101841406566009219059042888412893352417446437227440076869427577701706713564212185163005644118869496869980925214424591264870388237079776503547314587137721633918824664946974571838634860386893404364499977966899068777016064/70382695927096628347637455030970644630942872888311870124896575877585692281624151103204551947776906510366521972834357031777287506848887607457751667816514216907338309372900327919413372044625602555866294337672022362865161523684052940126509854895320132828009551012639156341878073682501185688461720664801829933689280752623773789373199210473995823367199793407048741191786377993390965297664875\", \"2617201476921368517857942326432090876874414269689140439151907982631768946799200744678055980827789859579196832718849393046147656447672531861353456343821196812881882023188898815179947651274131166835133965629115749368441605680383605331300030886676081418867305170012032824011912531673468215561506423833911621270680104083533917562622600478548/559567121085534865189976875600841717161617153776904752351231210970240323460800785728739412474960421770806162360125774000625035522428160837855944215417821324758873127567654244465281354654299068546570789547691342609793050301258532586131013585959164719533123826201937801986942606844854123769532447570107525081084531848318874835968017578125\", \"636225736038986537559880265988431731529837451289737542395494683393492040808565905376235074534207026537145408562785279823547657299565440309510931336394031904920056464959974743525662459433889398003683078967642651812081450227654478095420306880762753401111260630654049389197602389949892636943971690212484981672010398108426002137114819838399222096538921225458913266993881960732663394566024064/135776510176793971074115131648637508758953050390591773574951317807919051619690313331192027871176160424663811116849856489187562728496099757910540362703888937768555824513740118941387831822900198029266206334350448626733139136083404404120210893986654422850183837974770675600952078956326317698998103770833069712616832650406225828969036781514645731022616236082175582937900731419575337473384125\", \"266695771933124633677367149389643417608461366874310588884377151539325854547826373711099517873721616543570605935954334944030816383858485296542260152894035979141266909050267414072982042090341712035518685997484257326212454742816979806460287972757626105526907510197321350895873473656215941034605746494172316089636216915825022339855304925515685/56811706665210352283362623728191218698295056176625217939528332247537278605113496147630185544004654583441448319260578659922931798845493756189402805173037491645434052737405379674607517658118427614090338938517963215812444779184193933749520313676564187507594274551791388039139409235056119788261689087831209441779870873305232021728002651979776\", \"3511806683161697708497547617957719390189982761002154386881580160856792742952365159764830433511949678304281539875366378131195670004345568047690216126001067194904446295336734931691743477531830892015690816210752795806120303198745685394015161323982229908105397857791180342330098240702332072396030780386362735967021055250450666535422528637737695053315137238368787607412459874094164027214953984/746741569878639983491390741637813989978804202898438708743258000150996080386381281307609038830698579358879333079215327202911977568726258527646560497079622703052765164031089590965199628534477381843079892123440214378949632707668935001371616475282883095939750704292616758568964786737752325652839226013335092148777788733453702438432279149298482004122593243860829060557386699231448957232420125\", \"499543951252504651717279461487337168721376180441322735807713499521878076780205427598086756686061009718016175215146305489885835839673419698751530207404115002383180054704927695269921072232395828258826213554806570423602966743337801741633869267620843626804016742412046844770601322513184123515405692795346790813502805238635003099976693786012816/106032986203682550514602969462803214831559442358811656484036951559991322084935692953211120289352600484987931812632505499612220494311324679562152078883141464406938524087376964935494245010636163705698220308243980789514815579319533341929989455211613890905485981353837321342730307819060825125980500975023479813757024395422041501208805339176375\", \"8540849722242122835873311629952985285477986765819584558233324868363310302206006773828897816547299245727087876984857726652932481899766510637403577175623031467933486823994040576431755172220921921877192006685053572215922347418846423419683723609799729359551828522978186208983138345476801247634773975311405913274552616037005854836040162212761099347518242200807692224460514057530656658616850816/1809694575992816440924165741094996511361288430727981159314194000585536832192004274726651828760263522962868944612215633976203596150606503849595633388319338251977160257979846235995654357082321611719654136058257458753105122024859078420173515189641515736029725847315662215778251370398007468665986604529263071981040014321717598469319370651877296085250322599247141397427185438573360443115234375\", \"51377057693118720457387330519321684810411289582445982078756989158447711080414032055843805733348558621949380554029375294451303430269197115810494758213980833379214402452992657502777067850631862453239349835215260705131864911194740832694498014048717871429797341104227759557199716944554347879767916801106279081864127192611546757627038037780244683/10867246748205139797826516105458406878398263495890048637741584969144406206902037615496936724683237700974333817527350121106320991054058406504571347680049945745432432384570515723033245430148177097144850158758462968940525568041926860856763884474605057056550146491001458649244094211354153171337463406192651150028767064600270112838159624568832000\", \"2517199821548153657910904242290029026229621935918771922146425373057248090467388430999870036608278542449661971830076845113363443421757278612394167195431759807908413353743377586893872930828548256216510734912027450642648789925142482023713336937258932978503310551945630359646777080073329099268529064437120002567758664419443374110941824106727218341795100740316967386497091058915066147604481280/531524260324016969370728057738851340792702640911631807178654723224511108065633433027773388768889035083734041289308124943130099580765995149865288328550751289346866467755881013217287175392101334538392596956248952430438673292186779006015549928829953979591250274457658042926539541422697852390294886719770034058916886894408015624288115732154492554105512936468520265305162358665491880968652687\", \"937159485027553069020805864547349554547661693803137696125140510201297417077233061462068930061915381468160677500445535971818609631674361074587732183297775728389124966713749450996643183965795829780345678634356741756033039293590264355732129789110416943789326482663579413229893878422643110852069225671783017610387570935863228248464396615988222968188/197552642195166614912991396771845374656891854357948006221100585931656016640982345159207601253599235265353060942313995345483862152489766993442419668492877390774016299878943454249209917002169480134131612530977452579520564400124908392339263545911443803619972765231094502745980083350567509014991735227390978850048088378721210219321877150756855372125\", \"5119346675109082499980756672052066247676641510661024682574296075659671743397880591881419516307292610449161239233139088348510165442597278965718490070997173182184417648987611422446347235659085092530927312760229499083348217392125906851921500360553758600756698605047197529446594606336369425040236883171542367713951500007600355406492128741649090501989105696576697387613035366083536629358444229248/1077349190930018641197987339365056771667455373500846354778079878558146320193384166982231171317419356136237346389570422332278447217033773023556383420372685049620361481309067017697564760747047839930422553324681218253359586320952896352245366885171583221864112040038531116947187482413031483309534553461613717398523132176948321964066833901215878133594739833910960843185464241840039390204295097875\", \"58469980853327028628854378052548435225264353747414624620847476036979290604604988637469977624105451959796142112200285366199247075503424204044884512269071061176877225315884188402954249683107639777479663275428465242905314418930053869461904934138752031124685541853599407727446896558064252696813370692668496452783003306386669962110734257851955001481/12284458784412533668960387046583440199646081362484321078872891438551639470826582933879934711861551014258493898870867541349962531447724393381011633785884743889445407749238183080941846528000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\", \"632694338036291086868292541736272151517212971647680989553388199374739841494700315711180961760384484042159533979873604395621016272772109619401112452105475906812313548587880899058905419220497456502543971131226430775692744506047039958551641270070996110661036371362526401525207493270590999387476275629412687473362310414634469788979236895300129227082421021999210841384596617452097273320509348159488/132710874087075221626157136110978536488168313127228703025408943153782802265472978945703742152954881438058373686972477195846162708986982742647038014147903817539418442869011995988024638278746664230046452545499722614320284478925059527086663455478374200352375121910000967044366831275681254530914306064535110528723482282501358749001657608122307686482720926189537227492041135055090784059994118192625\", \"2022422468242151190347511883185841333968390991430363660248687284021524206079162212007263606819387821055183192871951076644707111802972354128011904720586729919826758651167984507804867954970064938022106484656560866447290934136610214175516487579122328055482392137619829739560923807880779865442016530712986750711199998190148885726144596663143651240/423528009127070458603837580844559347493775236970253513203186912091140251858605354218715508091394564000304400858761758838182654201653901408046974668599216804223721114331085507752600832390227068985693006017591304916519540245902645712532993889000048992026931475754508248265356181099817467608863068068953756055334213584649136541490530849577363647\", \"150542201776735231618709653388506394887777837646651406023174643241783006776019388336318216053045300417086929061565868663031237502137150880313922488106751241006715449458736723129545400133450376339156062387859536289694727635468338235084533552501618659272047966040838509286942825414463511175531001410923014751124732748099355476332649458471135027773371541572374016038525336728276024676601778299264/31475618522527975728853391146702172347290819252268551219771201846701658848754300838383637247014705706066050673096278897933831272607774110183488615338021656923433335661890414740664480671162459271850877855521869741833030384682549648626038314686632195158507693321505500888988183270276134667071014075017317692121986144742473139078857816578133693776368882596780120407949076129685719314703426278875\", \"162664351499283182546788129866259011542529017155637405328005084357078048074065548349602626724265307733005745244338982661090506394708170105916177679714664432754153795772811389612700051002336719842784098507498286260450939289109123759859710248621544296008356071415713931721102824434964336667980062728653562369697289761913925215639430496443820411811651/33956433298509232632327667206936379248172049619640091186698677954874297837764235300806836350019565970550533206216590639008637925266405524715041372407701947953283803854153876844320283735281209725651036513491246238622967031979233265136280687995181375582844780830517825595245506321879177965868747546127685256867456319112247572348416655367667187712000\", \"27228583713734183629451808889147559240254570554044667607519238865891084165382075658707675405673276615039702916443152954157535195508033284355580742761569101934821088036084480297442018005972653124248838420021440899368869744141698556359295489470499243402799483082406238128875386939389123336303631993557844565927960009744780823166462314116039469622216263221278402673028225214534859076857413557466368/5675134787340359276387085910732530678163604187009567576895331134521132071092293139167824957253050637085885426100206370974479279292804959049999647539684766632278449357893560561608633329561385765035738071726214510832066885156767060324427330401967034889966727638276371320401053302413136551142103678412692111973028587922399670456670380189570979581674699102934733563330382821732200682163238525390625\", \"1340937726818688387636018677960518622106989311577445614347061615417831160296369500704524022869612973331444242000788110133157689786976834913297544087249593601420972111789552905846168933014570399562460789075871112224533723259660967481288525220689577290386781169316008987012566216235876842757183233207943071523447855623001920854571597886491163165150556/279054368814522483241446594911968519760869180429079780837994812436395792594449929617293503975169489945136244602350941695478861584261665582123038340824700224583170270427163469762789603657025958695551448477050958557681299495041994050951692916032501884523150972841782658389836059236040091605838583126400660344344601879969354053137568588338096589095875\", \"8910951660339249479517731530773509037034977353457185453617569046885132434552771722727442649095007828468878374139001808825741829728375370140505088133244952288239619141544661695065318568074863317054989982620944602245967155400712702259180443238473885690297281525960618905625084639870407113029712510345262279507055197024677292523214467306898573956604928730377318210588837126450942086527893437954864000/1851573255256476362977604759655284263358595254392797078730401113550522214182030016660458780180636930591149034499142464357511158868625309442843792189394292787657774627425816694628839987456477799348874853555586931850788645677998004186437300173080088839930384424797706381282430208961565555953254145002318893188197561315855286173276564036402546798318351229978103276843822345004757661005876638005274037\", \"84997663352987536417038496128111159210386455419431137931308301989414462311135708114322046234708053448098538629166672456703651524480738219822858469100454933583774404032968304328859365484249897913676382909050450855222567147661842184538302991526635974158862033287154321908483007506326807469239745851379559259262425675035790574846229470041596801343087041/17634687575122715507915388096857069366146981156897230620371714518707518105157483283253374797127075689236298114335734874553183291806268149747826050838089931351158483980735336772879045027213982661634865556129548356487722537193914986994283729746578044621115589195066212043187229606921062007047940293972381121200723292297716621231320254309060321476608000\", \"1648849257486312935416274009474520589799750757877252390543329851029437452988499485179026845292068377957697884739052491455807688429630524210823560524122596610276957537756142278585091315141096146341773982302888007751632401090642472506538817998043326415693840862261701364114923327286462650797963969289743571514890723145251583881752876340628073395708716735192690808352188867334842743895738955762067968/341580411902962140529547622267381834425264893226447658723654120920549166416114849731588552578626041597847002946105459812230979900480135423787717825697955152193526724029890829615845314765605770060975538542976523177976182401820926854406945392167140347444433885786340415437006775075196031433365827874254477351374236932624514469241634422312990555534789607377023339236417434574755566856489013828206625\", \"4899626659231633406569362199187192352933567344960498139854460545644210119722856870634652562532083546344965166340063297647520613455037240144734014575196764021102614748218834054157165781057405100578668000290493431869797883155764963238760612333048336953434663867580862692267574574465371615023999531030446250351305046572267686566999209229202587258144318592/1013522377571209303732207048597964555261512342860326827024786500686692475697570284120359840724596444209277948648863014479460188496587721578075151793081823795161404110811480269106846359964436993190293615381593756076515012514100289406862487971220020752628653845345780766244842386136740768474703009091552043945843632199999007070800871588289737701416015625\", \"362903847358088423032098939589019598036593525722040887883164115981767777873860799955715587436566233010543937498922435963385091400670303956612881974450548904906949032005878241638546734597308786514086678561900713741746905742866635779432216761799371793260025549698865319760786921444505323758235164807966277024031605673481480590193724980659448692487108892154809490199414370023696404259691299614147712/74959603173756091922435708504751461448318819548943586676159545028063979695880930926805574951275602951047845904770828900645717477098988124553474616764040938121171776556999069351772286262529729056288451037717198273521810585868307402693261479298923209587143468206907278220909447483738730657438961435587752873879244136801168836767273934997417156543866722171766794171623224855358640156858606843576125\", \"8521348154958613550574095745596657249924328336262127244827955886474742319277424381360677655239017583606851483318951440691757875270001283229585075137091617073509041644097526047127618954293881264113694362598157456878784814696577083997902588926421675843291157049153701100218784481406086810264243143337016042301806376864424632290226377881206765051896745/1757584673254145109614914862134217345456065873908262753169404848658913774363650863904627183104777337461445063704655164325930891269843669860409763569362863600932267319335889540453302785099532688264425988677082044905948179153286276609910158854349711054144968131934713419772852663860893241364433872853338630216232313607969790083448433666334742108176384\", \"1802461420562646993856730082999823508145602238125054717836501201545920604020389361370931345491160549787411668288359013059160331370751496329806488246135100776263777863399096485894306306621852596694700845918608199329091852956315870664531614358379176680326508877329862713333336188556181470928613423972314983964578645688876556351433429494008513812136152576866650152623510296911708111085518974142728903424/371238439252064016214448115231139360835481920731625321084601566992497057371416121407293286027832357816257507287295719261141426130159269433199862002841433235955835172774430690352481806933860390015899973299268361513643524088242973968537595085600335021120523852420135081643310663869327371821064862449426404044951571585406092523478861879148545678639697679215289523234342337347529225543852787599016265125\", \"88795280670112240977945082069219541902481768504536167808816453021962616596410396813316064685579412429940019071114917828928080181638058444302439626425155946562362550070187433083541414569447612195370911498321149367969974762244140788494955146280201020345849385865084095189982291190135293114489407801749533448443222584092575861096946605418438181411489276/18262596223069549313969288693970246663726147886364354584825624311486557881239003216971630599389642752648815377795018130449384513824927138566203714891090017787258920529990523519479383032564209629983810866231367438270859421572641494420831435563580050954867101292568399107965982704216434467243223964964535464624988344342084084237484262612100980519602625\", \"752911409358158070688133336918078236438086521781731735123294741731669530734909563155732092406099003582749182967246236657021875488130304108082404134004381196925042617909108654109138702993903561036987511410396567636331465803949049946947888490287210013788802287247422993384874670368649616782837096233384279817294778916419067404863458318451722971117669642134894906235066332205740872938406767767019265664/154635332883086377656813458754577288834216641577439356891585125701020579768315520324293435008561626926046988056302745604248220408154454267643222328696606367409715369481567213640103076112146615938180089303294709009813772509602954514391675152597458428326644988225555987883250642389550531163153338541870029415077982539614784206119074702022117790679351778993541426110436276530890609137713909149169921875\", \"15286089077439918584953144558775765002061832952090847117286473868694909713791678395221438112006475047633028543501632631679316850512797978594476229228325228403849089079675681042224057234415951253954044235099139983386056610384489202589484570852048157272551098909455253037561994944665563291526597323199530997923272894119350512727802414680772513760081360291/3135161418037836259442831302977219750614726139657718770206960776514822107155928800694375522572523712277389679035632531727155957120566617736817225541673148354829212969778664144907503411589126111888917929495106029890532891919001138770210977012708107496187227751496980000137223047079127096028939624830654227758737339725345681745847598157538483308068864000\", \"17723482381737693269787076798246423310802126092500438681864673375704464394105734049099094818738115345706100191580982712146882034618103161268453808819471603805345990162762722549964406042295355916458624836894291267553138041035528315839108252422478610879301656207772491548742981990469454529537049123948604931661837539943536878260665617524824604291547373872716194154198824107266275716083848262625068958720/3630091565725887087605600771358216927099748013831912080380983545872077197366172619225751217619097657405660172801849926220948413919823038425519006413005998509677472226729295278652284861834178791332630676772284971762683579047508016687969040658592436230062049051143001484384767836353233324570686249824980508520186643477313941054900197268584495128610811273834192099099592687485176400539748616360799518357\", \"39160514032490258389003214587901781721548011632821053230881239001436341012396166857515197251499460842954863342641015306304854226194551189224721257664420778416733889030680295206179109679627522113592373938602737416822981698362363553492610842201005420727750505681358595340127099855823746410663750133019743170700888375554918213182862789028531284364877435896/8009919337434786244380818390213546866794958389603666737562053423775386173149395943310276429895991903753441584557917565343673605019989336264748588735390182130334278887642569515202100870042209261561001627386525182096090194076839370589780431326097965428311786635366819094633651297179987340498215947144870164066409654464551017761658775207392803825996394875\", \"18188388167811476762477659006849121912679763597132233588170406666718758511478154418948855160838212151370453213943784067796172102916618102024199200086478021533171984254799008541948973652219533819511807681148179806051835318645591102296256347927018942348574774821478499092054497390790734798143983945096982240517058861467440217558586822663985584775920517755909444876443211404222400335500608733284461685888/3715278241795087610941547133490827711133909145414878217965273061493740719983191775105550559905283733134189195190321643965858771461560130864714477448011225816210219450040558581571206711791272284197614810026220745160693898421068168630870850392739817340370146186703867097982858560347971281142766235850971837330222970900661653800041795020382847588362774677568059355238174402415384788280852059532958121625\", \"46353430636874284402376008361176880938798775506236714098123916668545331718677407145199311191108199195405139575147933283523305343027297808443653460575141799729554209181454676876263582758919969948546918471128299522715691694855904535448703118221685887195383025133924852224568922999317583667985459047407473419196367812949579858081181660610155317911318937349/9455890179897829052705408931064120820559254220394152447502395298827357144081378513080398823188243663943177539817982481713456798757563952162598464929784370305696420245648035222083207596797327498500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\", \"13607414211126412689435920170832779523235279308039712294681570127241403406455725064605210473923965685858012114332021572088551127762628892611459785625407107300355287623761046438724706918300976102581928643740596336865698485838431972050267114940079353996100620311097561405192365496385584164725035842307146351211183443267583872067352881387294766804298681841402861626441205037637282007810811602289501477350144/2772205947240095684743358245950494400934136973845543049938212403703005150954425087866758842625041409060217562878157900197951382737615822655863548356735553650755342108183641353142157728364469706919993519071329069805875834057743793434164720370026073143626055293058601124362130539040404491770346043977106988100969901297669523170508321703496903672333781306743488573086901583022550356345156457496396749797875\", \"23264350093315690507131500726914401771633259602904894387312742275462601574788485574913195967854009886824436237740789910851843045306673524324611130536719802717912615609109285261163220007241492964833933975789257681755002054890453747803418465119567389315754801791950553304034666399677630030683759466627797123971742061866928213780452325847848901682792886840980/4733430508316851445525799359992627142007028326865116523033957869609125212251136452396410236930025876982265915963089597825393317909648054808274488356887197933393799241941120691826916741647173843634076299630884655997401370400734954098249519111198509015387869462198674657171808841005212058822254513429836457539629035675822719720295352508916898476137111981397\", \"538960934807826161927564251064896730663918579817797131801326848839524373936888402762331254883505157846659830555799909822861853145306547699817986010353774500545305596630924815657016569444824389893996399550343022444937690798126189162954188680257730893424775303801562327757655350002001080811866451425665301674688928515041429654624970707803336800125648742168380676815769457467038849213225206824671025803392/109517448833211208909213522579666376007937648875042608355810687327424621469323788799169718267715808580775296460944943658428295481347915131091297305260674731651980547668762317138753250458639043477453950774629862540017034566407286963562574188172753764978963685535201028286359818524519980885827473904574840285411260037264057197155527809916623487144493019982419606308144576939532055057697567269576800542875\", \"24451481554350251656598350124163983489544445991992661049829014268366250968046589127810466483349378560701491445658725080497078590986743512397927747885285095846398852574219367580068049729894667374214861939897557930527646930793431512683750733092448862551580494245486308114129295467976874843852138144539250235632985676953662288536669286915983261820949386845806781/4962240683851186225340479316959605207278948397833849899236383273145853045488131674290332609876751222112917095096150531825255611911377071887145019702433883343849119017643117746273523770961304609989779231048095665388209125939879595509516490230961558353074751312876252070889983946768175488341370453053495319823381943793679003096504200440997908071027962806272000\", \"166591964685609920525429719961758335887941461052357297159523350448241484106515158310298216150030768812873781356326923214637847449893575074813991141092681107583183275003570804134461187213143832123628701876041315736048451374824101256980832991214945762266748755723551899001458245164317581617731332466039757786839492869211248064662857987111284518155462148044812626055842061283907063784492325693994911811072/33765943466859756347231737285768516240749714264564410814839966011490233598006227246396923594069488496368994857718734549787000213944990695920130591750377483911116845697231074543526982580529937081378303555262933800375576494067959129682770065443667091668104132884375840812635624862495548888467575848428463895756394050252457592540570490061561616914443009224917652440212112452400106121785938739776611328125\", \"142464729519206642943985715465196065680101634264787375740459792619754842396453535646509170066091478069799080172299369994438836484938378991283020978342879057271045033903518255546705211647900945143546293360496661466657600494787228476009216508124736254967761901224547269496682078470378676865981855568197705507111970901389105723589666709580851611656838285777566736/28839643075889294346635430272525349651555039807615358795334663734940126053968249608601725991946342449660829847322517564370606746964714098508298705743689729306507554363954348780144675937510900983622836770223945538844314468550644543502501484521561567788992156632892028591678742014134130878101553633195551605796158103033794695984958987367799607407626319024034625\", \"380457154857422076784416625436182734840012277442496600178664323821064977485271288502806124740204295811759917468598315932331219906040253463960961995849761235911145436552991677050565022181516596464968316292789048809559129516930574340710998611088996508613850407294743457197519091160170604426002924022923388338999324182261954685794522778833029950214443271526469607532589775916381786492089432407550224137344640/76922142291839859196033215395526448408989799722090330866256930898223012427332209054699494033511478050536463051459450844520020426942553107946282832072826069342120835351421637970462054707566481086202287686453371483126873188020538661871147778312986131920021929455276187425940666580158173676284545586944833678819622895550345083175685846944633982680908505900099388037050135210936852210263717185637166725605577\", \"79999800708369666670693340813609265988600461251844239982904928629083975986385235816587497657678297663151298709076884516168798694292862559083730259839524968813932151813233366175091317046758260934357096757322369138747731224414176608247605314668045838769433811781490030635374856042786947109101585097035794969502111354126773165391577217071956928171336060247633607/16154850265413610119312596299635391433380319311682208755390341659152160578366244774029302281068833963848811596545791104919556346810193385001196395489740571188884873246131813864782581356887110499639544662322008824704830818136660544673293865921754569356583698951612797219776290835161780326945625621758204931298948625885081325268123344406261740843197232316416000\", \"26517014004241498798848003208133111307300592620947908933072661812816683085261359696887064436611747292468717739609776825664344064024535028242737616786238200200498291226984541942836459188328346609549239724653950302145388877472274074665166631509490297630344351573245265440164082334092997307729007429218385933622623935704482371360985836659823269511115937443161532987660855490906546130131716829909388620539153152/5348257529530073524280989257577050878033239486885664777340947102417077875628238501791711336803418503616042922880218860266611595594400020206192599559925169589023339295256084579966533260861249529670141854632965231468533448709363477120437277477668173149958267956654411822360053335695956270719680086524322530514249891157439878407417971839744392044064720476417844056346174795601710447583861127956455406902139625\", \"71197348290771978405602732839537012310626009318133570890482364371056186523989330157966045289127980687764218363064941391483781008265266963537623770685390148810455244349859354857421474277963009857011653865476081389968122418691934354122230780300833008753686234433642072919923583176333668289998661499146617277981691372057042930131717336250309680764289256080895092/14342680993892886303954853579883363225921109635079605392320944523109187641283117181461662846411912306480691901515655220490850586434947504504317080144378185989596578890875561336496479576651516902048606328604696610314441229321219627021610788398730173161473456954861916116391687748151443335513249810808309201830214153565966339609616397865465842187404632568359375\", \"342401018754023891059352629509715357053454506037284788725127073168445189422181540408896452651232759821766616850264122591225331120588918865882061344322996688880669665450231982002597398732201789017495427566260651180470635467002453249479483900268320570004293679361696197905823690145326531180324429318916092471863347575533714871355651558610515931373080997536792242278529575700808878786732127630024064418468916608/68894647682461956089382461406499759613691148650738957016015844830333168307020284281532026442272618372290646283794122772122665531108484704223311663270836645399554940741928358317884620420886609705267248656765357348477857852684140561714900614303731786621656041881975328169543884661780531057279582784036689401206706069028229798913082362331334839997133771880514515972024899408556517159759907883793675672065360125\", \"190286571838805495686895463752492174798162827967490343625540320679760700551286395956241059969689020885714190883323266375067607282890063444652926151862650426323339187596278760962390404656342309737428214493422028545912504503974763216230927196187743439226243880933947417760147785405444976177822143722569696182520826218120595298059020305548681823408268556482981325/38242608291912408815838081993045123864617058390583394828737640036167893859507494091864963383596867701436244007905770284939991912884465101575490548813894148831966132970730263562113961685364216989999844961688441914455435934703797359360780356482629495214859917249465567846934284121032247250332634283689409883499295469118485912489058982596725212975311140618764288\", \"15345379701153714436938289567639102307887273898834051456693981514956329731572600026866162286097662958712922836383881840211072389867463987895894067288699955858337488812343674818565432780224654423872618380928462939482247900055572079914753652915184313685270722583926261499687728814560680092231526501970431280783177357735398580700300402036873780385926225005561766822479878280891130232036389707452005183370152749056/3080426623087819678602049171756961824196425548529619576972793653585089380165862889092832375934535464160425580449193072125955685099151500755278763306599307218302635233595329082702148677300945556130106197481236122437978375963261172524503625593066102601042060541617791008722569799735202779005407381267021641545644264334109052258081225159748043792288699674153722046659880085850980843460715080965607434114275256125\", \"36443601662144279337033484452272105547257065463167427418525882851507989449375452076227652634440476502702584889057376829320548464677623038648843251719168810701744338735202853412651160681259533015293997501525430222870696235141468274274064390273214484922080219643095978640300874086585386991338440415203863901714217818222666715642467237183267303214471854472286478344/7307237990148312451155090506264642657872224684879860008436735430879314349554023096366846856470375025555139219961666754780864835035902856314981482268319886395881809659368275720375576152008289949085453326722156553603358879420820012964006978808113307340321824660484441618487292138631579616351777191144073820686595597986548374588839763719082323114663844043046087375\", \"1575294930860663922843149113097927168024893739962464327016763741314068438447271326302129681931564068796631337571133444163024224071270063174829664848259482066723104251718808936762938249028582992557822551950212098797718627418782376027133576209718376784834456568694813577764300716139817031545408608110880973380162736536313173329973171844528083756524804574267826691156368696436273087171467254161930265910972517504/315498546654512047637461608750018349421492986465373840347519942494904200733840189483934245529561231604050629653992944140351106887747105945984325466452136415067807666316202346895657914393512001212656936450425268507235863153258769360296536050028695266363553141327896064944506216017933135251875087069031098099192325817395958019524956320840925176589616439477134480262100237057953933117460110224783420562744140625\", \"7692057599553133417225997786980128299372439542315125030077404519679450372805989755158000864378924877036225189784045171045139667691524763609840822628706422918926410377185494048355128046783294954373197082851501927410350313585640237550107070936498164597231431242858771457898152684298047446530220873884022213114819556822050178579707210264243087257050468000092842761/1538814487241112760739561704846381585063002784795057066438330325566843108114787083741788078680861495340026117682606689156065008672344707615420501964123121620401073675430690541617930520947170306763541251152854304975131871537939618684186766168376514664494488691311397307418298556185724993104760692216619178358268934740746932420562664234738576394742559349407744000\", \"15190836470550557926140012263310230378455340797095100474720776113765300081463960235506950799869073894127884189857505951314428810423734978025409205413789025720642609035117121385453856877706229778165533034683130064865256448444765902482146676668197546098809055341050873494446231793312407516463576380102073171090898973046611572020564659042146465345334273595086941562425006763960197801018796906114925005810069684480/3035556598829526968124942916297025416522606357010637652635799096498208643970273828496655227572100159414352020909846298817521082538898702393916708804775798552206401718323929157863173504795127180177622667376867235806208021329981136637175570409791442328468473111768140746895005561471574356889047981458002257872092408771959478275534098789982899056118498417649167444480913552548249005268380838457505944462494874581\", \"2923754549090941424546974281011770689534961442264350984393235983189168024079617848190236639328676436485460311093391982825027512234467853098757486086492333410753919927528867817406389678461354257841007722472106464785557179844602277350411593959136520732862935740433163383885526249897183805981219416420390137516812715245569037561966929572448247077578419534651990827044/583599691615378545100950777601104007812792435102945248411439102112424251478512952087517463400054567832353967731887062349496616445419782499817548928078665212077449420216892583997505908858360011413290038645573504472422610780073975450391707084016931661068694024023083417126286468909117254531307085545768412513447197205482285022417611018126886491416133665625891075125\", \"441922815213568908489589193556560586318864326425397702047965372289295962228254658331201274291697626694859414786292266008476137667843874780506886929181835469302142365772763129838217316953835831059616268288399119642314758261677639945004547833810080700127847214666763863338091523753898362699222880772298183760217731228628442782431573977490761665091005756534420789258276075174436091798475838370152192077494553263232/88113527373573049332749294663402406454524640221866407165839162576979477138694653404281889227416977618913249275712917582743426231744980461918772793673202077716234026090308791893409200158969108910565467273725064769890443408324386897017825489615600787634985397885230455168591240328585041836771921929567914891379235573982442311269392541694564675053636078990836491104116280492254795616055818375774141667319774630875\", \"91197133767962483852278456285591810579974783077874307589555559715577599604626819245000672929518645004771085106770784762994476973842713035791487204122653245797126906189270204029735872508462106527240320932458036231707311992868347221176460407003487373754014365881209649632547685657666691589606571865740595829983849941049450471212387808617247938941417000965198123059467/18163679611214677813643455199979098261849405189805364986036911945012016248297645596270602508015864371788974684317239728239847888960155365342460843559658233069613218442910226128113196984801126248862273503232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\", \"733396724434554481470656964167233690851279923085197144879644750437402627936723531635898542414136943003236478432848965516925891956615111678444586384493883113385335463639674699443808084827715994137410743992130712903997815471369201406683862985677774155704267039224546352414417632475628136460919900347977754644214725932476856018335195927604771408949980634142255497812566866795799230501026066145434755838336990365184/145912495644159810313026420025053989609942265686388630266226856650796088768164358961644113076809511566125145395699271530802891523741636707532676065833327082092521989958971154798465784847092870457944857590623097781956884297103961713362268264159015928554707158239398721416218953003215109202771651993622244788505649098445109438104466256408060944298437033058380804126574878377874459371251056800895394904459469832875\", \"167606423853658713615749101123336326908381619586838606922565378505211386185130407423587264776519589295420758009764678759213587906216543160801059029133457062067529468464636376639307690657945597847080706144898920305379653754920571797771178341550808041652360635584401789901525709166172283390177673009483341826911179861584213314395893323035527116283758445038413646757280/33310364848744488727470761889861069993071965180756187311178124887286133554324042422503263994717993129539448310743598138364172889305532401505890384806078790034557049074169245078416704866867380089103064821732673967120808611636618526737138435792818828990403374766228037003927569643972203993263329403469747342204808360947840103843317533210523853631711601450617095736473\", \"22466735478643771803624909352181817912387732117378538284107485621001246177152644141853604633676939694208131243081227668237716194316732125445041260568403752325416203858329469477774720998849334961751541191761521224644520742691981372782009394826739249604257098248751626957528543558542443122470657230835176462612530464044652140581367666271771882198747182114685116336512604038833327707163107207664705120728068987996560512/4460342260599110071819142535903990817893424192972341872394014748315090430999224107274777695306032783105944721337053156074851240201179902835353097683269298594190456286888326067932777720561181760369783486872666974623910515795208353605697065447942804414120030678603538761538385793829787734830129764152263691296719726909633580318897787729004972323599773548689272008712427926734258913271101899780538635213826239542884125\", \"1972862002066252798837977155272535342727415329632252213508267781390870646909686724955861608046325765650407340102472833428905279473185818898693854344138403744757857928883601637909604082588338869612221777263582365745419719805587946558326048087138197694016224613118304623864709183681172362693106460535117459192992832969130895829916210933710820035479169562970982784580861/391262854245936198649509275719624152305206807261382621390946060636032376057385723427601113233050260359684153963520782285097664628279596618521963444574543409076428660874564026651742234728997339844161514273669735686516761239076529088145208958938384732800586298943281728435207452253170935715239392534815683367114290676180839217919539381651841151674859715992309727232000\", \"25408691426286653276004556426513401767718328640048945917745783225459709487487356095164164652218100925888847689099153320777389381851598236046402124684511968385325107497047025485302333503075085562533472482645023963717347867696861885363417595298751490212495932766872748125111115039311507374363000062513977436921772096443948159289707996749061007112458126301618769295162649600673247799961118662602756889448152517364992/5033870770817104909025512331238419776407331281944565644457345507262881100618908405924951559853352841154730802006750688581603270849880756026262217651685813584900300357685874044482329601894134443542753690048962260914642678445058891387041919581376195543193199307524572671344323361282633828144708683536721118910549933336800461248338059209853766305058943888965279863852107507075916981165164543199352920055389404296875\", \"616565940481577765011174617619124841631603944267256178093555235591208387588894068005162766513720546626399308168923904625210748051788652328072241494243040185611373035059619136712559505023703153194815611268503291295059648269772663939137446253437248541496631852986499688052678961495116210133458596866684413931188348798244969797973846568160999564540652111599082181871436/122025682149627484528651507368051367620578469392233875493556828623437869650284356703295836998178256875766319508797903923638967073687991229708051285605187358616531926112736402511567721889845693991963610192161413692928378708223712791930113386840109729368772998347036090902364801014045328348830748307179590755723160142468563977011700764517880467116766150322736003147125\", \"979882056834583241477188686550561625289337025747787132773853690143359657519481397575561812727394470125172272246774578404543257210124412718725081536309818383310896102958167337333430555168671327992395916735022711297435263157670501117734412587691271084981140167017421900852550822579410636184333142944411060788723653596377015359036101170054828623669169047118551010102258802465554033173968468183492058271365801755986560/193732066620504775981759812703028757608600125742477178751189607602983198559778039141192492589734277739017909889924488699372940787977794555519474807920198944109549023547259912324279741006975129518191081373554817584214941629021088206977532599055014150433581544599721903881284581257812850697423350805715586436114842183295730680490110793225514602133304729484547181740290534056445482186430729398701311563285494964645419\", \"1138059441890428903336718712159907364975959482163004276901676063186939296217569849990951930955270849692775077813359573394435924934540269310629731801376134549169322946310756738187834128956671195358413024062230774111935109203207768898525882417078119314003162592087920755572050993355843681931139257303484526223461840939880759908449181135029327442039666513325916729112853/224777393704985303260433439401503507705148576727364388720387174977154204629336985298082893443205223017966145098064861566754244624732671470935725326043491911142467178027013112527668183783450932992534517827863293825061296257420183669383719043873666284378647952385401303733274771042385666436214517205678674213118374889121542369996042313879258622144464565403138392064000\", \"614262617634904509410555695398092190166323289787703954329113412647342230855826568873946233136303566178604275296873234926652080462259552775254755109931312516616838091852915397846984381183732773411263828600108443070778861986849272794442105107285234729077818614332155890946804257724112143631642663084660012362691100872465148864413343598067567142977134846266425075195546265101720326272502009234689388355365794889444257557504/121200854655310345878069155190734381476914416893031941761756379148622591310152793328910334357724762079139509813381997287954319983165971628429295803162563856219211627796200599196263868781937234015821367575512548522790158101892507996780675863234181700253545912643548466256938936835469646114659598727592390628209362096738343417775009361678599075671154405137663077798419897932404104579113056038271753988669813988076515476125\", \"106893445531995430131837569895703697604978445859412739331042151546083234373443601923983714252801103551874986033841637079479794895452077803182698291822629713500021995241940133037200268381793282318691568234728329378829301282121562652452936297422136961147432559766896143081059518238234777055931999714973999553456547746825617168005650221542417216291412324174772893635832/21070287546583154895102927029203125577385528350171457634203261197137238923923245382493868134869009844094435068284335909266152042903157700510534904847257436666980671067329084409346149729385625108233234542133838924281113454526471855573271066865534480974484196644173270141056470857666632902827625475719738076524047736123182255306429677688129231682978570461273193359375\", \"1112742798776748551928744983308584493817112400536084744850969025063360679785378789764875076529575583792571198510306186417773101346425704969671256564494135750783642910394213727189639661184379341961737135764570942961692159177189753139209638929302928699705042832922774012622017270172331722295881412111812933593370743210214549038212395941675257558442878012136484052827439007483777859391215222647499741572327725689840850048/219121905514652575155579185322367175400669386131891843382447432851122462422992147756333729893028362013318264155489537138133372703295804002840920402482110260590055749843170064921843460498824128274420925357547023876488939786863662801268798987685503391058250902634999352652063668663245829496836853509616873246554292796823779397317819134891873583857621623143253788854530146303641400986028503534408870194989478421253057625\", \"983995170259637497940121707857673268620603982844439610076334749792119502557380361624096960070148627663305171311646851566811683351232268240169848810658089698606409195744471343416197434926513684882439596141368794175162315633192028977211909698595778839497844847281262559899914504080092844816319298286511436690429175757804604673752838786852277255064434365401871903307643705/193579499709739777577893639665643417521924510242119561765932078835121983190401762561436208758210519231103767232899529457440602166918701550386152070813526760823513884391055054076485295945972185402977095815609448651316824455250005505410192101148149284756928250258632031981439345164037318129987999546683113483700660879431801728391911161900686707231543216283304182063038464\", \"30691013076836380319652884848585431917439358375118437035944950498156836885409110087616602043242747413728866747975631727566613593257623099549583001362246649928075859944695060947434885707102684568632559339383409378997568182445019183928058902445738702610436187907199482604867148445903921474846103586253320950728989228898324829144701782792767763794895137313050381112872972806712570559942583906619373159053654481250809168128/6031936190594376585238407905469035598668211679521553144958053099463931217856780171872253258738635531385711702176347575597387389685526098889278278029314982721284691198967204664771178761416891317672705719303088746953644978471289001577698554025410820041497108311270431130911021653860874238212040640737171103823631718483572464361276703378587106311153455557896527384426327053165214814954154328483257657424873929502112904625\", \"33633002641218571027682690377239300567277297301791434890431645909447040830457253186262970747405514897340315490970846553666201190386457221846694126637998462873786334837901001833771510353365825087187582807843940479192544772559118293851131234910638705258664901225494129023244916125545283621607920983287799648992632814461828998517949449887522866259724675318233522060729654796/6603800575190864815125307817934327053530311915572323544225173935830559756077637251538096164499112411672913910767032482188570876526606118068929913515497400397562722669603861813453418621246538114872330536044519242663538662076583511078523573320035084744399535581216815034837553165853576616422592790103728141443697362408727056813977234078214386771115586436985105038873998875\", \"9090550743395453237608373761422705922989356346696677314277463900103283296889488490217663400349361962695279888433677856471792856853109469433355422802663947305503479561493033851081993247556828544308258821557994512133708656174864544457143793106703578476914924328960109390350040954158797845288786321215010324565010420734044059968931558099077932776525974187717655105951506223649947806568984848883258144616897526257038550656/1783219994432430133950472014582130883873515063182143523712063859964133099770763874744121895885645346884371273930727450069430704145915261127061538288702855011220545530326588799412076879985026006593893648911637986337776174555198865379578424838210466703683642106934154603710587408512357351455891557594977191641529451749437270208258072920514602243985184744955476557012910446023911358037761232253615162335336208343505859375\", \"396226087129511787616470716244996965529391571019620342657409150252952330537366537352182763477820160355931003174946109480036915624974500187179367618457008802667089004678925595775249725629495848146669773574395699032785024522882892752987825063933573399691764866816284097232869198405981830106568826923407996367321353003569052419999880089180418759265274331299787468134974811/77651132902382550540201641628906752945078964002822585000619340261128555048628863996784740469908853602590877726845475670110127527874088625214912598995012971630852593597027649154487264595100300180591016581254965295280089902497540043916128232871685159131211213497239568483141031137909208031392464815187505714066235868748950184065923236670418822911614780061752905170944000\", \"1288523130900767412477856952035690867153496584747510253984686336382980221603917538996138294311274357713893956725672062832264871415025750136690143411884111580335458539824573239771267043414225271729141508235839982033182605445173050590151912297720800168687369852280323356691345317649445843078291369394324862039143247087442309135074453265658730028145500871559458519282433012494054724678302957276371418936282902434203225600/252284450515080370603949213084529993395050575951188044032908270470514999880554862449223347761507020354321422785760279154913310488296485989979706208254206974075438570521939826124860483842758137231373182496438568202110337751291106165654945352183167578675508602832478752400011567482434301614269579368882858973850914513870297071866544875650189106576672289734326492492059816669288907018095832842249738081022227281715919357\", \"559506782175368748187145067236900803925823792088293851453005882621173124590368101213652371965740365119375069053747415415684193092607523211636912074219215053809881814859129515591479780669511533619258835199715146655774919418434080807837587396115955105126806762961292429904380132116986984435528307613054828929294602185927322238461491059740342387266084431988727321711184308176/109446188216864405154936682374609448082436347600301765944233278303643744736544109262794383069197271409398615846380701459882784547857821831816863216080069944818453908760476475874319791512782445408136169878207358663250499628002971644430164185578966399908622640732411885568638054229180673755690889471388585521113862492432946110902070139679164884208988489955874131206343597375\", \"365842109776085256207829452385781129402656684569922320812625438296958174120084800064669048017227033185969596458778213306152397766619692644694641677223213185977626940193107608138827771259334379895020377700759789774994800008933137569543592829220611543060189849601828342989023692876182148818363689293009174358168826340010491728715549904988196347316703985894355217235339548078187164176255405596310602921647203428200269666176/71497266937783826306774367225149833789788300609530680399994804704196212252148324552193149332755057982662844988588678159610516634667597707204818296457616315484973288944637139939912166034691155272078609876888919170894915224022982785138928008133003473320018151370486895637936102520353951511525996197267572355782608352075229547764732602557133494648237258900273354364050662921889937355682486287799239363976556848320046933875\", \"59378684894605773397070783936113244261297966863668546282887298999811950599772732377979382620766180662159460666220894896896564357533604962977968843474062092083279165837424210591042655271577974272394203253875965589611493384384257117088518521598379301169916060951350650621757237206805037261878212424267780312614942173870651684587166691539909068452932891649554575072205080763/11593916877920131260484148322810317629326850763057953025674154928920977965095141485536566217873796019006709247938019404840440511433467040918770165456925609124166970862430104329357419669175323763143377917913760028500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\", \"440706629842402075137926797732405268015915199334341565218443748798479563505125605478061664327658137598204192554352688830679475840386882350034150077506804799859586772904929402683276898098601814091430598259347980573084686932949502809068565420937301632494387691284902026088950093888426872222813857928092871267130505744095697172494119689779474840037266295586359244899477781345249657455186847452249040895151288114085352974933708544/85971876318334010542313048056773419567285701852816309711738644074302467763075671531248793080425349570584102078764464196653843973936119037322000695949209283327606280423406302517302874806092835694196353778161663338667091195199032831587897410329509487165187753418615356836636352319310103639079123698118997500068644500893282438137614420288839230827096109835206605385673197123994357393257304049093683934224826006704198171592304125\", \"13220371178312284248107863849287558696210741535280184003301555188086761767176560823174196915070378763091889333203635784037294769747641959860810039816533609140662043493962707445564057197150603226797446933532133956054671103942520142568674339411250001585991743608723150284270101326419464088290151483823061613403673956918458456165552482913079283537536214967294211244361353060/2576683013797055224377707713704899315377379548630511095136568220145808780162671473907260623503552385384482723173913562423316997528913651044277418227616447815609873991028073011738113927961824632868956802271260292075825561646156680740323686126811928372672670917332613490241615850953660246271541592056143611581223295045062157404996958100136358649109693659623847024011265147\", \"1538372578072246705266078247950089219881197139399081643650271348770110178217959856819170325400476655944115553238940541695152110949081675985299189913515975242840473616169775880272489805123124548256666658584129873597192213080038937409046114908719298170078476325423466734429870048697383304265342125425087105698152643145531760853127801123272389134514333752173173161562273487752064850461823726948588221913540799816489566883798912/299566102446745552813544808169323270315327122249327394279467999308669285416179486075255023523726449428151807672528368606071047812907935426406886253284580296349349558797128593446316786243666290649442956134448480598303527795996222703837663605600624271807461605295956674925277658331760000117761013381199880905748188151556184620779667670278558839116983636972680749836497346863752662521197700717702790359162307617024566689271625\", \"281696937222363685333688097915539146272117417024070728031063821781398985795813333650547982965341298894634762289669256129805545549280355643122501181852136332529515756074502902204877664395456278205770206019663082511098956468724829475220996427130295010430751942126263620206886404244432409164651524408198286831329682605959881993845189585640874220032515465014097345759490750307207/54806274927935495596891312029173862473687610099325998583092091915101265393157631244775387832621032230434007486602816972765210205596482942091518459849775458089575743699797096697542306049628939919466378189656065461708686421130956996965004776108499273871055615413566043083634090083096967567965373203683231171594922347812966905149873265654962896456451681332216735396249206784000\", \"228506238533410805238253122961471637501498406104430046727793420497895852412513560203475440156216063574654372726194215013407325207763369075250819386897086702757125418327084312933061738392406321003231853349865003322697360659712771167066453430309997639548320673279964210730701373707765051246595806673865646607841876463608039111252607452843372970797479959213447237540830563469297144446069689149549515457318899981763489792/44418759813188470246596822974281932219088697005123285598909329328419879212164564561558656547678211265529803086702843380128457744445765859393426675396393053094588240457569380155526179040891009717323059641035189017918495485630657360525410506453554255734005459614858972904374739673834145083512160883402151636664208253116362089211658645312778404886460203600762546810897889629330022309705583438699250109493732452392578125\", \"2396110297187570506257836426251930521245117960980667897194680897478996322590925380310917400763581787981992131769075961259393685331523600287377841990678117113566991100720996059187144934569703045966210306282348527729533806882408323961336166190162075154579344185244957673138372347997134388801085788353482276257401005734929059700346687783400772331280644647089520646562669857652648/465370154262863030800729180763091967573522779260407615567563274096037297593764955820626213827962697601334935773802201919483657310282236100250543992334865461800976838791035335861420892967699843608855185710753433852279737724446294443337363478679601049432404435672469098850676302728116369979460222148206944323730586138087862719386327396334468302608499235112520318322763857676375\", \"1188272888075247520453568790651819187486389546755745961952033150576243575862120569399808467067800830890874391487822723879717525264875722720416173276963170672622214121308038530968291758445510982186014289745026439477197148445087614813262170975056866881909056450023324743409114115141145340480846088869807540798073417035168139476153897066325127540609756310068558610112731607522096096821938163134080426356894899245575410494080/230586762395914863625709048789913840511134004337945700368117795195769576856434588144361459740833007125516905017415184787078710001969815416281381427387949263792200577791644278234661952852149216540491852757174842146376788280677956350901082838474705227642420261641783722891948710833898248566893322144435457967452449965772543077421407816225704952270697016152452032506898311260979594550143344971416786595888053149375287120733\", \"1072184299258468249004114536023934869518152618369895613271618698908405514630154819453979477077738526673716264830106745031385951736108376866253955319711026042389282009348594845497252059906901748860111986811345742998968284077119165082435598381810306691078037018432766116865792677955520465319184311529667642995217214507658693259694586107847099911341219913576038605872218680562047/207882129535607118520818565811162643811811563516006836924341123976848022970024793004700710992938987476728640943834012473687892481059618823520721737479364352887178017866425027953255856440099446112508663603319745066750522936408781591578321031173620445865113295407603090322283539974563690157418931060565698315406021569491751612761888641141446406531645379264720684248398299136000\", \"158094023904374464057702010126993231151433474361820266584020400101533651587072432728050776506672527718975042616651177034635188178967462982926261516748842073587981953038445977514446838733557926696939591069712397947055261777416704028506441173540338327591514650398349069348381309688677335132100441905603664282735310299686268721634369502296867409514777359935022301425165750780988231639828675424239931533849896744198012747670272/30626384366513923671063955469537776291182594080083494737341604579575446319190916924682809546024369330706012653799783122328775875399363759308193432327358837772825609356553955350401725689682838701996446404559005896479618311357573203081153855961484398360670837599853294627153740224543175497655414585918231215639906924313779933211774291565425360415684556655021031131349317390382320286092667852173815259422737956767922154798375\", \"12216278924286401897470540169822542417611356797676160128176706721343511598951866107858729405615631246003458062949723290192242594609994613705183460814797527214549142043573863947658832694800184691222426521703728394203722420336773310908687071670107794543022567943478843065246011544888390757810534211554666736239506503613750756246364621509359804902243487113673014588325806249988332/2364584127734680580481708368927921125934330000162935118371174269642831409084634375654239735054363928748162229294829526339927907778510530444646754603322373712788147193691037688552857183116332292048731726305451516954679277320777955342295564000586923227775208580772868590742136150431152495718132142742153643081187691849828217592954519485869135930755646768375299870967864990234375\", \"578939195017447864385837341975558679292903716580114421030538728778491606282153588930983966100514147976321305616196463174070345884292672842497715966933722088536619333912687108737657068701352918582656105418491672377271304970407730786932913490869797471081081431072836814581099271832696990064828717287258860166842791984158634684078346453202928137987930328826212011774670396356151265781053547412633310327737900786639842674288716416/111966291649651600701875186827360807558960817589719096407887999108024557254221008849510152469119211567152616745769256123968832250104006560061907741567034087109512483357851919402017950812795426393415409198268246337542639470834168040295134130657073201020340432236723824670803498949071870597039309004562024033656488150406105175401372709011082725359382691270659245312133919518760328422827067578306005644825927050994860723405473375\", \"8041514821545833865350873212853873042112343327573364523948780030849543753072688526717886590013028227714585965095216381829914996539132359247488639692828639170075726301411777307168737667077730792892326979446426349813642680537699905651125068091362135055902152994216233622733424128982011248923051410141033146604688083721413402395290842738021365861670415833356403364696759583009635/1553937833499559104910551811592138833189892464446761247731330672284191313590708439680460540329836344767557599746234213006493842842879398684745864919973051635127080738612248150108793397855113122368507483429209127035263504194847798809612278864438287815470711036548695032421148125849669175729331459149833945183228413961985381338162155596008680906676498435954178226973272371625984\", \"12059659399309169167301353842123191409306995788633965680414620302285606896146667751472818541537183787935352700725982053536032930866708413010971856856768384974849695774437178790890015242323873769697407411558706626105140596160049735605389301414460825674631122462760014451298494875244754354054447697502521388381253293175367558014453865905104467382184997528879171136492277222127399012368677604910497789360212571238146627048080568400384/2328494054002703067219004484782931471919751585969487160602269605916676223315055450845942763690581877771159615428854802721943114463834992106300185328876910271612375509166975628540839858771078495267566008071532876816826751069408153323840515037497664871689085370699991860738368371510578076683395101062439493831773194498579620513073693022191702398601471237166387045790480861932005012807234071429628725981935147069738988682858417182625\", \"683009426705008850682549700382901603742691705123356866338951397347368059105140826655486518416578697931244347554322654428162554903861783227680935341690740579867651545205562690172425016836559678937794312287639193745517811234257062356826622207475918293015140472942579713388671782202262396642735640315948612572908444501108579457520714632371056288874351015666995549139003946314085696/131769214246522869780429817236150406548549044658474416909806179734873399109656411633488099249198882165279745627038984487365589625562901914030850178330133080409420340227179447548044572594184601425691821617928130423410997853384425373999967759499571890326740433081063424903098252502791477854302204200941376983295622430177445507316706609802292121282957519571162158620971952084486375\", \"1418116259749091420309271913909337143756589314597557128553117870573928055109322864794169592355058370891251425125187770724828108988587888087023982451205475980371440423992838481547236638456717520835668859093413956339261802305597694403381021863258753441889536361061407579332570493634254542013337999844407181346815549594836374497512447969751514466481466717590255369810506813543577735080228718660747940956248427356785784199073569408/273368882980516556922532339653303822104510203916024760371844491705599093435133738774975538364241630079468712981056336655766117378160822393876348755370711942273876284944422610974149712212944211513462921649872232656449940987552227525504529710373144228818606127541937831103642415534318303187393593236209298242574677293352798419428712873685798636474667204083938875672934235816396371477146089168375198141802684403955936431884765625\", \"546411077581845999248238069684194831621691193366466972898628141511422317954477211865167402284211971296286346492698354214043840080181702652132835681239302798339667835439189275457116051279366194551632712819028177402221815140045210690908631767786711675029194359998826252332434573121740830827417293557234891406021102083555472155479148332697839972702631641910213821827820374586459319/105246945889799140338072754365901705544530661781295362563214285953881890233987516230568663143342952799036341701952267011236663118111226623815975847494372076420199418712941018288738590264475520229651370015377608638075866459684692488079223686296541020897904588347083045723167762682959422858996673894180805702299907478685374065593161226849447131100462022089783265346597553176576000\", \"2398330640958841474772606439916070050977544535580605737383995160447105736276950196885906408317628083110923322157113892928963237845914017845444295040924101784423382681801754191301860383927129006953354739240926643562987838836997453985855576402628166875869041032631651591871962852884189548538272285387092843044669499688035134181859376665409767886188304314888753894905317929877238322615838524354191263502347881033855441181420399360/461588070868590122892265681879734295007029130965626060552783760068897000195207878227714842617470320231527222074701444349530952699708435668339712860464533455345665068841333232359698449088497137068713309811942968433868609329301082001752617420002377892756821532220676085014874112083615054550278903960627185675459015343606391094523511117705747842645927349130302549554534056269331809016770715819934970200483161548527932617036185253\", \"6041015879424725383006424536130409209607854044642113747266098198777011981328765528361630516108680392500990580908509403483891763219659726090675140672989657743882183951954294745396417829943469201306594018454995862321821016087416840247422350906412007336103086620396467456181771583200365740253389107968122850063607085957109965406634738740996318415514360956028575560979203447735121436/1161752799109428422288020947061281540989708937450568100764830251908850596717606701047413407636907934320789870175907792017513896999208892282137299070761467096211814586909598705615312819596495636017728313513520193786266452836805291464826226833593878504804389728477191170027729963773716267868284479768397603444919008915279522376004326398403851684761808785381609370767169521034383625\", \"13240077436443988749179508462267267187169441948722358165090554769250505713747934643200804819418670147225695324432684266924694524337920816452346599774452681831320005286326986675907899608537972384924882996757503264622991355949039882526389342174307168805166215838138277557052303430492669193939212362638263582899713198716541723383138016564027766560215944409353427176135895982596327685665844815618402881202645610620284792793420780517248/2544223084468158291883698813309541801455311468982232546872485444308211415529998472787377800559884210837213042932180479090277285630234238711851480232520137856848809986631784843528381778520727465146661792797924458540957133423665746229799675650290296217658444899605236550972043549278128087645211909479009099766619355677984218929672461506691980442071860591767266913041147587815452007726513853820116629482732060593116624596368806566625\", \"1953999166296955830935495158735359200362904181792947794529339487489730042568305997099959302322956898299616194932283060554261566410988618045107398092345476532371402134206635235570281738377188438407703089325315446371127042537576093536896282955524842632708645655481028161471313608974238110718242273935956977555610147714316158486553633871312187084618154014921190595222799283957140353/375191165084882521037046014569185165885459082629136124177286500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\"];\r\n            if(CACHE[x]) {\r\n                return Frac.quick.apply(null, CACHE[x].split('/'));\r\n            }\r\n            x = new Frac(x);\r\n            var n = 80;\r\n            var retval = new Frac(0);\r\n            var a = x.subtract(new Frac(1));\r\n            var b = x.add(new Frac(1));\r\n            for(var i = 0; i < n; i++) {\r\n                var t = new Frac(2 * i + 1);\r\n                var k = Math2.bigpow(a.divide(b), t);\r\n                var r = t.clone().invert().multiply(k);\r\n                retval = retval.add(r);\r\n\r\n            }\r\n            return retval.multiply(new Frac(2));\r\n        },\r\n        //the factorial function but using the big library instead\r\n        factorial: function (x) {\r\n            var is_int = x % 1 === 0;\r\n\r\n            /*factorial for negative integers is complex infinity according to Wolfram Alpha*/\r\n            if(is_int && x < 0)\r\n                return NaN;\r\n\r\n            if(!is_int)\r\n                return Math2.gamma(x + 1);\r\n\r\n            var retval = 1;\r\n            for(var i = 2; i <= x; i++)\r\n                retval = retval * i;\r\n            return retval;\r\n        },\r\n        //double factorial\r\n        //http://mathworld.wolfram.com/DoubleFactorial.html\r\n        dfactorial: function (x) {\r\n            if(isInt(x)) {\r\n                var even = x % 2 === 0;\r\n                /* If x = even then n = x/2 else n = (x-1)/2*/\r\n                var n = even ? x / 2 : (x + 1) / 2;\r\n                /*the return value*/\r\n                var r = new Frac(1);\r\n                /*start the loop*/\r\n                if(even)\r\n                    for(var i = 1; i <= n; i++)\r\n                        r = r.multiply(new Frac(2).multiply(new Frac(i)));\r\n                else\r\n                    for(var i = 1; i <= n; i++)\r\n                        r = r.multiply(new Frac(2).multiply(new Frac(i)).subtract(new Frac(1)));\r\n            }\r\n            else {\r\n                /*Not yet extended to bigNum*/\r\n                r = Math.pow(2, (1 + 2 * x - Math.cos(Math.PI * x)) / 4) * Math.pow(Math.PI, (Math.cos(Math.PI * x) - 1) / 4) * Math2.gamma(1 + x / 2);\r\n            }\r\n\r\n            /*done*/\r\n            return r;\r\n        },\r\n        GCD: function () {\r\n            var args = arrayUnique([].slice.call(arguments)\r\n                    .map(function (x) {\r\n                        return Math.abs(x);\r\n                    })).sort(),\r\n                    a = Math.abs(args.shift()),\r\n                    n = args.length;\r\n\r\n            while(n-- > 0) {\r\n                var b = Math.abs(args.shift());\r\n                while(true) {\r\n                    a %= b;\r\n                    if(a === 0) {\r\n                        a = b;\r\n                        break;\r\n                    }\r\n                    b %= a;\r\n                    if(b === 0)\r\n                        break;\r\n                    ;\r\n                }\r\n            }\r\n            return a;\r\n        },\r\n        QGCD: function () {\r\n            var args = [].slice.call(arguments);\r\n            var a = args[0];\r\n            for(var i = 1; i < args.length; i++) {\r\n                var b = args[i];\r\n                var sign = a.isNegative() && b.isNegative() ? -1 : 1;\r\n                a = b.gcd(a);\r\n                if(sign < 0)\r\n                    a.negate();\r\n            }\r\n            return a;\r\n        },\r\n        LCM: function (a, b) {\r\n            return (a * b) / Math2.GCD(a, b);\r\n        },\r\n        //pow but with the handling of negative numbers\r\n        //http://stackoverflow.com/questions/12810765/calculating-cubic-root-for-negative-number\r\n        pow: function (b, e) {\r\n            if(b < 0) {\r\n                if(Math.abs(e) < 1) {\r\n                    /*nth root of a negative number is imaginary when n is even*/\r\n                    if(1 / e % 2 === 0)\r\n                        return NaN;\r\n                    return -Math.pow(Math.abs(b), e);\r\n                }\r\n            }\r\n            return Math.pow(b, e);\r\n        },\r\n        factor: function (n) {\r\n            n = Number(n);\r\n            var sign = Math.sign(n); /*store the sign*/\r\n            /*move the number to absolute value*/\r\n            n = Math.abs(n);\r\n            var ifactors = Math2.ifactor(n);\r\n            var factors = new Symbol();\r\n            factors.symbols = {};\r\n            factors.group = CB;\r\n            for(var x in ifactors) {\r\n                var factor = new Symbol(1);\r\n                factor.group = P; /*cheat a little*/\r\n                factor.value = x;\r\n                factor.power = new Symbol(ifactors[x]);\r\n                factors.symbols[x] = factor;\r\n            }\r\n            factors.updateHash();\r\n\r\n            if(n === 1) {\r\n                factors = new Symbol(n);\r\n            }\r\n\r\n            /*put back the sign*/\r\n            if(sign < 0)\r\n                factors.negate();\r\n\r\n            return factors;\r\n        },\r\n        /**\r\n         * Uses trial division\r\n         * @param {Integer} n - the number being factored\r\n         * @param {object} factors -  the factors object\r\n         * @returns {object}\r\n         */\r\n        sfactor: function (n, factors) {\r\n            factors = factors || {};\r\n            var r = Math.floor(Math.sqrt(n));\r\n            var lcprime = PRIMES[PRIMES.length - 1];\r\n            /*a one-time cost... Hopefully ... And don't bother for more than a million*/\r\n            /*takes too long*/\r\n            if(r > lcprime && n < 1e6)\r\n                generatePrimes(r);\r\n            var l = PRIMES.length;\r\n            for(var i = 0; i < l; i++) {\r\n                var prime = PRIMES[i];\r\n                /*trial division*/\r\n                while(n % prime === 0) {\r\n                    n = n / prime;\r\n                    factors[prime] = (factors[prime] || 0) + 1;\r\n                }\r\n            }\r\n            if(n > 1)\r\n                factors[n] = 1;\r\n            return factors;\r\n        },\r\n        /**\r\n         * Pollard's rho\r\n         * @param {Integer} n\r\n         * @returns {object}\r\n         */\r\n        ifactor: function (n) {\r\n            var input = new bigInt(n);\r\n\r\n            n = String(n);\r\n\r\n            if(n === '0')\r\n                return {'0': 1};\r\n            n = new bigInt(n); /*convert to bigInt for safety*/\r\n            var sign = n.sign ? -1 : 1;\r\n            n = n.abs();\r\n            var factors = {}; /*factor object being returned.*/\r\n            if(n.lt('65536')) { /*less than 2^16 just use trial division*/\r\n                factors = Math2.sfactor(n, factors);\r\n            }\r\n            else {\r\n                var add = function (e) {\r\n                    if(!e.isPrime()) {\r\n                        factors = Math2.sfactor(e, factors);\r\n                    }\r\n                    else\r\n                        factors[e] = (factors[e] || 0) + 1;\r\n                };\r\n\r\n                try {\r\n                    //set a safety\r\n                    var max = 1e3;\r\n                    var safety = 0;\r\n\r\n                    while(!n.abs().equals(1)) {\r\n                        if(n.isPrime()) {\r\n                            add(n);\r\n                            break;\r\n                        }\r\n                        else {\r\n                            function rho(c) {\r\n                                var xf = new bigInt(c),\r\n                                        cz = 2,\r\n                                        x = new bigInt(c),\r\n                                        factor = new bigInt(1);\r\n\r\n                                while(factor.equals(1)) {\r\n                                    for(var i = 0; i <= cz && factor.equals(1); i++) {\r\n                                        //trigger the safety\r\n                                        if(safety++ > max)\r\n                                            throw new Error('stopping');\r\n\r\n                                        x = x.pow(2).add(1).mod(n);\r\n                                        factor = bigInt.gcd(x.minus(xf).abs(), n);\r\n                                    }\r\n\r\n                                    cz = cz * 2;\r\n                                    xf = x;\r\n                                }\r\n                                if(factor.equals(n)) {\r\n                                    return rho(c + 1);\r\n                                }\r\n                                return factor;\r\n                            }\r\n                            var factor = rho(2);\r\n                            add(factor);\r\n                            /*divide out the factor*/\r\n                            n = n.divide(factor);\r\n                        }\r\n                    }\r\n                }\r\n                catch(e) {\r\n                    //reset factors\r\n                    factors = {};\r\n                    add(input);\r\n                }\r\n\r\n            }\r\n\r\n            /*put the sign back*/\r\n            if(sign === -1) {\r\n                var sm = arrayMin(keys(factors)); /*/get the smallest number*/\r\n                factors['-' + sm] = factors[sm];\r\n                delete factors[sm];\r\n            }\r\n\r\n            return factors;\r\n        },\r\n        //factors a number into rectangular box. If sides are primes that this will be\r\n        //their prime factors. e.g. 21 -> (7)(3), 133 -> (7)(19)\r\n        boxfactor: function (n, max) {\r\n            max = max || 200; //stop after this number of iterations\r\n            var c, r,\r\n                    d = Math.floor((5 / 12) * n), //the divisor\r\n                    i = 0, //number of iterations\r\n                    safety = false;\r\n            while(true) {\r\n                c = Math.floor(n / d);\r\n                r = n % d;\r\n                if(r === 0)\r\n                    break; //we're done\r\n                if(safety)\r\n                    return [n, 1];\r\n                d = Math.max(r, d - r);\r\n                i++;\r\n                safety = i > max;\r\n            }\r\n            return [c, d, i];\r\n        },\r\n        fib: function (n) {\r\n            var sign = Math.sign(n);\r\n            n = Math.abs(n);\r\n            sign = even(n) ? sign : Math.abs(sign);\r\n            var a = 0, b = 1, f = 1;\r\n            for(var i = 2; i <= n; i++) {\r\n                f = a + b;\r\n                a = b;\r\n                b = f;\r\n            }\r\n            return f * sign;\r\n        },\r\n        mod: function (x, y) {\r\n            return x % y;\r\n        },\r\n        //http://mathworld.wolfram.com/IntegerPart.html\r\n        integer_part: function (x) {\r\n            var sign = Math.sign(x);\r\n            return sign * Math.floor(Math.abs(x));\r\n        },\r\n        simpson: function (f, a, b, step) {\r\n            var get_value = function (f, x, side) {\r\n                var v = f(x);\r\n                var d = 0.000000000001;\r\n                if(isNaN(v)) {\r\n                    v = f(side === 1 ? x + d : x - d);\r\n                }\r\n                return v;\r\n            };\r\n\r\n            step = step || 0.0001;\r\n            //calculate the number of intervals\r\n            var n = Math.abs(Math.floor((b - a) / step));\r\n            //simpson's rule requires an even number of intervals. If it's not then add 1\r\n            if(n % 2 !== 0)\r\n                n++;\r\n            //get the interval size\r\n            var dx = (b - a) / n;\r\n            //get x0\r\n            var retval = get_value(f, a, 1);\r\n\r\n            //get the middle part 4x1+2x2+4x3 ...\r\n            //but first set a flag to see if it's even or odd.\r\n            //The first one is odd so we start there\r\n            var even = false;\r\n            //get x1\r\n            var xi = a + dx;\r\n            //the coefficient\r\n            var c, k;\r\n            //https://en.wikipedia.org/wiki/Simpson%27s_rule\r\n            for(var i = 1; i < n; i++) {\r\n                c = even ? 2 : 4;\r\n                k = c * get_value(f, xi, 1);\r\n                retval += k;\r\n                //flip the even flag\r\n                even = !even;\r\n                //increment xi\r\n                xi += dx;\r\n            }\r\n\r\n            //add xn\r\n            return (retval + get_value(f, xi, 2)) * (dx / 3);\r\n\r\n        },\r\n        /**\r\n         * https://github.com/scijs/integrate-adaptive-simpson\r\n         * @param {Function} f - the function being integrated\r\n         * @param {Number} a - lower bound\r\n         * @param {Number} b - upper bound\r\n         * @param {Number} tol - step width\r\n         * @param {Number} maxdepth\r\n         * @returns {Number}\r\n         */\r\n        num_integrate: function (f, a, b, tol, maxdepth) {\r\n            if(maxdepth < 0)\r\n                throw new Error('max depth cannot be negative');\r\n\r\n            /* This algorithm adapted from pseudocode in:*/\r\n            /* http://www.math.utk.edu/~ccollins/refs/Handouts/rich.pdf*/\r\n            function adsimp(f, a, b, fa, fm, fb, V0, tol, maxdepth, depth, state) {\r\n                if(state.nanEncountered) {\r\n                    return NaN;\r\n                }\r\n                var h, f1, f2, sl, sr, s2, m, V1, V2, err;\r\n                h = b - a;\r\n                f1 = f(a + h * 0.25);\r\n                f2 = f(b - h * 0.25);\r\n                /* Simple check for NaN:*/\r\n                if(isNaN(f1)) {\r\n                    state.nanEncountered = true;\r\n                    return;\r\n                }\r\n                /* Simple check for NaN:*/\r\n                if(isNaN(f2)) {\r\n                    state.nanEncountered = true;\r\n                    return;\r\n                }\r\n\r\n                sl = h * (fa + 4 * f1 + fm) / 12;\r\n                sr = h * (fm + 4 * f2 + fb) / 12;\r\n                s2 = sl + sr;\r\n                err = (s2 - V0) / 15;\r\n\r\n                if(state.maxDepthCount > 1000 * maxdepth) {\r\n                    return;\r\n                }\r\n\r\n\r\n                if(depth > maxdepth) {\r\n                    state.maxDepthCount++;\r\n                    return s2 + err;\r\n                }\r\n                else if(Math.abs(err) < tol) {\r\n                    return s2 + err;\r\n                }\r\n                else {\r\n                    m = a + h * 0.5;\r\n                    V1 = adsimp(f, a, m, fa, f1, fm, sl, tol * 0.5, maxdepth, depth + 1, state);\r\n                    if(isNaN(V1)) {\r\n                        state.nanEncountered = true;\r\n                        return NaN;\r\n                    }\r\n                    V2 = adsimp(f, m, b, fm, f2, fb, sr, tol * 0.5, maxdepth, depth + 1, state);\r\n\r\n                    if(isNaN(V2)) {\r\n                        state.nanEncountered = true;\r\n                        return NaN;\r\n                    }\r\n\r\n                    return V1 + V2;\r\n                }\r\n            }\r\n\r\n            function integrate(f, a, b, tol, maxdepth) {\r\n                var state = {\r\n                    maxDepthCount: 0,\r\n                    nanEncountered: false\r\n                };\r\n\r\n                if(tol === undefined) {\r\n                    tol = 1e-9;\r\n                }\r\n                if(maxdepth === undefined) {\r\n                    /*Issue #458 - This was lowered because of performance issues. */\r\n                    /*This was suspected from before but is now confirmed with this issue*/\r\n                    maxdepth = 45;\r\n                }\r\n\r\n                var fa = f(a);\r\n                var fm = f(0.5 * (a + b));\r\n                var fb = f(b);\r\n\r\n                var V0 = (fa + 4 * fm + fb) * (b - a) / 6;\r\n\r\n                var result = adsimp(f, a, b, fa, fm, fb, V0, tol, maxdepth, 1, state);\r\n\r\n                if(state.maxDepthCount > 0) {\r\n                    warn('integrate-adaptive-simpson: Warning: maximum recursion depth (' + maxdepth + ') reached ' + state.maxDepthCount + ' times');\r\n                }\r\n\r\n                if(state.nanEncountered) {\r\n                    throw new Error('Function does not converge over interval!');\r\n                }\r\n\r\n                return result;\r\n            }\r\n            var retval;\r\n\r\n            try {\r\n                retval = integrate(f, a, b, tol, maxdepth);\r\n            }\r\n            catch(e) {\r\n                /*fallback to non-adaptive*/\r\n                return Math2.simpson(f, a, b);\r\n            }\r\n            return nround(retval, 12);\r\n        },\r\n        //https://en.wikipedia.org/wiki/Trigonometric_integral\r\n        //CosineIntegral\r\n        Ci: function (x) {\r\n            var n = 20,\r\n                    /*roughly Euler–Mascheroni*/\r\n                    g = 0.5772156649015329,\r\n                    sum = 0;\r\n            for(var i = 1; i < n; i++) {\r\n                /*cache 2n*/\r\n                var n2 = 2 * i;\r\n                sum += (Math.pow(-1, i) * Math.pow(x, n2)) / (n2 * Math2.factorial(n2));\r\n            }\r\n            return Math.log(x) + g + sum;\r\n        },\r\n        /*SineIntegral*/\r\n        Si: function (x) {\r\n            var n = 20,\r\n                    sum = 0;\r\n            for(var i = 0; i < n; i++) {\r\n                var n2 = 2 * i;\r\n                sum += (Math.pow(-1, i) * Math.pow(x, n2 + 1)) / ((n2 + 1) * Math2.factorial(n2 + 1));\r\n            }\r\n            return sum;\r\n        },\r\n        /*ExponentialIntegral*/\r\n        Ei: function (x) {\r\n            if(Number(x) === 0)\r\n                return -Infinity;\r\n            var n = 30,\r\n                    g = 0.5772156649015328606, /*roughly Euler–Mascheroni*/\r\n                    sum = 0;\r\n            for(var i = 1; i < n; i++) {\r\n                sum += Math.pow(x, i) / (i * Math2.factorial(i));\r\n            }\r\n            return g + Math.abs(Math.log(x)) + sum;\r\n        },\r\n        /*Hyperbolic Sine Integral*/\r\n        /*http://mathworld.wolfram.com/Shi.html*/\r\n        Shi: function (x) {\r\n            var n = 30,\r\n                    sum = 0,\r\n                    k, t;\r\n            for(var i = 0; i < n; i++) {\r\n                k = 2 * i;\r\n                t = k + 1;\r\n                sum += Math.pow(x, t) / (t * t * Math2.factorial(k));\r\n            }\r\n            return sum;\r\n        },\r\n        /*the cosine integral function*/\r\n        Chi: function (x) {\r\n            var dx, g, f;\r\n            dx = 0.001;\r\n            g = 0.5772156649015328606;\r\n            f = function (t) {\r\n                return (Math.cosh(t) - 1) / t;\r\n            };\r\n            return Math.log(x) + g + Math2.num_integrate(f, 0.002, x, dx);\r\n        },\r\n        /*the log integral*/\r\n        Li: function (x) {\r\n            return Math2.Ei(Math2.bigLog(x));\r\n        },\r\n        /*the gamma incomplete function*/\r\n        gamma_incomplete: function (n, x) {\r\n            var t = n - 1,\r\n                    sum = 0,\r\n                    x = x || 0;\r\n            for(var i = 0; i < t; i++) {\r\n                sum += Math.pow(x, i) / Math2.factorial(i);\r\n            }\r\n            return Math2.factorial(t) * Math.exp(-x) * sum;\r\n        },\r\n        /*\r\n         * Heaviside step function - Moved from Special.js (originally contributed by Brosnan Yuen)\r\n         * Specification : http://mathworld.wolfram.com/HeavisideStepFunction.html\r\n         * if x > 0 then 1\r\n         * if x == 0 then 1/2\r\n         * if x < 0 then 0\r\n         */\r\n        step: function (x) {\r\n            if(x > 0)\r\n                return 1;\r\n            if(x < 0)\r\n                return 0;\r\n            return 0.5;\r\n        },\r\n        /*\r\n         * Rectangle function - Moved from Special.js (originally contributed by Brosnan Yuen)\r\n         * Specification : http://mathworld.wolfram.com/RectangleFunction.html\r\n         * if |x| > 1/2 then 0\r\n         * if |x| == 1/2 then 1/2\r\n         * if |x| < 1/2 then 1\r\n         */\r\n        rect: function (x) {\r\n            var x = Math.abs(x);\r\n            if(x === 0.5)\r\n                return x;\r\n            if(x > 0.5)\r\n                return 0;\r\n            return 1;\r\n        },\r\n        /*\r\n         * Sinc function - Moved from Special.js (originally contributed by Brosnan Yuen)\r\n         * Specification : http://mathworld.wolfram.com/SincFunction.html\r\n         * if x == 0 then 1\r\n         * otherwise sin(x)/x\r\n         */\r\n        sinc: function (x) {\r\n            if(x.equals(0))\r\n                return 1;\r\n            return Math.sin(x) / x;\r\n        },\r\n        /*\r\n         * Triangle function - Moved from Special.js (originally contributed by Brosnan Yuen)\r\n         * Specification : http://mathworld.wolfram.com/TriangleFunction.html\r\n         * if |x| >= 1 then 0\r\n         * if |x| < then 1-|x|\r\n         */\r\n        tri: function (x) {\r\n            x = Math.abs(x);\r\n            if(x >= 1)\r\n                return 0;\r\n            return 1 - x;\r\n        },\r\n        //https://en.wikipedia.org/wiki/Nth_root_algorithm\r\n        nthroot: function (A, n) {\r\n            /*make sure the input is of type Frac*/\r\n            if(!(A instanceof Frac))\r\n                A = new Frac(A.toString());\r\n            if(!(n instanceof Frac))\r\n                n = new Frac(n.toString());\r\n            if(n.equals(1))\r\n                return A;\r\n            /*begin algorithm*/\r\n            var xk = A.divide(new Frac(2)); /*x0*/\r\n            var e = new Frac(1e-15);\r\n            var dk, dk0, d0;\r\n            var a = n.clone().invert(),\r\n                    b = n.subtract(new Frac(1));\r\n            do {\r\n                var powb = Math2.bigpow(xk, b);\r\n                var dk_dec = a.multiply(A.divide(powb).subtract(xk)).toDecimal(25);\r\n                dk = Frac.create(dk_dec);\r\n                if(d0)\r\n                    break;\r\n\r\n                xk = xk.add(dk);\r\n                /*check to see if there's no change from the last xk*/\r\n                var dk_dec = dk.toDecimal();\r\n                d0 = dk0 ? dk0 === dk_dec : false;\r\n                dk0 = dk_dec;\r\n            }\r\n            while(dk.abs().gte(e))\r\n\r\n            return xk;\r\n        },\r\n        /*https://gist.github.com/jiggzson/0c5b33cbcd7b52b36132b1e96573285f*/\r\n        /*Just the square root function but big :)*/\r\n        sqrt: function (n) {\r\n            if(!(n instanceof Frac))\r\n                n = new Frac(n);\r\n            var xn, d, ld, same_delta;\r\n            var c = 0; /*counter*/\r\n            var done = false;\r\n            var delta = new Frac(1e-20);\r\n            xn = n.divide(new Frac(2));\r\n            var safety = 1000;\r\n            do {\r\n                /*break if we're not converging*/\r\n                if(c > safety)\r\n                    throw new Error('Unable to calculate square root for ' + n);\r\n                xn = xn.add(n.divide(xn)).divide(new Frac(2));\r\n                xn = new Frac(xn.decimal(30));\r\n                /*get the difference from the true square*/\r\n                d = n.subtract(xn.multiply(xn));\r\n                /*if the square of the calculated number is close enough to the number*/\r\n                /*we're getting the square root or the last delta was the same as the new delta*/\r\n                /*then we're done*/\r\n                same_delta = ld ? ld.equals(d) : false;\r\n                if(d.clone().abs().lessThan(delta) || same_delta)\r\n                    done = true;\r\n                /*store the calculated delta*/\r\n                ld = d;\r\n                c++; /*increase the counter*/\r\n            }\r\n            while(!done)\r\n\r\n            return xn;\r\n        }\r\n    };\r\n    //link the Math2 object to Settings.FUNCTION_MODULES\r\n    Settings.FUNCTION_MODULES.push(Math2);\r\n    reserveNames(Math2); //reserve the names in Math2\r\n\r\n\r\n//Polyfills ====================================================================\r\n    //https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/\r\n    Math.sign = Math.sign || function (x) {\r\n        x = +x; // convert to a number\r\n        if(x === 0 || isNaN(x)) {\r\n            return x;\r\n        }\r\n        return x > 0 ? 1 : -1;\r\n    };\r\n\r\n    Math.cosh = Math.cosh || function (x) {\r\n        var y = Math.exp(x);\r\n        return (y + 1 / y) / 2;\r\n    };\r\n\r\n    Math.sech = Math.sech || function (x) {\r\n        return 1 / Math.cosh(x);\r\n    };\r\n\r\n    Math.csch = Math.csch || function (x) {\r\n        return 1 / Math.sinh(x);\r\n    };\r\n\r\n    Math.coth = Math.coth || function (x) {\r\n        return 1 / Math.tanh(x);\r\n    };\r\n\r\n    Math.sinh = Math.sinh || function (x) {\r\n        var y = Math.exp(x);\r\n        return (y - 1 / y) / 2;\r\n    };\r\n\r\n    Math.tanh = Math.tanh || function (x) {\r\n        if(x === Infinity) {\r\n            return 1;\r\n        }\r\n        else if(x === -Infinity) {\r\n            return -1;\r\n        }\r\n        else {\r\n            var y = Math.exp(2 * x);\r\n            return (y - 1) / (y + 1);\r\n        }\r\n    };\r\n\r\n    Math.asinh = Math.asinh || function (x) {\r\n        if(x === -Infinity) {\r\n            return x;\r\n        }\r\n        else {\r\n            return Math.log(x + Math.sqrt(x * x + 1));\r\n        }\r\n    };\r\n\r\n    Math.acosh = Math.acosh || function (x) {\r\n        return Math.log(x + Math.sqrt(x * x - 1));\r\n    };\r\n\r\n    Math.atanh = Math.atanh || function (x) {\r\n        return Math.log((1 + x) / (1 - x)) / 2;\r\n    };\r\n\r\n    Math.log10 = Math.log10 || function (x) {\r\n        return Math.log(x) * Math.LOG10E;\r\n    };\r\n\r\n    Math.trunc = Math.trunc || function (x) {\r\n        if(isNaN(x)) {\r\n            return NaN;\r\n        }\r\n        if(x > 0) {\r\n            return Math.floor(x);\r\n        }\r\n        return Math.ceil(x);\r\n    };\r\n\r\n//Global functions =============================================================\r\n    /**\r\n     * This method will return a hash or a text representation of a Symbol, Matrix, or Vector.\r\n     * If all else fails it *assumes* the object has a toString method and will call that.\r\n     *\r\n     * @param {Object} obj\r\n     * @param {String} option get is as a hash\r\n     * @param {int} useGroup\r\n     * @returns {String}\r\n     */\r\n    function text(obj, option, useGroup, decp) { \r\n        var asHash = option === 'hash',\r\n                //whether to wrap numbers in brackets\r\n                wrapCondition = undefined,\r\n                opt = asHash ? undefined : option,\r\n                asDecimal = opt === 'decimal' || opt === 'decimals';\r\n\r\n        if(asDecimal && typeof decp === 'undefined')\r\n            decp = Settings.DEFAULT_DECP;\r\n\r\n        function toString(obj) {\r\n            switch(option)\r\n            {\r\n                case 'decimals':\r\n                case 'decimal':\r\n                    wrapCondition = wrapCondition || function (str) {\r\n                        return false;\r\n                    };\r\n                    return obj.valueOf();\r\n                case 'recurring':\r\n                    wrapCondition = wrapCondition || function (str) {\r\n                        return str.indexOf(\"'\") !== -1;\r\n                    };\r\n\r\n                    var str = obj.toString();\r\n                    //verify that the string is actually a fraction\r\n                    var frac = /^-?\\d+(?:\\/\\d+)?$/.exec(str);\r\n                    if(frac.length === 0)\r\n                        return str;\r\n\r\n                    //split the fraction into the numerator and denominator\r\n                    var parts = frac[0].split('/');\r\n                    var negative = false;\r\n                    var m = Number(parts[0]);\r\n                    if(m < 0) {\r\n                        m = -m;\r\n                        negative = true;\r\n                    }\r\n                    var n = Number(parts[1]);\r\n                    if(!n)\r\n                        n = 1;\r\n\r\n                    //https://softwareengineering.stackexchange.com/questions/192070/what-is-a-efficient-way-to-find-repeating-decimal#comment743574_192081\r\n                    var quotient = Math.floor(m / n), c = 10 * (m - quotient * n);\r\n                    quotient = quotient.toString() + \".\";\r\n                    while(c && c < n) {\r\n                        c *= 10;\r\n                        quotient += \"0\";\r\n                    }\r\n                    var digits = \"\", passed = [], i = 0;\r\n                    while(true) {\r\n                        if(typeof passed[c] !== 'undefined') {\r\n                            var prefix = digits.slice(0, passed[c]),\r\n                                    cycle = digits.slice(passed[c]),\r\n                                    result = quotient + prefix + \"'\" + cycle + \"'\";\r\n                            return (negative ? \"-\" : \"\") + result.replace(\"'0'\", \"\").replace(/\\.$/, \"\");\r\n                        }\r\n                        var q = Math.floor(c / n), r = c - q * n;\r\n                        passed[c] = i;\r\n                        digits += q.toString();\r\n                        i += 1;\r\n                        c = 10 * r;\r\n                    }\r\n                case 'mixed':\r\n                    wrapCondition = wrapCondition || function (str) {\r\n                        return str.indexOf('/') !== -1;\r\n                    };\r\n\r\n                    var str = obj.toString();\r\n                    //verify that the string is actually a fraction\r\n                    var frac = /^-?\\d+(?:\\/\\d+)?$/.exec(str);\r\n                    if(frac.length === 0)\r\n                        return str;\r\n\r\n                    //split the fraction into the numerator and denominator\r\n                    var parts = frac[0].split('/');\r\n                    var numer = new bigInt(parts[0]);\r\n                    var denom = new bigInt(parts[1]);\r\n                    if(denom.equals(0))\r\n                        denom = new bigInt(1);\r\n\r\n                    //return the quotient plus the remainder\r\n                    var divmod = numer.divmod(denom);\r\n                    var quotient = divmod.quotient;\r\n                    var remainder = divmod.remainder;\r\n                    var operator = parts[0][0] === '-' || quotient.equals(0) || remainder.equals(0) ? '' : '+';\r\n                    return (quotient.equals(0) ? '' : quotient.toString()) + operator + (remainder.equals(0) ? '' : (remainder.toString() + '/' + parts[1]));\r\n                case 'scientific':\r\n                    wrapCondition = wrapCondition || function (str) {\r\n                        return false;\r\n                    };\r\n                    return new Scientific(obj.valueOf()).toString(Settings.SCIENTIFIC_MAX_DECIMAL_PLACES);\r\n                default:\r\n                    wrapCondition = wrapCondition || function (str) {\r\n                        return str.indexOf('/') !== -1;\r\n                    };\r\n\r\n                    return obj.toString();\r\n            }\r\n        }\r\n\r\n        //if the object is a symbol\r\n        if(isSymbol(obj)) {\r\n            var multiplier = '',\r\n                    power = '',\r\n                    sign = '',\r\n                    group = obj.group || useGroup,\r\n                    value = obj.value;\r\n\r\n            //if the value is to be used as a hash then the power and multiplier need to be suppressed\r\n            if(!asHash) {\r\n                //use asDecimal to get the object back as a decimal\r\n                var om = toString(obj.multiplier);\r\n                if(om == '-1' && String(obj.multiplier) === '-1') {\r\n                    sign = '-';\r\n                    om = '1';\r\n                }\r\n                //only add the multiplier if it's not 1\r\n                if(om != '1')\r\n                    multiplier = om;\r\n                //use asDecimal to get the object back as a decimal\r\n                var p = obj.power ? toString(obj.power) : '';\r\n                //only add the multiplier\r\n                if(p != '1') {\r\n                    //is it a symbol\r\n                    if(isSymbol(p)) {\r\n                        power = text(p, opt);\r\n                    }\r\n                    else {\r\n                        power = p;\r\n                    }\r\n                }\r\n            }\r\n\r\n            switch(group) {\r\n                case N:\r\n                    multiplier = '';\r\n                    //round if requested\r\n                    var m = decp && asDecimal ? obj.multiplier.toDecimal(decp) : toString(obj.multiplier);\r\n                    //if it's numerical then all we need is the multiplier\r\n                    value = String(obj.multiplier) == '-1' ? '1' : m;\r\n                    power = '';\r\n                    break;\r\n                case PL:\r\n                    value = obj.collectSymbols().map(function (x) {\r\n                        var txt = text(x, opt, useGroup, decp);\r\n                        if(txt == '0')\r\n                            txt = '';\r\n                        return txt;\r\n                    }).sort().join('+').replace(/\\+\\-/g, '-');\r\n                    break;\r\n                case CP:\r\n                    value = obj.collectSymbols().map(function (x) {\r\n                        var txt = text(x, opt, useGroup, decp);\r\n                        if(txt == '0')\r\n                            txt = '';\r\n                        return txt;\r\n                    }).sort().join('+').replace(/\\+\\-/g, '-');\r\n                    break;\r\n                case CB:\r\n                    value = obj.collectSymbols(function (symbol) {\r\n                        var g = symbol.group;\r\n                        //both groups will already be in brackets if their power is greater than 1\r\n                        //so skip it.\r\n                        if((g === PL || g === CP) && (symbol.power.equals(1) && symbol.multiplier.equals(1))) {\r\n                            return inBrackets(text(symbol, opt));\r\n                        }\r\n                        return text(symbol, opt);\r\n                    }).join('*');\r\n                    break;\r\n                case EX:\r\n                    var pg = obj.previousGroup,\r\n                            pwg = obj.power.group;\r\n\r\n                    //PL are the exception. It's simpler to just collect and set the value\r\n                    if(pg === PL)\r\n                        value = obj.collectSymbols(text, opt).join('+').replace('+-', '-');\r\n                    if(!(pg === N || pg === S || pg === FN) && !asHash) {\r\n                        value = inBrackets(value);\r\n                    }\r\n\r\n                    if((pwg === CP || pwg === CB || pwg === PL || obj.power.multiplier.toString() != '1') && power) {\r\n                        power = inBrackets(power);\r\n                    }\r\n                    break;\r\n            }\r\n\r\n            if(group === FN) {\r\n                value = obj.fname + inBrackets(obj.args.map(function (symbol) {\r\n                    return text(symbol, opt);\r\n                }).join(','));\r\n            }\r\n            //TODO: Needs to be more efficient. Maybe.\r\n            if(group === FN && obj.fname in CUSTOM_OPERATORS) {\r\n                var a = text(obj.args[0]);\r\n                var b = text(obj.args[1]);\r\n                if(obj.args[0].isComposite()) //preserve the brackets\r\n                    a = inBrackets(a);\r\n                if(obj.args[1].isComposite()) //preserve the brackets\r\n                    b = inBrackets(b);\r\n                value = a + CUSTOM_OPERATORS[obj.fname] + b;\r\n            }\r\n            //wrap the power since / is less than ^\r\n            //TODO: introduce method call isSimple\r\n            if(power && group !== EX && wrapCondition(power)) {\r\n                power = inBrackets(power);\r\n            }\r\n\r\n            //the following groups are held together by plus or minus. They can be raised to a power or multiplied\r\n            //by a multiplier and have to be in brackets to preserve the order of precedence\r\n            if(((group === CP || group === PL) && (multiplier && multiplier != '1' || sign === '-'))\r\n                    || ((group === CB || group === CP || group === PL) && (power && power != '1'))\r\n                    || !asHash && group === P && value == -1\r\n                    || obj.fname === PARENTHESIS) {\r\n\r\n                value = inBrackets(value);\r\n            }\r\n\r\n            if(decp && (option === 'decimal' || option === 'decimals' && multiplier)) {\r\n                multiplier = nround(multiplier, decp);\r\n            }\r\n\r\n\r\n            //add the sign back\r\n            var c = sign + multiplier;\r\n\r\n            if(multiplier && wrapCondition(multiplier))\r\n                c = inBrackets(c);\r\n\r\n            if(power < 0)\r\n                power = inBrackets(power);\r\n\r\n            //add the multiplication back\r\n            if(multiplier)\r\n                c = c + '*';\r\n\r\n            if(power) {\r\n                if(value === 'e' && Settings.E_TO_EXP) {\r\n                    return c + 'exp' + inBrackets(power);\r\n                }\r\n                power = Settings.POWER_OPERATOR + power;\r\n            }\r\n\r\n            //this needs serious rethinking. Must fix\r\n            if(group === EX && value.charAt(0) === '-') {\r\n                value = inBrackets(value);\r\n            }\r\n\r\n            var cv = c + value;\r\n\r\n            if(obj.parens) {\r\n                cv = inBrackets(cv);\r\n            }\r\n\r\n            return cv + power;\r\n        }\r\n        else if(isVector(obj)) {\r\n            var l = obj.elements.length,\r\n                    c = [];\r\n            for(var i = 0; i < l; i++)\r\n                c.push(obj.elements[i].text(option));\r\n            return '[' + c.join(',') + ']';\r\n        }\r\n        else {\r\n            try {\r\n                return obj.toString();\r\n            }\r\n            catch(e) {\r\n                return '';\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Calculates prime factors for a number. It first checks if the number\r\n     * is a prime number. If it's not then it will calculate all the primes \r\n     * for that number.\r\n     * @param {int} num\r\n     * @returns {Array}\r\n     */\r\n\r\n    function primeFactors(num) {\r\n        if(isPrime(num)) {\r\n            return [num];\r\n        }\r\n\r\n        var l = num, i = 1, factors = [],\r\n                epsilon = 2.2204460492503130808472633361816E-16;\r\n        while(i < l) {\r\n            var quotient = num / i;\r\n            var whole = Math.floor(quotient);\r\n            var remainder = quotient - whole;\r\n\r\n            if(remainder <= epsilon && i > 1) {\r\n                // If the prime wasn't found but calculated then save it and\r\n                // add it as a factor.\r\n                if(isPrime(i)) {\r\n                    if(PRIMES.indexOf(i) === -1) {\r\n                        PRIMES.push(i);\r\n                    }\r\n                    factors.push(i);\r\n                }\r\n\r\n                // Check if the remainder is a prime\r\n                if(isPrime(whole)) {\r\n                    factors.push(whole);\r\n                    break;\r\n                }\r\n\r\n                l = whole;\r\n            }\r\n            i++;\r\n        }\r\n\r\n        return factors.sort(function (a, b) {\r\n            return a - b;\r\n        });\r\n    }\r\n    ;\r\n    primeFactors(314146179365)\r\n//Expression ===================================================================\r\n    /**\r\n     * This is what nerdamer returns. It's sort of a wrapper around the symbol class and\r\n     * provides the user with some useful functions. If you want to provide the user with extra\r\n     * library functions then add them to this class's prototype.\r\n     * @param {Symbol} symbol\r\n     * @returns {Expression} wraps around the Symbol class\r\n     */\r\n    function Expression(symbol) {\r\n        //we don't want arrays wrapped\r\n        this.symbol = symbol;\r\n    }\r\n    /**\r\n     * Returns stored expression at index. For first index use 1 not 0.\r\n     * @param {bool} asType\r\n     * @param {Integer} expression_number\r\n     */\r\n    Expression.getExpression = function (expression_number, asType) {\r\n        if(expression_number === 'last' || !expression_number)\r\n            expression_number = EXPRESSIONS.length;\r\n        if(expression_number === 'first')\r\n            expression_number = 1;\r\n        var index = expression_number - 1,\r\n                expression = EXPRESSIONS[index],\r\n                retval = expression ? new Expression(expression) : expression;\r\n        return retval;\r\n    };\r\n    Expression.prototype = {\r\n        /**\r\n         * Returns the text representation of the expression\r\n         * @param {String} opt - option of formatting numbers\r\n         * @param {Number} n The number of significant figures\r\n         * @returns {String}\r\n         */\r\n        text: function (opt, n) {\r\n            n = n || Settings.EXPRESSION_DECP;\r\n            opt = opt || 'decimals';\r\n            if(this.symbol.text_)\r\n                return this.symbol.text_(opt);\r\n\r\n            return text(this.symbol, opt, undefined, n);\r\n        },\r\n        /**\r\n         * Returns the latex representation of the expression\r\n         * @param {String} option - option for formatting numbers\r\n         * @returns {String}\r\n         */\r\n        latex: function (option) {\r\n            if(this.symbol.latex)\r\n                return this.symbol.latex(option);\r\n            return LaTeX.latex(this.symbol, option);\r\n        },\r\n        valueOf: function () {\r\n            return this.symbol.valueOf();\r\n        },\r\n\r\n        /**\r\n         * Evaluates the expression and tries to reduce it to a number if possible.\r\n         * If an argument is given in the form of %{integer} it will evaluate that expression.\r\n         * Other than that it will just use it's own text and reparse\r\n         * @returns {Expression}\r\n         */\r\n        evaluate: function () {\r\n\r\n            // Don't evaluate an empty vector\r\n            if(isVector(this.symbol) && this.symbol.dimensions() === 0) {\r\n                return this;\r\n            }\r\n\r\n            var first_arg = arguments[0], expression, idx = 1;\r\n\r\n            //Enable getting of expressions using the % so for example %1 should get the first expression\r\n            if(typeof first_arg === 'string') {\r\n                expression = (first_arg.charAt(0) === '%') ? Expression.getExpression(first_arg.substr(1)).text() : first_arg;\r\n            }\r\n            else if(first_arg instanceof Expression || isSymbol(first_arg)) {\r\n                expression = first_arg.text();\r\n            }\r\n            else {\r\n                expression = this.symbol.text();\r\n                idx--;\r\n            }\r\n\r\n            var subs = arguments[idx] || {};\r\n\r\n            var retval = new Expression(block('PARSE2NUMBER', function () {\r\n                return _.parse(expression, subs);\r\n            }, true));\r\n\r\n            return retval;\r\n        },\r\n        /**\r\n         * Converts a symbol to a JS function. Pass in an array of variables to use that order instead of\r\n         * the default alphabetical order\r\n         * @param vars {Array}\r\n         */\r\n        buildFunction: function (vars) {\r\n            return Build.build(this.symbol, vars);\r\n        },\r\n        /**\r\n         * Checks to see if the expression is just a plain old number\r\n         * @returns {boolean}\r\n         */\r\n        isNumber: function () {\r\n            return isNumericSymbol(this.symbol);\r\n        },\r\n        /**\r\n         * Checks to see if the expression is infinity\r\n         * @returns {boolean}\r\n         */\r\n        isInfinity: function () {\r\n            return Math.abs(this.symbol.multiplier) === Infinity;\r\n        },\r\n        /**\r\n         * Checks to see if the expression contains imaginary numbers\r\n         * @returns {boolean}\r\n         */\r\n        isImaginary: function () {\r\n            return evaluate(_.parse(this.symbol)).isImaginary();\r\n        },\r\n        /**\r\n         * Returns all the variables in the expression\r\n         * @returns {Array}\r\n         */\r\n        variables: function () {\r\n            return variables(this.symbol);\r\n        },\r\n\r\n        toString: function () {\r\n            try {\r\n                if(isArray(this.symbol))\r\n                    return '[' + this.symbol.toString() + ']';\r\n                return this.symbol.toString();\r\n            }\r\n            catch(e) {\r\n                return '';\r\n            }\r\n        },\r\n        //forces the symbol to be returned as a decimal\r\n        toDecimal: function (prec) {\r\n            Settings.precision = prec;\r\n            var dec = text(this.symbol, 'decimals');\r\n            Settings.precision = undefined;\r\n            return dec;\r\n        },\r\n        //checks to see if the expression is a fraction\r\n        isFraction: function () {\r\n            return isFraction(this.symbol);\r\n        },\r\n        //checks to see if the symbol is a multivariate polynomial\r\n        isPolynomial: function () {\r\n            return this.symbol.isPoly();\r\n        },\r\n        //performs a substitution\r\n        sub: function (symbol, for_symbol) {\r\n            return new Expression(this.symbol.sub(_.parse(symbol), _.parse(for_symbol)));\r\n        },\r\n        operation: function (otype, symbol) {\r\n            if(isExpression(symbol))\r\n                symbol = symbol.symbol;\r\n            else if(!isSymbol(symbol))\r\n                symbol = _.parse(symbol);\r\n            return new Expression(_[otype](this.symbol.clone(), symbol.clone()));\r\n        },\r\n        add: function (symbol) {\r\n            return this.operation('add', symbol);\r\n        },\r\n        subtract: function (symbol) {\r\n            return this.operation('subtract', symbol);\r\n        },\r\n        multiply: function (symbol) {\r\n            return this.operation('multiply', symbol);\r\n        },\r\n        divide: function (symbol) {\r\n            return this.operation('divide', symbol);\r\n        },\r\n        pow: function (symbol) {\r\n            return this.operation('pow', symbol);\r\n        },\r\n        expand: function () {\r\n            return new Expression(_.expand(this.symbol));\r\n        },\r\n        each: function (callback, i) {\r\n            if(this.symbol.each)\r\n                this.symbol.each(callback, i);\r\n            else if(isArray(this.symbol)) {\r\n                for(var i = 0; i < this.symbol.length; i++)\r\n                    callback.call(this.symbol, this.symbol[i], i);\r\n            }\r\n            else\r\n                callback.call(this.symbol);\r\n        },\r\n        eq: function (value) {\r\n            if(!isSymbol(value))\r\n                value = _.parse(value);\r\n            try {\r\n                var d = _.subtract(this.symbol.clone(), value);\r\n                return d.equals(0);\r\n            }\r\n            catch(e) {\r\n                return false;\r\n            }\r\n            ;\r\n        },\r\n        lt: function (value) {\r\n            if(!isSymbol(value))\r\n                value = _.parse(value);\r\n            try {\r\n                var d = evaluate(_.subtract(this.symbol.clone(), value));\r\n                return d.lessThan(0);\r\n            }\r\n            catch(e) {\r\n                return false;\r\n            }\r\n            ;\r\n        },\r\n        gt: function (value) {\r\n            if(!isSymbol(value))\r\n                value = _.parse(value);\r\n            try {\r\n                var d = evaluate(_.subtract(this.symbol.clone(), value));\r\n                return d.greaterThan(0);\r\n            }\r\n            catch(e) {\r\n                return false;\r\n            }\r\n        },\r\n        gte: function (value) {\r\n            return this.gt(value) || this.eq(value);\r\n        },\r\n        lte: function (value) {\r\n            return this.lt(value) || this.eq(value);\r\n        },\r\n\r\n        numerator: function () {\r\n            return new Expression(this.symbol.getNum());\r\n        },\r\n        denominator: function () {\r\n            return new Expression(this.symbol.getDenom());\r\n        },\r\n        hasFunction: function (f) {\r\n            return this.symbol.containsFunction(f);\r\n        },\r\n        contains: function (variable) {\r\n            return this.symbol.contains(variable);\r\n        }\r\n    };\r\n    //Aliases\r\n    Expression.prototype.toTeX = Expression.prototype.latex;\r\n\r\n    \r\n//Scientific ===================================================================\r\n    /*\r\n     * Javascript has the toExponential method but this allows you to work with string and therefore any number of digits of your choosing\r\n     * For example Scientific('464589498449496467924197545625247695464569568959124568489548454');\r\n     */\r\n\r\n    function Scientific(num) {\r\n        if(!(this instanceof Scientific))\r\n            return new Scientific(num);\r\n\r\n        num = String(typeof num === 'undefined' ? 0 : num); //convert to a string\r\n\r\n        //remove the sign\r\n        if(num.startsWith('-')) {\r\n            this.sign = -1;\r\n            //remove the sign\r\n            num = num.substr(1, num.length);\r\n        }\r\n        else {\r\n            this.sign = 1;\r\n        }\r\n\r\n        if(Scientific.isScientific(num)) {\r\n            this.fromScientific(num);\r\n        }\r\n        else {\r\n            this.convert(num);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    Scientific.prototype = {\r\n        fromScientific: function (num) {\r\n            var parts = String(num).toLowerCase().split('e');\r\n            this.coeff = parts[0];\r\n            this.exponent = parts[1];\r\n\r\n            return this;\r\n        },\r\n        convert: function (num) {\r\n            //get wholes and decimals\r\n            var parts = num.split('.');\r\n            //make zero go away\r\n            var w = parts[0] || '';\r\n            var d = parts[1] || '';\r\n            //convert zero to blank strings\r\n            w = Scientific.removeLeadingZeroes(w);\r\n            d = Scientific.removeTrailingZeroes(d);\r\n            //find the location of the decimal place which is right after the wholes\r\n            var dot_location = w.length;\r\n            //add them together so we can move the dot\r\n            var n = w + d;\r\n            //find the next number\r\n            var zeroes = Scientific.leadingZeroes(n).length;\r\n            //set the exponent\r\n            this.exponent = dot_location - (zeroes + 1);\r\n            //set the coeff but first remove leading zeroes\r\n            var coeff = Scientific.removeLeadingZeroes(n);\r\n            this.coeff = coeff.charAt(0) + '.' + (coeff.substr(1, coeff.length) || '0');\r\n\r\n            //the coeff decimal places\r\n            var dec = this.coeff.split('.')[1] || ''; //if it's undefined or zero it's going to blank\r\n\r\n            this.decp = dec === '0' ? 0 : dec.length;\r\n            //decimals\r\n            this.dec = d;\r\n            //wholes\r\n            this.wholes = w;\r\n\r\n            return this;\r\n        },\r\n        round: function (num) {\r\n            var n = this.copy();\r\n\r\n            num = Number(num); //cast to number for safety\r\n            //since we know it guaranteed to be in the format {digit}{optional dot}{optional digits}\r\n            //we can round based on this\r\n            if(num === 0)\r\n                n.coeff = n.coeff.charAt(0);\r\n            else {\r\n                //get up to n-1 digits\r\n                var rounded = this.coeff.substring(0, num + 1);\r\n                //get the next two\r\n                var next_two = this.coeff.substring(num + 1, num + 3);\r\n                //the extra digit\r\n                var ed = next_two.charAt(0);\r\n\r\n                if(next_two.charAt(1) > 4)\r\n                    ed++;\r\n\r\n                n.coeff = rounded + ed;\r\n            }\r\n\r\n            return n;\r\n        },\r\n        copy: function () {\r\n            var n = new Scientific(0);\r\n            n.coeff = this.coeff;\r\n            n.exponent = this.exponent;\r\n            n.sign = this.sign;\r\n            return n;\r\n        },\r\n        toString: function (n) {\r\n            var retval;\r\n\r\n            if(Settings.SCIENTIFIC_IGNORE_ZERO_EXPONENTS && this.exponent === 0 && this.decp < n) {\r\n                if(this.decp === 0)\r\n                    retval = this.wholes;\r\n                else\r\n                    retval = this.coeff;\r\n            }\r\n            else {\r\n                var coeff = typeof n === 'undefined' ? this.coeff : Scientific.round(this.coeff, Math.min(n, this.decp || 1));\r\n                retval = this.exponent === 0 ? coeff : coeff + 'e' + this.exponent;\r\n            }\r\n\r\n            return (this.sign === -1 ? '-' : '') + retval;\r\n        }\r\n    };\r\n\r\n    Scientific.isScientific = function (num) {\r\n        return /\\d+\\.?\\d*e[\\+\\-]*\\d+/i.test(num);\r\n    };\r\n    Scientific.leadingZeroes = function (num) {\r\n        var match = num.match(/^(0*).*$/);\r\n        return match ? match[1] : '';\r\n    };\r\n    Scientific.removeLeadingZeroes = function (num) {\r\n        var match = num.match(/^0*(.*)$/);\r\n        return match ? match[1] : '';\r\n    };\r\n\r\n    Scientific.removeTrailingZeroes = function (num) {\r\n        var match = num.match(/0*$/);\r\n        return match ? num.substring(0, num.length - match[0].length) : '';\r\n    };\r\n\r\n    Scientific.round = function (c, n) {\r\n        var coeff = nround(c, n);\r\n        var m = String(coeff).split('.').pop();\r\n        var d = n - m.length;\r\n        //if we're asking for more significant figures\r\n        if(d > 0) {\r\n            coeff = coeff + (new Array(d + 1).join(0));\r\n        }\r\n        return coeff;\r\n    };\r\n\r\n//Frac =========================================================================\r\n    function Frac(n) {\r\n        if(n instanceof Frac)\r\n            return n;\r\n        if(n === undefined)\r\n            return this;\r\n        try {\r\n            if(isInt(n)) {\r\n                try {\r\n                    this.num = bigInt(n);\r\n                    this.den = bigInt(1);\r\n                }\r\n                catch(e) {\r\n                    return Frac.simple(n);\r\n                }\r\n            }\r\n            else {\r\n                var frac = n instanceof bigDec ? Fraction.quickConversion(n) : Fraction.convert(n);\r\n                this.num = new bigInt(frac[0]);\r\n                this.den = new bigInt(frac[1]);\r\n            }\r\n        }\r\n        catch(e) {\r\n            return Frac.simple(n);\r\n        }\r\n\r\n    }\r\n    //safe to use with negative numbers or other types\r\n    Frac.create = function (n) {\r\n        if(n instanceof Frac)\r\n            return n;\r\n        n = n.toString();\r\n        var is_neg = n.charAt(0) === '-'; //check if it's negative\r\n        if(is_neg)\r\n            n = n.substr(1, n.length - 1); //remove the sign\r\n        var frac = new Frac(n);\r\n        //put the sign back\r\n        if(is_neg)\r\n            frac.negate();\r\n        return frac;\r\n    };\r\n    Frac.isFrac = function (o) {\r\n        return (o instanceof Frac);\r\n    };\r\n    Frac.quick = function (n, d) {\r\n        var frac = new Frac();\r\n        frac.num = new bigInt(n);\r\n        frac.den = new bigInt(d);\r\n        return frac;\r\n    };\r\n    Frac.simple = function (n) {\r\n        var nstr = String(scientificToDecimal(n)),\r\n                m_dc = nstr.split('.'),\r\n                num = m_dc.join(''),\r\n                den = 1,\r\n                l = (m_dc[1] || '').length;\r\n        for(var i = 0; i < l; i++)\r\n            den += '0';\r\n        var frac = Frac.quick(num, den);\r\n        return frac.simplify();\r\n    };\r\n    Frac.prototype = {\r\n        multiply: function (m) {\r\n            if(this.isOne()) {\r\n                return m.clone();\r\n            }\r\n            if(m.isOne()) {\r\n                return this.clone();\r\n            }\r\n\r\n            var c = this.clone();\r\n            c.num = c.num.multiply(m.num);\r\n            c.den = c.den.multiply(m.den);\r\n\r\n            return c.simplify();\r\n        },\r\n        divide: function (m) {\r\n            if(m.equals(0))\r\n                throw new DivisionByZero('Division by zero not allowed!');\r\n            return this.clone().multiply(m.clone().invert()).simplify();\r\n        },\r\n        subtract: function (m) {\r\n            return this.clone().add(m.clone().neg());\r\n        },\r\n        neg: function () {\r\n            this.num = this.num.multiply(-1);\r\n            return this;\r\n        },\r\n        add: function (m) {\r\n            var n1 = this.den, n2 = m.den, c = this.clone();\r\n            var a = c.num, b = m.num;\r\n            if(n1.equals(n2)) {\r\n                c.num = a.add(b);\r\n            }\r\n            else {\r\n                c.num = a.multiply(n2).add(b.multiply(n1));\r\n                c.den = n1.multiply(n2);\r\n            }\r\n\r\n            return c.simplify();\r\n        },\r\n        mod: function (m) {\r\n            var a = this.clone(),\r\n                    b = m.clone();\r\n            //make their denominators even and return the mod of their numerators\r\n            a.num = a.num.multiply(b.den);\r\n            a.den = a.den.multiply(b.den);\r\n            b.num = b.num.multiply(this.den);\r\n            b.den = b.den.multiply(this.den);\r\n            a.num = a.num.mod(b.num);\r\n            return a.simplify();\r\n        },\r\n        simplify: function () {\r\n            var gcd = bigInt.gcd(this.num, this.den);\r\n\r\n            this.num = this.num.divide(gcd);\r\n            this.den = this.den.divide(gcd);\r\n            return this;\r\n        },\r\n        clone: function () {\r\n            var m = new Frac();\r\n            m.num = new bigInt(this.num);\r\n            m.den = new bigInt(this.den);\r\n            return m;\r\n        },\r\n        decimal: function (prec) {\r\n            var sign = this.num.isNegative() ? '-' : '';\r\n            if(this.num.equals(this.den)) {\r\n                return '1';\r\n            }\r\n            //go plus one for rounding\r\n            prec = prec || Settings.PRECISION;\r\n            prec++;\r\n            var narr = [],\r\n                    n = this.num.abs(),\r\n                    d = this.den;\r\n            for(var i = 0; i < prec; i++) {\r\n                var w = n.divide(d), //divide out whole\r\n                        r = n.subtract(w.multiply(d)); //get remainder\r\n\r\n                narr.push(w);\r\n                if(r.equals(0))\r\n                    break;\r\n                n = r.times(10); //shift one dec place\r\n            }\r\n            var whole = narr.shift();\r\n            if(narr.length === 0) {\r\n                return sign + whole.toString();\r\n            }\r\n\r\n            if(i === prec) {\r\n                var lt = [];\r\n                //get the last two so we can round it\r\n                for(var i = 0; i < 2; i++)\r\n                    lt.unshift(narr.pop());\r\n                //put the last digit back by rounding the last two\r\n                narr.push(Math.round(lt.join('.')));\r\n            }\r\n\r\n            var dec = whole.toString() + '.' + narr.join('');\r\n            return sign + dec;\r\n        },\r\n        toDecimal: function (prec) { \r\n            prec = prec || Settings.PRECISION;\r\n            if(prec) {\r\n                return this.decimal(prec);\r\n            }\r\n            else {\r\n                return this.num / this.den;\r\n            }\r\n        },\r\n        qcompare: function (n) {\r\n            return [this.num.multiply(n.den), n.num.multiply(this.den)];\r\n        },\r\n        equals: function (n) {\r\n            if(!isNaN(n))\r\n                n = new Frac(n);\r\n            var q = this.qcompare(n);\r\n\r\n            return q[0].equals(q[1]);\r\n        },\r\n        absEquals: function (n) {\r\n            if(!isNaN(n))\r\n                n = new Frac(n);\r\n            var q = this.qcompare(n);\r\n\r\n            return q[0].abs().equals(q[1]);\r\n        },\r\n        //lazy check to be fixed. Sufficient for now but will cause future problems\r\n        greaterThan: function (n) {\r\n            if(!isNaN(n))\r\n                n = new Frac(n);\r\n            var q = this.qcompare(n);\r\n\r\n            return q[0].gt(q[1]);\r\n        },\r\n        gte: function (n) {\r\n            return this.greaterThan(n) || this.equals(n);\r\n        },\r\n        lte: function (n) {\r\n            return this.lessThan(n) || this.equals(n);\r\n        },\r\n        lessThan: function (n) {\r\n            if(!isNaN(n))\r\n                n = new Frac(n);\r\n            var q = this.qcompare(n);\r\n\r\n            return q[0].lt(q[1]);\r\n        },\r\n        isInteger: function () {\r\n            return this.den.equals(1);\r\n        },\r\n        negate: function () {\r\n            this.num = this.num.multiply(-1);\r\n            return this;\r\n        },\r\n        invert: function () {\r\n            var t = this.den;\r\n            //why invert 0/1? It'll become 1/0 and that's a lie.\r\n            if(!this.num.equals(0)) {\r\n                var isnegative = this.num.isNegative();\r\n                this.den = this.num.abs();\r\n                this.num = t;\r\n                if(isnegative)\r\n                    this.num = this.num.multiply(-1);\r\n            }\r\n\r\n            return this;\r\n        },\r\n        isOne: function () {\r\n            return this.num.equals(1) && this.den.equals(1);\r\n        },\r\n        sign: function () {\r\n            return this.num.isNegative() ? -1 : 1;\r\n        },\r\n        abs: function () {\r\n            this.num = this.num.abs();\r\n            return this;\r\n        },\r\n        gcd: function (f) {\r\n            return Frac.quick(bigInt.gcd(f.num, this.num), bigInt.lcm(f.den, this.den));\r\n        },\r\n        toString: function () {\r\n            return !this.den.equals(1) ? this.num.toString() + '/' + this.den.toString() : this.num.toString();\r\n        },\r\n        valueOf: function () {\r\n//            if(this.num == 24) throw new Error(999)\r\n            if(Settings.USE_BIG)\r\n                return new bigDec(this.num.toString()).div(new bigDec(this.den.toString()));\r\n            var retval = this.num / this.den;\r\n            return retval;\r\n        },\r\n        isNegative: function () {\r\n            return this.toDecimal() < 0;\r\n        }\r\n    };\r\n\r\n//Symbol =======================================================================\r\n    /**\r\n     * All symbols e.g. x, y, z, etc or functions are wrapped in this class. All symbols have a multiplier and a group.\r\n     * All symbols except for \"numbers (group N)\" have a power.\r\n     * @class Primary data type for the Parser.\r\n     * @param {String} obj\r\n     * @returns {Symbol}\r\n     */\r\n    function Symbol(obj) {\r\n        var isInfinity = obj === 'Infinity';\r\n        // This enables the class to be instantiated without the new operator\r\n        if(!(this instanceof Symbol)) {\r\n            return new Symbol(obj);\r\n        }\r\n        // Convert big numbers to a string\r\n        if(obj instanceof bigDec) {\r\n            obj = obj.toString();\r\n        }\r\n        //define numeric symbols\r\n        if(/^(\\-?\\+?\\d+)\\.?\\d*e?\\-?\\+?\\d*/i.test(obj) || obj instanceof bigDec) {\r\n            this.group = N;\r\n            this.value = CONST_HASH;\r\n            this.multiplier = new Frac(obj);\r\n        }\r\n        //define symbolic symbols\r\n        else {\r\n            this.group = S;\r\n            validateName(obj);\r\n            this.value = obj;\r\n            this.multiplier = new Frac(1);\r\n            this.imaginary = obj === Settings.IMAGINARY;\r\n            this.isInfinity = isInfinity;\r\n        }\r\n\r\n        //As of 6.0.0 we switched to infinite precision so all objects have a power\r\n        //Although this is still redundant in constants, it simplifies the logic in\r\n        //other parts so we'll keep it\r\n        this.power = new Frac(1);\r\n\r\n        // Added to silence the strict warning.\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns vanilla imaginary symbol\r\n     * @returns {Symbol}\r\n     */\r\n    Symbol.imaginary = function () {\r\n        var s = new Symbol(Settings.IMAGINARY);\r\n        s.imaginary = true;\r\n        return s;\r\n    };\r\n    /**\r\n     * Return nerdamer's representation of Infinity\r\n     * @param {int} negative -1 to return negative infinity\r\n     * @returns {Symbol}\r\n     */\r\n    Symbol.infinity = function (negative) {\r\n        var v = new Symbol('Infinity');\r\n        if(negative === -1)\r\n            v.negate();\r\n        return v;\r\n    };\r\n    Symbol.shell = function (group, value) {\r\n        var symbol = new Symbol(value);\r\n        symbol.group = group;\r\n        symbol.symbols = {};\r\n        symbol.length = 0;\r\n        return symbol;\r\n    };\r\n    //sqrt(x) -> x^(1/2)\r\n    Symbol.unwrapSQRT = function (symbol, all) {\r\n        var p = symbol.power;\r\n        if(symbol.fname === SQRT && (symbol.isLinear() || all)) {\r\n            var t = symbol.args[0].clone();\r\n            t.power = t.power.multiply(new Frac(1 / 2));\r\n            t.multiplier = t.multiplier.multiply(symbol.multiplier);\r\n            symbol = t;\r\n            if(all)\r\n                symbol.power = p.multiply(new Frac(1 / 2));\r\n        }\r\n\r\n        return symbol;\r\n    };\r\n    Symbol.hyp = function (a, b) {\r\n        a = a || new Symbol(0);\r\n        b = b || new Symbol(0);\r\n        return _.sqrt(_.add(_.pow(a.clone(), new Symbol(2)), _.pow(b.clone(), new Symbol(2))));\r\n    };\r\n    //converts to polar form array\r\n    Symbol.toPolarFormArray = function (symbol) {\r\n        var re, im, r, theta;\r\n        re = symbol.realpart();\r\n        im = symbol.imagpart();\r\n        r = Symbol.hyp(re, im);\r\n        theta = re.equals(0) ? _.parse('pi/2') : _.trig.atan(_.divide(im, re));\r\n        return [r, theta];\r\n    };\r\n    //removes parentheses\r\n    Symbol.unwrapPARENS = function (symbol) {\r\n        if(symbol.fname === '') {\r\n            var r = symbol.args[0];\r\n            r.power = r.power.multiply(symbol.power);\r\n            r.multiplier = r.multiplier.multiply(symbol.multiplier);\r\n            if(symbol.fname === '')\r\n                return Symbol.unwrapPARENS(r);\r\n            return r;\r\n        }\r\n        return symbol;\r\n    };\r\n    //quickly creates a Symbol\r\n    Symbol.create = function (value, power) {\r\n        power = power === undefined ? 1 : power;\r\n        return _.parse('(' + value + ')^(' + power + ')');\r\n    };\r\n    Symbol.prototype = {\r\n        /**\r\n         * Gets nth root accounting for rounding errors\r\n         * @param {Number} n\r\n         * @return {Number}\r\n         */\r\n        getNth: function (n) {\r\n            // First calculate the root\r\n            var root = evaluate(_.pow(_.parse(this.multiplier), _.parse(n).invert()));\r\n            // Round of any errors\r\n            var rounded = _.parse(nround(root));\r\n            // Reverse the root\r\n            var e = evaluate(_.pow(rounded, _.parse(n)));\r\n            // If the rounded root equals the original number then we're good \r\n            if(e.equals(_.parse(this.multiplier))) {\r\n                return rounded;\r\n            }\r\n            // Otherwise return the unrounded version\r\n            return root;\r\n        },\r\n        /**\r\n         * Checks if symbol is to the nth power\r\n         * @returns {Boolean}\r\n         */\r\n        isToNth: function (n) {\r\n            // Start by check in the multiplier for squareness\r\n            // First get the root but round it because currently we still depend \r\n            var root = this.getNth(n);\r\n            var nthMultiplier = isInt(root);\r\n            var nthPower;\r\n\r\n            if(this.group === CB) {\r\n                // Start by assuming that all will be square.\r\n                nthPower = true;\r\n                // All it takes is for one of the symbols to not have an even power\r\n                // e.g. x^n1*y^n2 requires that both n1 and n2 are even\r\n                this.each(function (x) {\r\n                    var isNth = x.isToNth(n);\r\n\r\n                    if(!isNth) {\r\n                        nthPower = false;\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                // Check if the power is divisible by n if it's not a number.\r\n                nthPower = this.group === N ? true : isInt(_.divide(_.parse(this.power), _.parse(n)));\r\n            }\r\n\r\n            return nthMultiplier && nthPower;\r\n        },\r\n        /**\r\n         * Checks if a symbol is square\r\n         * @return {Boolean}\r\n         */\r\n        isSquare: function () {\r\n            return this.isToNth(2);\r\n        },\r\n        /**\r\n         * Checks if a symbol is cube\r\n         * @return {Boolean}\r\n         */\r\n        isCube: function () {\r\n            return this.isToNth(3);\r\n        },\r\n        /**\r\n         * Checks if a symbol is a bare variable\r\n         * @return {Boolean}\r\n         */\r\n        isSimple: function () {\r\n            return this.power.equals(1) && this.multiplier.equals(1);\r\n        },\r\n        /**\r\n         * Simplifies the power of the symbol\r\n         * @returns {Symbol} a clone of the symbol\r\n         */\r\n        powSimp: function () {\r\n            if(this.group === CB) {\r\n                var powers = [],\r\n                        sign = this.multiplier.sign();\r\n                this.each(function (x) {\r\n                    var p = x.power;\r\n                    //why waste time if I can't do anything anyway\r\n                    if(isSymbol(p) || p.equals(1))\r\n                        return this.clone();\r\n                    powers.push(p);\r\n                });\r\n                var min = new Frac(arrayMin(powers));\r\n\r\n                //handle the coefficient\r\n                //handle the multiplier\r\n                var sign = this.multiplier.sign(),\r\n                        m = this.multiplier.clone().abs(),\r\n                        mfactors = Math2.ifactor(m);\r\n                //if we have a multiplier of 6750 and a min of 2 then the factors are 5^3*5^3*2\r\n                //we can then reduce it to 2*3*5*(15)^2\r\n                var out_ = new Frac(1);\r\n                var in_ = new Frac(1);\r\n\r\n                for(var x in mfactors) {\r\n                    var n = new Frac(mfactors[x]);\r\n                    if(!n.lessThan(min)) {\r\n                        n = n.divide(min).subtract(new Frac(1));\r\n                        in_ = in_.multiply(new Frac(x)); //move the factor inside the bracket\r\n                    }\r\n\r\n                    out_ = out_.multiply(_.parse(inBrackets(x) + '^' + inBrackets(n)).multiplier);\r\n                }\r\n                var t = new Symbol(in_);\r\n                this.each(function (x) {\r\n                    x = x.clone();\r\n                    x.power = x.power.divide(min);\r\n                    t = _.multiply(t, x);\r\n                });\r\n\r\n                var xt = _.symfunction(PARENTHESIS, [t]);\r\n                xt.power = min;\r\n                xt.multiplier = sign < 0 ? out_.negate() : out_;\r\n\r\n                return xt;\r\n            }\r\n            return this.clone();\r\n        },\r\n        /**\r\n         * Checks to see if two functions are of equal value\r\n         * @param {Symbol} symbol\r\n         */\r\n        equals: function (symbol) {\r\n            if(!isSymbol(symbol))\r\n                symbol = new Symbol(symbol);\r\n            return this.value === symbol.value && this.power.equals(symbol.power)\r\n                    && this.multiplier.equals(symbol.multiplier)\r\n                    && this.group === symbol.group;\r\n        },\r\n        abs: function () {\r\n            var e = this.clone();\r\n            e.multiplier.abs();\r\n            return e;\r\n        },\r\n        // Greater than\r\n        gt: function (symbol) {\r\n            if(!isSymbol(symbol))\r\n                symbol = new Symbol(symbol);\r\n            return this.isConstant() && symbol.isConstant() && this.multiplier.greaterThan(symbol.multiplier);\r\n        },\r\n        // Greater than\r\n        gte: function (symbol) {\r\n            if(!isSymbol(symbol))\r\n                symbol = new Symbol(symbol);\r\n            return this.equals(symbol) ||\r\n                    this.isConstant() && symbol.isConstant() && this.multiplier.greaterThan(symbol.multiplier);\r\n        },\r\n        // Less than\r\n        lt: function (symbol) {\r\n            if(!isSymbol(symbol))\r\n                symbol = new Symbol(symbol);\r\n            return this.isConstant() && symbol.isConstant() && this.multiplier.lessThan(symbol.multiplier);\r\n        },\r\n        // Less than\r\n        lte: function (symbol) {\r\n            if(!isSymbol(symbol))\r\n                symbol = new Symbol(symbol);\r\n            return this.equals(symbol) ||\r\n                    this.isConstant() && symbol.isConstant() && this.multiplier.lessThan(symbol.multiplier);\r\n        },\r\n        /**\r\n         * Because nerdamer doesn't group symbols by polynomials but\r\n         * rather a custom grouping method, this has to be\r\n         * reinserted in order to make use of most algorithms. This function\r\n         * checks if the symbol meets the criteria of a polynomial.\r\n         * @param {bool} multivariate\r\n         * @returns {boolean}\r\n         */\r\n        isPoly: function (multivariate) {\r\n            var g = this.group,\r\n                    p = this.power;\r\n            //the power must be a integer so fail if it's not\r\n            if(!isInt(p) || p < 0)\r\n                return false;\r\n            //constants and first orders\r\n            if(g === N || g === S || this.isConstant(true))\r\n                return true;\r\n            var vars = variables(this);\r\n            if(g === CB && vars.length === 1) {\r\n                //the variable is assumed the only one that was found\r\n                var v = vars[0];\r\n                //if no variable then guess what!?!? We're done!!! We have a polynomial.\r\n                if(!v)\r\n                    return true;\r\n                for(var x in this.symbols) {\r\n                    var sym = this.symbols[x];\r\n                    //sqrt(x)\r\n                    if(sym.group === FN && !sym.args[0].isConstant())\r\n                        return false;\r\n                    if(!sym.contains(v) && !sym.isConstant(true))\r\n                        return false;\r\n                }\r\n                return true;\r\n            }\r\n            //PL groups. These only fail if a power is not an int\r\n            //this should handle cases such as x^2*t\r\n            if(this.isComposite() || g === CB && multivariate) {\r\n                //fail if we're not checking for multivariate polynomials\r\n                if(!multivariate && vars.length > 1)\r\n                    return false;\r\n                //loop though the symbols and check if they qualify\r\n                for(var x in this.symbols) {\r\n                    //we've already the symbols if we're not checking for multivariates at this point\r\n                    //so we check the sub-symbols\r\n                    if(!this.symbols[x].isPoly(multivariate))\r\n                        return false;\r\n                }\r\n                return true;\r\n            }\r\n            else\r\n                return false;\r\n\r\n            /*\r\n             //all tests must have passed so we must be dealing with a polynomial\r\n             return true;\r\n             */\r\n        },\r\n        //removes the requested variable from the symbol and returns the remainder\r\n        stripVar: function (x, exclude_x) {\r\n            var retval;\r\n            if((this.group === PL || this.group === S) && this.value === x)\r\n                retval = new Symbol(exclude_x ? 0 : this.multiplier);\r\n            else if(this.group === CB && this.isLinear()) {\r\n                retval = new Symbol(1);\r\n                this.each(function (s) {\r\n                    if(!s.contains(x, true))\r\n                        retval = _.multiply(retval, s.clone());\r\n                });\r\n                retval.multiplier = retval.multiplier.multiply(this.multiplier);\r\n            }\r\n            else if(this.group === CP && !this.isLinear()) {\r\n                retval = new Symbol(this.multiplier);\r\n            }\r\n            else if(this.group === CP && this.isLinear()) {\r\n                retval = new Symbol(0);\r\n                this.each(function (s) {\r\n                    if(!s.contains(x)) {\r\n                        var t = s.clone();\r\n                        t.multiplier = t.multiplier.multiply(this.multiplier);\r\n                        retval = _.add(retval, t);\r\n                    }\r\n                });\r\n                //BIG TODO!!! It doesn't make much sense\r\n                if(retval.equals(0))\r\n                    retval = new Symbol(this.multiplier);\r\n            }\r\n            else if(this.group === EX && this.power.contains(x, true)) {\r\n                retval = new Symbol(this.multiplier);\r\n            }\r\n            else if(this.group === FN && this.contains(x)) {\r\n                retval = new Symbol(this.multiplier);\r\n            }\r\n            else\r\n                //wth? This should technically be the multiplier.\r\n                //Unfortunately this method wasn't very well thought out :`(.\r\n                //should be: retval = new Symbol(this.multiplier);\r\n                //use: ((1+x^2)*sqrt(-1+x^2))^(-1) for correction.\r\n                //this will break a bunch of unit tests so be ready to for the long haul\r\n                retval = this.clone();\r\n\r\n\r\n            return retval;\r\n        },\r\n        //returns symbol in array form with x as base e.g. a*x^2+b*x+c = [c, b, a].\r\n        toArray: function (v, arr) {\r\n            arr = arr || {\r\n                arr: [],\r\n                add: function (x, idx) {\r\n                    var e = this.arr[idx];\r\n                    this.arr[idx] = e ? _.add(e, x) : x;\r\n                }\r\n            };\r\n            var g = this.group;\r\n\r\n            if(g === S && this.contains(v)) {\r\n                arr.add(new Symbol(this.multiplier), this.power);\r\n            }\r\n            else if(g === CB) {\r\n                var a = this.stripVar(v),\r\n                        x = _.divide(this.clone(), a.clone());\r\n                var p = x.isConstant() ? 0 : x.power;\r\n                arr.add(a, p);\r\n            }\r\n            else if(g === PL && this.value === v) {\r\n                this.each(function (x, p) {\r\n                    arr.add(x.stripVar(v), p);\r\n                });\r\n            }\r\n            else if(g === CP) {\r\n                //the logic: they'll be broken into symbols so e.g. (x^2+x)+1 or (a*x^2+b*x+c)\r\n                //each case is handled above\r\n                this.each(function (x) {\r\n                    x.toArray(v, arr);\r\n                });\r\n            }\r\n            else if(this.contains(v)) {\r\n                throw new NerdamerTypeError('Cannot convert to array! Exiting');\r\n            }\r\n            else {\r\n                arr.add(this.clone(), 0); //it's just a constant wrt to v\r\n            }\r\n            //fill the holes\r\n            arr = arr.arr; //keep only the array since we don't need the object anymore\r\n            for(var i = 0; i < arr.length; i++)\r\n                if(!arr[i])\r\n                    arr[i] = new Symbol(0);\r\n            return arr;\r\n        },\r\n        //checks to see if a symbol contans a function\r\n        hasFunc: function (v) {\r\n            var fn_group = this.group === FN || this.group === EX;\r\n            if(fn_group && !v || fn_group && this.contains(v))\r\n                return true;\r\n            if(this.symbols) {\r\n                for(var x in this.symbols) {\r\n                    if(this.symbols[x].hasFunc(v))\r\n                        return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n        sub: function (a, b) {\r\n            a = !isSymbol(a) ? _.parse(a) : a.clone();\r\n            b = !isSymbol(b) ? _.parse(b) : b.clone();\r\n            if(a.group === N || a.group === P)\r\n                err('Cannot substitute a number. Must be a variable');\r\n            var same_pow = false,\r\n                    a_is_unit_multiplier = a.multiplier.equals(1),\r\n                    m = this.multiplier.clone(),\r\n                    retval;\r\n            /*\r\n             * In order to make the substitution the bases have to first match take\r\n             * (x+1)^x -> (x+1)=y || x^2 -> x=y^6\r\n             * In both cases the first condition is that the bases match so we begin there\r\n             * Either both are PL or both are not PL but we cannot have PL and a non-PL group match\r\n             */\r\n            if(this.value === a.value && (this.group !== PL && a.group !== PL || this.group === PL && a.group === PL)) {\r\n                //we cleared the first hurdle but a subsitution may not be possible just yet\r\n                if(a_is_unit_multiplier || a.multiplier.equals(this.multiplier)) {\r\n                    if(a.isLinear()) {\r\n                        retval = b;\r\n                    }\r\n                    else if(a.power.equals(this.power)) {\r\n                        retval = b;\r\n                        same_pow = true;\r\n                    }\r\n                    if(a.multiplier.equals(this.multiplier))\r\n                        m = new Frac(1);\r\n                }\r\n            }\r\n            //the next thing is to handle CB\r\n            else if(this.group === CB || this.previousGroup === CB) {\r\n                retval = new Symbol(1);\r\n                this.each(function (x) {\r\n                    var subbed = _.parse(x.sub(a, b)); //parse it again for safety\r\n                    retval = _.multiply(retval, subbed);\r\n\r\n                });\r\n            }\r\n            else if(this.isComposite()) {\r\n                var symbol = this.clone();\r\n\r\n                if(a.isComposite() && symbol.isComposite() && symbol.isLinear() && a.isLinear()) {\r\n                    var find = function (stack, needle) {\r\n                        for(var x in stack.symbols) {\r\n                            var sym = stack.symbols[x];\r\n                            //if the symbol equals the needle or it's within the sub-symbols we're done\r\n                            if(sym.isComposite() && find(sym, needle) || sym.equals(needle))\r\n                                return true;\r\n                        }\r\n                        return false;\r\n                    };\r\n                    //go fish\r\n                    for(var x in a.symbols) {\r\n                        if(!find(symbol, a.symbols[x]))\r\n                            return symbol.clone();\r\n                    }\r\n                    retval = _.add(_.subtract(symbol.clone(), a), b);\r\n                }\r\n                else {\r\n                    retval = new Symbol(0);\r\n                    symbol.each(function (x) {\r\n                        retval = _.add(retval, x.sub(a, b));\r\n                    });\r\n                }\r\n            }\r\n            else if(this.group === EX) {\r\n                // the parsed value could be a function so parse and sub\r\n                retval = _.parse(this.value).sub(a, b);\r\n            }\r\n            else if(this.group === FN) {\r\n                var nargs = [];\r\n                for(var i = 0; i < this.args.length; i++) {\r\n                    var arg = this.args[i];\r\n                    if(!isSymbol(arg))\r\n                        arg = _.parse(arg);\r\n                    nargs.push(arg.sub(a, b));\r\n                }\r\n                retval = _.symfunction(this.fname, nargs);\r\n            }\r\n            //if we did manage a substitution\r\n            if(retval) {\r\n                if(!same_pow) {\r\n                    //substitute the power\r\n                    var p = this.group === EX ? this.power.sub(a, b) : _.parse(this.power);\r\n                    //now raise the symbol to that power\r\n                    retval = _.pow(retval, p);\r\n                }\r\n\r\n                //transfer the multiplier\r\n                retval.multiplier = retval.multiplier.multiply(m);\r\n\r\n                //done\r\n                return retval;\r\n            }\r\n            //if all else fails\r\n            return this.clone();\r\n        },\r\n        isMonomial: function () {\r\n            if(this.group === S)\r\n                return true;\r\n            if(this.group === CB) {\r\n                for(var x in this.symbols)\r\n                    if(this.symbols[x].group !== S)\r\n                        return false;\r\n            }\r\n            else\r\n                return false;\r\n            return true;\r\n        },\r\n        isPi: function () {\r\n            return this.group === S && this.value === 'pi';\r\n        },\r\n        sign: function () {\r\n            return this.multiplier.sign();\r\n        },\r\n        isE: function () {\r\n            return this.value === 'e';\r\n        },\r\n        isSQRT: function () {\r\n            return this.fname === SQRT;\r\n        },\r\n        isConstant: function (check_all, check_symbols) {\r\n            if(check_symbols && this.group === CB) {\r\n                for(var x in this.symbols) {\r\n                    if(this.symbols[x].isConstant(true))\r\n                        return true;\r\n                }\r\n            }\r\n\r\n            if(check_all === 'functions' && this.isComposite()) {\r\n                var isConstant = true;\r\n\r\n                this.each(function (x) {\r\n                    if(!x.isConstant(check_all, check_symbols)) {\r\n                        isConstant = false;\r\n                    }\r\n                }, true);\r\n\r\n                return isConstant;\r\n            }\r\n\r\n            if(check_all === 'all' && (this.isPi() || this.isE())) {\r\n                return true;\r\n            }\r\n\r\n            if(check_all && this.group === FN) {\r\n                for(var i = 0; i < this.args.length; i++) {\r\n                    if(!this.args[i].isConstant(check_all))\r\n                        return false;\r\n                }\r\n                return true;\r\n            }\r\n\r\n            if(check_all)\r\n                return isNumericSymbol(this);\r\n            return this.value === CONST_HASH;\r\n        },\r\n        //the symbols is imaginary if\r\n        //1. n*i\r\n        //2. a+b*i\r\n        //3. a*i\r\n        isImaginary: function () {\r\n            if(this.imaginary)\r\n                return true;\r\n            else if(this.symbols) {\r\n                for(var x in this.symbols)\r\n                    if(this.symbols[x].isImaginary())\r\n                        return true;\r\n            }\r\n            return false;\r\n        },\r\n        /**\r\n         * Returns the real part of a symbol\r\n         * @returns {Symbol}\r\n         */\r\n        realpart: function () {\r\n            if(this.isConstant()) {\r\n                return this.clone();\r\n            }\r\n            else if(this.imaginary)\r\n                return new Symbol(0);\r\n            else if(this.isComposite()) {\r\n                var retval = new Symbol(0);\r\n                this.each(function (x) {\r\n                    retval = _.add(retval, x.realpart());\r\n                });\r\n                return retval;\r\n            }\r\n            else if(this.isImaginary())\r\n                return new Symbol(0);\r\n            return this.clone();\r\n        },\r\n        /*\r\n         * Return imaginary part of a symbol\r\n         * @returns {Symbol}\r\n         */\r\n        imagpart: function () {\r\n            if(this.group === S && this.isImaginary())\r\n                return new Symbol(this.multiplier);\r\n            if(this.isComposite()) {\r\n                var retval = new Symbol(0);\r\n                this.each(function (x) {\r\n                    retval = _.add(retval, x.imagpart());\r\n                });\r\n                return retval;\r\n            }\r\n            if(this.group === CB)\r\n                return this.stripVar(Settings.IMAGINARY);\r\n            return new Symbol(0);\r\n        },\r\n        isInteger: function () {\r\n            return this.isConstant() && this.multiplier.isInteger();\r\n        },\r\n        isLinear: function (wrt) {\r\n            if(wrt) {\r\n                if(this.isConstant())\r\n                    return true;\r\n                if(this.group === S) {\r\n                    if(this.value === wrt)\r\n                        return this.power.equals(1);\r\n                    else\r\n                        return true;\r\n                }\r\n\r\n                if(this.isComposite() && this.power.equals(1)) {\r\n                    for(var x in this.symbols) {\r\n                        if(!this.symbols[x].isLinear(wrt))\r\n                            return false;\r\n                    }\r\n                    return true;\r\n                }\r\n\r\n                if(this.group === CB && this.symbols[wrt])\r\n                    return this.symbols[wrt].isLinear(wrt);\r\n                return false;\r\n            }\r\n            else\r\n                return this.power.equals(1);\r\n        },\r\n        /**\r\n         * Checks to see if a symbol has a function by a specified name or within a specified list\r\n         * @param {String|String[]} names\r\n         * @returns {Boolean}\r\n         */\r\n        containsFunction: function (names) {\r\n            if(typeof names === 'string')\r\n                names = [names];\r\n            if(this.group === FN && names.indexOf(this.fname) !== -1)\r\n                return true;\r\n            if(this.symbols) {\r\n                for(var x in this.symbols) {\r\n                    if(this.symbols[x].containsFunction(names))\r\n                        return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n        multiplyPower: function (p2) {\r\n            //leave out 1\r\n            if(this.group === N && this.multiplier.equals(1))\r\n                return this;\r\n\r\n            var p1 = this.power;\r\n\r\n            if(this.group !== EX && p2.group === N) {\r\n                var p = p2.multiplier;\r\n                if(this.group === N && !p.isInteger()) {\r\n                    this.convert(P);\r\n                }\r\n\r\n                this.power = p1.equals(1) ? p.clone() : p1.multiply(p);\r\n\r\n                if(this.group === P && isInt(this.power)) {\r\n                    //bring it back to an N\r\n                    this.value = Math.pow(this.value, this.power);\r\n                    this.toLinear();\r\n                    this.convert(N);\r\n                }\r\n            }\r\n            else {\r\n                if(this.group !== EX) {\r\n                    p1 = new Symbol(p1);\r\n                    this.convert(EX);\r\n                }\r\n                this.power = _.multiply(p1, p2);\r\n            }\r\n\r\n            return this;\r\n        },\r\n        setPower: function (p, retainSign) {\r\n            //leave out 1\r\n            if(this.group === N && this.multiplier.equals(1)) {\r\n                return this;\r\n            }\r\n            if(this.group === EX && !isSymbol(p)) {\r\n                this.group = this.previousGroup;\r\n                delete this.previousGroup;\r\n                if(this.group === N) {\r\n                    this.multiplier = new Frac(this.value);\r\n                    this.value = CONST_HASH;\r\n                }\r\n                else\r\n                    this.power = p;\r\n            }\r\n            else {\r\n                var isSymbolic = false;\r\n                if(isSymbol(p)) {\r\n                    if(p.group === N) {\r\n                        //p should be the multiplier instead\r\n                        p = p.multiplier;\r\n\r\n                    }\r\n                    else {\r\n                        isSymbolic = true;\r\n                    }\r\n                }\r\n                var group = isSymbolic ? EX : P;\r\n                this.power = p;\r\n                if(this.group === N && group)\r\n                    this.convert(group, retainSign);\r\n            }\r\n\r\n            return this;\r\n        },\r\n        /**\r\n         * Checks to see if symbol is located in the denominator\r\n         * @returns {boolean}\r\n         */\r\n        isInverse: function () {\r\n            if(this.group === EX)\r\n                return (this.power.multiplier.lessThan(0));\r\n            return this.power < 0;\r\n        },\r\n        /**\r\n         * Make a duplicate of a symbol by copying a predefined list of items.\r\n         * The name 'copy' would probably be a more appropriate name.\r\n         * to a new symbol\r\n         * @param {Symbol} c\r\n         * @returns {Symbol}\r\n         */\r\n        clone: function (c) {\r\n            var clone = c || new Symbol(0),\r\n                    //list of properties excluding power as this may be a symbol and would also need to be a clone.\r\n                    properties = [\r\n                        'value', 'group', 'length', 'previousGroup', 'imaginary', 'fname', 'args', 'isInfinity', 'scientific'],\r\n                    l = properties.length, i;\r\n            if(this.symbols) {\r\n                clone.symbols = {};\r\n                for(var x in this.symbols) {\r\n                    clone.symbols[x] = this.symbols[x].clone();\r\n                }\r\n            }\r\n\r\n            for(i = 0; i < l; i++) {\r\n                if(this[properties[i]] !== undefined) {\r\n                    clone[properties[i]] = this[properties[i]];\r\n                }\r\n            }\r\n\r\n            clone.power = this.power.clone();\r\n            clone.multiplier = this.multiplier.clone();\r\n            //add back the flag to track if this symbol is a conversion symbol\r\n            if(this.isConversion)\r\n                clone.isConversion = this.isConversion;\r\n\r\n            if(this.isUnit)\r\n                clone.isUnit = this.isUnit;\r\n\r\n            return clone;\r\n        },\r\n        /**\r\n         * Converts a symbol multiplier to one.\r\n         * @param {Boolean} keepSign Keep the multiplier as negative if the multiplier is negative and keepSign is true\r\n         * @returns {Symbol}\r\n         */\r\n        toUnitMultiplier: function (keepSign) {\r\n            this.multiplier.num = new bigInt(this.multiplier.num.isNegative() && keepSign ? -1 : 1);\r\n            this.multiplier.den = new bigInt(1);\r\n            return this;\r\n        },\r\n        /**\r\n         * Converts a Symbol's power to one.\r\n         * @returns {Symbol}\r\n         */\r\n        toLinear: function () {\r\n            // Do nothing if it's already linear\r\n            if(this.power.equals(1)) {\r\n                return this;\r\n            }\r\n            this.setPower(new Frac(1));\r\n            return this;\r\n        },\r\n        /**\r\n         * Iterates over all the sub-symbols. If no sub-symbols exist then it's called on itself\r\n         * @param {Function} fn\r\n         * @@param {Boolean} deep If true it will itterate over the sub-symbols their symbols as well\r\n         */\r\n        each: function (fn, deep) {\r\n            if(!this.symbols) {\r\n                fn.call(this, this, this.value);\r\n            }\r\n            else {\r\n                for(var x in this.symbols) {\r\n                    var sym = this.symbols[x];\r\n                    if(sym.group === PL && deep) {\r\n                        for(var y in sym.symbols) {\r\n                            fn.call(x, sym.symbols[y], y);\r\n                        }\r\n                    }\r\n                    else\r\n                        fn.call(this, sym, x);\r\n                }\r\n            }\r\n        },\r\n        /**\r\n         * A numeric value to be returned for Javascript. It will try to\r\n         * return a number as far a possible but in case of a pure symbolic\r\n         * symbol it will just return its text representation\r\n         * @returns {String|Number}\r\n         */\r\n        valueOf: function () {\r\n            if(this.group === N)\r\n                return this.multiplier.valueOf();\r\n            else if(this.power === 0) {\r\n                return 1;\r\n            }\r\n            else if(this.multiplier === 0) {\r\n                return 0;\r\n            }\r\n            else {\r\n                return text(this, 'decimals');\r\n            }\r\n        },\r\n        /**\r\n         * Checks to see if a symbols has a particular variable within it.\r\n         * Pass in true as second argument to include the power of exponentials\r\n         * which aren't check by default.\r\n         * @example var s = _.parse('x+y+z'); s.contains('y');\r\n         * //returns true\r\n         * @param {any} variable\r\n         * @param {boolean} all\r\n         * @returns {boolean}\r\n         */\r\n        contains: function (variable, all) {\r\n            //contains expects a string\r\n            variable = String(variable);\r\n            var g = this.group;\r\n            if(this.value === variable)\r\n                return true;\r\n            if(this.symbols) {\r\n                for(var x in this.symbols) {\r\n                    if(this.symbols[x].contains(variable, all))\r\n                        return true;\r\n                }\r\n            }\r\n            if(g === FN || this.previousGroup === FN) {\r\n                for(var i = 0; i < this.args.length; i++) {\r\n                    if(this.args[i].contains(variable, all))\r\n                        return true;\r\n                }\r\n            }\r\n\r\n            if(g === EX) {\r\n                //exit only if it does\r\n                if(all && this.power.contains(variable, all)) {\r\n                    return true;\r\n                }\r\n                if(this.value === variable)\r\n                    return true;\r\n\r\n            }\r\n\r\n            return this.value === variable;\r\n        },\r\n        /**\r\n         * Negates a symbols\r\n         * @returns {boolean}\r\n         */\r\n        negate: function () {\r\n            this.multiplier.negate();\r\n            if(this.group === CP || this.group === PL)\r\n                this.distributeMultiplier();\r\n            return this;\r\n        },\r\n        /**\r\n         * Inverts a symbol\r\n         * @param {boolean} power_only\r\n         * @param {boolean} all\r\n         * @returns {boolean}\r\n         */\r\n        invert: function (power_only, all) {\r\n            //invert the multiplier\r\n            if(!power_only)\r\n                this.multiplier = this.multiplier.invert();\r\n            //invert the rest\r\n            if(isSymbol(this.power)) {\r\n                this.power.negate();\r\n            }\r\n            else if(this.group === CB && all) {\r\n                this.each(function (x) {\r\n                    return x.invert();\r\n                });\r\n            }\r\n            else {\r\n                if(this.power && this.group !== N)\r\n                    this.power.negate();\r\n            }\r\n            return this;\r\n        },\r\n        /**\r\n         * Symbols of group CP or PL may have the multiplier being carried by\r\n         * the top level symbol at any given time e.g. 2*(x+y+z). This is\r\n         * convenient in many cases, however in some cases the multiplier needs\r\n         * to be carried individually e.g. 2*x+2*y+2*z.\r\n         * This method distributes the multiplier over the entire symbol\r\n         * @param {boolean} all\r\n         * @returns {Symbol}\r\n         */\r\n        distributeMultiplier: function (all) {\r\n            var is_one = all ? this.power.absEquals(1) : this.power.equals(1);\r\n            if(this.symbols && is_one && this.group !== CB && !this.multiplier.equals(1)) {\r\n                for(var x in this.symbols) {\r\n                    var s = this.symbols[x];\r\n                    s.multiplier = s.multiplier.multiply(this.multiplier);\r\n                    s.distributeMultiplier();\r\n                }\r\n                this.toUnitMultiplier();\r\n            }\r\n\r\n            return this;\r\n        },\r\n        /**\r\n         * This method expands the exponent over the entire symbol just like\r\n         * distributeMultiplier\r\n         * @returns {Symbol}\r\n         */\r\n        distributeExponent: function () {\r\n            if(!this.power.equals(1)) {\r\n                var p = this.power;\r\n                for(var x in this.symbols) {\r\n                    var s = this.symbols[x];\r\n                    if(s.group === EX) {\r\n                        s.power = _.multiply(s.power, new Symbol(p));\r\n                    }\r\n                    else {\r\n                        this.symbols[x].power = this.symbols[x].power.multiply(p);\r\n                    }\r\n                }\r\n                this.toLinear();\r\n            }\r\n            return this;\r\n        },\r\n        /**\r\n         * This method will attempt to up-convert or down-convert one symbol\r\n         * from one group to another. Not all symbols are convertible from one\r\n         * group to another however. In that case the symbol will remain\r\n         * unchanged.\r\n         * @param {int} group\r\n         * @param {string} imaginary\r\n         */\r\n        convert: function (group, imaginary) {\r\n            if(group > FN) {\r\n                //make a clone of this symbol;\r\n                var cp = this.clone();\r\n\r\n                //attach a symbols object and upgrade the group\r\n                this.symbols = {};\r\n\r\n                if(group === CB) {\r\n                    //symbol of group CB hold symbols bound together through multiplication\r\n                    //because of commutativity this multiplier can technically be anywhere within the group\r\n                    //to keep track of it however it's easier to always have the top level carry it\r\n                    cp.toUnitMultiplier();\r\n                }\r\n                else {\r\n                    //reset the symbol\r\n                    this.toUnitMultiplier();\r\n                }\r\n\r\n                if(this.group === FN) {\r\n                    cp.args = this.args;\r\n                    delete this.args;\r\n                    delete this.fname;\r\n                }\r\n\r\n                //the symbol may originate from the symbol i but this property no longer holds true\r\n                //after copying\r\n                if(this.isImgSymbol)\r\n                    delete this.isImgSymbol;\r\n\r\n                this.toLinear();\r\n                //attach a clone of this symbol to the symbols object using its proper key\r\n                this.symbols[cp.keyForGroup(group)] = cp;\r\n                this.group = group;\r\n                //objects by default don't have a length property. However, in order to keep track of the number\r\n                //of sub-symbols we have to impliment our own.\r\n                this.length = 1;\r\n            }\r\n            else if(group === EX) {\r\n                //1^x is just one so check and make sure\r\n                if(!(this.group === N && this.multiplier.equals(1))) {\r\n                    if(this.group !== EX)\r\n                        this.previousGroup = this.group;\r\n                    if(this.group === N) {\r\n                        this.value = this.multiplier.num.toString();\r\n                        this.toUnitMultiplier();\r\n                    }\r\n                    //update the hash to reflect the accurate hash\r\n                    else\r\n                        this.value = text(this, 'hash');\r\n\r\n                    this.group = EX;\r\n                }\r\n            }\r\n            else if(group === N) {\r\n                var m = this.multiplier.toDecimal();\r\n                if(this.symbols)\r\n                    this.symbols = undefined;\r\n                new Symbol(this.group === P ? m * Math.pow(this.value, this.power) : m).clone(this);\r\n            }\r\n            else if(group === P && this.group === N) {\r\n                this.value = imaginary ? this.multiplier.num.toString() : Math.abs(this.multiplier.num.toString());\r\n                this.toUnitMultiplier(!imaginary);\r\n                this.group = P;\r\n            }\r\n            return this;\r\n        },\r\n        /**\r\n         * This method is one of the principal methods to make it all possible.\r\n         * It performs cleanup and prep operations whenever a symbols is\r\n         * inserted. If the symbols results in a 1 in a CB (multiplication)\r\n         * group for instance it will remove the redundant symbol. Similarly\r\n         * in a symbol of group PL or CP (symbols glued by multiplication) it\r\n         * will remove any dangling zeroes from the symbol. It will also\r\n         * up-convert or down-convert a symbol if it detects that it's\r\n         * incorrectly grouped. It should be noted that this method is not\r\n         * called directly but rather by the 'attach' method for addition groups\r\n         * and the 'combine' method for multiplication groups.\r\n         * @param {Symbol} symbol\r\n         * @param {String} action\r\n         */\r\n        insert: function (symbol, action) {\r\n            //this check can be removed but saves a lot of aggravation when trying to hunt down\r\n            //a bug. If left, you will instantly know that the error can only be between 2 symbols.\r\n            if(!isSymbol(symbol))\r\n                err('Object ' + symbol + ' is not of type Symbol!');\r\n            if(this.symbols) {\r\n                var group = this.group;\r\n                if(group > FN) {\r\n                    var key = symbol.keyForGroup(group);\r\n                    var existing = key in this.symbols ? this.symbols[key] : false; //check if there's already a symbol there\r\n                    if(action === 'add') {\r\n                        var hash = key;\r\n                        if(existing) {\r\n                            //add them together using the parser\r\n                            this.symbols[hash] = _.add(existing, symbol);\r\n                            //if the addition resulted in a zero multiplier remove it\r\n                            if(this.symbols[hash].multiplier.equals(0)) {\r\n                                delete this.symbols[hash];\r\n                                this.length--;\r\n\r\n                                if(this.length === 0) {\r\n                                    this.convert(N);\r\n                                    this.multiplier = new Frac(0);\r\n                                }\r\n                            }\r\n                        }\r\n                        else {\r\n                            this.symbols[key] = symbol;\r\n                            this.length++;\r\n                        }\r\n                    }\r\n                    else {\r\n                        //check if this is of group P and unwrap before inserting\r\n                        if(symbol.group === P && isInt(symbol.power)) {\r\n                            symbol.convert(N);\r\n                        }\r\n\r\n                        //transfer the multiplier to the upper symbol but only if the symbol numeric\r\n                        if(symbol.group !== EX) {\r\n                            this.multiplier = this.multiplier.multiply(symbol.multiplier);\r\n                            symbol.toUnitMultiplier();\r\n                        }\r\n                        else {\r\n                            symbol.parens = symbol.multiplier.lessThan(0);\r\n                            this.multiplier = this.multiplier.multiply(symbol.multiplier.clone().abs());\r\n                            symbol.toUnitMultiplier(true);\r\n                        }\r\n\r\n                        if(existing) {\r\n                            //remove because the symbol may have changed\r\n                            symbol = _.multiply(remove(this.symbols, key), symbol);\r\n                            if(symbol.isConstant()) {\r\n                                this.multiplier = this.multiplier.multiply(symbol.multiplier);\r\n                                symbol = new Symbol(1); //the dirty work gets done down the line when it detects 1\r\n                            }\r\n\r\n                            this.length--;\r\n                            //clean up\r\n                        }\r\n\r\n                        //don't insert the symbol if it's 1\r\n                        if(!symbol.isOne(true)) {\r\n                            this.symbols[key] = symbol;\r\n                            this.length++;\r\n                        }\r\n                        else if(symbol.multiplier.lessThan(0)) {\r\n                            this.negate(); //put back the sign\r\n                        }\r\n                    }\r\n\r\n                    //clean up\r\n                    if(this.length === 0)\r\n                        this.convert(N);\r\n                    //update the hash\r\n                    if(this.group === CP || this.group === CB) {\r\n                        this.updateHash();\r\n                    }\r\n                }\r\n            }\r\n\r\n            return this;\r\n        },\r\n        //the insert method for addition\r\n        attach: function (symbol) {\r\n            if(isArray(symbol)) {\r\n                for(var i = 0; i < symbol.length; i++)\r\n                    this.insert(symbol[i], 'add');\r\n                return this;\r\n            }\r\n            return this.insert(symbol, 'add');\r\n        },\r\n        //the insert method for multiplication\r\n        combine: function (symbol) {\r\n            if(isArray(symbol)) {\r\n                for(var i = 0; i < symbol.length; i++)\r\n                    this.insert(symbol[i], 'multiply');\r\n                return this;\r\n            }\r\n            return this.insert(symbol, 'multiply');\r\n        },\r\n        /**\r\n         * This method should be called after any major \"surgery\" on a symbol.\r\n         * It updates the hash of the symbol for example if the fname of a\r\n         * function has changed it will update the hash of the symbol.\r\n         */\r\n        updateHash: function () {\r\n            if(this.group === N)\r\n                return;\r\n\r\n            if(this.group === FN) {\r\n                var contents = '',\r\n                        args = this.args,\r\n                        is_parens = this.fname === PARENTHESIS;\r\n                for(var i = 0; i < args.length; i++)\r\n                    contents += (i === 0 ? '' : ',') + text(args[i]);\r\n                var fn_name = is_parens ? '' : this.fname;\r\n                this.value = fn_name + (is_parens ? contents : inBrackets(contents));\r\n            }\r\n            else if(!(this.group === S || this.group === PL)) {\r\n                this.value = text(this, 'hash');\r\n            }\r\n        },\r\n        /**\r\n         * this function defines how every group in stored within a group of\r\n         * higher order think of it as the switchboard for the library. It\r\n         * defines the hashes for symbols.\r\n         * @param {int} group\r\n         */\r\n        keyForGroup: function (group) {\r\n            var g = this.group;\r\n            var key;\r\n\r\n            if(g === N) {\r\n                key = this.value;\r\n            }\r\n            else if(g === S || g === P) {\r\n                if(group === PL)\r\n                    key = this.power.toDecimal();\r\n                else\r\n                    key = this.value;\r\n            }\r\n            else if(g === FN) {\r\n                if(group === PL)\r\n                    key = this.power.toDecimal();\r\n                else\r\n                    key = text(this, 'hash');\r\n            }\r\n            else if(g === PL) {\r\n                //if the order is reversed then we'll assume multiplication\r\n                //TODO: possible future dilemma\r\n                if(group === CB)\r\n                    key = text(this, 'hash');\r\n                else if(group === CP) {\r\n                    if(this.power.equals(1))\r\n                        key = this.value;\r\n                    else\r\n                        key = inBrackets(text(this, 'hash')) + Settings.POWER_OPERATOR + this.power.toDecimal();\r\n                }\r\n                else if(group === PL)\r\n                    key = this.power.toString();\r\n                else\r\n                    key = this.value;\r\n                return key;\r\n            }\r\n            else if(g === CP) {\r\n                if(group === CP) {\r\n                    key = text(this, 'hash');\r\n                }\r\n                if(group === PL)\r\n                    key = this.power.toDecimal();\r\n                else\r\n                    key = this.value;\r\n            }\r\n            else if(g === CB) {\r\n                if(group === PL)\r\n                    key = this.power.toDecimal();\r\n                else\r\n                    key = text(this, 'hash');\r\n            }\r\n            else if(g === EX) {\r\n                if(group === PL)\r\n                    key = text(this.power);\r\n                else\r\n                    key = text(this, 'hash');\r\n            }\r\n\r\n            return key;\r\n        },\r\n        /**\r\n         * Symbols are typically stored in an object which works fine for most\r\n         * cases but presents a problem when the order of the symbols makes\r\n         * a difference. This function simply collects all the symbols and\r\n         * returns them as an array. If a function is supplied then that\r\n         * function is called on every symbol contained within the object.\r\n         * @param {Function} fn\r\n         * @param {Object} opt\r\n         * @param {Function} sort_fn\r\n         * @@param {Boolean} expand_symbol\r\n         * @returns {Array}\r\n         */\r\n        collectSymbols: function (fn, opt, sort_fn, expand_symbol) {\r\n            var collected = [];\r\n            if(!this.symbols)\r\n                collected.push(this);\r\n            else {\r\n                for(var x in this.symbols) {\r\n                    var symbol = this.symbols[x];\r\n                    if(expand_symbol && (symbol.group === PL || symbol.group === CP)) {\r\n                        collected = collected.concat(symbol.collectSymbols());\r\n                    }\r\n                    else\r\n                        collected.push(fn ? fn(symbol, opt) : symbol);\r\n                }\r\n            }\r\n            if(sort_fn === null)\r\n                sort_fn = undefined; //WTF Firefox? Seriously?\r\n\r\n            return collected.sort(sort_fn);//sort hopefully gives us some sort of consistency\r\n        },\r\n        /**\r\n         * Returns the latex representation of the symbol\r\n         * @param {String} option\r\n         * @returns {String}\r\n         */\r\n        latex: function (option) {\r\n            return LaTeX.latex(this, option);\r\n        },\r\n        /**\r\n         * Returns the text representation of a symbol\r\n         * @param {String} option\r\n         * @returns {String}\r\n         */\r\n        text: function (option) {\r\n            return text(this, option);\r\n        },\r\n        /**\r\n         * Checks if the function evaluates to 1. e.g. x^0 or 1 :)\r\n         * @@param {bool} abs Compares the absolute value\r\n         */\r\n        isOne: function (abs) {\r\n            var f = abs ? 'absEquals' : 'equals';\r\n            if(this.group === N)\r\n                return this.multiplier[f](1);\r\n            else\r\n                return this.power.equals(0);\r\n        },\r\n        isComposite: function () {\r\n            var g = this.group,\r\n                    pg = this.previousGroup;\r\n            return g === CP || g === PL || pg === PL || pg === CP;\r\n        },\r\n        isCombination: function () {\r\n            var g = this.group,\r\n                    pg = this.previousGroup;\r\n            return g === CB || pg === CB;\r\n        },\r\n        lessThan: function (n) {\r\n            return this.multiplier.lessThan(n);\r\n        },\r\n        greaterThan: function (n) {\r\n            if(!isSymbol(n)) {\r\n                n = new Symbol(n);\r\n            }\r\n\r\n            // We can't tell for sure if a is greater than be if they're not both numbers\r\n            if(!this.isConstant(true) || !n.isConstant(true)) {\r\n                return false;\r\n            }\r\n\r\n            return this.multiplier.greaterThan(n.multiplier);\r\n        },\r\n        /**\r\n         * Get's the denominator of the symbol if the symbol is of class CB (multiplication)\r\n         * with other classes the symbol is either the denominator or not.\r\n         * Take x^-1+x^-2. If the symbol was to be mixed such as x+x^-2 then the symbol doesn't have have an exclusive\r\n         * denominator and has to be found by looking at the actual symbols themselves.\r\n         */\r\n        getDenom: function () {\r\n            var retval, symbol;\r\n            symbol = this.clone();\r\n            //e.g. 1/(x*(x+1))\r\n            if(this.group === CB && this.power.lessThan(0))\r\n                symbol = _.expand(symbol);\r\n\r\n            //if the symbol already is the denominator... DONE!!!\r\n            if(symbol.power.lessThan(0) || symbol.group === EX && symbol.power.multiplier.lessThan(0)) {\r\n                var d = _.parse(symbol.multiplier.den);\r\n                retval = symbol.toUnitMultiplier();\r\n                retval.power.negate();\r\n                retval = _.multiply(d, retval); //put back the coeff\r\n            }\r\n            else if(symbol.group === CB) {\r\n                retval = _.parse(symbol.multiplier.den);\r\n                for(var x in symbol.symbols) {\r\n                    var s = symbol.symbols[x];\r\n                    if(s.power < 0 || s.group === EX && s.power.multiplier.lessThan(0))\r\n                        retval = _.multiply(retval, symbol.symbols[x].clone().invert());\r\n                }\r\n            }\r\n            else {\r\n                retval = _.parse(symbol.multiplier.den);\r\n            }\r\n            return retval;\r\n        },\r\n        getNum: function () {\r\n            var retval, symbol;\r\n            symbol = this.clone();\r\n            //e.g. 1/(x*(x+1))\r\n            if(symbol.group === CB && symbol.power.lessThan(0))\r\n                symbol = _.expand(symbol);\r\n            //if the symbol already is the denominator... DONE!!!\r\n            if(symbol.power.greaterThan(0) && symbol.group !== CB || symbol.group === EX && symbol.power.multiplier.greaterThan(0)) {\r\n                retval = _.multiply(_.parse(symbol.multiplier.num), symbol.toUnitMultiplier());\r\n            }\r\n            else if(symbol.group === CB) {\r\n                retval = _.parse(symbol.multiplier.num);\r\n                symbol.each(function (x) {\r\n                    if(x.power > 0 || x.group === EX && x.power.multiplier > 0) {\r\n                        retval = _.multiply(retval, x.clone());\r\n                    }\r\n                });\r\n            }\r\n//            else if(symbol.group === EX && this.previousGroup === S) {\r\n//                retval = _.multiply(_.parse(symbol.multiplier.num), symbol.toUnitMultiplier());\r\n//            }\r\n            else {\r\n                retval = _.parse(symbol.multiplier.num);\r\n            }\r\n            return retval;\r\n        },\r\n        toString: function () {\r\n            return this.text();\r\n        }\r\n    };\r\n\r\n//Parser =======================================================================\r\n    //Uses modified Shunting-yard algorithm. http://en.wikipedia.org/wiki/Shunting-yard_algorithm\r\n    function Parser() {\r\n        //Point to the local parser instead of the global one\r\n        var _ = this;\r\n        var bin = {};\r\n        var preprocessors = {names: [], actions: []};\r\n\r\n//Parser.classes ===============================================================\r\n        function Slice(upper, lower) {\r\n            this.start = upper;\r\n            this.end = lower;\r\n        }\r\n        ;\r\n        Slice.prototype.isConstant = function () {\r\n            return this.start.isConstant() && this.end.isConstant();\r\n        };\r\n        Slice.prototype.text = function () {\r\n            return text(this.start) + ':' + text(this.end);\r\n        };\r\n\r\n        /**\r\n         * Class used to collect arguments for functions\r\n         * @returns {Parser.Collection}\r\n         */\r\n        function Collection() {\r\n            this.elements = [];\r\n        }\r\n        Collection.prototype.append = function (e) {\r\n            this.elements.push(e);\r\n        };\r\n        Collection.prototype.getItems = function () {\r\n            return this.elements;\r\n        };\r\n        Collection.prototype.toString = function () {\r\n            return _.pretty_print(this.elements);\r\n        };\r\n        Collection.create = function (e) {\r\n            var collection = new Collection();\r\n            if(e)\r\n                collection.append(e);\r\n            return collection;\r\n        };\r\n\r\n        function Token(node, node_type, column) {\r\n            this.type = node_type;\r\n            this.value = node;\r\n            if(column !== undefined)\r\n                this.column = column + 1;\r\n            if(node_type === Token.OPERATOR) {\r\n                //copy everything over from the operator\r\n                var operator = operators[node];\r\n                for(var x in operator)\r\n                    this[x] = operator[x];\r\n\r\n            }\r\n            else if(node_type === Token.FUNCTION) {\r\n                this.precedence = Token.MAX_PRECEDENCE; //leave enough roon\r\n                this.leftAssoc = false;\r\n            }\r\n        }\r\n        Token.prototype.toString = function () {\r\n            return this.value;\r\n        };\r\n        Token.prototype.toString = function () {\r\n            if(this.is_prefix)\r\n                return '`' + this.value;\r\n            return this.value;\r\n        };\r\n        //some constants\r\n        Token.OPERATOR = 'OPERATOR';\r\n        Token.VARIABLE_OR_LITERAL = 'VARIABLE_OR_LITERAL';\r\n        Token.FUNCTION = 'FUNCTION';\r\n        Token.UNIT = 'UNIT';\r\n        Token.KEYWORD = 'KEYWORD';\r\n        Token.MAX_PRECEDENCE = 999;\r\n        //create link to classes\r\n        this.classes = {\r\n            Collection: Collection,\r\n            Slice: Slice,\r\n            Token: Token\r\n        };\r\n//Parser.modules ===============================================================\r\n        //object for functions which handle complex number\r\n        var complex = {\r\n            prec: undefined,\r\n            cos: function (r, i) {\r\n                var re, im;\r\n                re = _.parse(Math.cos(r) * Math.cosh(i));\r\n                im = _.parse(Math.sin(r) * Math.sinh(i));\r\n                return _.subtract(re, _.multiply(im, Symbol.imaginary()));\r\n            },\r\n            sin: function (r, i) {\r\n                var re, im;\r\n                re = _.parse(Math.sin(r) * Math.cosh(i));\r\n                im = _.parse(Math.cos(r) * Math.sinh(i));\r\n                return _.subtract(re, _.multiply(im, Symbol.imaginary()));\r\n            },\r\n            tan: function (r, i) {\r\n                var re, im;\r\n                re = _.parse(Math.sin(2 * r) / (Math.cos(2 * r) + Math.cosh(2 * i)));\r\n                im = _.parse(Math.sinh(2 * i) / (Math.cos(2 * r) + Math.cosh(2 * i)));\r\n                return _.add(re, _.multiply(im, Symbol.imaginary()));\r\n            },\r\n            sec: function (r, i) {\r\n                var t = this.removeDen(this.cos(r, i));\r\n                return _.subtract(t[0], _.multiply(t[1], Symbol.imaginary()));\r\n            },\r\n            csc: function (r, i) {\r\n                var t = this.removeDen(this.sin(r, i));\r\n                return _.add(t[0], _.multiply(t[1], Symbol.imaginary()));\r\n            },\r\n            cot: function (r, i) {\r\n                var t = this.removeDen(this.tan(r, i));\r\n                return _.subtract(t[0], _.multiply(t[1], Symbol.imaginary()));\r\n            },\r\n            acos: function (r, i) {\r\n                var symbol, sq, a, b, c, squared;\r\n                symbol = this.fromArray([r, i]);\r\n                squared = _.pow(symbol.clone(), new Symbol(2));\r\n                sq = _.expand(squared); //z*z\r\n                a = _.multiply(sqrt(_.subtract(new Symbol(1), sq)), Symbol.imaginary());\r\n                b = _.expand(_.add(symbol.clone(), a));\r\n                c = log(b);\r\n                return _.expand(_.multiply(Symbol.imaginary().negate(), c));\r\n            },\r\n            asin: function (r, i) {\r\n                return _.subtract(_.parse('pi/2'), this.acos(r, i));\r\n            },\r\n            atan: function (r, i) {\r\n                // Handle i and -i\r\n                if(r.equals(0) && (i.equals(1) || i.equals(-1))) {\r\n                    // Just copy Wolfram Alpha for now. The parenthesis \r\n                    return _.parse(`${Symbol.infinity()}*${Settings.IMAGINARY}*${i}`);\r\n                }\r\n                var a, b, c, symbol;\r\n                symbol = complex.fromArray([r, i]);\r\n                a = _.expand(_.multiply(Symbol.imaginary(), symbol.clone()));\r\n                b = log(_.expand(_.subtract(new Symbol(1), a.clone())));\r\n                c = log(_.expand(_.add(new Symbol(1), a.clone())));\r\n                return _.expand(_.multiply(_.divide(Symbol.imaginary(), new Symbol(2)), _.subtract(b, c)));\r\n            },\r\n            asec: function (r, i) {\r\n                var d = this.removeDen([r, i]);\r\n                d[1].negate();\r\n                return this.acos.apply(this, d);\r\n            },\r\n            acsc: function (r, i) {\r\n                var d = this.removeDen([r, i]);\r\n                d[1].negate();\r\n                return this.asin.apply(this, d);\r\n            },\r\n            acot: function (r, i) {\r\n                var d = this.removeDen([r, i]);\r\n                d[1].negate();\r\n                return this.atan.apply(this, d);\r\n            },\r\n            //Hyperbolic trig\r\n            cosh: function (r, i) {\r\n                var re, im;\r\n                re = _.parse(Math.cosh(r) * Math.cos(i));\r\n                im = _.parse(Math.sinh(r) * Math.sin(i));\r\n                return _.add(re, _.multiply(im, Symbol.imaginary()));\r\n            },\r\n            sinh: function (r, i) {\r\n                var re, im;\r\n                re = _.parse(Math.sinh(r) * Math.cos(i));\r\n                im = _.parse(Math.cosh(r) * Math.sin(i));\r\n                return _.add(re, _.multiply(im, Symbol.imaginary()));\r\n            },\r\n            tanh: function (r, i) {\r\n                var re, im;\r\n                re = _.parse(Math.sinh(2 * r) / (Math.cos(2 * i) + Math.cosh(2 * r)));\r\n                im = _.parse(Math.sin(2 * i) / (Math.cos(2 * i) + Math.cosh(2 * r)));\r\n                return _.subtract(re, _.multiply(im, Symbol.imaginary()));\r\n            },\r\n            sech: function (r, i) {\r\n                var t = this.removeDen(this.cosh(r, i));\r\n                return _.subtract(t[0], _.multiply(t[1], Symbol.imaginary()));\r\n            },\r\n            csch: function (r, i) {\r\n                var t = this.removeDen(this.sinh(r, i));\r\n                return _.subtract(t[0], _.multiply(t[1], Symbol.imaginary()));\r\n            },\r\n            coth: function (r, i) {\r\n                var t = this.removeDen(this.tanh(r, i));\r\n                return _.add(t[0], _.multiply(t[1], Symbol.imaginary()));\r\n            },\r\n            acosh: function (r, i) {\r\n                var a, b, z;\r\n                z = this.fromArray([r, i]);\r\n                a = sqrt(_.add(z.clone(), new Symbol(1)));\r\n                b = sqrt(_.subtract(z.clone(), new Symbol(1)));\r\n                return _.expand(log(_.add(z, _.expand(_.multiply(a, b)))));\r\n            },\r\n            asinh: function (r, i) {\r\n                var a, z;\r\n                z = this.fromArray([r, i]);\r\n                a = sqrt(_.add(new Symbol(1), _.expand(_.pow(z.clone(), new Symbol(2)))));\r\n                return _.expand(log(_.add(z, a)));\r\n            },\r\n            atanh: function (r, i) {\r\n                var a, b, z;\r\n                z = this.fromArray([r, i]);\r\n                a = log(_.add(z.clone(), new Symbol(1)));\r\n                b = log(_.subtract(new Symbol(1), z));\r\n                return _.expand(_.divide(_.subtract(a, b), new Symbol(2)));\r\n            },\r\n            asech: function (r, i) {\r\n                var t = this.removeDen([r, i]);\r\n                t[1].negate();\r\n                return this.acosh.apply(this, t);\r\n            },\r\n            acsch: function (r, i) {\r\n                var t = this.removeDen([r, i]);\r\n                t[1].negate();\r\n                return this.asinh.apply(this, t);\r\n            },\r\n            acoth: function (r, i) {\r\n                var t = this.removeDen([r, i]);\r\n                t[1].negate();\r\n                return this.atanh.apply(this, t);\r\n            },\r\n            sqrt: function (symbol) {\r\n                var re, im, h, a, d;\r\n                re = symbol.realpart();\r\n                im = symbol.imagpart();\r\n                h = Symbol.hyp(re, im);\r\n                a = _.add(re.clone(), h);\r\n                d = sqrt(_.multiply(new Symbol(2), a.clone()));\r\n                return _.add(_.divide(a.clone(), d.clone()), _.multiply(_.divide(im, d), Symbol.imaginary()));\r\n            },\r\n            log: function (r, i) {\r\n                var re, im, phi;\r\n                re = log(Symbol.hyp(r, i));\r\n                phi = Settings.USE_BIG ? Symbol(bigDec.atan2(i.multiplier.toDecimal(), r.multiplier.toDecimal())) : Math.atan2(i, r);\r\n                im = _.parse(phi);\r\n                return _.add(re, _.multiply(Symbol.imaginary(), im));\r\n            },\r\n            erf(symbol, n) {\r\n                //Do nothing for now. Revisit this in the future.\r\n                return _.symfunction('erf', [symbol]);\r\n\r\n                n = n || 30;\r\n\r\n                var f = function (R, I) {\r\n                    return block('PARSE2NUMBER', function () {\r\n                        var retval = new Symbol(0);\r\n                        for(var i = 0; i < n; i++) {\r\n                            var a, b;\r\n                            a = _.parse(bigDec.exp(bigDec(i).toPower(2).neg().dividedBy(bigDec(n).pow(2).plus(bigDec(R).toPower(2).times(4)))));\r\n                            b = _.parse(format('2*({1})-e^(-(2*{0}*{1}*{2}))*(2*{1}*cosh({2}*{3})-{0}*{3}*sinh({3}*{2}))', Settings.IMAGINARY, R, I, i));\r\n                            retval = _.add(retval, _.multiply(a, b));\r\n                        }\r\n                        return _.multiply(retval, new Symbol(2));\r\n                    }, true);\r\n                };\r\n                var re, im, a, b, c, k;\r\n                re = symbol.realpart();\r\n                im = symbol.imagpart();\r\n\r\n                k = _.parse(format('(e^(-{0}^2))/pi', re));\r\n                a = _.parse(format('(1-e^(-(2*{0}*{1}*{2})))/(2*{1})', Settings.IMAGINARY, re, im));\r\n                b = f(re.toString(), im.toString());\r\n\r\n                return _.add(_.parse(Math2.erf(re.toString())), _.multiply(k, _.add(a, b)));\r\n            },\r\n            removeDen: function (symbol) {\r\n                var den, r, i, re, im;\r\n                if(isArray(symbol)) {\r\n                    r = symbol[0];\r\n                    i = symbol[1];\r\n                }\r\n                else {\r\n                    r = symbol.realpart();\r\n                    i = symbol.imagpart();\r\n                }\r\n\r\n                den = Math.pow(r, 2) + Math.pow(i, 2);\r\n                re = _.parse(r / den);\r\n                im = _.parse(i / den);\r\n                return [re, im];\r\n            },\r\n            fromArray: function (arr) {\r\n                return _.add(arr[0], _.multiply(Symbol.imaginary(), arr[1]));\r\n            },\r\n            evaluate: function (symbol, f) {\r\n                var re, im, sign;\r\n\r\n                sign = symbol.power.sign();\r\n                //remove it from under the denominator\r\n                symbol.power = symbol.power.abs();\r\n                //expand\r\n                if(symbol.power.greaterThan(1))\r\n                    symbol = _.expand(symbol);\r\n                //remove the denominator\r\n                if(sign < 0) {\r\n                    var d = this.removeDen(symbol);\r\n                    re = d[0];\r\n                    im = d[1];\r\n                }\r\n                else {\r\n                    re = symbol.realpart();\r\n                    im = symbol.imagpart();\r\n                }\r\n\r\n                if(re.isConstant('all') && im.isConstant('all'))\r\n                    return this[f].call(this, re, im);\r\n\r\n                return _.symfunction(f, [symbol]);\r\n            }\r\n        };\r\n        //object for functions which handle trig\r\n        var trig = this.trig = {\r\n            //container for trigonometric function\r\n            cos: function (symbol) {\r\n                if(symbol.equals('pi') && symbol.multiplier.den.equals(2))\r\n                    return new Symbol(0);\r\n\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.equals(new Symbol(Settings.PI / 2)))\r\n                        return new Symbol(0);\r\n                    if(symbol.isConstant()) {\r\n                        if(Settings.USE_BIG) {\r\n                            return new Symbol(bigDec.cos(symbol.multiplier.toDecimal()));\r\n                        }\r\n\r\n                        return new Symbol(Math.cos(symbol.valueOf()));\r\n                    }\r\n                    if(symbol.isImaginary()) {\r\n                        return complex.evaluate(symbol, 'cos');\r\n                    }\r\n                }\r\n                if(symbol.equals(0))\r\n                    return new Symbol(1);\r\n\r\n                var retval,\r\n                        c = false,\r\n                        q = getQuadrant(symbol.multiplier.toDecimal()),\r\n                        m = symbol.multiplier.abs();\r\n                symbol.multiplier = m;\r\n\r\n                if(symbol.isPi() && symbol.isLinear()) {\r\n                    //return for 1 or -1 for multiples of pi\r\n                    if(isInt(m)) {\r\n                        retval = new Symbol(even(m) ? 1 : -1);\r\n                    }\r\n                    else {\r\n                        var n = Number(m.num), d = Number(m.den);\r\n                        if(d === 2)\r\n                            retval = new Symbol(0);\r\n                        else if(d === 3) {\r\n                            retval = _.parse('1/2');\r\n                            c = true;\r\n                        }\r\n                        else if(d === 4) {\r\n                            retval = _.parse('1/sqrt(2)');\r\n                            c = true;\r\n                        }\r\n                        else if(d === 6) {\r\n                            retval = _.parse('sqrt(3)/2');\r\n                            c = true;\r\n                        }\r\n                        else\r\n                            retval = _.symfunction('cos', [symbol]);\r\n                    }\r\n                }\r\n\r\n                if(c && (q === 2 || q === 3))\r\n                    retval.negate();\r\n\r\n                if(!retval)\r\n                    retval = _.symfunction('cos', [symbol]);\r\n\r\n                return retval;\r\n            },\r\n            sin: function (symbol) {\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant()) {\r\n                        if(symbol % Math.PI === 0) {\r\n                            return new Symbol(0);\r\n                        }\r\n\r\n                        if(Settings.USE_BIG) {\r\n                            return new Symbol(bigDec.sin(symbol.multiplier.toDecimal()));\r\n                        }\r\n\r\n                        return new Symbol(Math.sin(symbol.valueOf()));\r\n                    }\r\n                    if(symbol.isImaginary())\r\n                        return complex.evaluate(symbol, 'sin');\r\n                }\r\n\r\n                if(symbol.equals(0))\r\n                    return new Symbol(0);\r\n\r\n                var retval,\r\n                        c = false,\r\n                        q = getQuadrant(symbol.multiplier.toDecimal()),\r\n                        sign = symbol.multiplier.sign(),\r\n                        m = symbol.multiplier.abs();\r\n                symbol.multiplier = m;\r\n                if(symbol.equals('pi'))\r\n                    retval = new Symbol(0);\r\n                else if(symbol.isPi() && symbol.isLinear()) {\r\n                    //return for 0 for multiples of pi\r\n                    if(isInt(m)) {\r\n                        retval = new Symbol(0);\r\n                    }\r\n                    else {\r\n                        var n = m.num, d = m.den;\r\n                        if(d == 2) {\r\n                            retval = new Symbol(1);\r\n                            c = true;\r\n                        }\r\n                        else if(d == 3) {\r\n                            retval = _.parse('sqrt(3)/2');\r\n                            c = true\r\n                        }\r\n                        else if(d == 4) {\r\n                            retval = _.parse('1/sqrt(2)');\r\n                            c = true;\r\n                        }\r\n                        else if(d == 6) {\r\n                            retval = _.parse('1/2');\r\n                            c = true;\r\n                        }\r\n                        else\r\n                            retval = _.multiply(new Symbol(sign), _.symfunction('sin', [symbol]));\r\n                    }\r\n                }\r\n\r\n                if(!retval)\r\n                    retval = _.multiply(new Symbol(sign), _.symfunction('sin', [symbol]));\r\n\r\n                if(c && (q === 3 || q === 4))\r\n                    retval.negate();\r\n\r\n                return retval;\r\n            },\r\n            tan: function (symbol) {\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol % Math.PI === 0 && symbol.isLinear()) {\r\n                        return new Symbol(0);\r\n                    }\r\n                    if(symbol.isConstant()) {\r\n                        if(Settings.USE_BIG) {\r\n                            return new Symbol(bigDec.tan(symbol.multiplier.toDecimal()));\r\n                        }\r\n\r\n                        return new Symbol(Math.tan(symbol.valueOf()));\r\n                    }\r\n                    if(symbol.isImaginary())\r\n                        return complex.evaluate(symbol, 'tan');\r\n                }\r\n                var retval,\r\n                        c = false,\r\n                        q = getQuadrant(symbol.multiplier.toDecimal()),\r\n                        m = symbol.multiplier;\r\n\r\n                symbol.multiplier = m;\r\n\r\n                if(symbol.isPi() && symbol.isLinear()) {\r\n                    //return 0 for all multiples of pi\r\n                    if(isInt(m)) {\r\n                        retval = new Symbol(0);\r\n                    }\r\n                    else {\r\n                        var n = m.num, d = m.den;\r\n                        if(d == 2)\r\n                            throw new UndefinedError('tan is undefined for ' + symbol.toString());\r\n                        else if(d == 3) {\r\n                            retval = _.parse('sqrt(3)');\r\n                            c = true;\r\n                        }\r\n                        else if(d == 4) {\r\n                            retval = new Symbol(1);\r\n                            c = true;\r\n                        }\r\n                        else if(d == 6) {\r\n                            retval = _.parse('1/sqrt(3)');\r\n                            c = true;\r\n                        }\r\n                        else\r\n                            retval = _.symfunction('tan', [symbol]);\r\n                    }\r\n                }\r\n\r\n                if(!retval)\r\n                    retval = _.symfunction('tan', [symbol]);\r\n\r\n                if(c && (q === 2 || q === 4))\r\n                    retval.negate();\r\n\r\n                return retval;\r\n            },\r\n            sec: function (symbol) {\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant()) {\r\n                        if(Settings.USE_BIG) {\r\n                            return new Symbol(new bigDec(1).dividedBy(bigDec.cos(symbol.multiplier.toDecimal())));\r\n                        }\r\n\r\n                        return new Symbol(Math2.sec(symbol.valueOf()));\r\n                    }\r\n                    if(symbol.isImaginary())\r\n                        return complex.evaluate(symbol, 'sec');\r\n                    return _.parse(format('1/cos({0})', symbol));\r\n                }\r\n\r\n                var retval,\r\n                        c = false,\r\n                        q = getQuadrant(symbol.multiplier.toDecimal()),\r\n                        m = symbol.multiplier.abs();\r\n                symbol.multiplier = m;\r\n\r\n                if(symbol.isPi() && symbol.isLinear()) {\r\n                    //return for 1 or -1 for multiples of pi\r\n                    if(isInt(m)) {\r\n                        retval = new Symbol(even(m) ? 1 : -1);\r\n                    }\r\n                    else {\r\n                        var n = m.num, d = m.den;\r\n                        if(d == 2)\r\n                            throw new UndefinedError('sec is undefined for ' + symbol.toString());\r\n                        else if(d == 3) {\r\n                            retval = new Symbol(2);\r\n                            c = true;\r\n                        }\r\n                        else if(d == 4) {\r\n                            retval = _.parse('sqrt(2)');\r\n                            c = true;\r\n                        }\r\n                        else if(d == 6) {\r\n                            retval = _.parse('2/sqrt(3)');\r\n                            c = true;\r\n                        }\r\n                        else\r\n                            retval = _.symfunction('sec', [symbol]);\r\n                    }\r\n                }\r\n\r\n                if(c && (q === 2 || q === 3))\r\n                    retval.negate();\r\n\r\n                if(!retval)\r\n                    retval = _.symfunction('sec', [symbol]);\r\n\r\n                return retval;\r\n            },\r\n            csc: function (symbol) {\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant()) {\r\n                        if(Settings.USE_BIG) {\r\n                            return new Symbol(new bigDec(1).dividedBy(bigDec.sin(symbol.multiplier.toDecimal())));\r\n                        }\r\n\r\n                        return new Symbol(Math2.csc(symbol.valueOf()));\r\n                    }\r\n                    if(symbol.isImaginary())\r\n                        return complex.evaluate(symbol, 'csc');\r\n                    return _.parse(format('1/sin({0})', symbol));\r\n                }\r\n\r\n                var retval,\r\n                        c = false,\r\n                        q = getQuadrant(symbol.multiplier.toDecimal()),\r\n                        sign = symbol.multiplier.sign(),\r\n                        m = symbol.multiplier.abs();\r\n\r\n                symbol.multiplier = m;\r\n\r\n                if(symbol.isPi() && symbol.isLinear()) {\r\n                    //return for 0 for multiples of pi\r\n                    if(isInt(m)) {\r\n                        throw new UndefinedError('csc is undefined for ' + symbol.toString());\r\n                    }\r\n                    else {\r\n                        var n = m.num, d = m.den;\r\n                        if(d == 2) {\r\n                            retval = new Symbol(1);\r\n                            c = true;\r\n                        }\r\n                        else if(d == 3) {\r\n                            retval = _.parse('2/sqrt(3)');\r\n                            c = true\r\n                        }\r\n                        else if(d == 4) {\r\n                            retval = _.parse('sqrt(2)');\r\n                            c = true;\r\n                        }\r\n                        else if(d == 6) {\r\n                            retval = new Symbol(2);\r\n                            c = true;\r\n                        }\r\n                        else\r\n                            retval = _.multiply(new Symbol(sign), _.symfunction('csc', [symbol]));\r\n                    }\r\n                }\r\n\r\n                if(!retval)\r\n                    retval = _.multiply(new Symbol(sign), _.symfunction('csc', [symbol]));\r\n\r\n                if(c && (q === 3 || q === 4))\r\n                    retval.negate();\r\n\r\n                return retval;\r\n            },\r\n            cot: function (symbol) {\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol % (Math.PI/2) === 0) {\r\n                        return new Symbol(0);\r\n                    }\r\n                    if(symbol.isConstant()) {\r\n                        if(Settings.USE_BIG) {\r\n                            return new Symbol(new bigDec(1).dividedBy(bigDec.tan(symbol.multiplier.toDecimal())));\r\n                        }\r\n\r\n                        return new Symbol(Math2.cot(symbol.valueOf()));\r\n                    }\r\n                    if(symbol.isImaginary())\r\n                        return complex.evaluate(symbol, 'cot');\r\n                    return _.parse(format('1/tan({0})', symbol));\r\n                }\r\n                var retval,\r\n                        c = false,\r\n                        q = getQuadrant(symbol.multiplier.toDecimal()),\r\n                        m = symbol.multiplier;\r\n\r\n                symbol.multiplier = m;\r\n\r\n                if(symbol.isPi() && symbol.isLinear()) {\r\n                    //return 0 for all multiples of pi\r\n                    if(isInt(m)) {\r\n                        throw new UndefinedError('cot is undefined for ' + symbol.toString());\r\n                    }\r\n                    else {\r\n                        var n = m.num, d = m.den;\r\n                        if(d == 2)\r\n                            retval = new Symbol(0);\r\n                        else if(d == 3) {\r\n                            retval = _.parse('1/sqrt(3)');\r\n                            c = true;\r\n                        }\r\n                        else if(d == 4) {\r\n                            retval = new Symbol(1);\r\n                            c = true;\r\n                        }\r\n                        else if(d == 6) {\r\n                            retval = _.parse('sqrt(3)');\r\n                            c = true;\r\n                        }\r\n                        else\r\n                            retval = _.symfunction('cot', [symbol]);\r\n                    }\r\n                }\r\n\r\n                if(!retval)\r\n                    retval = _.symfunction('cot', [symbol]);\r\n\r\n                if(c && (q === 2 || q === 4))\r\n                    retval.negate();\r\n\r\n                return retval;\r\n            },\r\n            acos: function (symbol) {\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant()) {\r\n                        // Handle values in the complex domain\r\n                        if(symbol.gt(1) || symbol.lt(-1)) {\r\n                            var x = symbol.toString();\r\n                            return expand(evaluate(`pi/2-asin(${x})`));\r\n                        }\r\n                        // Handle big numbers\r\n                        if(Settings.USE_BIG) {\r\n                            return new Symbol(bigDec.acos(symbol.multiplier.toDecimal()));\r\n                        }\r\n\r\n                        return new Symbol(Math.acos(symbol.valueOf()));\r\n                    }\r\n                    if(symbol.isImaginary())\r\n                        return complex.evaluate(symbol, 'acos');\r\n                }\r\n                return _.symfunction('acos', arguments);\r\n            },\r\n            asin: function (symbol) {\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant()) {\r\n                        // Handle values in the complex domain\r\n                        if(symbol.gt(1) || symbol.lt(-1)) {\r\n                            var i = Settings.IMAGINARY;\r\n                            var x = symbol.multiplier.toDecimal();\r\n                            return expand(evaluate(`${i}*log(sqrt(1-${x}^2)-${i}*${x})`));\r\n                        }\r\n                        // Handle big numbers\r\n                        if(Settings.USE_BIG) {\r\n                            return new Symbol(bigDec.asin(symbol.multiplier.toDecimal()));\r\n                        }\r\n\r\n                        return new Symbol(Math.asin(symbol.valueOf()));\r\n                    }\r\n                    if(symbol.isImaginary())\r\n                        return complex.evaluate(symbol, 'asin');\r\n                }\r\n                return _.symfunction('asin', arguments);\r\n            },\r\n            atan: function (symbol) {\r\n                var retval;\r\n                if(symbol.equals(0))\r\n                    retval = new Symbol(0);\r\n                else if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant()) {\r\n                        // Handle big numbers\r\n                        if(Settings.USE_BIG) {\r\n                            return new Symbol(bigDec.atan(symbol.multiplier.toDecimal()));\r\n                        }\r\n\r\n                        return new Symbol(Math.atan(symbol.valueOf()));\r\n                    }\r\n                    if(symbol.isImaginary())\r\n                        return complex.evaluate(symbol, 'atan');\r\n                    return _.symfunction('atan', arguments);\r\n                }\r\n                else if(symbol.equals(-1))\r\n                    retval = _.parse('-pi/4');\r\n                else\r\n                    retval = _.symfunction('atan', arguments);\r\n                return retval;\r\n            },\r\n            asec: function (symbol) {\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.equals(0)) {\r\n                        throw new OutOfFunctionDomainError('Input is out of the domain of sec!');\r\n                    }\r\n                    if(symbol.isConstant()) {\r\n                        return trig.acos(symbol.invert());\r\n                    }\r\n                    if(symbol.isImaginary()) {\r\n                        return complex.evaluate(symbol, 'asec');\r\n                    }\r\n                }\r\n                return _.symfunction('asec', arguments);\r\n            },\r\n            acsc: function (symbol) {\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant()) {\r\n                        return trig.asin(symbol.invert());\r\n                    }\r\n\r\n                    if(symbol.isImaginary())\r\n                        return complex.evaluate(symbol, 'acsc');\r\n                }\r\n                return _.symfunction('acsc', arguments);\r\n            },\r\n            acot: function (symbol) {\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant()) {\r\n                        return new _.add(_.parse('pi/2'), trig.atan(symbol).negate());\r\n                    }\r\n\r\n                    if(symbol.isImaginary())\r\n                        return complex.evaluate(symbol, 'acot');\r\n                }\r\n                return _.symfunction('acot', arguments);\r\n            },\r\n            atan2: function (a, b) {\r\n                if(a.equals(0) && b.equals(0))\r\n                    throw new UndefinedError('atan2 is undefined for 0, 0');\r\n\r\n                if(Settings.PARSE2NUMBER && a.isConstant() && b.isConstant()) {\r\n                    return new Symbol(Math.atan2(a, b));\r\n                }\r\n                return _.symfunction('atan2', arguments);\r\n            }\r\n        };\r\n        //object for functions which handle hyperbolic trig\r\n        var trigh = this.trigh = {\r\n            //container for hyperbolic trig function\r\n            cosh: function (symbol) {\r\n                var retval;\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant())\r\n                        return new Symbol(Math.cosh(symbol.valueOf()));\r\n                    if(symbol.isImaginary()) {\r\n                        return complex.evaluate(symbol, 'cosh');\r\n                    }\r\n                }\r\n\r\n                return retval = _.symfunction('cosh', arguments);\r\n            },\r\n            sinh: function (symbol) {\r\n                var retval;\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant())\r\n                        return new Symbol(Math.sinh(symbol.valueOf()));\r\n                    if(symbol.isImaginary()) {\r\n                        return complex.evaluate(symbol, 'sinh');\r\n                    }\r\n                }\r\n\r\n                return retval = _.symfunction('sinh', arguments);\r\n            },\r\n            tanh: function (symbol) {\r\n                var retval;\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant())\r\n                        return new Symbol(Math.tanh(symbol.valueOf()));\r\n                    if(symbol.isImaginary()) {\r\n                        return complex.evaluate(symbol, 'tanh');\r\n                    }\r\n                }\r\n\r\n                return retval = _.symfunction('tanh', arguments);\r\n            },\r\n            sech: function (symbol) {\r\n                var retval;\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant()) {\r\n                        return new Symbol(Math.sech(symbol.valueOf()));\r\n                    }\r\n                    if(symbol.isImaginary()) {\r\n                        return complex.evaluate(symbol, 'sech');\r\n                    }\r\n                    return _.parse(format('1/cosh({0})', symbol));\r\n                }\r\n\r\n                return retval = _.symfunction('sech', arguments);\r\n            },\r\n            csch: function (symbol) {\r\n                var retval;\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant())\r\n                        return new Symbol(Math.csch(symbol.valueOf()));\r\n                    if(symbol.isImaginary()) {\r\n                        return complex.evaluate(symbol, 'csch');\r\n                    }\r\n                    return _.parse(format('1/sinh({0})', symbol));\r\n                }\r\n\r\n                return retval = _.symfunction('csch', arguments);\r\n            },\r\n            coth: function (symbol) {\r\n                var retval;\r\n                if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.isConstant())\r\n                        return new Symbol(Math.coth(symbol.valueOf()));\r\n                    if(symbol.isImaginary()) {\r\n                        return complex.evaluate(symbol, 'coth');\r\n                    }\r\n                    return _.parse(format('1/tanh({0})', symbol));\r\n                }\r\n\r\n                return retval = _.symfunction('coth', arguments);\r\n            },\r\n            acosh: function (symbol) {\r\n                var retval;\r\n                if(Settings.PARSE2NUMBER && symbol.isImaginary())\r\n                    retval = complex.evaluate(symbol, 'acosh');\r\n                else if(Settings.PARSE2NUMBER)\r\n                    retval = evaluate(_.parse(format(Settings.LOG + '(({0})+sqrt(({0})^2-1))', symbol.toString())));\r\n                else\r\n                    retval = _.symfunction('acosh', arguments);\r\n                return retval;\r\n            },\r\n            asinh: function (symbol) {\r\n                var retval;\r\n                if(Settings.PARSE2NUMBER && symbol.isImaginary())\r\n                    retval = complex.evaluate(symbol, 'asinh');\r\n                else if(Settings.PARSE2NUMBER)\r\n                    retval = evaluate(_.parse(format(Settings.LOG + '(({0})+sqrt(({0})^2+1))', symbol.toString())));\r\n                else\r\n                    retval = _.symfunction('asinh', arguments);\r\n                return retval;\r\n            },\r\n            atanh: function (symbol) {\r\n                var retval;\r\n                if(Settings.PARSE2NUMBER && symbol.isImaginary())\r\n                    retval = complex.evaluate(symbol, 'atanh');\r\n                else if(Settings.PARSE2NUMBER) {\r\n                    retval = evaluate(_.parse(format('(1/2)*' + Settings.LOG + '((1+({0}))/(1-({0})))', symbol.toString())));\r\n                }\r\n                else\r\n                    retval = _.symfunction('atanh', arguments);\r\n                return retval;\r\n            },\r\n            asech: function (symbol) {\r\n                var retval;\r\n                if(Settings.PARSE2NUMBER && symbol.isImaginary())\r\n                    retval = complex.evaluate(symbol, 'asech');\r\n                else if(Settings.PARSE2NUMBER)\r\n                    retval = evaluate(log(_.add(symbol.clone().invert(), sqrt(_.subtract(_.pow(symbol, new Symbol(-2)), new Symbol(1))))));\r\n                else\r\n                    retval = _.symfunction('asech', arguments);\r\n                return retval;\r\n            },\r\n            acsch: function (symbol) {\r\n                var retval;\r\n                if(Settings.PARSE2NUMBER && symbol.isImaginary())\r\n                    retval = complex.evaluate(symbol, 'acsch');\r\n                else if(Settings.PARSE2NUMBER)\r\n                    retval = evaluate(_.parse(format(Settings.LOG + '((1+sqrt(1+({0})^2))/({0}))', symbol.toString())));\r\n                else\r\n                    retval = _.symfunction('acsch', arguments);\r\n                return retval;\r\n            },\r\n            acoth: function (symbol) {\r\n                var retval;\r\n                if(Settings.PARSE2NUMBER && symbol.isImaginary())\r\n                    retval = complex.evaluate(symbol, 'acoth');\r\n                else if(Settings.PARSE2NUMBER) {\r\n                    if(symbol.equals(1))\r\n                        retval = Symbol.infinity();\r\n                    else\r\n                        retval = evaluate(\r\n                                _.divide(\r\n                                        log(_.divide(_.add(symbol.clone(), new Symbol(1)), _.subtract(symbol.clone(), new Symbol(1)))),\r\n                                        new Symbol(2)));\r\n                }\r\n                else\r\n                    retval = _.symfunction('acoth', arguments);\r\n                return retval;\r\n            }\r\n        };\r\n        //list of supported units\r\n        this.units = {};\r\n        //list all the supported operators\r\n        var operators = {\r\n            '\\\\': {\r\n                precedence: 8,\r\n                operator: '\\\\',\r\n                action: 'slash',\r\n                prefix: true,\r\n                postfix: false,\r\n                leftAssoc: true,\r\n                operation: function (e) {\r\n                    return e; //bypass the slash\r\n                }\r\n            },\r\n            '!!': {\r\n                precedence: 7,\r\n                operator: '!!',\r\n                action: 'dfactorial',\r\n                prefix: false,\r\n                postfix: true,\r\n                leftAssoc: true,\r\n                operation: function (e) {\r\n                    return _.symfunction(Settings.DOUBLEFACTORIAL, [e]); //wrap it in a factorial function\r\n                }\r\n            },\r\n            '!': {\r\n                precedence: 7,\r\n                operator: '!',\r\n                action: 'factorial',\r\n                prefix: false,\r\n                postfix: true,\r\n                leftAssoc: true,\r\n                operation: function (e) {\r\n                    return factorial(e); //wrap it in a factorial function\r\n                }\r\n            },\r\n            '^': {\r\n                precedence: 6,\r\n                operator: '^',\r\n                action: 'pow',\r\n                prefix: false,\r\n                postfix: false,\r\n                leftAssoc: true\r\n            },\r\n            '**': {\r\n                precedence: 6,\r\n                operator: '**',\r\n                action: 'pow',\r\n                prefix: false,\r\n                postfix: false,\r\n                leftAssoc: true\r\n            },\r\n            '%': {\r\n                precedence: 4,\r\n                operator: '%',\r\n                action: 'percent',\r\n                prefix: false,\r\n                postfix: true,\r\n                leftAssoc: true,\r\n                overloaded: true,\r\n                overloadAction: 'mod',\r\n                overloadLeftAssoc: false,\r\n                operation: function (x) {\r\n                    return _.divide(x, new Symbol(100));\r\n                }\r\n            },\r\n            '*': {\r\n                precedence: 4,\r\n                operator: '*',\r\n                action: 'multiply',\r\n                prefix: false,\r\n                postfix: false,\r\n                leftAssoc: false\r\n            },\r\n            '/': {\r\n                precedence: 4,\r\n                operator: '/',\r\n                action: 'divide',\r\n                prefix: false,\r\n                postfix: false,\r\n                leftAssoc: false\r\n            },\r\n            '+': {\r\n                precedence: 3,\r\n                operator: '+',\r\n                action: 'add',\r\n                prefix: true,\r\n                postfix: false,\r\n                leftAssoc: false,\r\n                operation: function (x) {\r\n                    return x;\r\n                }\r\n            },\r\n            'plus': {\r\n                precedence: 3,\r\n                operator: 'plus',\r\n                action: 'add',\r\n                prefix: true,\r\n                postfix: false,\r\n                leftAssoc: false,\r\n                operation: function (x) {\r\n                    return x;\r\n                }\r\n            },\r\n            '-': {\r\n                precedence: 3,\r\n                operator: '-',\r\n                action: 'subtract',\r\n                prefix: true,\r\n                postfix: false,\r\n                leftAssoc: false,\r\n                operation: function (x) {\r\n                    return x.negate();\r\n                }\r\n            },\r\n            '=': {\r\n                precedence: 2,\r\n                operator: '=',\r\n                action: 'equals',\r\n                prefix: false,\r\n                postfix: false,\r\n                leftAssoc: false\r\n            },\r\n            '==': {\r\n                precedence: 1,\r\n                operator: '==',\r\n                action: 'eq',\r\n                prefix: false,\r\n                postfix: false,\r\n                leftAssoc: false\r\n            },\r\n            '<': {\r\n                precedence: 1,\r\n                operator: '<',\r\n                action: 'lt',\r\n                prefix: false,\r\n                postfix: false,\r\n                leftAssoc: false\r\n            },\r\n            '<=': {\r\n                precedence: 1,\r\n                operator: '<=',\r\n                action: 'lte',\r\n                prefix: false,\r\n                postfix: false,\r\n                leftAssoc: false\r\n            },\r\n            '>': {\r\n                precedence: 1,\r\n                operator: '>',\r\n                action: 'gt',\r\n                prefix: false,\r\n                postfix: false,\r\n                leftAssoc: false\r\n            },\r\n            '=>': {\r\n                precedence: 1,\r\n                operator: '=>',\r\n                action: 'gte',\r\n                prefix: false,\r\n                postfix: false,\r\n                leftAssoc: false\r\n            },\r\n            ',': {\r\n                precedence: 0,\r\n                operator: ',',\r\n                action: 'comma',\r\n                prefix: false,\r\n                postfix: false,\r\n                leftAssoc: false\r\n            },\r\n            ':': {\r\n                precedence: 0,\r\n                operator: ',',\r\n                action: 'assign',\r\n                prefix: false,\r\n                postfix: false,\r\n                leftAssoc: false,\r\n                vectorFn: 'slice'\r\n            },\r\n            ':=': {\r\n                precedence: 0,\r\n                operator: ',',\r\n                action: 'function_assign',\r\n                prefix: false,\r\n                postfix: false,\r\n                leftAssoc: true\r\n            }\r\n        };\r\n        //brackets\r\n        var brackets = {\r\n            '(': {\r\n                type: 'round',\r\n                id: 1,\r\n                is_open: true,\r\n                is_close: false\r\n            },\r\n            ')': {\r\n                type: 'round',\r\n                id: 2,\r\n                is_open: false,\r\n                is_close: true\r\n            },\r\n            '[': {\r\n                type: 'square',\r\n                id: 3,\r\n                is_open: true,\r\n                is_close: false,\r\n                maps_to: 'vector'\r\n            },\r\n            ']': {\r\n                type: 'square',\r\n                id: 4,\r\n                is_open: false,\r\n                is_close: true\r\n            },\r\n            '{': {\r\n                type: 'curly',\r\n                id: 5,\r\n                is_open: true,\r\n                is_close: false,\r\n                maps_to: 'Set'\r\n            },\r\n            '}': {\r\n                type: 'curly',\r\n                id: 6,\r\n                is_open: false,\r\n                is_close: true\r\n            }\r\n        };\r\n        // Supported functions.\r\n        // Format: function_name: [mapped_function, number_of_parameters]\r\n        var functions = this.functions = {\r\n            'cos': [trig.cos, 1],\r\n            'sin': [trig.sin, 1],\r\n            'tan': [trig.tan, 1],\r\n            'sec': [trig.sec, 1],\r\n            'csc': [trig.csc, 1],\r\n            'cot': [trig.cot, 1],\r\n            'acos': [trig.acos, 1],\r\n            'asin': [trig.asin, 1],\r\n            'atan': [trig.atan, 1],\r\n            'arccos': [trig.acos, 1],\r\n            'arcsin': [trig.asin, 1],\r\n            'arctan': [trig.atan, 1],\r\n            'asec': [trig.asec, 1],\r\n            'acsc': [trig.acsc, 1],\r\n            'acot': [trig.acot, 1],\r\n            'atan2': [trig.atan2, 2],\r\n            'acoth': [trigh.acoth, 1],\r\n            'asech': [trigh.asech, 1],\r\n            'acsch': [trigh.acsch, 1],\r\n            'sinh': [trigh.sinh, 1],\r\n            'cosh': [trigh.cosh, 1],\r\n            'tanh': [trigh.tanh, 1],\r\n            'asinh': [trigh.asinh, 1],\r\n            'sech': [trigh.sech, 1],\r\n            'csch': [trigh.csch, 1],\r\n            'coth': [trigh.coth, 1],\r\n            'acosh': [trigh.acosh, 1],\r\n            'atanh': [trigh.atanh, 1],\r\n            'log10': [, 1],\r\n            'exp': [exp, 1],\r\n            'radians': [radians, 1],\r\n            'degrees': [degrees, 1],\r\n            'min': [min, -1],\r\n            'max': [max, -1],\r\n            'erf': [, 1],\r\n            'floor': [, 1],\r\n            'ceil': [, 1],\r\n            'trunc': [, 1],\r\n            'Si': [, 1],\r\n            'step': [, 1],\r\n            'rect': [, 1],\r\n            'sinc': [sinc, 1],\r\n            'tri': [, 1],\r\n            'sign': [sign, 1],\r\n            'Ci': [, 1],\r\n            'Ei': [, 1],\r\n            'Shi': [, 1],\r\n            'Chi': [, 1],\r\n            'Li': [, 1],\r\n            'fib': [, 1],\r\n            'fact': [factorial, 1],\r\n            'factorial': [factorial, 1],\r\n            'continued_fraction': [continued_fraction, [1, 2]],\r\n            'dfactorial': [, 1],\r\n            'gamma_incomplete': [, [1, 2]],\r\n            'round': [round, [1, 2]],\r\n            'scientific': [scientific, [1, 2]],\r\n            'mod': [mod, 2],\r\n            'pfactor': [pfactor, 1],\r\n            'vector': [vector, -1],\r\n            'matrix': [matrix, -1],\r\n            'Set': [set, -1],\r\n            'imatrix': [imatrix, -1],\r\n            'parens': [parens, -1],\r\n            'sqrt': [sqrt, 1],\r\n            'cbrt': [cbrt, 1],\r\n            'nthroot': [nthroot, 2],\r\n            'log': [log, [1, 2]],\r\n            'expand': [expandall, 1],\r\n            'abs': [abs, 1],\r\n            'invert': [invert, 1],\r\n            'determinant': [determinant, 1],\r\n            'size': [size, 1],\r\n            'transpose': [transpose, 1],\r\n            'dot': [dot, 2],\r\n            'cross': [cross, 2],\r\n            'vecget': [vecget, 2],\r\n            'vecset': [vecset, 3],\r\n            'vectrim': [vectrim, [1, 2]],\r\n            'matget': [matget, 3],\r\n            'matset': [matset, 4],\r\n            'matgetrow': [matgetrow, 2],\r\n            'matsetrow': [matsetrow, 3],\r\n            'matgetcol': [matgetcol, 2],\r\n            'matsetcol': [matsetcol, 3],\r\n            'rationalize': [rationalize, 1],\r\n            'IF': [IF, 3],\r\n            'is_in': [is_in, 2],\r\n            //imaginary support\r\n            'realpart': [realpart, 1],\r\n            'imagpart': [imagpart, 1],\r\n            'conjugate': [conjugate, 1],\r\n            'arg': [arg, 1],\r\n            'polarform': [polarform, 1],\r\n            'rectform': [rectform, 1],\r\n            'sort': [sort, [1, 2]],\r\n            'integer_part': [, 1],\r\n            'union': [union, 2],\r\n            'contains': [contains, 2],\r\n            'intersection': [intersection, 2],\r\n            'difference': [difference, 2],\r\n            'intersects': [intersects, 2],\r\n            'is_subset': [is_subset, 2],\r\n            //system support\r\n            'print': [print, -1]\r\n        };\r\n\r\n        //error handler\r\n        this.error = err;\r\n        //this function is used to comb through the function modules and find a function given its name\r\n        var findFunction = function (fname) {\r\n            var fmodules = Settings.FUNCTION_MODULES,\r\n                    l = fmodules.length;\r\n            for(var i = 0; i < l; i++) {\r\n                var fmodule = fmodules[i];\r\n                if(fname in fmodule)\r\n                    return fmodule[fname];\r\n            }\r\n            err('The function ' + fname + ' is undefined!');\r\n        };\r\n\r\n        /**\r\n         * This method gives the ability to override operators with new methods.\r\n         * @param {String} which\r\n         * @param {Function} with_what\r\n         */\r\n        this.override = function (which, with_what) {\r\n            if(!bin[which])\r\n                bin[which] = [];\r\n            bin[which].push(this[which]);\r\n            this[which] = with_what;\r\n        };\r\n\r\n        /**\r\n         * Restores a previously overridden operator\r\n         * @param {String} what\r\n         */\r\n        this.restore = function (what) {\r\n            if(this[what])\r\n                this[what] = bin[what].pop();\r\n        };\r\n\r\n        /**\r\n         * This method is supposed to behave similarly to the override method but it does not override\r\n         * the existing function rather it only extends it\r\n         * @param {String} what\r\n         * @param {Function} with_what\r\n         * @param {boolean} force_call\r\n         */\r\n        this.extend = function (what, with_what, force_call) {\r\n            var _ = this,\r\n                    extended = this[what];\r\n            if(typeof extended === 'function' && typeof with_what === 'function') {\r\n                var f = this[what];\r\n                this[what] = function (a, b) {\r\n                    if(isSymbol(a) && isSymbol(b) && !force_call)\r\n                        return f.call(_, a, b);\r\n                    else\r\n                        return with_what.call(_, a, b, f);\r\n                };\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Generates library's representation of a function. It's a fancy way of saying a symbol with\r\n         * a few extras. The most important thing is that that it gives a fname and\r\n         * an args property to the symbols in addition to changing its group to FN\r\n         * @param {String} fn_name\r\n         * @param {Array} params\r\n         * @returns {Symbol}\r\n         */\r\n        this.symfunction = function (fn_name, params) {\r\n            //call the proper function and return the result;\r\n            var f = new Symbol(fn_name);\r\n            f.group = FN;\r\n            if(typeof params === 'object')\r\n                params = [].slice.call(params);//ensure an array\r\n            f.args = params;\r\n            f.fname = fn_name === PARENTHESIS ? '' : fn_name;\r\n            f.updateHash();\r\n            return f;\r\n        };\r\n\r\n        /**\r\n         * An internal function call for the Parser. This will either trigger a real\r\n         * function call if it can do so or just return a symbolic representation of the\r\n         * function using symfunction.\r\n         * @param {String} fn_name\r\n         * @param {Array} args\r\n         * @param {int} allowed_args\r\n         * @returns {Symbol}\r\n         */\r\n        this.callfunction = function (fn_name, args, allowed_args) {\r\n            var fn_settings = functions[fn_name];\r\n\r\n            if(!fn_settings)\r\n                err('Nerdamer currently does not support the function ' + fn_name);\r\n\r\n            var num_allowed_args = fn_settings[1] || allowed_args, //get the number of allowed arguments\r\n                    fn = fn_settings[0], //get the mapped function\r\n                    retval;\r\n            //We want to be able to call apply on the arguments or create a symfunction. Both require\r\n            //an array so make sure to wrap the argument in an array.\r\n            if(!(args instanceof Array))\r\n                args = args !== undefined ? [args] : [];\r\n\r\n            if(num_allowed_args !== -1) {\r\n                var is_array = isArray(num_allowed_args),\r\n                        min_args = is_array ? num_allowed_args[0] : num_allowed_args,\r\n                        max_args = is_array ? num_allowed_args[1] : num_allowed_args,\r\n                        num_args = args.length;\r\n\r\n                var error_msg = fn_name + ' requires a {0} of {1} arguments. {2} provided!';\r\n\r\n                if(num_args < min_args)\r\n                    err(format(error_msg, 'minimum', min_args, num_args));\r\n                if(num_args > max_args)\r\n                    err(format(error_msg, 'maximum', max_args, num_args));\r\n            }\r\n\r\n            /*\r\n             * The following are very important to the how nerdamer constructs functions!\r\n             * Assumption 1 - if fn is undefined then handling of the function is purely numeric. This\r\n             *     enables us to reuse Math, Math2, ..., any function from Settings.FUNCTIONS_MODULES entry\r\n             * Assumption 2 - if fn is defined then that function takes care of EVERYTHING including symbolics\r\n             * Assumption 3 - if the user calls symbolics on a function that returns a numeric value then\r\n             *     they are expecting a symbolic output.\r\n             */\r\n            //check if arguments are all numers\r\n            var numericArgs = allNumbers(args);\r\n            //Big number support. Check if Big number is requested and the arguments are all numeric and, not imaginary\r\n//            if (Settings.USE_BIG && numericArgs) {\r\n//                retval = Big[fn_name].apply(undefined, args);\r\n//            }\r\n//            else {\r\n            if(!fn) {\r\n                //Remember assumption 1. No function defined so it MUST be numeric in nature\r\n                fn = findFunction(fn_name);\r\n                if(Settings.PARSE2NUMBER && numericArgs)\r\n                    retval = bigConvert(fn.apply(fn, args));\r\n                else\r\n                    retval = _.symfunction(fn_name, args);\r\n            }\r\n            else {\r\n                //Remember assumption 2. The function is defined so it MUST handle all aspects including numeric values\r\n                retval = fn.apply(fn_settings[2], args);\r\n            }\r\n//            }\r\n\r\n            return retval;\r\n        };\r\n        /**\r\n         * Build a regex based on the operators currently loaded. These operators are to be ignored when\r\n         * substituting spaces for multiplication\r\n         */\r\n        this.operator_filter_regex = (function () {\r\n            //we only want the operators which are singular since those are the ones\r\n            //that nerdamer uses anyway\r\n            var ostr = '^\\\\' + Object.keys(operators).filter(function (x) {\r\n                if(x.length === 1)\r\n                    return x;\r\n            }).join('\\\\');\r\n            //create a regex which captures all spaces between characters except those\r\n            //have an operator on one end\r\n            return new RegExp('([' + ostr + '])\\\\s+([' + ostr + '])');\r\n        })();\r\n\r\n        /**\r\n         * Replaces nerdamer.setOperator\r\n         * @param {object} operator\r\n         * @param {boolean} shift\r\n         */\r\n        this.setOperator = function (operator, action, shift) {\r\n            var name = operator.operator; //take the name to be the symbol\r\n            operators[name] = operator;\r\n            if(action)\r\n                this[operator.action] = action;\r\n            //make the parser aware of the operator\r\n            _[name] = operator.operation;\r\n            //make the action available to the parser if infix\r\n            if(!operator.action && !(operator.prefix || operator.postif)) {\r\n                operator.action = name;\r\n            }\r\n            //if this operator is exclusive then all successive operators should be shifted\r\n            if(shift === 'over' || shift === 'under') {\r\n                var precedence = operator.precedence;\r\n\r\n                for(var x in operators) {\r\n                    var o = operators[x];\r\n                    var condition = shift === 'over' ? o.precedence >= precedence : o.precedence > precedence;\r\n                    if(condition)\r\n                        o.precedence++;\r\n                }\r\n                ;\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Gets an opererator by its symbol\r\n         * @param {String} operator\r\n         * @returns {Object}\r\n         */\r\n        this.getOperator = function (operator) {\r\n            return operators[operator];\r\n        };\r\n\r\n        this.aliasOperator = function (o, n) {\r\n            var t = {};\r\n            var operator = operators[o];\r\n            //copy everything over to the new operator\r\n            for(var x in operator) {\r\n                t[x] = operator[x];\r\n            }\r\n            //update the symbol\r\n            t.operator = n;\r\n\r\n            this.setOperator(t);\r\n        };\r\n\r\n        /**\r\n         * Returns the list of operators. Caution! Can break parser!\r\n         * @returns {object}\r\n         */\r\n        this.getOperators = function () {\r\n            //will replace this with some cloning action in the future\r\n            return operators;\r\n        };\r\n\r\n        this.getBrackets = function () {\r\n            return brackets;\r\n        };\r\n        /*\r\n         * Preforms preprocessing on the string. Useful for making early modification before\r\n         * sending to the parser\r\n         * @param {String} e\r\n         */\r\n        var prepare_expression = function (e) {\r\n            /*\r\n             * Since variables cannot start with a number, the assumption is made that when this occurs the\r\n             * user intents for this to be a coefficient. The multiplication symbol in then added. The same goes for\r\n             * a side-by-side close and open parenthesis\r\n             */\r\n            e = String(e);\r\n            //apply preprocessors\r\n            for(var i = 0; i < preprocessors.actions.length; i++)\r\n                e = preprocessors.actions[i].call(this, e);\r\n\r\n            //e = e.split(' ').join('');//strip empty spaces\r\n            //replace multiple spaces with one space\r\n            e = e.replace(/\\s+/g, ' ');\r\n\r\n            //only even bother to check if the string contains e. This regex is painfully slow and might need a better solution. e.g. hangs on (0.06/3650))^(365)\r\n            if(/e/gi.test(e)) {\r\n                e = e.replace(/\\-*\\d+\\.*\\d*e\\+?\\-?\\d+/gi, function (x) {\r\n                    return scientificToDecimal(x);\r\n                });\r\n            }\r\n            //replace scientific numbers\r\n\r\n            //allow omission of multiplication after coefficients\r\n            e = e.replace(Settings.IMPLIED_MULTIPLICATION_REGEX, function () {\r\n                var str = arguments[4],\r\n                        group1 = arguments[1],\r\n                        group2 = arguments[2],\r\n                        start = arguments[3],\r\n                        first = str.charAt(start),\r\n                        before = '',\r\n                        d = '*';\r\n                if(!first.match(/[\\+\\-\\/\\*]/))\r\n                    before = str.charAt(start - 1);\r\n                if(before.match(/[a-z]/i))\r\n                    d = '';\r\n                return group1 + d + group2;\r\n            })\r\n                    .replace(/([a-z0-9_]+)/gi, function (match, a) {\r\n                        if(Settings.USE_MULTICHARACTER_VARS === false && !(a in functions)) {\r\n                            if(!isNaN(a))\r\n                                return a;\r\n                            return a.split('').join('*');\r\n                        }\r\n                        return a;\r\n                    })\r\n                    //allow omission of multiplication sign between brackets\r\n                    .replace(/\\)\\(/g, ')*(') || '0';\r\n            //replace x(x+a) with x*(x+a)\r\n            while(true) {\r\n                var e_org = e; //store the original\r\n                e = e.replace(/([a-z0-9_]+)(\\()|(\\))([a-z0-9]+)/gi, function (match, a, b, c, d) {\r\n                    var g1 = a || c,\r\n                            g2 = b || d;\r\n                    if(g1 in functions) //create a passthrough for functions\r\n                        return g1 + g2;\r\n                    return g1 + '*' + g2;\r\n                });\r\n                //if the original equals the replace we're done\r\n                if(e_org === e)\r\n                    break;\r\n            }\r\n            return e;\r\n        };\r\n        //delay setting of constants until Settings is ready\r\n        this.initConstants = function () {\r\n            this.CONSTANTS = {\r\n                E: new Symbol(Settings.E),\r\n                PI: new Symbol(Settings.PI)\r\n            };\r\n        };\r\n        /*\r\n         * Debugging method used to better visualize vector and arrays\r\n         * @param {object} o\r\n         * @returns {String}\r\n         */\r\n        this.pretty_print = function (o) {\r\n            if(Array.isArray(o)) {\r\n                var s = o.map(x => _.pretty_print(x)).join(', ');\r\n                if(o.type === 'vector')\r\n                    return 'vector<' + s + '>';\r\n                return '(' + s + ')';\r\n            }\r\n            return o.toString();\r\n        };\r\n        this.peekers = {\r\n            pre_operator: [],\r\n            post_operator: [],\r\n            pre_function: [],\r\n            post_function: []\r\n        };\r\n\r\n        this.callPeekers = function (name) {\r\n            if(Settings.callPeekers) {\r\n                var peekers = this.peekers[name];\r\n                //remove the first items and stringify\r\n                var args = arguments2Array(arguments).slice(1).map(stringify);\r\n                //call each one of the peekers\r\n                for(var i = 0; i < peekers.length; i++) {\r\n                    peekers[i].apply(null, args);\r\n                }\r\n            }\r\n        };\r\n        /*\r\n         * Tokenizes the string\r\n         * @param {String} e\r\n         * @returns {Token[]}\r\n         */\r\n        this.tokenize = function (e) {\r\n            //cast to String\r\n            e = String(e);\r\n            //remove multiple white spaces and spaces at beginning and end of string\r\n            e = e.trim().replace(/\\s+/g, ' ');\r\n            //remove spaces before and after brackets\r\n            for(var x in brackets) {\r\n                var regex = new RegExp(brackets[x].is_close ? '\\\\s+\\\\' + x : '\\\\' + x + '\\\\s+', 'g');\r\n                e = e.replace(regex, x);\r\n            }\r\n\r\n            var col = 0; //the column position\r\n            var L = e.length; //expression length\r\n            var lpos = 0; //marks beginning of next token\r\n            var tokens = []; //the tokens container\r\n            var scopes = [tokens]; //initiate with the tokens as the highest scope\r\n            var target = scopes[0]; //the target to which the tokens are added. This can swing up or down\r\n            var depth = 0;\r\n            var open_brackets = [];\r\n            var has_space = false; //marks if an open space character was found\r\n            var SPACE = ' ';\r\n            var EMPTY_STRING = '';\r\n            var COMMA = ',';\r\n            var MINUS = '-';\r\n            var MULT = '*';\r\n            //Possible source of bug. Review\r\n            /*\r\n             //gets the next space\r\n             var next_space = function(from) {\r\n             for(var i=from; i<L; i++) {\r\n             if(e.charAt(i) === ' ')\r\n             return i;\r\n             }\r\n             \r\n             return L; //assume the end of the string instead\r\n             };\r\n             */\r\n            /**\r\n             * Adds a scope to tokens\r\n             * @param {String} scope_type\r\n             * @param {int} column\r\n             * @returns {undefined}\r\n             */\r\n            var addScope = function (scope_type, column) {\r\n                var new_scope = []; //create a new scope\r\n                if(scope_type !== undefined) {\r\n                    new_scope.type = scope_type;\r\n                }\r\n                new_scope.column = column; //mark the column of the scope\r\n                scopes.push(new_scope); //add it to the list of scopes\r\n                target.push(new_scope); //add it to the tokens list since now it's a scope\r\n                target = new_scope; //point to it\r\n                depth++; //go down one in scope\r\n            };\r\n            /**\r\n             * Goes up in scope by one\r\n             * @returns {undefined}\r\n             */\r\n            var goUp = function () {\r\n                scopes.pop(); //remove the scope from the scopes stack\r\n                target = scopes[--depth]; //point the above scope\r\n            };\r\n            /**\r\n             * Extracts all the operators from the expression string starting at postion start_at\r\n             * @param {int} start_at\r\n             * @returns {String}\r\n             */\r\n            var get_operator_str = function (start_at) {\r\n                start_at = start_at !== undefined ? start_at : col;\r\n                //mark the end of the operator as the start since we're just going\r\n                //to be walking along the string\r\n                var end = start_at + 1;\r\n                //just keep moving along\r\n                while(e.charAt(end++) in operators) {\r\n                }\r\n                //remember that we started at one position ahead. The beginning operator is what triggered\r\n                //this function to be called in the first place. String.CharAt is zero based so we now\r\n                //have to correct two places. The initial increment + the extra++ at the end of end during\r\n                //the last iteration.\r\n                return e.substring(start_at, end - 1);\r\n            };\r\n            /**\r\n             * Breaks operator up in to several different operators as defined in operators\r\n             * @param {String} operator_str\r\n             * @returns {String[]}\r\n             */\r\n            var chunkify = function (operator_str) {\r\n                var start = col - operator_str.length; //start of operator\r\n                var _operators = [];\r\n                var operator = operator_str.charAt(0);\r\n                //grab the largest possible chunks but start at 2 since we already know\r\n                //that the first character is an operator\r\n\r\n                for(var i = 1, L = operator_str.length; i < L; i++) {\r\n                    var ch = operator_str.charAt(i);\r\n                    var o = operator + ch;\r\n                    //since the operator now is undefined then the last operator\r\n                    //was the largest possible combination.\r\n                    if(!(o in operators)) {\r\n                        _operators.push(new Token(operator, Token.OPERATOR, start + i));\r\n                        operator = ch;\r\n                    }\r\n                    else\r\n                        operator = o;//now the operator is the larger chunk\r\n                }\r\n                //add the last operator\r\n                _operators.push(new Token(operator, Token.OPERATOR, start + i));\r\n                return _operators;\r\n            };\r\n\r\n            /**\r\n             * Is used to add a token to the tokens array. Makes sure that no empty token is added\r\n             * @param {int} at\r\n             * @param {String} token\r\n             * @returns {undefined}\r\n             */\r\n            var add_token = function (at, token) {\r\n                //grab the token if we're not supplied one\r\n                if(token === undefined)\r\n                    token = e.substring(lpos, at);\r\n                //only add it if it's not an empty string\r\n                if(token in _.units)\r\n                    target.push(new Token(token, Token.UNIT, lpos));\r\n                else if(token !== '')\r\n                    target.push(new Token(token, Token.VARIABLE_OR_LITERAL, lpos));\r\n            };\r\n            /**\r\n             * Adds a function to the output\r\n             * @param {String} f\r\n             * @returns {undefined}\r\n             */\r\n            var add_function = function (f) {\r\n                target.push(new Token(f, Token.FUNCTION, lpos));\r\n            };\r\n            /**\r\n             * Tokens are found between operators so this marks the location of where the last token was found\r\n             * @param {int} position\r\n             * @returns {undefined}\r\n             */\r\n            var set_last_position = function (position) {\r\n                lpos = position + 1;\r\n            };\r\n            /**\r\n             * When a operator is found and added, especially a combo operator, then the column location\r\n             * has to be adjusted to the end of the operator\r\n             * @returns {undefined}\r\n             */\r\n            var adjust_column_position = function () {\r\n                lpos = lpos + operator_str.length - 2;\r\n                col = lpos - 1;\r\n            };\r\n            for(; col < L; col++) {\r\n                var ch = e.charAt(col);\r\n                if(ch in operators) {\r\n                    add_token(col);\r\n                    //is the last token numeric?\r\n                    var last_token_is_numeric = target[0] && isNumber(target[0]);\r\n                    //is this character multiplication?\r\n                    var is_multiplication = last_token_is_numeric && ch === MULT;\r\n                    //if we're in a new scope then go up by one but if the space\r\n                    //is right befor an operator then it makes no sense to go up in scope\r\n                    //consider sin -x. The last position = current position at the minus sign\r\n                    //this means that we're going for sin(x) -x which is wrong\r\n                    //Ignore comma since comma is still part of the existing scope.\r\n                    if(has_space && lpos < col && !(ch === COMMA || is_multiplication)) {\r\n                        has_space = false;\r\n                        goUp();\r\n                    }\r\n                    //mark the last position that a\r\n                    set_last_position(col + 1);\r\n                    var operator_str = get_operator_str(col);\r\n\r\n                    adjust_column_position();\r\n                    target.push.apply(target, chunkify(operator_str));\r\n                }\r\n                else if(ch in brackets) {\r\n                    var bracket = brackets[ch];\r\n\r\n                    if(bracket.is_open) {\r\n                        //mark the bracket\r\n                        open_brackets.push([bracket, lpos]);\r\n                        var f = e.substring(lpos, col);\r\n                        if(f in functions) {\r\n                            add_function(f);\r\n                        }\r\n                        else if(f !== '') {\r\n                            //assume multiplication\r\n                            //TODO: Add the multiplication to stack\r\n                            target.push(new Token(f, Token.VARIABLE_OR_LITERAL, lpos));\r\n                        }\r\n                        //go down one in scope\r\n                        addScope(bracket.maps_to, col);\r\n                    }\r\n                    else if(bracket.is_close) {\r\n                        //get the matching bracket\r\n                        var pair = open_brackets.pop();\r\n                        //throw errors accordingly\r\n                        //missing open bracket\r\n                        if(!pair)\r\n                            throw new ParityError('Missing open bracket for bracket at: ' + (col + 1));\r\n                        //incorrect pair\r\n                        else if(pair[0].id !== bracket.id - 1)\r\n                            throw new ParityError('Parity error');\r\n\r\n                        add_token(col);\r\n                        goUp();\r\n                    }\r\n                    set_last_position(col);\r\n                }\r\n                else if(ch === SPACE) {\r\n                    var prev = e.substring(lpos, col); //look back\r\n                    var nxt = e.charAt(col + 1); //look forward\r\n                    if(has_space) {\r\n\r\n                        if(prev in operators) {\r\n                            target.push(new Token(prev, Token.OPERATOR, col));\r\n                        }\r\n                        else {\r\n                            add_token(undefined, prev);\r\n                            //we're at the closing space\r\n                            goUp(); //go up in scope if we're at a space\r\n\r\n                            //assume multiplication if it's not an operator except for minus\r\n                            var is_operator = nxt in operators;\r\n\r\n                            if((is_operator && operators[nxt].value === MINUS) || !is_operator) {\r\n                                target.push(new Token(MULT, Token.OPERATOR, col));\r\n                            }\r\n                        }\r\n                        has_space = false; //remove the space\r\n                    }\r\n                    else {\r\n                        //we're at the closing space\r\n                        //check if it's a function\r\n                        var f = e.substring(lpos, col);\r\n\r\n                        if(f in functions) {\r\n                            //there's no need to go up in scope if the next character is an operator\r\n                            has_space = true; //mark that a space was found\r\n                            add_function(f);\r\n                            addScope();\r\n                        }\r\n                        else if(f in operators) {\r\n                            target.push(new Token(f, Token.OPERATOR, col));\r\n                        }\r\n                        else {\r\n                            add_token(undefined, f);\r\n                            //peek ahead to the next character\r\n                            var nxt = e.charAt(col + 1);\r\n\r\n                            //If it's a number then add the multiplication operator to the stack but make sure that the next character\r\n                            //is not an operator\r\n\r\n                            if(prev !== EMPTY_STRING && nxt !== EMPTY_STRING && !(prev in operators) && !(nxt in operators))\r\n                                target.push(new Token(MULT, Token.OPERATOR, col));\r\n                        }\r\n                        //Possible source of bug. Review\r\n                        /*\r\n                         //space can mean multiplication so add the symbol if the is encountered\r\n                         if(/\\d+|\\d+\\.?\\d*e[\\+\\-]*\\d+/i.test(f)) {\r\n                         var next = e.charAt(col+1);\r\n                         var next_is_operator = next in operators;\r\n                         var ns = next_space(col+1);\r\n                         var next_word = e.substring(col+1, ns);\r\n                         //the next can either be a prefix operator or no operator\r\n                         if((next_is_operator && operators[next].prefix) || !(next_is_operator || next_word in operators))\r\n                         target.push(new Token('*', Token.OPERATOR, col));\r\n                         }\r\n                         */\r\n                    }\r\n                    set_last_position(col); //mark this location\r\n                }\r\n            }\r\n            //check that all brackets were closed\r\n            if(open_brackets.length) {\r\n                var b = open_brackets.pop();\r\n                throw new ParityError('Missing closed bracket for bracket at ' + (b[1] + 1));\r\n            }\r\n            //add the last token\r\n            add_token(col);\r\n\r\n            return tokens;\r\n        };\r\n        /*\r\n         * Puts token array in Reverse Polish Notation\r\n         * @param {Token[]} tokens\r\n         * @returns {Token[]}\r\n         */\r\n        this.toRPN = function (tokens) {\r\n            var fn = tokens.type;\r\n            var l = tokens.length, i;\r\n            var output = [];\r\n            var stack = [];\r\n            var prefixes = [];\r\n            var collapse = function (target, destination) {\r\n                while(target.length)\r\n                    destination.push(target.pop());\r\n            };\r\n            //mark all the prefixes and add them to the stack\r\n            for(i = 0; i < l; i++) {\r\n                var token = tokens[i];\r\n                if(token.type !== Token.OPERATOR)\r\n                    break;\r\n                if(!token.prefix)\r\n                    throw new OperatorError('Not a prefix operator');\r\n                token.is_prefix = true;\r\n                stack.push(token);\r\n            }\r\n            //begin with remaining tokens\r\n            for(; i < l; i++) {\r\n                var e = tokens[i];\r\n                if(e.type === Token.OPERATOR) {\r\n                    var operator = e;\r\n\r\n                    //create the option for the operator being overloaded\r\n                    if(operator.overloaded) {\r\n                        var next = tokens[i + 1];\r\n                        //if it's followed by a number or variable then we assume it's not a postfix operator\r\n                        if(next && next.type === Token.VARIABLE_OR_LITERAL) {\r\n                            operator.postfix = false;\r\n                            //override the original function with the overload function\r\n                            operator.action = operator.overloadAction;\r\n                            operator.leftAssoc = operator.overloadLeftAssoc;\r\n                        }\r\n                    }\r\n\r\n                    //if the stack is not empty\r\n                    while(stack.length) {\r\n                        var last = stack[stack.length - 1];\r\n                        //if (there is an operator at the top of the operator stack with greater precedence)\r\n                        //or (the operator at the top of the operator stack has equal precedence and is left associative)) ~ wikipedia\r\n                        //the !prefixes.length makes sure that the operator on stack isn't prematurely taken fromt he stack.\r\n                        if(!(last.precedence > operator.precedence || !operator.leftAssoc && last.precedence === operator.precedence))\r\n                            break;\r\n                        output.push(stack.pop());\r\n                    }\r\n\r\n                    //change the behavior of the operator if it's a vector and we've been asked to do so\r\n                    if((fn === 'vector' || fn === 'set') && 'vectorFn' in operator)\r\n                        operator.action = operator.vectorFn;\r\n\r\n\r\n                    //if the operator is a postfix operator then we're ready to go since it belongs\r\n                    //to the preceding token. However the output cannot be empty. It must have either\r\n                    //an operator or a variable/literal\r\n                    if(operator.postfix) {\r\n                        var previous = tokens[i - 1];\r\n                        if(!previous)\r\n                            throw new OperatorError(\"Unexpected prefix operator '\" + e.value + \"'! at \" + e.column);\r\n                        else if(previous.type === Token.OPERATOR) {\r\n                            //a postfix can only be followed by a postfix\r\n                            if(!previous.postfix)\r\n                                throw new OperatorError(\"Unexpected prefix operator '\" + previous.value + \"'! at \" + previous.column);\r\n                        }\r\n                    }\r\n                    else {\r\n                        //we must be at an infix so point the operator this\r\n                        do {\r\n                            //the first one is an infix operator all others have to be prefix operators so jump to the end\r\n                            var next = tokens[i + 1]; //take a look ahead\r\n                            var next_is_operator = next ? next.type === Token.OPERATOR : false; //check if it's an operator\r\n                            if(next_is_operator) {\r\n                                //if it's not a prefix operator then it not in the right place\r\n                                if(!next.prefix) {\r\n                                    throw new OperatorError('A prefix operator was expected at ' + next.column);\r\n                                }\r\n                                //mark it as a confirmed prefix\r\n                                next.is_prefix = true;\r\n                                //add it to the prefixes\r\n                                prefixes.push(next);\r\n                                i++;\r\n                            }\r\n                        }\r\n                        while(next_is_operator)\r\n                    }\r\n\r\n                    //if it's a prefix it should be on a special stack called prefixes\r\n                    //we do this to hold on to prefixes because of left associative operators.\r\n                    //they belong to the variable/literal but if placed on either the stack\r\n                    //or output there's no way of knowing this. I might be wrong so I welcome\r\n                    //any discussion about this.\r\n\r\n                    if(operator.is_prefix) //ADD ALL EXCEPTIONS FOR ADDING TO PREFIX STACK HERE. !!!\r\n                        prefixes.push(operator);\r\n                    else\r\n                        stack.push(operator);\r\n                    //move the prefixes to the stack\r\n                    while(prefixes.length) {\r\n                        if(operator.leftAssoc || !operator.leftAssoc && prefixes[prefixes.length - 1].precedence >= operator.precedence) //revisit for commas\r\n                            stack.push(prefixes.pop());\r\n                        else\r\n                            break;\r\n                    }\r\n                }\r\n                else if(e.type === Token.VARIABLE_OR_LITERAL) {\r\n                    //move prefixes to stack at beginning of scope\r\n                    if(output.length === 0)\r\n                        collapse(prefixes, stack);\r\n                    //done with token\r\n                    output.push(e);\r\n                    var last_on_stack = stack[stack.length - 1];\r\n                    //then move all the prefixes to the output\r\n                    if(!last_on_stack || !last_on_stack.leftAssoc)\r\n                        collapse(prefixes, output);\r\n                }\r\n                else if(e.type === Token.FUNCTION) {\r\n                    stack.push(e);\r\n                }\r\n                else if(e.type === Token.UNIT) {\r\n                    //if it's a unit it belongs on the stack since it's tied to the previous token\r\n                    output.push(e);\r\n                }\r\n                //if it's an additonal scope then put that into RPN form\r\n                if(Array.isArray(e)) {\r\n                    output.push(this.toRPN(e));\r\n                    if(e.type)\r\n                        output.push(new Token(e.type, Token.FUNCTION, e.column)); //since it's hidden it needs no column\r\n\r\n                }\r\n            }\r\n            //collapse the remainder of the stack and prefixes to output\r\n            collapse(stack, output);\r\n            collapse(prefixes, output);\r\n\r\n            return output;\r\n        };\r\n        /*\r\n         * Parses the tokens\r\n         * @param {Tokens[]} rpn\r\n         * @param {object} substitutions\r\n         * @returns {Symbol}\r\n         */\r\n        this.parseRPN = function (rpn, substitutions) {\r\n            try {\r\n                //default substitutions\r\n                substitutions = substitutions || {};\r\n                //prepare the substitutions.\r\n                //we first parse them out as-is\r\n                for(var x in substitutions)\r\n                    substitutions[x] = _.parse(substitutions[x], {});\r\n\r\n                //Although technically constants,\r\n                //pi and e are only available when evaluating the expression so add to the subs.\r\n                //Doing this avoids rounding errors\r\n                //link e and pi\r\n                if(Settings.PARSE2NUMBER) {\r\n                    //use the value provided if the individual for some strange reason prefers this.\r\n                    //one reason could be to sub e but not pi or vice versa\r\n                    if(!('e' in substitutions))\r\n                        substitutions.e = new Symbol(Settings.E);\r\n                    if((!('pi' in substitutions)))\r\n                        substitutions.pi = new Symbol(Settings.PI);\r\n                }\r\n\r\n                var Q = [];\r\n                for(var i = 0, l = rpn.length; i < l; i++) {\r\n                    var e = rpn[i];\r\n\r\n                    //Arrays indicate a new scope so parse that out\r\n                    if(Array.isArray(e)) {\r\n                        e = this.parseRPN(e, substitutions);\r\n                    }\r\n\r\n                    if(e) {\r\n                        if(e.type === Token.OPERATOR) {\r\n                            if(e.is_prefix || e.postfix)\r\n                                //resolve the operation assocated with the prefix\r\n                                Q.push(e.operation(Q.pop()));\r\n                            else {\r\n                                var b = Q.pop();\r\n                                var a = Q.pop();\r\n                                //Throw an error if the RH value is empty. This cannot be a postfix since we already checked\r\n                                if(typeof a === 'undefined')\r\n                                    throw new OperatorError(e + ' is not a valid postfix operator at ' + e.column);\r\n\r\n                                var is_comma = e.action === 'comma';\r\n                                //convert Sets to Vectors on all operations at this point. Sets are only recognized functions or individually\r\n                                if(a instanceof Set && !is_comma)\r\n                                    a = Vector.fromSet(a);\r\n\r\n                                if(b instanceof Set && !is_comma)\r\n                                    b = Vector.fromSet(b);\r\n\r\n                                //call all the pre-operators\r\n                                this.callPeekers('pre_operator', a, b, e);\r\n\r\n                                var ans = _[e.action](a, b);\r\n\r\n                                //call all the pre-operators\r\n                                this.callPeekers('post_operator', ans, a, b, e);\r\n\r\n                                Q.push(ans);\r\n                            }\r\n                        }\r\n                        else if(e.type === Token.FUNCTION) {\r\n                            var args = Q.pop();\r\n                            var parent = args.parent; //make a note of the parent\r\n                            if(!(args instanceof Collection))\r\n                                args = Collection.create(args);\r\n                            //the return value may be a vector. If it is then we check\r\n                            //Q to see if there's another vector on the stack. If it is then\r\n                            //we check if has elements. If it does then we know that we're dealing\r\n                            //with an \"getter\" object and return the requested values\r\n\r\n                            //call the function. This is the _.callfunction method in nerdamer\r\n                            //call the function. This is the _.callfunction method in nerdamer\r\n                            var fn_name = e.value;\r\n                            var fn_args = args.getItems();\r\n\r\n                            //call the pre-function peekers\r\n                            this.callPeekers('pre_function', fn_name, fn_args);\r\n\r\n                            var ret = _.callfunction(fn_name, fn_args);\r\n\r\n                            //call the post-function peekers\r\n                            this.callPeekers('post_function', ret, fn_name, fn_args);\r\n\r\n                            var last = Q[Q.length - 1];\r\n                            var next = rpn[i + 1];\r\n                            var next_is_comma = next && next.type === Token.OPERATOR && next.value === ',';\r\n\r\n                            if(!next_is_comma && ret instanceof Vector && last && last.elements && !(last instanceof Collection)) {\r\n                                //remove the item from the queue\r\n                                var item = Q.pop();\r\n\r\n                                var getter = ret.elements[0];\r\n                                //check if it's symbolic. If so put it back and add the item to the stack\r\n                                if(!getter.isConstant()) {\r\n                                    item.getter = getter;\r\n                                    Q.push(item);\r\n                                    Q.push(ret);\r\n                                }\r\n                                else if(getter instanceof Slice) {\r\n                                    //if it's a Slice return the slice\r\n                                    Q.push(Vector.fromArray(item.elements.slice(getter.start, getter.end)));\r\n                                }\r\n                                else {\r\n                                    var index = Number(getter);\r\n                                    var il = item.elements.length;\r\n                                    //support for negative indices\r\n                                    if(index < 0)\r\n                                        index = il + index;\r\n                                    //it it's still out of bounds\r\n                                    if(index < 0 || index >= il) //index should no longer be negative since it's been reset above\r\n                                        //range error\r\n                                        throw new OutOfRangeError('Index out of range ' + (e.column + 1));\r\n\r\n                                    var element = item.elements[index];\r\n                                    //cyclic but we need to mark this for future reference\r\n                                    item.getter = index;\r\n                                    element.parent = item;\r\n\r\n                                    Q.push(element);\r\n                                }\r\n                            }\r\n                            else {\r\n                                //extend the parent reference\r\n                                if(parent)\r\n                                    ret.parent = parent;\r\n                                Q.push(ret);\r\n                            }\r\n\r\n                        }\r\n                        else {\r\n                            var subbed;\r\n                            var v = e.value;\r\n\r\n                            if(v in Settings.ALIASES)\r\n                                e = _.parse(Settings.ALIASES[e]);\r\n                            //wrap it in a symbol if need be\r\n                            else if(e.type === Token.VARIABLE_OR_LITERAL)\r\n                                e = new Symbol(v);\r\n                            else if(e.type === Token.UNIT) {\r\n                                e = new Symbol(v);\r\n                                e.isUnit = true;\r\n                            }\r\n\r\n                            //make substitutions\r\n                            //Always constants first. This avoids the being overridden\r\n                            if(v in _.CONSTANTS) {\r\n                                subbed = e;\r\n                                e = new Symbol(_.CONSTANTS[v]);\r\n                            }\r\n                            //next substitutions. This allows declared variable to be overridden\r\n                            //check if the values match to avoid erasing the multiplier.\r\n                            //Example:/e = 3*a. substutiting a for a will wipe out the multiplier.\r\n                            else if(v in substitutions && v !== substitutions[v].toString()) {\r\n                                subbed = e;\r\n                                e = substitutions[v].clone();\r\n                            }\r\n                            //next declare variables\r\n                            else if(v in VARS) {\r\n                                subbed = e;\r\n                                e = VARS[v].clone();\r\n                            }\r\n                            //make notation of what it was before\r\n                            if(subbed)\r\n                                e.subbed = subbed;\r\n\r\n                            Q.push(e);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                var retval = Q[0];\r\n\r\n                if(['undefined', 'string', 'number'].indexOf(typeof retval) !== -1) {\r\n                    throw new UnexpectedTokenError('Unexpected token!');\r\n                }\r\n\r\n                return retval;\r\n            }\r\n            catch(error) {\r\n                var rethrowErrors = [OutOfFunctionDomainError];\r\n                // Rethrow certain errors in the same class to preserve them\r\n                rethrowErrors.forEach(function (E) {\r\n                    if(error instanceof E) {\r\n                        throw new E(error.message + ': ' + e.column);\r\n                    }\r\n                });\r\n\r\n                throw new ParseError(error.message + ': ' + e.column);\r\n            }\r\n        };\r\n        /**\r\n         * This is the method that triggers the parsing of the string. It generates a parse tree but processes\r\n         * it right away. The operator functions are called when their respective operators are reached. For instance\r\n         * + with cause this.add to be called with the left and right hand values. It works by walking along each\r\n         * character of the string and placing the operators on the stack and values on the output. When an operator\r\n         * having a lower order than the last is reached then the stack is processed from the last operator on the\r\n         * stack.\r\n         * @param {String} token\r\n         */\r\n\r\n        function Node(token) {\r\n            this.type = token.type;\r\n            this.value = token.value;\r\n            //the incoming token may already be a Node type\r\n            this.left = token.left;\r\n            this.right = token.right;\r\n        }\r\n\r\n        Node.prototype.toString = function () {\r\n            var left = this.left ? this.left.toString() + '---' : '';\r\n            var right = this.right ? '---' + this.right.toString() : '';\r\n            return left + '(' + this.value + ')' + right;\r\n        };\r\n\r\n        Node.prototype.toHTML = function (depth, indent) {\r\n            depth = depth || 0;\r\n            indent = typeof indent === 'undefined' ? 4 : indent;\r\n            var tab = function (n) {\r\n                return ' '.repeat(indent * n);\r\n            };\r\n            var html = '';\r\n            var left = this.left ? tab(depth + 1) + '<li>\\n' + this.left.toHTML(depth + 2, indent) + tab(depth + 1) + '</li> \\n' : '';\r\n            var right = this.right ? tab(depth + 1) + '<li>\\n' + this.right.toHTML(depth + 2, indent) + tab(depth + 1) + '</li>\\n' : '';\r\n            var html = tab(depth) + '<div class=\"' + this.type.toLowerCase() + '\"><span>' + this.value + '</span></div>' + tab(depth) + '\\n';\r\n            if(left || right) {\r\n                html += tab(depth) + '<ul>\\n' + left + right + tab(depth) + '</ul>\\n';\r\n            }\r\n            html += '';\r\n            return html;\r\n        };\r\n\r\n        this.tree = function (tokens) {\r\n            var Q = [];\r\n            for(var i = 0; i < tokens.length; i++) {\r\n                var e = tokens[i];\r\n                //Arrays indicate a new scope so parse that out\r\n                if(Array.isArray(e)) {\r\n                    e = this.tree(e);\r\n                    //if it's a comma then it's just arguments\r\n                    Q.push(e);\r\n                    continue;\r\n                }\r\n                if(e.type === Token.OPERATOR) {\r\n                    if(e.is_prefix || e.postfix) {\r\n                        //prefixes go to the left, postfix to the right\r\n                        var location = e.is_prefix ? 'left' : 'right';\r\n                        var last = Q.pop();\r\n                        e = new Node(e);\r\n                        e[location] = last;\r\n                        Q.push(e);\r\n                    }\r\n                    else {\r\n                        e = new Node(e);\r\n                        e.right = Q.pop();\r\n                        e.left = Q.pop();\r\n                        Q.push(e);\r\n                    }\r\n                }\r\n                else if(e.type === Token.FUNCTION) {\r\n                    e = new Node(e);\r\n                    var args = Q.pop();\r\n                    e.right = args;\r\n                    if(e.value === 'object') {\r\n                        //check if Q has a value\r\n                        var last = Q[Q.length - 1];\r\n                        if(last) {\r\n                            while(last.right) {\r\n                                last = last.right;\r\n                            }\r\n                            last.right = e;\r\n                            continue;\r\n                        }\r\n                    }\r\n\r\n                    Q.push(e);\r\n                }\r\n                else {\r\n                    Q.push(new Node(e));\r\n                }\r\n            }\r\n\r\n            return Q[0];\r\n        };\r\n        this.parse = function (e, substitutions) {\r\n            e = prepare_expression(e);\r\n            substitutions = substitutions || {};\r\n            //three passes but easier to debug\r\n            var tokens = this.tokenize(e);\r\n            var rpn = this.toRPN(tokens);\r\n            return this.parseRPN(rpn, substitutions);\r\n        };\r\n        /**\r\n         * TODO: Switch to Parser.tokenize for this method\r\n         * Reads a string into an array of Symbols and operators\r\n         * @param {String} expression_string\r\n         * @returns {Array}\r\n         */\r\n        this.toObject = function (expression_string) {\r\n            var objectify = function (tokens) {\r\n                var output = [];\r\n                for(var i = 0, l = tokens.length; i < l; i++) {\r\n                    var token = tokens[i];\r\n                    var v = token.value;\r\n                    if(token.type === Token.VARIABLE_OR_LITERAL) {\r\n                        output.push(new Symbol(v));\r\n                    }\r\n                    else if(token.type === Token.FUNCTION) {\r\n                        //jump ahead since the next object are the arguments\r\n                        i++;\r\n                        //create a symbolic function and stick it on output\r\n                        var f = _.symfunction(v, objectify(tokens[i]));\r\n                        f.isConversion = true;\r\n                        output.push(f);\r\n                    }\r\n                    else if(token.type === Token.OPERATOR) {\r\n                        output.push(v);\r\n                    }\r\n                    else {\r\n                        output.push(objectify(token));\r\n                    }\r\n                }\r\n\r\n                return output;\r\n            };\r\n            return objectify(_.tokenize(expression_string));\r\n        };\r\n\r\n        // A helper method for toTeX\r\n        var chunkAtCommas = function (arr) {\r\n            var j, k = 0, chunks = [[]];\r\n            for(var j = 0, l = arr.length; j < l; j++) {\r\n                if(arr[j] === ',') {\r\n                    k++;\r\n                    chunks[k] = [];\r\n                }\r\n                else {\r\n                    chunks[k].push(arr[j]);\r\n                }\r\n            }\r\n            return chunks;\r\n        };\r\n\r\n        // Helper method for toTeX\r\n        var rem_brackets = function (str) {\r\n            return str.replace(/^\\\\left\\((.+)\\\\right\\)$/g, function (str, a) {\r\n                if(a)\r\n                    return a;\r\n                return str;\r\n            });\r\n        };\r\n\r\n        var remove_redundant_powers = function (arr) {\r\n            // The filtered array\r\n            var narr = [];\r\n\r\n            while(arr.length) {\r\n                // Remove the element from the front\r\n                var e = arr.shift();\r\n                var next = arr[0];\r\n                var next_is_array = isArray(next);\r\n                var next_is_minus = next === '-';\r\n\r\n                // Remove redundant plusses \r\n                if(e === '^') {\r\n                    if(next === '+') {\r\n                        arr.shift();\r\n                    }\r\n                    else if(next_is_array && next[0] === '+') {\r\n                        next.shift();\r\n                    }\r\n\r\n                    // Remove redundant parentheses\r\n                    if(next_is_array && next.length === 1) {\r\n                        arr.unshift(arr.shift()[0]);\r\n                    }\r\n                }\r\n\r\n                // Check if it's a negative power\r\n                if(e === '^' && (next_is_array && next[0] === '-' || next_is_minus)) {\r\n                    // If so:\r\n                    // - Remove it from the new array, place a one and a division sign in that array and put it back\r\n                    var last = narr.pop();\r\n                    // Check if it's something multiplied by\r\n                    var before = narr[narr.length - 1];\r\n                    var before_last = '1';\r\n\r\n                    if(before === '*') {\r\n                        narr.pop();\r\n                        // For simplicity we just pop it. \r\n                        before_last = narr.pop();\r\n                    }\r\n                    // Implied multiplication\r\n                    else if(isArray(before)) {\r\n                        before_last = narr.pop();\r\n                    }\r\n\r\n                    narr.push(before_last, '/', last, e);\r\n\r\n                    // Remove the negative sign from the power \r\n                    if(next_is_array) {\r\n                        next.shift();\r\n                    }\r\n                    else {\r\n                        arr.shift();\r\n                    }\r\n\r\n                    // Remove it from the array so we don't end up with redundant parentheses if we can\r\n                    if(next_is_array && next.length === 1) {\r\n                        narr.push(arr.shift()[0]);\r\n                    }\r\n                }\r\n                else {\r\n                    narr.push(e);\r\n                }\r\n            }\r\n\r\n            return narr;\r\n        };\r\n        /*\r\n         * Convert expression or object to LaTeX\r\n         * @param {String} expression_or_obj\r\n         * @param {object} opt\r\n         * @returns {String}\r\n         */\r\n        this.toTeX = function (expression_or_obj, opt) {\r\n            opt = opt || {};\r\n            // Add decimal option as per issue #579. Consider passing an object to Latex.latex as option instead of string\r\n            var decimals = opt.decimals === true ? 'decimals' : undefined;\r\n\r\n            var obj = typeof expression_or_obj === 'string' ? this.toObject(expression_or_obj) : expression_or_obj,\r\n                    TeX = [],\r\n                    cdot = typeof opt.cdot === 'undefined' ? '\\\\cdot' : opt.cdot; //set omit cdot to true by default\r\n\r\n            // Remove negative powers as per issue #570\r\n            obj = remove_redundant_powers(obj);\r\n\r\n            if(isArray(obj)) {\r\n                var nobj = [], a, b;\r\n                //first handle ^\r\n                for(var i = 0; i < obj.length; i++) {\r\n                    a = obj[i];\r\n\r\n                    if(obj[i + 1] === '^') {\r\n                        b = obj[i + 2];\r\n                        nobj.push(LaTeX.braces(this.toTeX([a])) + '^' + LaTeX.braces(this.toTeX([b])));\r\n                        i += 2;\r\n                    }\r\n                    else {\r\n                        nobj.push(a);\r\n                    }\r\n                }\r\n                obj = nobj;\r\n            }\r\n\r\n            for(var i = 0, l = obj.length; i < l; i++) {\r\n                var e = obj[i];\r\n\r\n                // Convert * to cdot\r\n                if(e === '*') {\r\n                    e = cdot;\r\n                }\r\n\r\n                if(isSymbol(e)) {\r\n                    if(e.group === FN) {\r\n                        var fname = e.fname, f;\r\n\r\n                        if(fname === SQRT) {\r\n                            f = '\\\\sqrt' + LaTeX.braces(this.toTeX(e.args));\r\n                        }\r\n                        else if(fname === ABS) {\r\n                            f = LaTeX.brackets(this.toTeX(e.args), 'abs');\r\n                        }\r\n                        else if(fname === PARENTHESIS) {\r\n                            f = LaTeX.brackets(this.toTeX(e.args), 'parens');\r\n                        }\r\n                        else if(fname === Settings.LOG10) {\r\n                            f = '\\\\' + Settings.LOG10_LATEX + '\\\\left( ' + this.toTeX(e.args) + '\\\\right)';\r\n                        }\r\n                        else if(fname === 'integrate') {\r\n                            /* Retrive [Expression, x] */\r\n                            var chunks = chunkAtCommas(e.args);\r\n                            /* Build TeX */\r\n                            var expr = LaTeX.braces(this.toTeX(chunks[0])),\r\n                                    dx = this.toTeX(chunks[1]);\r\n                            f = '\\\\int ' + expr + '\\\\, d' + dx;\r\n                        }\r\n                        else if(fname === 'defint') {\r\n                            var chunks = chunkAtCommas(e.args),\r\n                                    expr = LaTeX.braces(this.toTeX(chunks[0])),\r\n                                    dx = this.toTeX(chunks[3]),\r\n                                    lb = this.toTeX(chunks[1]),\r\n                                    ub = this.toTeX(chunks[2]);\r\n                            f = '\\\\int\\\\limits_{' + lb + '}^{' + ub + '} ' + expr + '\\\\, d' + dx;\r\n\r\n                        }\r\n                        else if(fname === 'diff') {\r\n                            var chunks = chunkAtCommas(e.args);\r\n                            var dx = '', expr = LaTeX.braces(this.toTeX(chunks[0]));\r\n                            /* Handle cases: one argument provided, we need to guess the variable, and assume n = 1 */\r\n                            if(chunks.length === 1) {\r\n                                var vars = [];\r\n                                for(j = 0; j < chunks[0].length; j++) {\r\n                                    if(chunks[0][j].group === 3) {\r\n                                        vars.push(chunks[0][j].value);\r\n                                    }\r\n                                }\r\n                                vars.sort();\r\n                                dx = vars.length > 0 ? ('\\\\frac{d}{d ' + vars[0] + '}') : '\\\\frac{d}{d x}';\r\n                            }\r\n                            /* If two arguments, we have expression and variable, we assume n = 1 */\r\n                            else if(chunks.length === 2) {\r\n                                dx = '\\\\frac{d}{d ' + chunks[1] + '}';\r\n                            }\r\n                            /* If we have more than 2 arguments, we assume we've got everything */\r\n                            else {\r\n                                dx = '\\\\frac{d^{' + chunks[2] + '}}{d ' + this.toTeX(chunks[1]) + '^{' + chunks[2] + '}}';\r\n                            }\r\n\r\n                            f = dx + '\\\\left(' + expr + '\\\\right)';\r\n\r\n                        }\r\n                        else if(fname === 'sum' || fname === 'product') {\r\n                            // Split e.args into 4 parts based on locations of , symbols.\r\n                            var argSplit = [[], [], [], []], j = 0, i;\r\n                            for(i = 0; i < e.args.length; i++) {\r\n                                if(e.args[i] === ',') {\r\n                                    j++;\r\n                                    continue;\r\n                                }\r\n                                argSplit[j].push(e.args[i]);\r\n                            }\r\n                            // Then build TeX string.\r\n                            f = (fname === 'sum' ? '\\\\sum_' : '\\\\prod_') + LaTeX.braces(this.toTeX(argSplit[1]) + ' = ' + this.toTeX(argSplit[2]));\r\n                            f += '^' + LaTeX.braces(this.toTeX(argSplit[3])) + LaTeX.braces(this.toTeX(argSplit[0]));\r\n                        }\r\n                        else if(fname === 'limit') {\r\n                            var args = chunkAtCommas(e.args).map(function (x) {\r\n                                if(Array.isArray(x))\r\n                                    return _.toTeX(x.join(''));\r\n                                return _.toTeX(String(x));\r\n                            });\r\n                            f = '\\\\lim_' + LaTeX.braces(args[1] + '\\\\to ' + args[2]) + ' ' + LaTeX.braces(args[0]);\r\n                        }\r\n                        else if(fname === FACTORIAL || fname === DOUBLEFACTORIAL) {\r\n                            f = this.toTeX(e.args) + (fname === FACTORIAL ? '!' : '!!');\r\n                        }\r\n                        else {\r\n                            f = LaTeX.latex(e, decimals);\r\n                            //f = '\\\\mathrm'+LaTeX.braces(fname.replace(/_/g, '\\\\_')) + LaTeX.brackets(this.toTeX(e.args), 'parens');\r\n                        }\r\n\r\n                        TeX.push(f);\r\n                    }\r\n                    else {\r\n                        TeX.push(LaTeX.latex(e, decimals));\r\n                    }\r\n                }\r\n                else if(isArray(e)) {\r\n                    TeX.push(LaTeX.brackets(this.toTeX(e)));\r\n                }\r\n                else {\r\n                    if(e === '/')\r\n                        TeX.push(LaTeX.frac(rem_brackets(TeX.pop()), rem_brackets(this.toTeX([obj[++i]]))));\r\n                    else\r\n                        TeX.push(e);\r\n                }\r\n            }\r\n\r\n            return TeX.join(' ');\r\n        };\r\n\r\n//Parser.functions ==============================================================\r\n        /* Although parens is not a \"real\" function it is important in some cases when the\r\n         * symbol must carry parenthesis. Once set you don't have to worry about it anymore\r\n         * as the parser will get rid of it at the first opportunity\r\n         */\r\n        function parens(symbol) {\r\n            if(Settings.PARSE2NUMBER) {\r\n                return symbol;\r\n            }\r\n            return _.symfunction('parens', [symbol]);\r\n        }\r\n\r\n        function abs(symbol) {\r\n\r\n            //|-∞| = ∞\r\n            if(symbol.isInfinity) {\r\n                return Symbol.infinity();\r\n            }\r\n            if(symbol.multiplier.lessThan(0))\r\n                symbol.multiplier.negate();\r\n\r\n            if(symbol.isImaginary()) {\r\n                var re = symbol.realpart();\r\n                var im = symbol.imagpart();\r\n                if(re.isConstant() && im.isConstant())\r\n                    return sqrt(_.add(_.pow(re, new Symbol(2)), _.pow(im, new Symbol(2))));\r\n            }\r\n            else if(isNumericSymbol(symbol) || even(symbol.power)) {\r\n                return symbol;\r\n            }\r\n\r\n            if(symbol.isComposite()) {\r\n                var ms = [];\r\n                symbol.each(function (x) {\r\n                    ms.push(x.multiplier);\r\n                });\r\n                var gcd = Math2.QGCD.apply(null, ms);\r\n                if(gcd.lessThan(0)) {\r\n                    symbol.multiplier = symbol.multiplier.multiply(new Frac(-1));\r\n                    symbol.distributeMultiplier();\r\n                }\r\n            }\r\n\r\n            //convert |n*x| to n*|x|\r\n            var m = _.parse(symbol.multiplier);\r\n            symbol.toUnitMultiplier();\r\n\r\n            return _.multiply(m, _.symfunction(ABS, [symbol]));\r\n        }\r\n        /**\r\n         * The factorial function\r\n         * @param {Symbol} symbol\r\n         * @return {Symbol}\r\n         */\r\n        function factorial(symbol) {\r\n            var retval;\r\n            if(isVector(symbol)) {\r\n                var V = new Vector();\r\n                symbol.each(function (x, i) {\r\n                    //i start at one.\r\n                    V.set(i - 1, factorial(x));\r\n                });\r\n                return V;\r\n            }\r\n            if(isMatrix(symbol)) {\r\n                var M = new Matrix();\r\n                symbol.each(function (x, i, j) {\r\n                    //i start at one.\r\n                    M.set(i, j, factorial(x));\r\n                });\r\n                return M;\r\n            }\r\n            if(Settings.PARSE2NUMBER && symbol.isConstant()) {\r\n                if(isInt(symbol)) {\r\n                    retval = Math2.bigfactorial(symbol);\r\n                }\r\n                else {\r\n                    retval = Math2.gamma(symbol.multiplier.add(new Frac(1)).toDecimal());\r\n                }\r\n\r\n                retval = bigConvert(retval);\r\n                return retval;\r\n            }\r\n            else if(symbol.isConstant()) {\r\n                var den = symbol.getDenom();\r\n                if(den.equals(2)) {\r\n                    var num = symbol.getNum();\r\n                    var a, b, c, n;\r\n\r\n                    if(!symbol.multiplier.isNegative()) {\r\n                        n = _.add(num, new Symbol(1)).multiplier.divide(new Frac(2));\r\n                        a = Math2.bigfactorial(new Frac(2).multiply(n));\r\n                        b = _.pow(new Symbol(4), new Symbol(n)).multiplier.multiply(Math2.bigfactorial(n));\r\n                    }\r\n                    else {\r\n                        n = _.subtract(num.negate(), new Symbol(1)).multiplier.divide(new Frac(2));\r\n                        a = _.pow(new Symbol(-4), new Symbol(n)).multiplier.multiply(Math2.bigfactorial(n));\r\n                        b = Math2.bigfactorial(new Frac(2).multiply(n));\r\n                    }\r\n                    c = a.divide(b);\r\n                    return _.multiply(_.parse('sqrt(pi)'), new Symbol(c));\r\n                }\r\n            }\r\n            return _.symfunction(FACTORIAL, [symbol]);\r\n        }\r\n        ;\r\n        /**\r\n         * Returns the continued fraction of a number\r\n         * @param {Symbol} symbol\r\n         * @param {Symbol} n\r\n         * @returns {Symbol}\r\n         */\r\n        function continued_fraction(symbol, n) {\r\n            var _symbol = evaluate(symbol);\r\n            if(_symbol.isConstant()) {\r\n                var cf = Math2.continuedFraction(_symbol, n);\r\n                //convert the fractions array to a new Vector\r\n                var fractions = Vector.fromArray(cf.fractions.map(function (x) {\r\n                    return new Symbol(x);\r\n                }));\r\n                return Vector.fromArray([new Symbol(cf.sign), new Symbol(cf.whole), fractions]);\r\n            }\r\n            return _.symfunction('continued_fraction', arguments);\r\n        }\r\n        /**\r\n         * Returns the error function\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function erf(symbol) {\r\n            var _symbol = evaluate(symbol);\r\n\r\n            if(_symbol.isConstant()) {\r\n                return Math2.erf(_symbol);\r\n            }\r\n            else if(_symbol.isImaginary()) {\r\n                return complex.erf(symbol);\r\n            }\r\n            return _.symfunction('erf', arguments);\r\n        }\r\n        ;\r\n        /**\r\n         * The mod function\r\n         * @param {Symbol} symbol1\r\n         * @param {Symbol} symbol2\r\n         * @returns {Symbol}\r\n         */\r\n        function mod(symbol1, symbol2) {\r\n            if(symbol1.isConstant() && symbol2.isConstant()) {\r\n                var retval = new Symbol(1);\r\n                retval.multiplier = retval.multiplier.multiply(symbol1.multiplier.mod(symbol2.multiplier));\r\n                return retval;\r\n            }\r\n            //try to see if division has remainder of zero\r\n            var r = _.divide(symbol1.clone(), symbol2.clone());\r\n            if(isInt(r))\r\n                return new Symbol(0);\r\n            return _.symfunction('mod', [symbol1, symbol2]);\r\n        }\r\n        /**\r\n         * A branghing function\r\n         * @param {Boolean} condition\r\n         * @param {Symbol} a\r\n         * @param {Symbol} b\r\n         * @returns {Symbol}\r\n         */\r\n        function IF(condition, a, b) {\r\n            if(typeof condition !== 'boolean')\r\n                if(isNumericSymbol(condition))\r\n                    condition = !!Number(condition);\r\n            if(condition)\r\n                return a;\r\n            return b;\r\n        }\r\n        /**\r\n         *\r\n         * @param {Matrix|Vector|Set|Collection} obj\r\n         * @param {Symbol} item\r\n         * @returns {Boolean}\r\n         */\r\n        function is_in(obj, item) {\r\n            if(isMatrix(obj)) {\r\n                for(var i = 0, l = obj.rows(); i < l; i++) {\r\n                    for(var j = 0, l2 = obj.cols(); j < l2; j++) {\r\n                        var element = obj.elements[i][j];\r\n                        if(element.equals(item))\r\n                            return new Symbol(1);\r\n                    }\r\n                }\r\n            }\r\n            else if(obj.elements) {\r\n                for(var i = 0, l = obj.elements.length; i < l; i++) {\r\n                    if(obj.elements[i].equals(item))\r\n                        return new Symbol(1);\r\n                }\r\n            }\r\n\r\n            return new Symbol(0);\r\n        }\r\n\r\n        /**\r\n         * A symbolic extension for sinc\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function sinc(symbol) {\r\n            if(Settings.PARSE2NUMBER) {\r\n                if(symbol.isConstant()) {\r\n                    return new Symbol(Math2.sinc(symbol));\r\n                }\r\n                return _.parse(format('sin({0})/({0})', symbol));\r\n            }\r\n            return _.symfunction('sinc', [symbol]);\r\n        }\r\n\r\n        /**\r\n         * A symbolic extension for exp. This will auto-convert all instances of exp(x) to e^x.\r\n         * Thanks @ Happypig375\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function exp(symbol) {\r\n            if(symbol.fname === Settings.LOG && symbol.isLinear()) {\r\n                return _.pow(symbol.args[0], Symbol.create(symbol.multiplier));\r\n            }\r\n            return _.parse(format('e^({0})', symbol));\r\n        }\r\n\r\n        /**\r\n         * Converts value degrees to radians\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function radians(symbol) {\r\n            return _.parse(format('({0})*pi/180', symbol));\r\n        }\r\n\r\n        /**\r\n         * Converts value from radians to degrees\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function degrees(symbol) {\r\n            return _.parse(format('({0})*180/pi', symbol));\r\n        }\r\n\r\n        function nroots(symbol) {\r\n            var a, b;\r\n            if(symbol.group === FN && symbol.fname === '') {\r\n                a = Symbol.unwrapPARENS(_.parse(symbol).toLinear());\r\n                b = _.parse(symbol.power);\r\n            }\r\n            else if(symbol.group === P) {\r\n                a = _.parse(symbol.value);\r\n                b = _.parse(symbol.power);\r\n            }\r\n\r\n            if(a && b && a.group === N && b.group === N) {\r\n                var _roots = [];\r\n                var parts = Symbol.toPolarFormArray(symbol);\r\n                var r = _.parse(a).abs().toString();\r\n                //https://en.wikipedia.org/wiki/De_Moivre%27s_formula\r\n                var x = arg(a).toString();\r\n                var n = b.multiplier.den.toString();\r\n                var p = b.multiplier.num.toString();\r\n\r\n                var formula = \"(({0})^({1})*(cos({3})+({2})*sin({3})))^({4})\";\r\n                for(var i = 0; i < n; i++) {\r\n                    var t = evaluate(_.parse(format(\"(({0})+2*pi*({1}))/({2})\", x, i, n))).multiplier.toDecimal();\r\n                    _roots.push(evaluate(_.parse(format(formula, r, n, Settings.IMAGINARY, t, p))));\r\n                }\r\n                return Vector.fromArray(_roots);\r\n            }\r\n            else if(symbol.isConstant(true)) {\r\n                var sign = symbol.sign();\r\n                var x = evaluate(symbol.abs());\r\n                var root = _.sqrt(x);\r\n\r\n                var _roots = [root.clone(), root.negate()];\r\n\r\n                if(sign < 0)\r\n                    _roots = _roots.map(function (x) {\r\n                        return _.multiply(x, Symbol.imaginary());\r\n                    });\r\n            }\r\n            else {\r\n                _roots = [_.parse(symbol)];\r\n            }\r\n\r\n            return Vector.fromArray(_roots);\r\n        }\r\n\r\n        /**\r\n         * Rationalizes a symbol\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function rationalize(symbol) {\r\n            if(symbol.isComposite()) {\r\n                var retval = new Symbol(0);\r\n                var num, den, retnum, retden, a, b, n, d;\r\n                symbol.each(function (x) {\r\n                    num = x.getNum();\r\n                    den = x.getDenom();\r\n                    retnum = retval.getNum();\r\n                    retden = retval.getDenom();\r\n                    a = _.multiply(den, retnum);\r\n                    b = _.multiply(num, retden);\r\n                    n = _.expand(_.add(a, b));\r\n                    d = _.multiply(retden, den);\r\n                    retval = _.divide(n, d);\r\n                }, true);\r\n\r\n                return retval;\r\n            }\r\n            return symbol;\r\n        }\r\n\r\n        /**\r\n         * The square root function\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function sqrt(symbol) {\r\n            if(!isSymbol(symbol)) {\r\n                symbol = _.parse(symbol);\r\n            }\r\n            \r\n            // Exit early for EX\r\n            if(symbol.group === EX) {\r\n                return _.symfunction(SQRT, [symbol]);\r\n            }\r\n\r\n            if(symbol.fname === '' && symbol.power.equals(1))\r\n                symbol = symbol.args[0];\r\n\r\n            var is_negative = symbol.multiplier.sign() < 0;\r\n\r\n            if(Settings.PARSE2NUMBER) {\r\n                if(symbol.isConstant() && !is_negative) {\r\n                    return new Symbol(bigDec.sqrt(symbol.multiplier.toDecimal()));\r\n                }\r\n                else if(symbol.isImaginary()) {\r\n                    return complex.sqrt(symbol);\r\n                }\r\n                else if(symbol.group === S) {\r\n                    return _.symfunction('sqrt', [symbol]);\r\n                }\r\n            }\r\n\r\n            var img, retval,\r\n                    isConstant = symbol.isConstant();\r\n\r\n            if(symbol.group === CB && symbol.isLinear()) {\r\n                var m = sqrt(Symbol(symbol.multiplier));\r\n                for(var s in symbol.symbols) {\r\n                    var x = symbol.symbols[s];\r\n                    m = _.multiply(m, sqrt(x));\r\n                }\r\n\r\n                retval = m;\r\n            }\r\n            //if the symbol is already sqrt then it's that symbol^(1/4) and we can unwrap it\r\n            else if(symbol.fname === SQRT) {\r\n                var s = symbol.args[0];\r\n                var ms = symbol.multiplier;\r\n                s.setPower(symbol.power.multiply(new Frac(0.25)));\r\n                retval = s;\r\n                //grab the multiplier\r\n                if(!ms.equals(1))\r\n                    retval = _.multiply(sqrt(_.parse(ms)), retval);\r\n            }\r\n            //if the symbol is a fraction then we don't keep can unwrap it. For instance\r\n            //no need to keep sqrt(x^(1/3))\r\n            else if(!symbol.power.isInteger()) {\r\n                symbol.setPower(symbol.power.multiply(new Frac(0.5)));\r\n                retval = symbol;\r\n            }\r\n            else if(symbol.multiplier < 0 && symbol.group === S) {\r\n                var a = _.parse(symbol.multiplier).negate();\r\n                var b = _.parse(symbol).toUnitMultiplier().negate();\r\n                retval = _.multiply(_.symfunction(Settings.SQRT, [b]), sqrt(a));\r\n            }\r\n            else {\r\n\r\n                //Related to issue #401. Since sqrt(a)*sqrt(b^-1) relates in issues, we'll change the form\r\n                //to sqrt(a)*sqrt(b)^1 for better simplification\r\n                //the sign of the power\r\n                var sign = symbol.power.sign();\r\n                //remove the sign\r\n                symbol.power = symbol.power.abs();\r\n\r\n                //if the symbols is imagary then we place in the imaginary part. We'll return it\r\n                //as a product\r\n                if(isConstant && symbol.multiplier.lessThan(0)) {\r\n                    img = Symbol.imaginary();\r\n                    symbol.multiplier = symbol.multiplier.abs();\r\n                }\r\n\r\n                var q = symbol.multiplier.toDecimal(),\r\n                        qa = Math.abs(q),\r\n                        t = Math.sqrt(qa);\r\n\r\n                var m;\r\n                //it's a perfect square so take the square\r\n                if(isInt(t)) {\r\n                    m = new Symbol(t);\r\n                }\r\n                else if(isInt(q)) {\r\n                    var factors = Math2.ifactor(q);\r\n                    var tw = 1;\r\n                    for(var x in factors) {\r\n                        var n = factors[x],\r\n                                nn = (n - (n % 2)); //get out the whole numbers\r\n                        if(nn) { //if there is a whole number ...\r\n                            var w = Math.pow(x, nn);\r\n                            tw *= Math.pow(x, nn / 2); //add to total wholes\r\n                            q /= w; //reduce the number by the wholes\r\n                        }\r\n                    }\r\n                    m = _.multiply(_.symfunction(SQRT, [new Symbol(q)]), new Symbol(tw));\r\n                }\r\n                else {\r\n                    //reduce the numerator and denominator using prime factorization\r\n                    var c = [new Symbol(symbol.multiplier.num), new Symbol(symbol.multiplier.den)];\r\n                    var r = [new Symbol(1), new Symbol(1)];\r\n                    var sq = [new Symbol(1), new Symbol(1)];\r\n                    for(var i = 0; i < 2; i++) {\r\n                        var n = c[i];\r\n                        //get the prime factors and loop through each.\r\n                        pfactor(n).each(function (x) {\r\n                            x = Symbol.unwrapPARENS(x);\r\n                            var b = x.clone().toLinear();\r\n                            var p = Number(x.power);\r\n                            //We'll consider it safe to use the native Number since 2^1000 is already a pretty huge number\r\n                            var rem = p % 2; //get the remainder. This will be 1 if 3 since sqrt(n^2) = n where n is positive\r\n                            var w = (p - rem) / 2; //get the whole numbers of n/2\r\n                            r[i] = _.multiply(r[i], _.pow(b, new Symbol(w)));\r\n                            sq[i] = _.multiply(sq[i], sqrt(_.pow(b, new Symbol(rem))));\r\n                        });\r\n                    }\r\n                    m = _.divide(_.multiply(r[0], sq[0]), _.multiply(r[1], sq[1]));\r\n                }\r\n\r\n\r\n                //strip the multiplier since we already took the sqrt\r\n                symbol = symbol.toUnitMultiplier(true);\r\n                //if the symbol is one just return one and not the sqrt function\r\n                if(symbol.isOne()) {\r\n                    retval = symbol;\r\n                }\r\n                else if(even(symbol.power.toString())) {\r\n                    //just raise it to the 1/2\r\n                    retval = _.pow(symbol.clone(), new Symbol(0.5));\r\n                }\r\n                else {\r\n                    retval = _.symfunction(SQRT, [symbol]);\r\n                }\r\n\r\n                //put back the sign that was removed earlier\r\n                if(sign < 0)\r\n                    retval.power.negate();\r\n\r\n                if(m)\r\n                    retval = _.multiply(m, retval);\r\n\r\n                if(img)\r\n                    retval = _.multiply(img, retval);\r\n            }\r\n\r\n            if(is_negative && Settings.PARSE2NUMBER)\r\n                return _.parse(retval);\r\n\r\n            return retval;\r\n        }\r\n\r\n        /**\r\n         * The cube root function\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function cbrt(symbol) {\r\n            if(!symbol.isConstant(true)) {\r\n                var retval;\r\n\r\n                var n = symbol.power / 3;\r\n                //take the cube root of the multplier\r\n                var m = _.pow(_.parse(symbol.multiplier), new Symbol(1 / 3));\r\n                //strip the multiplier\r\n                var sym = symbol.toUnitMultiplier();\r\n\r\n                //simplify the power\r\n                if(isInt(n)) {\r\n                    retval = _.pow(sym.toLinear(), _.parse(n));\r\n                }\r\n                else {\r\n                    if(sym.group === CB) {\r\n                        retval = new Symbol(1);\r\n                        sym.each(function (x) {\r\n                            retval = _.multiply(retval, cbrt(x));\r\n                        });\r\n                    }\r\n                    else {\r\n                        retval = _.symfunction('cbrt', [sym]);\r\n                    }\r\n                }\r\n\r\n                return _.multiply(m, retval);\r\n            }\r\n            return nthroot(symbol, new Symbol(3));\r\n        }\r\n\r\n        function scientific(symbol, sigfigs) {\r\n            //Just set the flag and keep it moving. Symbol.toString will deal with how to\r\n            //display this\r\n            symbol.scientific = sigfigs || 10;\r\n            return symbol;\r\n        }\r\n\r\n        /**\r\n         *\r\n         * @param {Symbol} num - the number being raised\r\n         * @param {Symbol} p - the exponent\r\n         * @param {type} prec - the precision wanted\r\n         * @param {bool} asbig - true if a bigDecimal is wanted\r\n         * @returns {Symbol}\r\n         */\r\n        function nthroot(num, p, prec, asbig) {\r\n            //clone p and convert to a number if possible\r\n            p = evaluate(_.parse(p));\r\n\r\n            //cannot calculate if p = 0. nthroot(0, 0) => 0^(1/0) => undefined\r\n            if(p.equals(0)) {\r\n                throw new UndefinedError('Unable to calculate nthroots of zero');\r\n            }\r\n\r\n            //Stop computation if it negative and even since we have an imaginary result\r\n            if(num < 0 && even(p))\r\n                throw new Error('Cannot calculate nthroot of negative number for even powers');\r\n\r\n            //return non numeric values unevaluated\r\n            if(!num.isConstant(true)) {\r\n                return _.symfunction('nthroot', arguments);\r\n            }\r\n\r\n            //evaluate numeric values\r\n            if(num.group !== N) {\r\n                num = evaluate(num);\r\n            }\r\n\r\n            //default is to return a big value\r\n            if(typeof asbig === 'undefined')\r\n                asbig = true;\r\n\r\n            prec = prec || 25;\r\n\r\n            var sign = num.sign();\r\n            var retval;\r\n            var ans;\r\n\r\n            if(sign < 0) {\r\n                num = abs(num); //remove the sign\r\n            }\r\n\r\n            if(isInt(num) && p.isConstant()) {\r\n\r\n                if(num < 18446744073709551616) {\r\n                    //2^64\r\n                    ans = Frac.create(Math.pow(num, 1 / p));\r\n                }\r\n                else {\r\n                    ans = Math2.nthroot(num, p);\r\n                }\r\n\r\n                var retval;\r\n                if(asbig) {\r\n                    retval = new Symbol(ans);\r\n                }\r\n                retval = new Symbol(ans.toDecimal(prec));\r\n\r\n                return _.multiply(new Symbol(sign), retval);\r\n            }\r\n        }\r\n\r\n        function pfactor(symbol) {\r\n            //Fix issue #458 | nerdamer(\"sqrt(1-(3.3333333550520926e-7)^2)\").evaluate().text()\r\n            //More Big Number issues >:(\r\n            if(symbol.greaterThan(9.999999999998891e+41) || symbol.equals(-1))\r\n                return symbol;\r\n            //Fix issue #298\r\n            if(symbol.equals(Math.PI))\r\n                return new Symbol(Math.PI);\r\n            //evaluate the symbol to merge constants\r\n            symbol = evaluate(symbol.clone());\r\n\r\n            if(symbol.isConstant()) {\r\n                var retval = new Symbol(1);\r\n                var m = symbol.toString();\r\n                if(isInt(m)) {\r\n                    var factors = Math2.ifactor(m);\r\n                    for(var factor in factors) {\r\n                        var p = factors[factor];\r\n                        retval = _.multiply(retval, _.symfunction('parens', [new Symbol(factor).setPower(new Frac(p))]));\r\n                    }\r\n                }\r\n                else {\r\n                    var n = pfactor(new Symbol(symbol.multiplier.num));\r\n                    var d = pfactor(new Symbol(symbol.multiplier.den));\r\n                    retval = _.multiply(_.symfunction('parens', [n]), _.symfunction('parens', [d]).invert());\r\n                }\r\n            }\r\n            else\r\n                retval = _.symfunction('pfactor', arguments);\r\n            return retval;\r\n        }\r\n\r\n        /**\r\n         * Get's the real part of a complex number. Return number if real\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function realpart(symbol) {\r\n            return symbol.realpart();\r\n        }\r\n\r\n        /**\r\n         * Get's the imaginary part of a complex number\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function imagpart(symbol) {\r\n            return symbol.imagpart();\r\n        }\r\n\r\n        /**\r\n         * Computes the conjugate of a complex number\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function conjugate(symbol) {\r\n            var re = symbol.realpart();\r\n            var im = symbol.imagpart();\r\n            return _.add(re, _.multiply(im.negate(), Symbol.imaginary()));\r\n        }\r\n\r\n        /**\r\n         * Returns the arugment of a complex number\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function arg(symbol) {\r\n            var re = symbol.realpart();\r\n            var im = symbol.imagpart();\r\n            if(re.isConstant() && im.isConstant())\r\n                return new Symbol(Math.atan2(im, re));\r\n            return _.symfunction('atan2', [im, re]);\r\n        }\r\n\r\n        /**\r\n         * Returns the arugment of a complex number\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function arg(symbol) {\r\n            var re = symbol.realpart();\r\n            var im = symbol.imagpart();\r\n            if(re.isConstant() && im.isConstant()) {\r\n                if(im.equals(0) && re.equals(-1)) {\r\n                    return _.parse('pi');\r\n                }\r\n                else if(im.equals(1) && re.equals(0)) {\r\n                    return _.parse('pi/2');\r\n                }\r\n                else if(im.equals(1) && re.equals(1)) {\r\n                    return _.parse('pi/4');\r\n                }\r\n                return new Symbol(Math.atan2(im, re));\r\n            }\r\n            return _.symfunction('atan2', [im, re]);\r\n        }\r\n\r\n        /**\r\n         * Returns the polarform of a complex number\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function polarform(symbol) {\r\n            var p, r, e, theta;\r\n            p = Symbol.toPolarFormArray(symbol);\r\n            theta = p[1];\r\n            r = p[0];\r\n            e = _.parse(format('e^({0}*({1}))', Settings.IMAGINARY, theta));\r\n            return _.multiply(r, e);\r\n        }\r\n\r\n        /**\r\n         * Returns the rectangular form of a complex number. Does not work for symbolic coefficients\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function rectform(symbol) {\r\n            //TODO: e^((i*pi)/4)\r\n            var original = symbol.clone();\r\n            try {\r\n                var f, p, q, s, h, d, n;\r\n                f = decompose_fn(symbol, 'e', true);\r\n                p = _.divide(f.x.power, Symbol.imaginary());\r\n                q = evaluate(trig.tan(p));\r\n                s = _.pow(f.a, new Symbol(2));\r\n                d = q.getDenom(true);\r\n                n = q.getNum();\r\n                h = Symbol.hyp(n, d);\r\n                //check\r\n                if(h.equals(f.a)) {\r\n                    return _.add(d, _.multiply(Symbol.imaginary(), n));\r\n                }\r\n                else {\r\n                    return original;\r\n                }\r\n            }\r\n            catch(e) {\r\n                return original;\r\n            }\r\n        }\r\n\r\n        function symMinMax(f, args) {\r\n            args.map(function (x) {\r\n                x.numVal = evaluate(x).multiplier;\r\n            });\r\n            var l, a, b, a_val, b_val;\r\n            while(true) {\r\n                l = args.length;\r\n                if(l < 2)\r\n                    return args[0];\r\n                a = args.pop();\r\n                b = args[l - 2];\r\n                if(f === 'min' ? a.numVal < b.numVal : a.numVal > b.numVal) {\r\n                    args.pop();\r\n                    args.push(a);\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Returns maximum of a set of numbers\r\n         * @returns {Symbol}\r\n         */\r\n        function max() {\r\n            var args = [].slice.call(arguments);\r\n            if(allSame(args))\r\n                return args[0];\r\n            if(allNumbers(args))\r\n                return new Symbol(Math.max.apply(null, args));\r\n            if(Settings.SYMBOLIC_MIN_MAX && allConstants(args))\r\n                return symMinMax('max', args);\r\n            return _.symfunction('max', args);\r\n        }\r\n\r\n        /**\r\n         * Returns minimum of a set of numbers\r\n         * @returns {Symbol}\r\n         */\r\n        function min() {\r\n            var args = [].slice.call(arguments);\r\n            if(allSame(args))\r\n                return args[0];\r\n            if(allNumbers(args))\r\n                return new Symbol(Math.min.apply(null, args));\r\n            if(Settings.SYMBOLIC_MIN_MAX && allConstants(args))\r\n                return symMinMax('min', args);\r\n            return _.symfunction('min', args);\r\n        }\r\n\r\n        /**\r\n         * Returns the sign of a number\r\n         * @param {Symbol} x\r\n         * @returns {Symbol}\r\n         */\r\n        function sign(x) {\r\n            if(x.isConstant(true))\r\n                return new Symbol(Math.sign(evaluate(x)));\r\n            return _.symfunction('sign', arguments);\r\n        }\r\n\r\n        function sort(symbol, opt) {\r\n            opt = opt ? opt.toString() : 'asc';\r\n            var getval = function (e) {\r\n                if(e.group === N)\r\n                    return e.multiplier;\r\n                if(e.group === FN) {\r\n                    if(e.fname === '')\r\n                        return getval(e.args[0]);\r\n                    return e.fname;\r\n                }\r\n                if(e.group === S)\r\n                    return e.power;\r\n\r\n                return e.value;\r\n            };\r\n            var symbols = isVector(symbol) ? symbol.elements : symbol.collectSymbols();\r\n            return new Vector(symbols.sort(function (a, b) {\r\n                var aval = getval(a),\r\n                        bval = getval(b);\r\n                if(opt === 'desc')\r\n                    return bval - aval;\r\n                return aval - bval;\r\n            }));\r\n        }\r\n\r\n        /**\r\n         * The log function\r\n         * @param {Symbol} symbol\r\n         * @param {Symbol} base\r\n         * @returns {Symbol}\r\n         */\r\n        function log(symbol, base) {\r\n\r\n            if(symbol.equals(1)) {\r\n                return new Symbol(0);\r\n            }\r\n\r\n            var retval;\r\n\r\n            if(symbol.fname === SQRT && symbol.multiplier.equals(1)) {\r\n                retval = _.divide(log(symbol.args[0]), new Symbol(2));\r\n\r\n                if(symbol.power.sign() < 0) {\r\n                    retval.negate();\r\n                }\r\n\r\n                // Exit early\r\n                return retval;\r\n            }\r\n\r\n            //log(0) is undefined so complain\r\n            if(symbol.equals(0)) {\r\n                throw new UndefinedError(Settings.LOG + '(0) is undefined!');\r\n            }\r\n\r\n            //deal with imaginary values\r\n            if(symbol.isImaginary()) {\r\n                return complex.evaluate(symbol, Settings.LOG);\r\n            }\r\n\r\n            if(symbol.isConstant() && typeof base !== 'undefined' && base.isConstant()) {\r\n                var log_sym = Math.log(symbol);\r\n                var log_base = Math.log(base);\r\n                retval = new Symbol(log_sym / log_base);\r\n            }\r\n            else if(symbol.group === EX && symbol.power.multiplier.lessThan(0) || symbol.power.toString() === '-1') {\r\n                symbol.power.negate();\r\n                //move the negative outside but keep the positive inside :)\r\n                retval = log(symbol).negate();\r\n            }\r\n            else if(symbol.value === 'e' && symbol.multiplier.equals(1)) {\r\n                var p = symbol.power;\r\n                retval = isSymbol(p) ? p : new Symbol(p);\r\n            }\r\n            else if(symbol.group === FN && symbol.fname === 'exp') {\r\n                var s = symbol.args[0];\r\n                if(symbol.multiplier.equals(1))\r\n                    retval = _.multiply(s, new Symbol(symbol.power));\r\n                else\r\n                    retval = _.symfunction(Settings.LOG, [symbol]);\r\n            }\r\n            else if(Settings.PARSE2NUMBER && isNumericSymbol(symbol)) {\r\n                // Parse for safety.\r\n                symbol = _.parse(symbol);\r\n\r\n                var img_part;\r\n                if(symbol.multiplier.lessThan(0)) {\r\n                    symbol.negate();\r\n                    img_part = _.multiply(new Symbol(Math.PI), new Symbol('i'));\r\n                }\r\n\r\n                retval = new Symbol(Math.log(symbol.multiplier.toDecimal()));\r\n\r\n                if(img_part) {\r\n                    retval = _.add(retval, img_part);\r\n                }\r\n\r\n            }\r\n            else {\r\n                var s;\r\n                if(!symbol.power.equals(1) && !symbol.contains('e')) {\r\n                    s = symbol.group === EX ? symbol.power : new Symbol(symbol.power);\r\n                    symbol.toLinear();\r\n                }\r\n                //log(a,a) = 1 since the base is allowed to be changed.\r\n                //This was pointed out by Happypig375 in issue #280\r\n                if(arguments.length > 1 && allSame(arguments)) {\r\n                    retval = new Symbol(1);\r\n                }\r\n                else {\r\n                    retval = _.symfunction(Settings.LOG, arguments);\r\n                }\r\n\r\n                if(s)\r\n                    retval = _.multiply(s, retval);\r\n            }\r\n\r\n            return retval;\r\n        }\r\n\r\n        /**\r\n         * Round a number up to s decimal places\r\n         * @param {Number} x\r\n         * @param {int} s - the number of decimal places\r\n         * @returns {undefined}\r\n         */\r\n        function round(x, s) {\r\n            var sIsConstant = s && s.isConstant() || typeof s === 'undefined';\r\n            if(x.isConstant() && sIsConstant) {\r\n                var v, e, exp, retval;\r\n                v = x;\r\n                //round the coefficient of then number but not the actual decimal value\r\n                //we know this because a negative number was passed\r\n                if(s && s.lessThan(0)) {\r\n                    s = abs(s);\r\n                    //convert the number to exponential form\r\n                    e = Number(x).toExponential().toString().split('e');\r\n                    //point v to the coefficient of then number\r\n                    v = e[0];\r\n                    //set the expontent\r\n                    exp = e[1];\r\n                }\r\n                //round the number to the requested precision\r\n                retval = new Symbol(nround(v, Number(s || 0)));\r\n                //if there's a exponent then put it back\r\n                return _.multiply(retval, _.pow(new Symbol(10), new Symbol(exp || 0)))\r\n            }\r\n\r\n\r\n            return _.symfunction('round', arguments);\r\n        }\r\n\r\n        /**\r\n         * Gets the quadrant of the trig function\r\n         * @param {Frac} m\r\n         * @returns {Int}\r\n         */\r\n        function getQuadrant(m) {\r\n            var v = m % 2, quadrant;\r\n\r\n            if(v < 0)\r\n                v = 2 + v; //put it in terms of pi\r\n\r\n            if(v >= 0 && v <= 0.5)\r\n                quadrant = 1;\r\n            else if(v > 0.5 && v <= 1)\r\n                quadrant = 2;\r\n            else if(v > 1 && v <= 1.5)\r\n                quadrant = 3;\r\n            else\r\n                quadrant = 4;\r\n            return quadrant;\r\n        }\r\n\r\n        /*\r\n         * Serves as a bridge between numbers and bigNumbers\r\n         * @param {Frac|Number} n\r\n         * @returns {Symbol}\r\n         */\r\n        function bigConvert(n) {\r\n            if(!isFinite(n)) {\r\n                var sign = Math.sign(n);\r\n                var r = new Symbol(String(Math.abs(n)));\r\n                r.multiplier = r.multiplier.multiply(new Frac(sign));\r\n                return r;\r\n            }\r\n            if(isSymbol(n))\r\n                return n;\r\n            if(typeof n === 'number') {\r\n                try {\r\n                    n = Frac.simple(n);\r\n                }\r\n                catch(e) {\r\n                    n = new Frac(n);\r\n                }\r\n            }\r\n\r\n            var symbol = new Symbol(0);\r\n            symbol.multiplier = n;\r\n            return symbol;\r\n        }\r\n        ;\r\n\r\n        function clean(symbol) {\r\n            // handle functions with numeric values\r\n            // handle denominator within denominator\r\n            // handle trig simplifications\r\n            var g = symbol.group, retval;\r\n            //Now let's get to work\r\n            if(g === CP) {\r\n                var num = symbol.getNum(),\r\n                        den = symbol.getDenom() || new Symbol(1),\r\n                        p = Number(symbol.power),\r\n                        factor = new Symbol(1);\r\n                if(Math.abs(p) === 1) {\r\n                    den.each(function (x) {\r\n                        if(x.group === CB) {\r\n                            factor = _.multiply(factor, clean(x.getDenom()));\r\n                        }\r\n                        else if(x.power.lessThan(0)) {\r\n                            factor = _.multiply(factor, clean(x.clone().toUnitMultiplier()));\r\n                        }\r\n                    });\r\n\r\n                    var new_den = new Symbol(0);\r\n                    //now divide out the factor and add to new den\r\n                    den.each(function (x) {\r\n                        new_den = _.add(_.divide(x, factor.clone()), new_den);\r\n                    });\r\n\r\n                    factor.invert(); //invert so it can be added to the top\r\n                    var new_num;\r\n                    if(num.isComposite()) {\r\n                        new_num = new Symbol(0);\r\n                        num.each(function (x) {\r\n                            new_num = _.add(_.multiply(clean(x), factor.clone()), new_num);\r\n                        });\r\n                    }\r\n                    else\r\n                        new_num = _.multiply(factor, num);\r\n\r\n                    retval = _.divide(new_num, new_den);\r\n                }\r\n            }\r\n            else if(g === CB) {\r\n                retval = new Symbol(1);\r\n                symbol.each(function (x) {\r\n                    retval = _.multiply(retval, _.clean(x));\r\n                });\r\n            }\r\n            else if(g === FN) {\r\n                if(symbol.args.length === 1 && symbol.args[0].isConstant())\r\n                    retval = block('PARSE2NUMBER', function () {\r\n                        return _.parse(symbol);\r\n                    }, true);\r\n            }\r\n\r\n            if(!retval)\r\n                retval = symbol;\r\n\r\n            return retval;\r\n        }\r\n\r\n        /**\r\n         * A wrapper for the expand function\r\n         * @param {Symbol} symbol\r\n         * @returns {Symbol}\r\n         */\r\n        function expandall(symbol, opt) {\r\n            opt = opt || {\r\n                expand_denominator: true,\r\n                expand_functions: true\r\n            };\r\n            return expand(symbol, opt);\r\n        }\r\n        /**\r\n         * Expands a symbol\r\n         * @param symbol\r\n         */\r\n        // Old expand\r\n        function expand(symbol, opt) {\r\n            if(Array.isArray(symbol)) {\r\n                return symbol.map(function (x) {\r\n                    return expand(x, opt);\r\n                });\r\n            }\r\n            opt = opt || {};\r\n            //deal with parenthesis\r\n            if(symbol.group === FN && symbol.fname === '') {\r\n                var f = expand(symbol.args[0], opt);\r\n                var x = expand(_.pow(f, _.parse(symbol.power)), opt);\r\n                return _.multiply(_.parse(symbol.multiplier), x).distributeMultiplier();\r\n            }\r\n            // We can expand these groups so no need to waste time. Just return and be done.\r\n            if([N, P, S].indexOf(symbol.group) !== -1) {\r\n                return symbol; //nothing to do\r\n            }\r\n\r\n            var original = symbol.clone();\r\n\r\n            // Set up a try-catch block. If anything goes wrong then we simply return the original symbol\r\n            try {\r\n                // Store the power and multiplier\r\n                var m = symbol.multiplier.toString();\r\n                var p = Number(symbol.power);\r\n                var retval = symbol;\r\n\r\n                // Handle (a+b)^2 | (x+x^2)^2\r\n                if(symbol.isComposite() && isInt(symbol.power) && symbol.power > 0) {\r\n                    var n = p - 1;\r\n                    // Strip the expression of it's multiplier and power. We'll call it f. The power will be p and the multiplier m.\r\n                    var f = new Symbol(0);\r\n\r\n                    symbol.each(function (x) {\r\n                        f = _.add(f, expand(_.parse(x), opt));\r\n                    });\r\n\r\n                    var expanded = _.parse(f);\r\n\r\n                    for(var i = 0; i < n; i++) {\r\n                        expanded = mix(expanded, f, opt);\r\n                    }\r\n\r\n                    retval = _.multiply(_.parse(m), expanded).distributeMultiplier();\r\n                }\r\n                else if(symbol.group === FN && opt.expand_functions === true) {\r\n                    var args = [];\r\n                    // Expand function the arguments\r\n                    symbol.args.forEach(function (x) {\r\n                        args.push(expand(x, opt));\r\n                    });\r\n                    // Put back the power and multiplier\r\n                    retval = _.pow(_.symfunction(symbol.fname, args), _.parse(symbol.power));\r\n                    retval = _.multiply(retval, _.parse(symbol.multiplier));\r\n                }\r\n                else if(symbol.isComposite() && isInt(symbol.power) && symbol.power < 0 && opt.expand_denominator === true) {\r\n                    // Invert it. Expand it and then re-invert it.\r\n                    symbol = symbol.invert();\r\n                    retval = expand(symbol, opt);\r\n                    retval.invert();\r\n                }\r\n                else if(symbol.group === CB) {\r\n                    var rank = function (s) {\r\n                        switch(s.group) {\r\n                            case CP:\r\n                                return 0;\r\n                            case PL:\r\n                                return 1;\r\n                            case CB:\r\n                                return 2;\r\n                            case FN:\r\n                                return 3;\r\n                            default:\r\n                                return 4;\r\n                        }\r\n                    };\r\n                    // Consider (a+b)(c+d). The result will be (a*c+a*d)+(b*c+b*d).\r\n                    // We start by moving collecting the symbols. We want others>FN>CB>PL>CP\r\n                    var symbols = symbol.collectSymbols().sort(function (a, b) {\r\n                        return rank(b) - rank(a);\r\n                    })\r\n                            // Distribute the power to each symbol and expand\r\n                            .map(function (s) {\r\n                                var x = _.pow(s, _.parse(p));\r\n                                var e = expand(x, opt);\r\n                                return e;\r\n                            });\r\n\r\n                    var f = symbols.pop();\r\n\r\n                    // If the first symbols isn't a composite then we're done\r\n                    if(f.isComposite() && f.isLinear()) {\r\n                        symbols.forEach(function (s) {\r\n                            f = mix(f, s, opt);\r\n                        });\r\n\r\n                        // If f is of group PL or CP then we can expand some more\r\n                        if(f.isComposite()) {\r\n                            if(f.power > 1) {\r\n                                f = expand(_.pow(f, _.parse(f.power)), opt);\r\n                            }\r\n                            // Put back the multiplier\r\n                            retval = _.multiply(_.parse(m), f).distributeMultiplier();\r\n                            ;\r\n                        }\r\n                        else {\r\n                            // Everything is expanded at this point so if it's still a CB\r\n                            // then just return the symbol\r\n                            retval = f;\r\n                        }\r\n                    }\r\n                    else {\r\n                        // Just multiply back in the expanded form of each\r\n                        retval = f;\r\n                        symbols.forEach(function (s) {\r\n                            retval = _.multiply(retval, s);\r\n                        });\r\n                        // Put back the multiplier\r\n                        retval = _.multiply(retval, _.parse(m)).distributeMultiplier();\r\n                    }\r\n\r\n                    // TODO: This exists solely as a quick fix for sqrt(11)*sqrt(33) not simplifying.\r\n                    if(retval.group === CB) {\r\n                        retval = _.parse(retval);\r\n                    }\r\n                }\r\n                else {\r\n                    // Otherwise just return the expression\r\n                    retval = symbol;\r\n                }\r\n                // Final cleanup and return\r\n                return retval;\r\n            }\r\n            catch(e) {\r\n                return original;\r\n            }\r\n\r\n            return original;\r\n        }\r\n\r\n        /**\r\n         * Returns an identity matrix of nxn\r\n         * @param {Number} n\r\n         * @returns {Matrix}\r\n         */\r\n        function imatrix(n) {\r\n            return Matrix.identity(n);\r\n        }\r\n\r\n        /**\r\n         * Retrieves and item from a vector\r\n         * @param {Vector} vector\r\n         * @param {Number} index\r\n         * @returns {Vector|Symbol}\r\n         */\r\n        function vecget(vector, index) {\r\n            if(index.isConstant() && isInt(index))\r\n                return vector.elements[index];\r\n            return _.symfunction('vecget', arguments);\r\n        }\r\n\r\n        /**\r\n         * Removes duplicates from a vector\r\n         * @param {Vector} vector\r\n         * @param {Number} tolerance\r\n         * @returns {Vector}\r\n         */\r\n        function vectrim(vector, tolerance) {\r\n            tolerance = typeof tolerance === 'undefined' ? 1e-14 : tolerance;\r\n\r\n            vector = vector.clone();\r\n\r\n            tolerance = Number(tolerance);\r\n            //place algebraic solutions first\r\n            vector.elements.sort(function (a, b) {\r\n                return b.group - a.group;\r\n            });\r\n            //depending on the start point we may have duplicates so we need to clean those up a bit.\r\n            //start by creating an object with the solution and the numeric value. This way we don't destroy algebraic values\r\n            vector.elements = removeDuplicates(vector.elements, function (a, b) {\r\n                var diff = Number(_.subtract(evaluate(a), evaluate(b)).abs());\r\n                return diff <= tolerance;\r\n            });\r\n\r\n            return vector;\r\n        }\r\n\r\n        /**\r\n         * Set a value for a vector at a given index\r\n         * @param {Vector} vector\r\n         * @param {Number} index\r\n         * @param {Symbol} value\r\n         * @returns {Vector}\r\n         */\r\n        function vecset(vector, index, value) {\r\n            if(!index.isConstant)\r\n                return _.symfunction('vecset', arguments);\r\n            vector.elements[index] = value;\r\n            return vector;\r\n        }\r\n\r\n        function matget(matrix, i, j) {\r\n            if(i.isConstant() && j.isConstant())\r\n                return matrix.elements[i][j];\r\n            return _.symfunction('matget', arguments);\r\n        }\r\n\r\n        function matgetrow(matrix, i) {\r\n            if(i.isConstant())\r\n                return new Matrix(matrix.elements[i]);\r\n            return _.symfunction('matgetrow', arguments);\r\n        }\r\n\r\n        function matsetrow(matrix, i, x) {\r\n            //handle symbolics\r\n            if(!i.isConstant())\r\n                return _.symfunction('matsetrow', arguments);\r\n            if(matrix.elements[i].length !== x.elements.length)\r\n                throw new DimensionError('Matrix row must match row dimensions!');\r\n            var M = matrix.clone();\r\n            M.elements[i] = x.clone().elements;\r\n            return M;\r\n        }\r\n\r\n        function matgetcol(matrix, col_index) {\r\n            //handle symbolics\r\n            if(!col_index.isConstant())\r\n                return _.symfunction('matgetcol', arguments);\r\n            col_index = Number(col_index);\r\n            var M = Matrix.fromArray([]);\r\n            matrix.each(function (x, i, j) {\r\n                if(j === col_index) {\r\n                    M.elements.push([x.clone()]);\r\n                }\r\n            });\r\n            return M;\r\n        }\r\n\r\n        function matsetcol(matrix, j, col) {\r\n            //handle symbolics\r\n            if(!j.isConstant())\r\n                return _.symfunction('matsetcol', arguments);\r\n            j = Number(j);\r\n            if(matrix.rows() !== col.elements.length)\r\n                throw new DimensionError('Matrix columns must match number of columns!');\r\n            col.each(function (x, i) {\r\n                matrix.set(i - 1, j, x.elements[0].clone());\r\n            });\r\n            return matrix;\r\n        }\r\n\r\n\r\n        function matset(matrix, i, j, value) {\r\n            matrix.elements[i][j] = value;\r\n            return matrix;\r\n        }\r\n\r\n        //the constructor for vectors\r\n        function vector() {\r\n            return new Vector([].slice.call(arguments));\r\n        }\r\n\r\n        //the constructor for matrices\r\n        function matrix() {\r\n            return Matrix.fromArray(arguments);\r\n        }\r\n\r\n        //the constructor for sets\r\n        function set() {\r\n            return Set.fromArray(arguments);\r\n        }\r\n\r\n        function determinant(symbol) {\r\n            if(isMatrix(symbol)) {\r\n                return symbol.determinant();\r\n            }\r\n            return symbol;\r\n        }\r\n\r\n        function size(symbol) {\r\n            var retval;\r\n            if(isMatrix(symbol))\r\n                retval = [new Symbol(symbol.cols()), new Symbol(symbol.rows())];\r\n            else if(isVector(symbol) || isSet(symbol))\r\n                retval = new Symbol(symbol.elements.length);\r\n            else\r\n                err('size expects a matrix or a vector');\r\n            return retval;\r\n        }\r\n\r\n        function dot(vec1, vec2) {\r\n            if(isVector(vec1) && isVector(vec2))\r\n                return vec1.dot(vec2);\r\n            err('function dot expects 2 vectors');\r\n        }\r\n\r\n        function cross(vec1, vec2) {\r\n            if(isVector(vec1) && isVector(vec2))\r\n                return vec1.cross(vec2);\r\n            err('function cross expects 2 vectors');\r\n        }\r\n\r\n        function transpose(mat) {\r\n            if(isMatrix(mat))\r\n                return mat.transpose();\r\n            err('function transpose expects a matrix');\r\n        }\r\n\r\n        function invert(mat) {\r\n            if(isMatrix(mat))\r\n                return mat.invert();\r\n            err('invert expects a matrix');\r\n        }\r\n\r\n        //basic set functions\r\n        function union(set1, set2) {\r\n            return set1.union(set2);\r\n        }\r\n\r\n        function intersection(set1, set2) {\r\n            return set1.intersection(set2);\r\n        }\r\n\r\n        function contains(set1, e) {\r\n            return set1.contains(e);\r\n        }\r\n\r\n        function difference(set1, set2) {\r\n            return set1.difference(set2);\r\n        }\r\n\r\n        function intersects(set1, set2) {\r\n            return new Symbol(Number(set1.intersects(set2)));\r\n        }\r\n\r\n        function is_subset(set1, set2) {\r\n            return new Symbol(Number(set1.is_subset(set2)));\r\n        }\r\n\r\n        function print() {\r\n            arguments2Array(arguments).map(function (x) {\r\n                console.log(x.toString());\r\n            });\r\n        }\r\n\r\n        function testSQRT(symbol) {\r\n            //wrap the symbol in sqrt. This eliminates one more check down the line.\r\n            if(!isSymbol(symbol.power) && symbol.power.absEquals(0.5)) {\r\n                var sign = symbol.power.sign();\r\n                //don't devide the power directly. Notice the use of toString. This makes it possible\r\n                //to use a bigNumber library in the future\r\n                var retval = sqrt(symbol.group === P ? new Symbol(symbol.value) : symbol.toLinear());\r\n                //place back the sign of the power\r\n                if(sign < 0)\r\n                    retval.invert();\r\n                return retval;\r\n            }\r\n            return symbol;\r\n        }\r\n\r\n        //try to reduce a symbol by pulling its power\r\n        function testPow(symbol) {\r\n            if(symbol.group === P) {\r\n                var v = symbol.value;\r\n\r\n                var fct = primeFactors(v)[0];\r\n\r\n                //safety\r\n                if(!fct) {\r\n                    warn('Unable to compute prime factors. This should not happen. Please review and report.');\r\n                    return symbol;\r\n                }\r\n\r\n                var n = new Frac(Math.log(v) / Math.log(fct)),\r\n                        p = n.multiply(symbol.power);\r\n\r\n                //we don't want a more complex number than before\r\n                if(p.den > symbol.power.den)\r\n                    return symbol;\r\n\r\n                if(isInt(p))\r\n                    symbol = Symbol(Math.pow(fct, p));\r\n                else\r\n                    symbol = new Symbol(fct).setPower(p);\r\n            }\r\n\r\n            return symbol;\r\n        }\r\n\r\n        //Link the functions to the parse so they're available outside of the library.\r\n        //This is strictly for convenience and may be deprecated.\r\n        this.expand = expand;\r\n        this.round = round;\r\n        this.clean = clean;\r\n        this.sqrt = sqrt;\r\n        this.cbrt = cbrt;\r\n        this.abs = abs;\r\n        this.log = log;\r\n        this.rationalize = rationalize;\r\n        this.nthroot = nthroot;\r\n        this.arg = arg;\r\n        this.conjugate = conjugate;\r\n        this.imagpart = imagpart;\r\n        this.realpart = realpart;\r\n\r\n        //TODO:\r\n        //Utilize the function below instead of the linked function\r\n        this.getFunction = function (name) {\r\n            return functions[name][0];\r\n        };\r\n\r\n//Parser.methods ===============================================================\r\n        this.addPreprocessor = function (name, action, order, shift_cells) {\r\n            var names = preprocessors.names;\r\n            var actions = preprocessors.actions;\r\n            if((typeof action !== 'function')) //the person probably forgot to specify a name\r\n                throw new PreprocessorError('Incorrect parameters. Function expected!');\r\n            if(!order) {\r\n                names.push(name);\r\n                actions.push(action);\r\n            }\r\n            else {\r\n                if(shift_cells) {\r\n                    names.splice(order, 0, name);\r\n                    actions.splice(order, 0, action);\r\n                }\r\n                else {\r\n                    names[order] = name;\r\n                    actions[order] = action;\r\n                }\r\n            }\r\n        };\r\n\r\n        this.getPreprocessors = function () {\r\n            var preprocessors = {};\r\n            for(var i = 0, l = preprocessors.names.length; i < l; i++) {\r\n                var name = preprocessors.names[i];\r\n                preprocessors[name] = {\r\n                    order: i,\r\n                    action: preprocessors.actions[i]\r\n                };\r\n            }\r\n            return preprocessors;\r\n        };\r\n\r\n        this.removePreprocessor = function (name, shift_cells) {\r\n            var i = preprocessors.names.indexOf(name);\r\n            if(shift_cells) {\r\n                remove(preprocessors.names, i);\r\n                remove(preprocessors.actions, i);\r\n            }\r\n            else {\r\n                preprocessors.names[i] = undefined;\r\n                preprocessors.actions[i] = undefined;\r\n            }\r\n        };\r\n\r\n        //The loader for functions which are not part of Math2\r\n        this.mapped_function = function () {\r\n            var subs = {},\r\n                    params = this.params;\r\n\r\n            for(var i = 0; i < params.length; i++) {\r\n                subs[params[i]] = String(arguments[i]);\r\n            }\r\n\r\n            return _.parse(this.body, subs);\r\n        };\r\n        /**\r\n         * Adds two symbols\r\n         * @param {Symbol} a\r\n         * @param {Symbol} b\r\n         * @returns {Symbol}\r\n         */\r\n        this.add = function (a, b) {\r\n            var aIsSymbol = isSymbol(a),\r\n                    bIsSymbol = isSymbol(b);\r\n            //we're dealing with two symbols\r\n            if(aIsSymbol && bIsSymbol) {\r\n                //forward the adding of symbols with units to the Unit module\r\n                if(a.unit || b.unit) {\r\n                    return _.Unit.add(a, b);\r\n                }\r\n                //handle Infinity\r\n                //https://www.encyclopediaofmath.org/index.php/Infinity\r\n                if(a.isInfinity || b.isInfinity) {\r\n                    var aneg = a.multiplier.lessThan(0),\r\n                            bneg = b.multiplier.lessThan(0);\r\n\r\n                    if(a.isInfinity && b.isInfinity && aneg !== bneg) {\r\n                        throw new UndefinedError('(' + a + ')+(' + b + ') is not defined!');\r\n                    }\r\n\r\n                    var inf = Symbol.infinity();\r\n                    if(bneg)\r\n                        inf.negate();\r\n                    return inf;\r\n                }\r\n\r\n                if(a.isComposite() && a.isLinear() && b.isComposite() && b.isLinear()) {\r\n                    a.distributeMultiplier();\r\n                    b.distributeMultiplier();\r\n                    // Fix for issue #606\r\n                    if(b.length > a.length && a.group === b.group) {\r\n                        [a, b] = [b, a];\r\n                    }\r\n                }\r\n                \r\n                //no need to waste time on zeroes\r\n                if(a.multiplier.equals(0))\r\n                    return b;\r\n                if(b.multiplier.equals(0))\r\n                    return a;\r\n\r\n                if(a.isConstant() && b.isConstant() && Settings.PARSE2NUMBER) {\r\n                    var result = new Symbol(a.multiplier.add(b.multiplier).toDecimal(Settings.PRECISION));\r\n                    return result;\r\n                }\r\n\r\n                var g1 = a.group,\r\n                        g2 = b.group,\r\n                        ap = a.power.toString(),\r\n                        bp = b.power.toString();\r\n\r\n                //always keep the greater group on the left.\r\n                if(g1 < g2 || (g1 === g2 && ap > bp && bp > 0)) {\r\n                    return this.add(b, a);\r\n                }\r\n\r\n                /*note to self: Please don't forget about this dilemma ever again. In this model PL and CB goes crazy\r\n                 * because it doesn't know which one to prioritize. */\r\n                //correction to PL dilemma\r\n                if(g1 === CB && g2 === PL && a.value === b.value) {\r\n                    //swap\r\n                    var t = a;\r\n                    a = b;\r\n                    b = t;\r\n                    g1 = a.group;\r\n                    g2 = b.group;\r\n                    ap = a.power.toString();\r\n                    bp = b.power.toString();\r\n                }\r\n\r\n                var powEQ = ap === bp,\r\n                        v1 = a.value,\r\n                        v2 = b.value,\r\n                        aIsComposite = a.isComposite(),\r\n                        bIsComposite = b.isComposite(),\r\n                        h1, h2, result;\r\n\r\n                if(aIsComposite)\r\n                    h1 = text(a, 'hash');\r\n                if(bIsComposite)\r\n                    h2 = text(b, 'hash');\r\n\r\n                if(g1 === CP && g2 === CP && b.isLinear() && !a.isLinear() && h1 !== h2) {\r\n                    return this.add(b, a);\r\n                }\r\n\r\n                //PL & PL should compare hashes and not values e.g. compare x+x^2 with x+x^3 and not x with x\r\n                if(g1 === PL && g2 === PL) {\r\n                    v1 = h1;\r\n                    v2 = h2;\r\n                }\r\n\r\n                var PN = g1 === P && g2 === N,\r\n                        PNEQ = a.value === b.multiplier.toString(),\r\n                        valEQ = (v1 === v2 || h1 === h2 && h1 !== undefined || (PN && PNEQ));\r\n\r\n                //equal values, equal powers\r\n                if(valEQ && powEQ && g1 === g2) {\r\n                    //make sure to convert N to something P can work with\r\n                    if(PN)\r\n                        b = b.convert(P);//CL\r\n\r\n                    //handle PL\r\n                    if(g1 === PL && (g2 === S || g2 === P)) {\r\n                        a.distributeMultiplier();\r\n                        result = a.attach(b);\r\n                    }\r\n                    else {\r\n                        result = a;//CL\r\n                        if(a.multiplier.isOne() && b.multiplier.isOne() && g1 === CP && a.isLinear() && b.isLinear()) {\r\n                            for(var s in b.symbols) {\r\n                                var x = b.symbols[s];\r\n                                result.attach(x);\r\n                            }\r\n                        }\r\n                        else\r\n                            result.multiplier = result.multiplier.add(b.multiplier);\r\n                    }\r\n                }\r\n                //equal values uneven powers\r\n                else if(valEQ && g1 !== PL) {\r\n                    //break the tie for e.g. (x+1)+((x+1)^2+(x+1)^3)\r\n                    if(g1 === CP && g2 === PL) {\r\n                        b.insert(a, 'add');\r\n                        result = b;\r\n                    }\r\n                    else {\r\n                        result = Symbol.shell(PL).attach([a, b]);\r\n                        //update the hash\r\n                        result.value = g1 === PL ? h1 : v1;\r\n                    }\r\n                }\r\n                else if(aIsComposite && a.isLinear()) {\r\n                    var canIterate = g1 === g2,\r\n                            bothPL = g1 === PL && g2 === PL;\r\n\r\n                    //we can only iterate group PL if they values match\r\n                    if(bothPL)\r\n                        canIterate = a.value === b.value;\r\n                    //distribute the multiplier over the entire symbol\r\n                    a.distributeMultiplier();\r\n\r\n                    if(b.isComposite() && b.isLinear() && canIterate) {\r\n                        b.distributeMultiplier();\r\n                        //CL\r\n                        for(var s in b.symbols) {\r\n                            var x = b.symbols[s];\r\n                            a.attach(x);\r\n                        }\r\n                        result = a;\r\n                    }\r\n                    //handle cases like 2*(x+x^2)^2+2*(x+x^2)^3+4*(x+x^2)^2\r\n                    else if(bothPL && a.value !== h2 || g1 === PL && !valEQ) {\r\n                        result = Symbol.shell(CP).attach([a, b]);\r\n                        result.updateHash();\r\n\r\n                    }\r\n                    else {\r\n                        result = a.attach(b);\r\n                    }\r\n                }\r\n                else {\r\n                    if(g1 === FN && a.fname === SQRT && g2 !== EX && b.power.equals(0.5)) {\r\n                        var m = b.multiplier.clone();\r\n                        b = sqrt(b.toUnitMultiplier().toLinear());\r\n                        b.multiplier = m;\r\n                    }\r\n                    //fix for issue #3 and #159\r\n                    if(a.length === 2 && b.length === 2 && even(a.power) && even(b.power)) {\r\n                        result = _.add(expand(a), expand(b));\r\n                    }\r\n                    else {\r\n                        result = Symbol.shell(CP).attach([a, b]);\r\n                        result.updateHash();\r\n                    }\r\n                }\r\n\r\n                if(result.multiplier.equals(0))\r\n                    result = new Symbol(0);\r\n\r\n                //make sure to remove unnecessary wraps\r\n                if(result.length === 1) {\r\n                    var m = result.multiplier;\r\n                    result = firstObject(result.symbols);\r\n                    result.multiplier = result.multiplier.multiply(m);\r\n                }\r\n\r\n                return result;\r\n            }\r\n            else {\r\n                //keep symbols to the right\r\n                if(bIsSymbol && !aIsSymbol) {\r\n                    var t = a;\r\n                    a = b;\r\n                    b = t; //swap\r\n                    t = bIsSymbol;\r\n                    bIsSymbol = aIsSymbol;\r\n                    aIsSymbol = t;\r\n                }\r\n\r\n                var bIsMatrix = isMatrix(b);\r\n\r\n                if(aIsSymbol && bIsMatrix) {\r\n                    var M = new Matrix();\r\n                    b.eachElement(function (e, i, j) {\r\n                        M.set(i, j, _.add(a.clone(), e));\r\n                    });\r\n\r\n                    b = M\r\n                }\r\n                else {\r\n                    if(isMatrix(a) && bIsMatrix) {\r\n                        b = a.add(b);\r\n                    }\r\n                    else if(aIsSymbol && isVector(b)) {\r\n                        b.each(function (x, i) {\r\n                            i--;\r\n                            b.elements[i] = _.add(a.clone(), b.elements[i]);\r\n                        });\r\n                    }\r\n                    else {\r\n                        if(isVector(a) && isVector(b)) {\r\n                            b.each(function (x, i) {\r\n                                i--;\r\n                                b.elements[i] = _.add(a.elements[i], b.elements[i]);\r\n                            });\r\n                        }\r\n                        else if(isVector(a) && isMatrix(b)) {\r\n                            //try to convert a to a matrix\r\n                            return _.add(b, a);\r\n                        }\r\n                        else if(isMatrix(a) && isVector(b)) {\r\n                            if(b.elements.length === a.rows()) {\r\n                                var M = new Matrix(), l = a.cols();\r\n                                b.each(function (e, i) {\r\n                                    var row = [];\r\n                                    for(var j = 0; j < l; j++) {\r\n                                        row.push(_.add(a.elements[i - 1][j].clone(), e.clone()));\r\n                                    }\r\n                                    M.elements.push(row);\r\n                                });\r\n                                return M;\r\n                            }\r\n                            else\r\n                                err('Dimensions must match!');\r\n                        }\r\n                    }\r\n                }\r\n                return b;\r\n            }\r\n\r\n        };\r\n        /**\r\n         * Gets called when the parser finds the - operator. Not the prefix operator. See this.add\r\n         * @param {Symbol} a\r\n         * @param {Symbol} b\r\n         * @returns {Symbol}\r\n         */\r\n        this.subtract = function (a, b) {\r\n            var aIsSymbol = aIsSymbol = isSymbol(a),\r\n                    bIsSymbol = isSymbol(b), t;\r\n\r\n            if(aIsSymbol && bIsSymbol) {\r\n                if(a.unit || b.unit) {\r\n                    return _.Unit.subtract(a, b);\r\n                }\r\n                return this.add(a, b.negate());\r\n            }\r\n            else {\r\n                if(bIsSymbol && isVector(a)) {\r\n                    b = a.map(function (x) {\r\n                        return _.subtract(x, b.clone());\r\n                    });\r\n                }\r\n                else if(aIsSymbol && isVector(b)) {\r\n                    b = b.map(function (x) {\r\n                        return _.subtract(a.clone(), x);\r\n                    });\r\n                }\r\n                else if(isVector(a) && isVector(b)) {\r\n                    if(a.dimensions() === b.dimensions())\r\n                        b = a.subtract(b);\r\n                    else\r\n                        _.error('Unable to subtract vectors. Dimensions do not match.');\r\n                }\r\n                else if(isMatrix(a) && isVector(b)) {\r\n                    if(b.elements.length === a.rows()) {\r\n                        var M = new Matrix(), l = a.cols();\r\n                        b.each(function (e, i) {\r\n                            var row = [];\r\n                            for(var j = 0; j < l; j++) {\r\n                                row.push(_.subtract(a.elements[i - 1][j].clone(), e.clone()));\r\n                            }\r\n                            M.elements.push(row);\r\n                        });\r\n                        return M;\r\n                    }\r\n                    else\r\n                        err('Dimensions must match!');\r\n                }\r\n                else if(isVector(a) && isMatrix(b)) {\r\n                    var M = b.clone().negate();\r\n                    return _.add(M, a);\r\n                }\r\n                else if(isMatrix(a) && isMatrix(b)) {\r\n                    b = a.subtract(b);\r\n                }\r\n                else if(isMatrix(a) && bIsSymbol) {\r\n                    var M = new Matrix();\r\n                    a.each(function (x, i, j) {\r\n                        M.set(i, j, _.subtract(x, b.clone()));\r\n                    });\r\n                    b = M;\r\n                }\r\n                else if(aIsSymbol && isMatrix(b)) {\r\n                    var M = new Matrix();\r\n                    b.each(function (x, i, j) {\r\n                        M.set(i, j, _.subtract(a.clone(), x));\r\n                    });\r\n                    b = M;\r\n                }\r\n                return b;\r\n            }\r\n        };\r\n        /**\r\n         * Gets called when the parser finds the * operator. See this.add\r\n         * @param {Symbol} a\r\n         * @param {Symbol} b\r\n         * @returns {Symbol}\r\n         */\r\n        this.multiply = function (a, b) {\r\n            var aIsSymbol = isSymbol(a),\r\n                    bIsSymbol = isSymbol(b);\r\n            //we're dealing with function assignment here\r\n            if(aIsSymbol && b instanceof Collection) {\r\n                b.elements.push(a);\r\n                return b;\r\n            }\r\n            if(aIsSymbol && bIsSymbol) {\r\n                //if it has a unit then add it and return it right away.\r\n                if(b.isUnit) {\r\n                    var result = a.clone();\r\n                    a.unit = b;\r\n                    return result;\r\n                }\r\n                \r\n                //if it has units then just forward that problem to the unit module\r\n                if(a.unit || b.unit) {\r\n                    return _.Unit.multiply(a, b);\r\n                }\r\n\r\n                //handle Infinty\r\n                if(a.isInfinity || b.isInfinity) {\r\n                    if(a.equals(0) || b.equals(0))\r\n                        throw new UndefinedError(a + '*' + b + ' is undefined!');\r\n                    //x/infinity\r\n                    if(b.power.lessThan(0)) {\r\n                        if(!a.isInfinity) {\r\n                            return new Symbol(0);\r\n                        }\r\n                        else {\r\n                            throw new UndefinedError('Infinity/Infinity is not defined!');\r\n                        }\r\n                    }\r\n\r\n                    var sign = a.multiplier.multiply(b.multiplier).sign(),\r\n                            inf = Symbol.infinity();\r\n                    if(a.isConstant() || b.isConstant() || (a.isInfinity && b.isInfinity)) {\r\n                        if(sign < 0)\r\n                            inf.negate();\r\n\r\n                        return inf;\r\n                    }\r\n                }\r\n                //the quickies\r\n                if(a.isConstant() && b.isConstant() && Settings.PARSE2NUMBER) {\r\n                    var t = new bigDec(a.multiplier.toDecimal()).times(new bigDec(b.multiplier.toDecimal())).toFixed();\r\n                    var retval = new Symbol(t);\r\n                    return retval;\r\n                }\r\n\r\n                //don't waste time\r\n                if(a.isOne()) {\r\n                    return b.clone();\r\n                }\r\n                if(b.isOne()) {\r\n                    return a.clone();\r\n                }\r\n\r\n                if(a.multiplier.equals(0) || b.multiplier.equals(0))\r\n                    return new Symbol(0);\r\n\r\n                if(b.group > a.group && !(b.group === CP))\r\n                    return this.multiply(b, a);\r\n                //correction for PL/CB dilemma\r\n                if(a.group === CB && b.group === PL && a.value === b.value) {\r\n                    var t = a;\r\n                    a = b;\r\n                    b = t;//swap\r\n                }\r\n\r\n                var g1 = a.group,\r\n                        g2 = b.group,\r\n                        bnum = b.multiplier.num,\r\n                        bden = b.multiplier.den;\r\n\r\n                if(g1 === FN && a.fname === SQRT && !b.isConstant() && a.args[0].value === b.value && !a.args[0].multiplier.lessThan(0)) {\r\n                    //unwrap sqrt\r\n                    var a_pow = a.power;\r\n                    var a_multiplier = _.parse(a.multiplier);\r\n                    a = _.multiply(a_multiplier, a.args[0].clone());\r\n                    a.setPower(new Frac(0.5).multiply(a_pow));\r\n                    g1 = a.group;\r\n                }\r\n                //simplify n/sqrt(n). Being very specific\r\n                else if(g1 === FN && a.fname === SQRT && a.multiplier.equals(1) && a.power.equals(-1) && b.isConstant() && a.args[0].equals(b)) {\r\n                    a = _.symfunction(SQRT, [b.clone()]);\r\n                    b = new Symbol(1);\r\n                }\r\n                ;\r\n\r\n                var v1 = a.value,\r\n                        v2 = b.value,\r\n                        sign = new Frac(a.sign()),\r\n                        //since P is just a morphed version of N we need to see if they relate\r\n                        ONN = (g1 === P && g2 === N && b.multiplier.equals(a.value)),\r\n                        //don't multiply the multiplier of b since that's equal to the value of a\r\n                        m = ONN ? new Frac(1).multiply(a.multiplier).abs() : a.multiplier.multiply(b.multiplier).abs(),\r\n                        result = a.clone().toUnitMultiplier();\r\n                b = b.clone().toUnitMultiplier(true);\r\n\r\n                //further simplification of sqrt\r\n                if(g1 === FN && g2 === FN) {\r\n                    var u = a.args[0].clone();\r\n                    var v = b.args[0].clone();\r\n                    if(a.fname === SQRT && b.fname === SQRT && a.isLinear() && b.isLinear()) {\r\n\r\n                        var q = _.divide(u, v).invert();\r\n                        if(q.gt(1) && isInt(q)) {\r\n                            //b contains a factor a which can be moved to a\r\n                            result = _.multiply(a.args[0].clone(), sqrt(q.clone()));\r\n                            b = new Symbol(1);\r\n                        }\r\n                    }\r\n                    //simplify factorial but only if\r\n                    //1 - It's division so b will have a negative power\r\n                    //2 - We're not dealing with factorials of numbers\r\n                    else if(a.fname === FACTORIAL && b.fname === FACTORIAL && !u.isConstant() && !v.isConstant() && b.power < 0) {\r\n                        //assume that n = positive\r\n                        var d = _.subtract(u.clone(), v.clone());\r\n\r\n                        //if it's not numeric then we don't know if we can simplify so just return\r\n                        if(d.isConstant()) {\r\n\r\n                            //there will never be a case where d == 0 since this will already have\r\n                            //been handled at the beginning of this function\r\n                            t = new Symbol(1);\r\n                            if(d < 0) {\r\n                                //If d is negative then the numerator is larger so expand that\r\n                                for(var i = 0, n = Math.abs(d); i <= n; i++) {\r\n                                    var s = _.add(u.clone(), new Symbol(i));\r\n                                    t = _.multiply(t, s);\r\n                                }\r\n\r\n                                result = _.multiply(_.pow(u, new Symbol(a.power)), _.pow(t, new Symbol(b.power)));\r\n\r\n                                b = new Symbol(1);\r\n                            }\r\n                            else {\r\n                                //Otherwise the denominator is larger so expand that\r\n                                for(var i = 0, n = Math.abs(d); i <= n; i++) {\r\n                                    var s = _.add(v.clone(), new Symbol(i));\r\n                                    t = _.multiply(t, s);\r\n                                }\r\n\r\n                                result = _.multiply(_.pow(t, new Symbol(a.power)), _.pow(v, new Symbol(b.power)));\r\n\r\n                                b = new Symbol(1);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n\r\n                //if both are PL then their hashes have to match\r\n                if(v1 === v2 && g1 === PL && g1 === g2) {\r\n                    v1 = a.text('hash');\r\n                    v2 = b.text('hash');\r\n                }\r\n\r\n                //same issue with (x^2+1)^x*(x^2+1)\r\n                //EX needs an exception when multiplying because it needs to recognize\r\n                //that (x+x^2)^x has the same hash as (x+x^2). The latter is kept as x\r\n                if(g2 === EX && b.previousGroup === PL && g1 === PL) {\r\n                    v1 = text(a, 'hash', EX);\r\n                }\r\n\r\n                if((v1 === v2 || ONN) && !(g1 === PL && (g2 === S || g2 === P || g2 === FN)) && !(g1 === PL && g2 === CB)) {\r\n                    var p1 = a.power,\r\n                            p2 = b.power,\r\n                            isSymbolP1 = isSymbol(p1),\r\n                            isSymbolP2 = isSymbol(p2),\r\n                            toEX = (isSymbolP1 || isSymbolP2);\r\n                    //TODO: this needs cleaning up\r\n                    if(g1 === PL && g2 !== PL && b.previousGroup !== PL && p1.equals(1)) {\r\n                        result = new Symbol(0);\r\n                        a.each(function (x) {\r\n                            result = _.add(result, _.multiply(x, b.clone()));\r\n                        }, true);\r\n                    }\r\n                    else {\r\n                        //add the powers\r\n                        result.power = toEX ? _.add(\r\n                                !(isSymbol(p1)) ? new Symbol(p1) : p1,\r\n                                !(isSymbol(p2)) ? new Symbol(p2) : p2\r\n                                ) : (g1 === N /*don't add powers for N*/ ? p1 : p1.add(p2));\r\n\r\n                        //eliminate zero power values and convert them to numbers\r\n                        if(result.power.equals(0))\r\n                            result = result.convert(N);\r\n\r\n                        //properly convert to EX\r\n                        if(toEX)\r\n                            result.convert(EX);\r\n\r\n                        //take care of imaginaries\r\n                        if(a.imaginary && b.imaginary) {\r\n                            var isEven = even(result.power % 2);\r\n                            if(isEven) {\r\n                                result = new Symbol(1);\r\n                                m.negate();\r\n                            }\r\n                        }\r\n\r\n                        //cleanup: this causes the LaTeX generator to get confused as to how to render the symbol\r\n                        if(result.group !== EX && result.previousGroup)\r\n                            result.previousGroup = undefined;\r\n                        //the sign for b is floating around. Remember we are assuming that the odd variable will carry\r\n                        //the sign but this isn't true if they're equals symbols\r\n                        result.multiplier = result.multiplier.multiply(b.multiplier);\r\n                    }\r\n                }\r\n                else if(g1 === CB && a.isLinear()) {\r\n                    if(g2 === CB)\r\n                        b.distributeExponent();\r\n                    if(g2 === CB && b.isLinear()) {\r\n                        for(var s in b.symbols) {\r\n                            var x = b.symbols[s];\r\n                            result = result.combine(x);\r\n                        }\r\n                        result.multiplier = result.multiplier.multiply(b.multiplier);\r\n                    }\r\n                    else {\r\n                        result.combine(b);\r\n                    }\r\n                }\r\n                else {\r\n                    //the multiplier was already handled so nothing left to do\r\n                    if(g1 !== N) {\r\n                        if(g1 === CB) {\r\n                            result.distributeExponent();\r\n                            result.combine(b);\r\n                        }\r\n                        else if(!b.isOne()) {\r\n                            var bm = b.multiplier.clone();\r\n                            b.toUnitMultiplier();\r\n                            result = Symbol.shell(CB).combine([result, b]);\r\n                            //transfer the multiplier to the outside\r\n                            result.multiplier = result.multiplier.multiply(bm);\r\n                        }\r\n                    }\r\n                    else {\r\n                        result = b.clone().toUnitMultiplier();\r\n                    }\r\n                }\r\n\r\n                if(result.group === P) {\r\n                    var logV = Math.log(result.value),\r\n                            n1 = Math.log(bnum) / logV,\r\n                            n2 = Math.log(bden) / logV,\r\n                            ndiv = m.num / bnum,\r\n                            ddiv = m.den / bden;\r\n                    //we don't want to divide by zero no do we? Strange things happen.\r\n                    if(n1 !== 0 && isInt(n1) && isInt(ndiv)) {\r\n                        result.power = result.power.add(new Frac(n1));\r\n                        m.num /= bnum; //BigInt? Keep that in mind for the future.\r\n                    }\r\n                    if(n2 !== 0 && isInt(n2) && isInt(ddiv)) {\r\n                        result.power = result.power.subtract(new Frac(n2));\r\n                        m.den /= bden; //BigInt? Keep that in mind for the future.\r\n                    }\r\n                }\r\n\r\n                //unpack CB if length is only one\r\n                if(result.length === 1) {\r\n                    var t = result.multiplier;\r\n                    //transfer the multiplier\r\n                    result = firstObject(result.symbols);\r\n                    result.multiplier = result.multiplier.multiply(t);\r\n                }\r\n\r\n                //reduce square root\r\n                var ps = result.power.toString();\r\n                if(even(ps) && result.fname === SQRT) {\r\n                    //grab the sign of the symbol\r\n                    sign = sign * result.sign();\r\n                    var p = result.power;\r\n                    result = result.args[0];\r\n                    result = _.multiply(new Symbol(m), _.pow(result, new Symbol(p.divide(new Frac(2)))));\r\n                    //flip it back to the correct sign\r\n                    if(sign < 0)\r\n                        result.negate()\r\n                }\r\n                else {\r\n                    result.multiplier = result.multiplier.multiply(m).multiply(sign);\r\n                    if(result.group === CP && result.isImaginary())\r\n                        result.distributeMultiplier();\r\n                }\r\n\r\n                //back convert group P to a simpler group N if possible\r\n                if(result.group === P && isInt(result.power.toDecimal()))\r\n                    result = result.convert(N);\r\n\r\n                return result;\r\n            }\r\n            else {\r\n                //****** Matrices & Vector *****//\r\n                if(bIsSymbol && !aIsSymbol) { //keep symbols to the right\r\n                    t = a;\r\n                    a = b;\r\n                    b = t; //swap\r\n                    t = bIsSymbol;\r\n                    bIsSymbol = aIsSymbol;\r\n                    aIsSymbol = t;\r\n                }\r\n\r\n                var isMatrixB = isMatrix(b), isMatrixA = isMatrix(a);\r\n                if(aIsSymbol && isMatrixB) {\r\n                    var M = new Matrix();\r\n                    b.eachElement(function (e, i, j) {\r\n                        M.set(i, j, _.multiply(a.clone(), e));\r\n                    });\r\n\r\n                    b = M;\r\n                }\r\n                else {\r\n                    if(isMatrixA && isMatrixB) {\r\n                        b = a.multiply(b);\r\n                    }\r\n                    else if(aIsSymbol && isVector(b)) {\r\n                        b.each(function (x, i) {\r\n                            i--;\r\n                            b.elements[i] = _.multiply(a.clone(), b.elements[i]);\r\n                        });\r\n                    }\r\n                    else {\r\n                        if(isVector(a) && isVector(b)) {\r\n                            b.each(function (x, i) {\r\n                                i--;\r\n                                b.elements[i] = _.multiply(a.elements[i], b.elements[i]);\r\n                            });\r\n                        }\r\n                        else if(isVector(a) && isMatrix(b)) {\r\n                            //try to convert a to a matrix\r\n                            return this.multiply(b, a);\r\n                        }\r\n                        else if(isMatrix(a) && isVector(b)) {\r\n                            if(b.elements.length === a.rows()) {\r\n                                var M = new Matrix(), l = a.cols();\r\n                                b.each(function (e, i) {\r\n                                    var row = [];\r\n                                    for(var j = 0; j < l; j++) {\r\n                                        row.push(_.multiply(a.elements[i - 1][j].clone(), e.clone()));\r\n                                    }\r\n                                    M.elements.push(row);\r\n                                });\r\n                                return M;\r\n                            }\r\n                            else\r\n                                err('Dimensions must match!');\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return b;\r\n            }\r\n        };\r\n        /**\r\n         * Gets called when the parser finds the / operator. See this.add\r\n         * @param {Symbol} a\r\n         * @param {Symbol} b\r\n         * @returns {Symbol}\r\n         */\r\n        this.divide = function (a, b) {\r\n            var aIsSymbol = isSymbol(a),\r\n                    bIsSymbol = isSymbol(b);\r\n\r\n            if(aIsSymbol && bIsSymbol) {\r\n                //forward to Unit division\r\n                if(a.unit || b.unit) {\r\n                    return _.Unit.divide(a, b);\r\n                }\r\n                var result;\r\n                if(b.equals(0))\r\n                    throw new DivisionByZero('Division by zero not allowed!');\r\n\r\n                if(a.isConstant() && b.isConstant()) {\r\n                    result = a.clone();\r\n                    result.multiplier = result.multiplier.divide(b.multiplier);\r\n                }\r\n                else {\r\n                    b.invert();\r\n                    result = _.multiply(a, b);\r\n                }\r\n                return result;\r\n            }\r\n            else {\r\n                //******* Vectors & Matrices *********//\r\n                var isVectorA = isVector(a), isVectorB = isVector(b);\r\n                if(aIsSymbol && isVectorB) {\r\n                    b = b.map(function (x) {\r\n                        return _.divide(a.clone(), x);\r\n                    });\r\n                }\r\n                else if(isVectorA && bIsSymbol) {\r\n                    b = a.map(function (x) {\r\n                        return _.divide(x, b.clone());\r\n                    });\r\n                }\r\n                else if(isVectorA && isVectorB) {\r\n                    if(a.dimensions() === b.dimensions()) {\r\n                        b = b.map(function (x, i) {\r\n                            return _.divide(a.elements[--i], x);\r\n                        });\r\n                    }\r\n                    else\r\n                        _.error('Cannot divide vectors. Dimensions do not match!');\r\n                }\r\n                else {\r\n                    var isMatrixA = isMatrix(a), isMatrixB = isMatrix(b);\r\n                    if(isMatrixA && bIsSymbol) {\r\n                        var M = new Matrix();\r\n                        a.eachElement(function (x, i, j) {\r\n                            M.set(i, j, _.divide(x, b.clone()));\r\n                        });\r\n                        b = M;\r\n                    }\r\n                    else if(aIsSymbol && isMatrixB) {\r\n                        var M = new Matrix();\r\n                        b.eachElement(function (x, i, j) {\r\n                            M.set(i, j, _.divide(a.clone(), x));\r\n                        });\r\n                        b = M;\r\n                    }\r\n                    else if(isMatrixA && isMatrixB) {\r\n                        var M = new Matrix();\r\n                        if(a.rows() === b.rows() && a.cols() === b.cols()) {\r\n                            a.eachElement(function (x, i, j) {\r\n                                M.set(i, j, _.divide(x, b.elements[i][j]));\r\n                            });\r\n                            b = M;\r\n                        }\r\n                        else {\r\n                            _.error('Dimensions do not match!');\r\n                        }\r\n                    }\r\n                    else if(isMatrixA && isVectorB) {\r\n                        if(a.cols() === b.dimensions()) {\r\n                            var M = new Matrix();\r\n                            a.eachElement(function (x, i, j) {\r\n                                M.set(i, j, _.divide(x, b.elements[i].clone()));\r\n                            });\r\n                            b = M;\r\n                        }\r\n                        else {\r\n                            _.error('Unable to divide matrix by vector.');\r\n                        }\r\n                    }\r\n                }\r\n                return b;\r\n            }\r\n        };\r\n        /**\r\n         * Gets called when the parser finds the ^ operator. See this.add\r\n         * @param {Symbol} a\r\n         * @param {Symbol} b\r\n         * @returns {Symbol}\r\n         */\r\n        this.pow = function (a, b) {\r\n            var aIsSymbol = isSymbol(a),\r\n                    bIsSymbol = isSymbol(b);\r\n            if(aIsSymbol && bIsSymbol) {\r\n                //it has units then it's the Unit module's problem\r\n                if(a.unit || b.unit) {\r\n                    return _.Unit.pow(a, b);\r\n                }\r\n                \r\n                // Handle abs\r\n                if(a.group === FN && a.fname === ABS && even(b)) {\r\n                    var m = a.multiplier.clone();\r\n                    var raised = _.pow(a.args[0], b);\r\n                    raised.multiplier = m;\r\n                    return raised;\r\n                }\r\n                \r\n                // Handle infinity\r\n                if(a.isInfinity || b.isInfinity) {\r\n                    if(a.isInfinity && b.isInfinity)\r\n                        throw new UndefinedError('(' + a + ')^(' + b + ') is undefined!');\r\n\r\n                    if(a.isConstant() && b.isInfinity) {\r\n                        if(a.equals(0)) {\r\n                            if(b.lessThan(0))\r\n                                throw new UndefinedError('0^Infinity is undefined!');\r\n                            return new Symbol(0);\r\n                        }\r\n                        if(a.equals(1))\r\n                            throw new UndefinedError('1^' + b.toString() + ' is undefined!');\r\n                        //a^-oo\r\n                        if(b.lessThan(0))\r\n                            return new Symbol(0);\r\n                        //a^oo\r\n                        if(!a.lessThan(0))\r\n                            return Symbol.infinity();\r\n                    }\r\n\r\n                    if(a.isInfinity && b.isConstant()) {\r\n                        if(b.equals(0))\r\n                            throw new UndefinedError(a + '^0 is undefined!');\r\n                        if(b.lessThan(0))\r\n                            return new Symbol(0);\r\n                        return _.multiply(Symbol.infinity(), _.pow(new Symbol(a.sign()), b.clone()));\r\n                    }\r\n                }\r\n\r\n                var aIsZero = a.equals(0);\r\n                var bIsZero = b.equals(0);\r\n                if(aIsZero && bIsZero)\r\n                    throw new UndefinedError('0^0 is undefined!');\r\n\r\n                // Return 0 right away if possible\r\n                if(aIsZero && b.isConstant() && b.multiplier.greaterThan(0))\r\n                    return new Symbol(0);\r\n\r\n                if(bIsZero)\r\n                    return new Symbol(1);\r\n\r\n                var bIsConstant = b.isConstant(),\r\n                        aIsConstant = a.isConstant(),\r\n                        bIsInt = b.isInteger(),\r\n                        m = a.multiplier,\r\n                        result = a.clone();\r\n\r\n                // 0^0, 1/0, etc. Complain.\r\n                if(aIsConstant && bIsConstant && a.equals(0) && b.lessThan(0))\r\n                    throw new UndefinedError('Division by zero is not allowed!');\r\n\r\n                // Compute imaginary numbers right away\r\n                if(Settings.PARSE2NUMBER && aIsConstant && bIsConstant && a.sign() < 0 && evenFraction(b)) {\r\n                    var k, re, im;\r\n                    k = Math.PI * b;\r\n                    re = new Symbol(Math.cos(k));\r\n                    im = _.multiply(Symbol.imaginary(), new Symbol(Math.sin(k)));\r\n                    return _.add(re, im);\r\n                }\r\n\r\n                // Imaginary number under negative nthroot or to the n\r\n                if(Settings.PARSE2NUMBER && a.isImaginary() && bIsConstant && isInt(b) && !b.lessThan(0)) {\r\n                    var re, im, r, theta, nre, nim, phi;\r\n                    re = a.realpart();\r\n                    im = a.imagpart();\r\n                    if(re.isConstant('all') && im.isConstant('all')) {\r\n                        phi = Settings.USE_BIG ? Symbol(bigDec.atan2(i.multiplier.toDecimal(), r.multiplier.toDecimal()).times(b.toString())) : Math.atan2(im, re) * b;\r\n                        theta = new Symbol(phi);\r\n                        r = _.pow(Symbol.hyp(re, im), b);\r\n                        nre = _.multiply(r.clone(), _.trig.cos(theta.clone()));\r\n                        nim = _.multiply(r, _.trig.sin(theta));\r\n                        return _.add(nre, _.multiply(Symbol.imaginary(), nim));\r\n                    }\r\n                }\r\n\r\n                // Take care of the symbolic part\r\n                result.toUnitMultiplier();\r\n                //simpifly sqrt\r\n                if(result.group === FN && result.fname === SQRT && !bIsConstant) {\r\n                    var s = result.args[0];\r\n                    s.multiplyPower(new Symbol(0.5));\r\n                    s.multiplier.multiply(result.multiplier);\r\n                    s.multiplyPower(b);\r\n                    result = s;\r\n                }\r\n                else {\r\n                    var sign = m.sign();\r\n                    //handle cases such as (-a^3)^(1/4)\r\n                    if(evenFraction(b) && sign < 0) {\r\n                        // Swaperoo\r\n                        // First put the sign back on the symbol\r\n                        result.negate();\r\n                        // Wrap it in brackets\r\n                        result = _.symfunction(PARENTHESIS, [result]);\r\n                        // Move the sign back the exterior and let nerdamer handle the rest\r\n                        result.negate();\r\n                    }\r\n\r\n                    result.multiplyPower(b);\r\n                }\r\n\r\n                if(aIsConstant && bIsConstant && Settings.PARSE2NUMBER) {\r\n                    var c;\r\n                    //remove the sign\r\n                    if(sign < 0) {\r\n                        a.negate();\r\n                        if(b.multiplier.den.equals(2))\r\n                            //we know that the numerator has to be odd and therefore it's i\r\n                            c = new Symbol(Settings.IMAGINARY);\r\n                        else if(isInt(b.multiplier)) {\r\n                            if(even(b.multiplier))\r\n                                c = new Symbol(1);\r\n                            else\r\n                                c = new Symbol(-1);\r\n                        }\r\n                        else if(!even(b.multiplier.den)) {\r\n                            c = new Symbol(Math.pow(sign, b.multiplier.num));\r\n                        }\r\n                        else {\r\n                            c = _.pow(_.symfunction(PARENTHESIS, [new Symbol(sign)]), b.clone());\r\n                        }\r\n                    }\r\n\r\n                    result = new Symbol(Math.pow(a.multiplier.toDecimal(), b.multiplier.toDecimal()));\r\n\r\n                    //result = new Symbol(Math2.bigpow(a.multiplier, b.multiplier));\r\n                    //put the back sign\r\n                    if(c)\r\n                        result = _.multiply(result, c);\r\n                }\r\n                else if(bIsInt && !m.equals(1)) {\r\n                    var abs_b = b.abs();\r\n                    // Provide fall back to JS until big number implementation is improved\r\n                    if(abs_b.gt(Settings.MAX_EXP)) {\r\n                        if(b.sign() < 0)\r\n                            return new Symbol(0);\r\n                        return Symbol.infinity();\r\n                    }\r\n                    else {\r\n                        var p = b.multiplier.toDecimal();\r\n                        var sgn = Math.sign(p);\r\n                        p = Math.abs(p);\r\n                        var multiplier = new Frac(1);\r\n                        multiplier.num = m.num.pow(p);\r\n                        multiplier.den = m.den.pow(p);\r\n                        if(sgn < 0)\r\n                            multiplier.invert();\r\n                        //multiplying is justified since after mulltiplyPower if it was of group P it will now be of group N\r\n                        result.multiplier = result.multiplier.multiply(multiplier);\r\n                    }\r\n                }\r\n                else {\r\n                    var sign = a.sign();\r\n                    if(b.isConstant() && a.isConstant() && !b.multiplier.den.equals(1) && sign < 0) {\r\n                        //we know the sign is negative so if the denominator for b == 2 then it's i\r\n                        if(b.multiplier.den.equals(2)) {\r\n                            var i = new Symbol(Settings.IMAGINARY);\r\n                            a.negate();//remove the sign\r\n                            //if the power is negative then i is negative\r\n                            if(b.lessThan(0)) {\r\n                                i.negate();\r\n                                b.negate();//remove the sign from the power\r\n                            }\r\n                            //pull the power normally and put back the imaginary\r\n                            result = _.multiply(_.pow(a, b), i);\r\n                        }\r\n                        else {\r\n                            var aa = a.clone();\r\n                            aa.multiplier.negate();\r\n                            result = _.pow(_.symfunction(PARENTHESIS, [new Symbol(sign)]), b.clone());\r\n                            var _a = _.pow(new Symbol(aa.multiplier.num), b.clone());\r\n                            var _b = _.pow(new Symbol(aa.multiplier.den), b.clone());\r\n                            var r = _.divide(_a, _b);\r\n                            result = _.multiply(result, r);\r\n                        }\r\n                    }\r\n                    else if(Settings.PARSE2NUMBER && b.isImaginary()) {\r\n                        //4^(i + 2) = e^(- (2 - 4 i) π n + (2 + i) log(4))\r\n\r\n                        var re = b.realpart();\r\n                        var im = b.imagpart();\r\n                        /*\r\n                         if(b.group === CP && false) {\r\n                         var ex = _.pow(a.clone(), re);\r\n                         var xi = _.multiply(_.multiply(ex.clone(), trig.sin(im.clone())), Symbol.imaginary());\r\n                         var xa = _.multiply(trig.cos(im), ex);\r\n                         result = _.add(xi, xa);\r\n                         }\r\n                         else {\r\n                         */\r\n                        var aa = a.clone().toLinear();\r\n                        var a1 = _.pow(aa.clone(), re);\r\n                        var log_a = log(aa.clone());\r\n                        var b1 = trig.cos(_.multiply(im.clone(), log_a));\r\n                        var c1 = _.multiply(trig.sin(_.multiply(im, log(aa))), Symbol.imaginary());\r\n                        result = _.multiply(a1, _.add(b1, c1));\r\n                        result = _.expand(_.parse(result));\r\n                        /*\r\n                         }   \r\n                         */\r\n                    }\r\n                    else {\r\n                        //b is a symbol\r\n                        var neg_num = a.group === N && sign < 0,\r\n                            num = testSQRT(new Symbol(neg_num ? m.num : Math.abs(m.num)).setPower(b.clone())),\r\n                            den = testSQRT(new Symbol(m.den).setPower(b.clone()).invert());\r\n\r\n                        //eliminate imaginary if possible\r\n                        if(a.imaginary) {\r\n                            if(bIsInt) {\r\n                                var s, p, n;\r\n                                s = Math.sign(b);\r\n                                p = abs(b);\r\n                                n = p % 4;\r\n                                result = new Symbol(even(n) ? -1 : Settings.IMAGINARY);\r\n                                if(n === 0 || s < 0 && (n === 1) || s > 0 && (n === 3)) {\r\n                                    result.negate();\r\n                                }\r\n                            }\r\n                            else {\r\n                                //assume i = sqrt(-1) -> (-1)^(1/2)\r\n                                var nr = b.multiplier.multiply(Frac.quick(1, 2)),\r\n                                        //the denominator denotes the power so raise to it. It will turn positive it round\r\n                                        tn = Math.pow(-1, nr.num);\r\n                                result = even(nr.den) ? new Symbol(-1).setPower(nr, true) : new Symbol(tn);\r\n                            }\r\n                        }\r\n                        //ensure that the sign is carried by the symbol and not the multiplier\r\n                        //this enables us to check down the line if the multiplier can indeed be transferred\r\n                        if(sign < 0 && !neg_num)\r\n                            result.negate();\r\n\r\n                        //retain the absolute value\r\n                        if(bIsConstant && a.group !== EX) {\r\n                            var evenr = even(b.multiplier.den),\r\n                                    evenp = even(a.power),\r\n                                    n = result.power.toDecimal(),\r\n                                    evennp = even(n);\r\n                            if(evenr && evenp && !evennp) {\r\n                                if(n === 1)\r\n                                    result = _.symfunction(ABS, [result]);\r\n                                else if(!isInt(n)) {\r\n                                    var p = result.power;\r\n                                    result = _.symfunction(ABS, [result.toLinear()]).setPower(p);\r\n                                }\r\n                                else {\r\n                                    result = _.multiply(_.symfunction(ABS, [result.clone().toLinear()]),\r\n                                            result.clone().setPower(new Frac(n - 1)));\r\n                                }\r\n                                //quick workaround. Revisit\r\n                                if(Settings.POSITIVE_MULTIPLIERS && result.fname === ABS)\r\n                                    result = result.args[0];\r\n                            }\r\n                        }\r\n                        //multiply out sqrt\r\n                        if(b.equals(2) && result.group === CB) {\r\n                            var _result = new Symbol(1);\r\n                            result.each(function (sym) {\r\n                                _result = _.multiply(_result, _.pow(sym, b));\r\n                            });\r\n                            result = _result;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                result = testSQRT(result);\r\n\r\n                // Don't multiply until we've tested the remaining symbol\r\n                if(num && den) {\r\n                    result = _.multiply(result, testPow(_.multiply(num, den)));\r\n                }\r\n\r\n                // Reduce square root\r\n                if(result.fname === SQRT) {\r\n                    var isEX = result.group === EX;\r\n                    var t = isEX ? result.power.multiplier.toString() : result.power.toString();\r\n                    if(even(t)) {\r\n                        var pt = isEX ? _.divide(result.power, new Symbol(2)) : new Symbol(result.power.divide(new Frac(2))),\r\n                                m = result.multiplier;\r\n                        result = _.pow(result.args[0], pt);\r\n                        result.multiplier = result.multiplier.multiply(m);\r\n                    }\r\n                }\r\n                // Detect Euler's identity\r\n                else if(!Settings.IGNORE_E && result.isE() && result.group === EX && result.power.contains('pi')\r\n                        && result.power.contains(Settings.IMAGINARY) && b.group === CB) {\r\n                    var theta = b.stripVar(Settings.IMAGINARY);\r\n                    result = _.add(trig.cos(theta), _.multiply(Symbol.imaginary(), trig.sin(theta)));\r\n                }\r\n\r\n                return result;\r\n            }\r\n            else {\r\n                if(isVector(a) && bIsSymbol) {\r\n                    a = a.map(function (x) {\r\n                        return _.pow(x, b.clone());\r\n                    });\r\n                }\r\n                else if(isMatrix(a) && bIsSymbol) {\r\n                    var M = new Matrix();\r\n                    a.eachElement(function (x, i, j) {\r\n                        M.set(i, j, _.pow(x, b.clone()));\r\n                    });\r\n                    a = M;\r\n                }\r\n                else if(aIsSymbol && isMatrix(b)) {\r\n                    var M = new Matrix();\r\n                    b.eachElement(function (x, i, j) {\r\n                        M.set(i, j, _.pow(a.clone(), x));\r\n                    });\r\n                    a = M;\r\n                }\r\n                return a;\r\n            }\r\n        };\r\n        // Gets called when the parser finds the , operator.\r\n        // Commas return a Collector object which is roughly an array\r\n        this.comma = function (a, b) {\r\n            if(!(a instanceof Collection))\r\n                a = Collection.create(a);\r\n            a.append(b);\r\n            return a;\r\n        };\r\n        // Link to modulus\r\n        this.mod = function (a, b) {\r\n            return mod(a, b);\r\n        };\r\n        // Used to slice elements from arrays\r\n        this.slice = function (a, b) {\r\n            return new Slice(a, b);\r\n        };\r\n        // The equality setter\r\n        this.equals = function (a, b) {\r\n            // Equality can only be set for group S so complain it's not\r\n            if(a.group !== S && !a.isLinear())\r\n                err('Cannot set equality for ' + a.toString());\r\n            VARS[a.value] = b.clone();\r\n            return b;\r\n        };\r\n        // Percent\r\n        this.percent = function (a) {\r\n            return _.divide(a, new Symbol(100));\r\n        };\r\n        // Set variable\r\n        this.assign = function (a, b) {\r\n            if(a instanceof Collection && b instanceof Collection) {\r\n                a.elements.map(function (x, i) {\r\n                    return _.assign(x, b.elements[i]);\r\n                });\r\n                return Vector.fromArray(b.elements);\r\n            }\r\n            if(a.parent) {\r\n                // It's referring to the parent instead. The current item can be discarded\r\n                var e = a.parent;\r\n                e.elements[e.getter] = b;\r\n                delete e.getter;\r\n                return e;\r\n            }\r\n\r\n            if(a.group !== S)\r\n                throw new NerdamerValueError('Cannot complete operation. Incorrect LH value for ' + a);\r\n            VARS[a.value] = b;\r\n            return b;\r\n        };\r\n        this.function_assign = function (a, b) {\r\n            var f = a.elements.pop();\r\n            return setFunction(f, a.elements, b);\r\n        };\r\n        // Function to quickly convert bools to Symbols\r\n        var bool2Symbol = function (x) {\r\n            return new Symbol(x === true ? 1 : 0);\r\n        };\r\n        //check for equality\r\n        this.eq = function (a, b) {\r\n            return bool2Symbol(a.equals(b));\r\n        };\r\n        //checks for greater than\r\n        this.gt = function (a, b) {\r\n            return bool2Symbol(a.gt(b));\r\n        };\r\n        //checks for greater than equal\r\n        this.gte = function (a, b) {\r\n            return bool2Symbol(a.gte(b));\r\n        };\r\n        //checks for less than\r\n        this.lt = function (a, b) {\r\n            return bool2Symbol(a.lt(b));\r\n        };\r\n        //checks for less than equal\r\n        this.lte = function (a, b) {\r\n            return bool2Symbol(a.lte(b));\r\n        };\r\n        // wraps the factorial\r\n        this.factorial = function (a) {\r\n            return this.symfunction(FACTORIAL, [a]);\r\n        };\r\n        // wraps the double factorial\r\n        this.dfactorial = function (a) {\r\n            return this.symfunction(DOUBLEFACTORIAL, [a]);\r\n        };\r\n    }\r\n    ;\r\n\r\n    /* \"STATIC\" */\r\n    // converts a number to a fraction.\r\n    var Fraction = {\r\n        /**\r\n         * Converts a decimal to a fraction\r\n         * @param {number} value\r\n         * @param {object} opts\r\n         * @returns {Array} - an array containing the denominator and the numerator\r\n         */\r\n        convert: function (value, opts) {\r\n            var frac;\r\n            if(value === 0) {\r\n                frac = [0, 1];\r\n            }\r\n            else {\r\n                if(value < 1e-6 || value > 1e20) {\r\n                    var qc = this.quickConversion(Number(value));\r\n                    if(qc[1] <= 1e20) {\r\n                        var abs = Math.abs(value);\r\n                        var sign = value / abs;\r\n                        frac = this.fullConversion(abs.toFixed((qc[1] + '').length - 1));\r\n                        frac[0] = frac[0] * sign;\r\n                    }\r\n                    else {\r\n                        frac = qc;\r\n                    }\r\n                }\r\n                else {\r\n                    frac = this.fullConversion(value);\r\n                }\r\n            }\r\n            return frac;\r\n        },\r\n        /**\r\n         * If the fraction is too small or too large this gets called instead of fullConversion method\r\n         * @param {number} dec\r\n         * @returns {Array} - an array containing the denominator and the numerator\r\n         */\r\n        quickConversion: function (value) {\r\n            var stripSign = function (s) {\r\n                // Explicitely convert to a string\r\n                if(typeof s !== 'string') {\r\n                    s = s.toString();\r\n                }\r\n\r\n                var sign = '';\r\n\r\n                // Remove and store the sign\r\n                var start = s.charAt(0);\r\n                if(start === '-') {\r\n                    s = s.substr(1, s.length);\r\n                    sign = '-';\r\n                }\r\n                else if(start === '+') {\r\n                    // Just remove the plus sign\r\n                    s = s.substr(1, s.length);\r\n                }\r\n\r\n                return {\r\n                    sign: sign,\r\n                    value: s\r\n                };\r\n            };\r\n\r\n\r\n            function convert(value) {\r\n                // Explicitely convert to a decimal\r\n                if(Scientific.isScientific(value)) {\r\n                    value = scientificToDecimal(value);\r\n                }\r\n\r\n                // Split the value into the sign and the value\r\n                var nparts = stripSign(value);\r\n\r\n                // Split it at the decimal. We'll refer to it as the coeffient parts\r\n                var cparts = nparts.value.split('.');\r\n\r\n                // Combine the entire number by removing leading zero and adding the decimal part\r\n                // This would be teh same as moving the decimal point to the end\r\n                var num;\r\n                // We're dealing with integers\r\n                if(cparts.length === 1) {\r\n                    num = cparts[0];\r\n                }\r\n                else {\r\n                    num = cparts[0] + cparts[1];\r\n                }\r\n                var n = cparts[1] ? cparts[1].length : 0;\r\n                // Generate the padding for the zeros\r\n                var den = `1${'0'.repeat(n)}`;\r\n\r\n                if(num !== '0') {\r\n                    num = num.replace(/^0+/, '');\r\n                }\r\n                return [nparts.sign + num, den];\r\n            }\r\n\r\n            return convert(value);\r\n        },\r\n        /**\r\n         * Returns a good approximation of a fraction. This method gets called by convert\r\n         * http://mathforum.org/library/drmath/view/61772.html\r\n         * Decimal To Fraction Conversion - A Simpler Version\r\n         * Dr Peterson\r\n         * @param {number} dec\r\n         * @returns {Array} - an array containing the denominator and the numerator\r\n         */\r\n        fullConversion: function (dec) {\r\n            var done = false;\r\n            // you can adjust the epsilon to a larger number if you don't need very high precision\r\n            var n1 = 0, d1 = 1, n2 = 1, d2 = 0, n = 0, q = dec, epsilon = 1e-16;\r\n            while(!done) {\r\n                n++;\r\n                if(n > 10000) {\r\n                    done = true;\r\n                }\r\n                var a = Math.floor(q);\r\n                var num = n1 + a * n2;\r\n                var den = d1 + a * d2;\r\n                var e = (q - a);\r\n                if(e < epsilon) {\r\n                    done = true;\r\n                }\r\n                q = 1 / e;\r\n                n1 = n2;\r\n                d1 = d2;\r\n                n2 = num;\r\n                d2 = den;\r\n                if(Math.abs(num / den - dec) < epsilon || n > 30) {\r\n                    done = true;\r\n                }\r\n            }\r\n            return [num, den];\r\n        }\r\n    };\r\n    //Depends on Fraction\r\n\r\n    //The latex generator\r\n    var LaTeX = {\r\n        parser: (function () {\r\n            // create a parser and strip it from everything except the items that you need\r\n            var keep = ['classes', 'setOperator', 'getOperators', 'getBrackets', 'tokenize', 'toRPN', 'tree', 'units'];\r\n            var parser = new Parser();\r\n            for(var x in parser) {\r\n                if(keep.indexOf(x) === -1)\r\n                    delete parser[x];\r\n            }\r\n            // declare the operators\r\n            parser.setOperator({\r\n                precedence: 8,\r\n                operator: '\\\\',\r\n                action: 'slash',\r\n                prefix: true,\r\n                postfix: false,\r\n                leftAssoc: true,\r\n                operation: function (e) {\r\n                    return e; // bypass the slash\r\n                }\r\n            });\r\n            parser.setOperator({\r\n                precedence: 8,\r\n                operator: '\\\\,',\r\n                action: 'slash_comma',\r\n                prefix: true,\r\n                postfix: false,\r\n                leftAssoc: true,\r\n                operation: function (e) {\r\n                    return e; // bypass the slash\r\n                }\r\n            });\r\n            // have braces not map to anything. We want them to be return as-is\r\n            var brackets = parser.getBrackets();\r\n            brackets['{'].maps_to = undefined;\r\n            return parser;\r\n        })(),\r\n        space: '~',\r\n        dot: ' \\\\cdot ',\r\n        // grab a list of supported functions but remove the excluded ones found in exclFN\r\n\r\n        latex: function (symbol, option) {\r\n            // it might be an array\r\n            if(symbol.clone) {\r\n                symbol = symbol.clone(); // leave original as-is\r\n            }\r\n            if(symbol instanceof _.classes.Collection)\r\n                symbol = symbol.elements;\r\n\r\n            if(isArray(symbol)) {\r\n                var LaTeXArray = [];\r\n                for(var i = 0; i < symbol.length; i++) {\r\n                    var sym = symbol[i];\r\n                    //This way I can generate LaTeX on an array of strings.\r\n                    if(!isSymbol(sym))\r\n                        sym = _.parse(sym);\r\n                    LaTeXArray.push(this.latex(sym, option));\r\n                }\r\n                return this.brackets(LaTeXArray.join(', '), 'square');\r\n            }\r\n\r\n            else if(isMatrix(symbol)) {\r\n                var TeX = '\\\\begin{pmatrix}\\n';\r\n                for(var i = 0; i < symbol.elements.length; i++) {\r\n                    var rowTeX = [],\r\n                            e = symbol.elements[i];\r\n                    for(var j = 0; j < e.length; j++) {\r\n                        rowTeX.push(this.latex(e[j], option));\r\n                    }\r\n                    TeX += rowTeX.join(' & ');\r\n                    if(i < symbol.elements.length - 1) {\r\n                        TeX += '\\\\\\\\\\n';\r\n                    }\r\n                }\r\n                TeX += '\\\\end{pmatrix}';\r\n                return TeX;\r\n            }\r\n\r\n            else if(isVector(symbol)) {\r\n                var TeX = '\\\\left[';\r\n                for(var i = 0; i < symbol.elements.length; i++) {\r\n                    TeX += this.latex(symbol.elements[i], option) + ' ' + (i !== symbol.elements.length - 1 ? ',\\\\,' : '');\r\n                }\r\n                TeX += '\\\\right]';\r\n                return TeX;\r\n            }\r\n\r\n            else if(isSet(symbol)) {\r\n                var TeX = '\\\\{';\r\n                for(var i = 0; i < symbol.elements.length; i++) {\r\n                    TeX += this.latex(symbol.elements[i], option) + ' ' + (i !== symbol.elements.length - 1 ? ',\\\\,' : '');\r\n                }\r\n                TeX += '\\\\}';\r\n                return TeX;\r\n            }\r\n\r\n            symbol = symbol.clone();\r\n\r\n            var decimal = (option === 'decimal' || option === 'decimals'),\r\n                    power = symbol.power,\r\n                    invert = isNegative(power),\r\n                    negative = symbol.multiplier.lessThan(0);\r\n\r\n            if(symbol.group === P && decimal) {\r\n                return String(symbol.multiplier.toDecimal() * Math.pow(symbol.value, symbol.power.toDecimal()));\r\n            }\r\n            else {\r\n                symbol.multiplier = symbol.multiplier.abs();\r\n\r\n                // if the user wants the result in decimal format then return it as such by placing it at the top part\r\n                var m_array;\r\n\r\n                if(decimal) {\r\n                    var m = String(symbol.multiplier.toDecimal());\r\n                    // if(String(m) === '1' && !decimal) m = '';\r\n                    m_array = [m, ''];\r\n                }\r\n                else {\r\n                    m_array = [symbol.multiplier.num, symbol.multiplier.den];\r\n                }\r\n                // get the value as a two part array\r\n                var v_array = this.value(symbol, invert, option, negative),\r\n                        p;\r\n                // make it all positive since we know whether to push the power to the numerator or denominator already.\r\n                if(invert)\r\n                    power.negate();\r\n                // the power is simple since it requires no additional formatting. We can get it to a\r\n                // string right away. pass in true to neglect unit powers\r\n                if(decimal) {\r\n                    p = isSymbol(power) ? LaTeX.latex(power, option) : String(power.toDecimal());\r\n                    if(String(p) === '1')\r\n                        p = '';\r\n                }\r\n                // get the latex representation\r\n                else if(isSymbol(power))\r\n                    p = this.latex(power, option);\r\n                // get it as a fraction\r\n                else\r\n                    p = this.formatFrac(power, true);\r\n                // use this array to specify if the power is getting attached to the top or the bottom\r\n                var p_array = ['', ''],\r\n                        // stick it to the top or the bottom. If it's negative then the power gets placed on the bottom\r\n                        index = invert ? 1 : 0;\r\n                p_array[index] = p;\r\n\r\n                // special case group P and decimal\r\n                var retval = (negative ? '-' : '') + this.set(m_array, v_array, p_array, symbol.group === CB);\r\n\r\n                return retval.replace(/\\+\\-/gi, '-');\r\n            }\r\n\r\n        },\r\n        // greek mapping\r\n        greek: {\r\n            alpha: '\\\\alpha',\r\n            beta: '\\\\beta',\r\n            gamma: '\\\\gamma',\r\n            delta: '\\\\delta',\r\n            epsilon: '\\\\epsilon',\r\n            zeta: '\\\\zeta',\r\n            eta: '\\\\eta',\r\n            theta: '\\\\theta',\r\n            iota: '\\\\iota',\r\n            kappa: '\\\\kappa',\r\n            lambda: '\\\\lambda',\r\n            mu: '\\\\mu',\r\n            nu: '\\\\nu',\r\n            xi: '\\\\xi',\r\n            omnikron: '\\\\omnikron',\r\n            pi: '\\\\pi',\r\n            rho: '\\\\rho',\r\n            sigma: '\\\\sigma',\r\n            tau: '\\\\tau',\r\n            upsilon: '\\\\upsilon',\r\n            phi: '\\\\phi',\r\n            chi: '\\\\chi',\r\n            psi: '\\\\psi',\r\n            omega: '\\\\omega',\r\n            Gamma: '\\\\Gamma',\r\n            Delta: '\\\\Delta',\r\n            Epsilon: '\\\\Epsilon',\r\n            Theta: '\\\\Theta',\r\n            Lambda: '\\\\Lambda',\r\n            Xi: '\\\\Xi',\r\n            Pi: '\\\\Pi',\r\n            Sigma: '\\\\Sigma',\r\n            Phi: '\\\\Phi',\r\n            Psi: '\\\\Psi',\r\n            Omega: '\\\\Omega'\r\n        },\r\n        symbols: {\r\n            arccos: '\\\\arccos',\r\n            cos: '\\\\cos',\r\n            csc: '\\\\csc',\r\n            exp: '\\\\exp',\r\n            ker: '\\\\ker',\r\n            limsup: '\\\\limsup',\r\n            min: '\\\\min',\r\n            sinh: '\\\\sinh',\r\n            arcsin: '\\\\arcsin',\r\n            cosh: '\\\\cosh',\r\n            deg: '\\\\deg',\r\n            gcd: '\\\\gcd',\r\n            lg: '\\\\lg',\r\n            ln: '\\\\ln',\r\n            Pr: '\\\\Pr',\r\n            sqrt: '\\\\sqrt',\r\n            sup: '\\\\sup',\r\n            arctan: '\\\\arctan',\r\n            cot: '\\\\cot',\r\n            det: '\\\\det',\r\n            hom: '\\\\hom',\r\n            lim: '\\\\lim',\r\n            log: '\\\\log',\r\n            LN: '\\\\LN',\r\n            sec: '\\\\sec',\r\n            tan: '\\\\tan',\r\n            arg: '\\\\arg',\r\n            coth: '\\\\coth',\r\n            dim: '\\\\dim',\r\n            inf: '\\\\inf',\r\n            liminf: '\\\\liminf',\r\n            max: '\\\\max',\r\n            sin: '\\\\sin',\r\n            tanh: '\\\\tanh'\r\n        },\r\n        // get the raw value of the symbol as an array\r\n        value: function (symbol, inverted, option, negative) {\r\n            var group = symbol.group,\r\n                    previousGroup = symbol.previousGroup,\r\n                    v = ['', ''],\r\n                    index = inverted ? 1 : 0;\r\n            /*if(group === N) // do nothing since we want to return top & bottom blank; */\r\n            if(symbol.isInfinity) {\r\n                v[index] = '\\\\infty';\r\n            }\r\n            else if(group === S || group === P || previousGroup === S || previousGroup === P || previousGroup === N) {\r\n                var value = this.formatSubscripts(symbol.value);\r\n                if(value.replace)\r\n                    value = value.replace(/(.+)_$/, '$1\\\\_');\r\n                // split it so we can check for instances of alpha as well as alpha_b\r\n                var t_varray = String(value).split('_');\r\n                var greek = this.greek[t_varray[0]];\r\n                if(greek) {\r\n                    t_varray[0] = greek;\r\n                    value = t_varray.join('_');\r\n                }\r\n                var symbol = this.symbols[t_varray[0]];\r\n                if(symbol) {\r\n                    t_varray[0] = symbol;\r\n                    value = t_varray.join('_');\r\n                }\r\n                v[index] = value;\r\n            }\r\n            else if(group === FN || previousGroup === FN) {\r\n                var name,\r\n                        input = [],\r\n                        fname = symbol.fname;\r\n                // collect the arguments\r\n                for(var i = 0; i < symbol.args.length; i++) {\r\n                    var arg = symbol.args[i], item;\r\n                    if(typeof arg === 'string')\r\n                        item = arg;\r\n                    else {\r\n                        item = this.latex(arg, option);\r\n                    }\r\n                    input.push(item);\r\n                }\r\n\r\n                if(fname === SQRT) {\r\n                    v[index] = '\\\\sqrt' + this.braces(input.join(','));\r\n                }\r\n                else if(fname === ABS) {\r\n                    v[index] = this.brackets(input.join(','), 'abs');\r\n                }\r\n                else if(fname === PARENTHESIS) {\r\n                    v[index] = this.brackets(input.join(','), 'parens');\r\n                }\r\n                else if(fname === 'limit') {\r\n                    v[index] = ' \\\\lim\\\\limits_{' + input[1] + ' \\\\to ' + input[2] + '} ' + input[0];\r\n                }\r\n                else if(fname === 'integrate') {\r\n                    v[index] = '\\\\int' + this.braces(input[0]) + this.braces('d' + input[1]);\r\n                }\r\n                else if(fname === 'defint') {\r\n                    v[index] = '\\\\int\\\\limits_' + this.braces(input[1]) + '^' + this.braces(input[2]) + ' ' + input[0] + ' d' + input[3];\r\n                }\r\n                else if(fname === FACTORIAL || fname === DOUBLEFACTORIAL) {\r\n                    var arg = symbol.args[0];\r\n                    if(arg.power.equals(1) && (arg.isComposite() || arg.isCombination())) {\r\n                        input[0] = this.brackets(input[0]);\r\n                    }\r\n                    v[index] = input[0] + (fname === FACTORIAL ? '!' : '!!');\r\n                }\r\n                else if(fname === 'floor') {\r\n                    v[index] = '\\\\left \\\\lfloor' + this.braces(input[0]) + '\\\\right \\\\rfloor';\r\n                }\r\n                else if(fname === 'ceil') {\r\n                    v[index] = '\\\\left \\\\lceil' + this.braces(input[0]) + '\\\\right \\\\rceil';\r\n                }\r\n                // capture log(a, b)\r\n                else if(fname === Settings.LOG && input.length > 1) {\r\n                    v[index] = '\\\\mathrm' + this.braces(Settings.LOG) + '_' + this.braces(input[1]) + this.brackets(input[0]);\r\n                }\r\n                // capture log(a, b)\r\n                else if(fname === Settings.LOG10) {\r\n                    v[index] = '\\\\mathrm' + this.braces(Settings.LOG) + '_' + this.braces(10) + this.brackets(input[0]);\r\n                }\r\n                else if(fname === 'sum') {\r\n                    var a = input[0],\r\n                            b = input[1],\r\n                            c = input[2],\r\n                            d = input[3];\r\n                    v[index] = '\\\\sum\\\\limits_{' + this.braces(b) + '=' + this.braces(c) + '}^' + this.braces(d) + ' ' + this.braces(a) + '';\r\n                }\r\n                else if(fname === 'product') {\r\n                    var a = input[0],\r\n                            b = input[1],\r\n                            c = input[2],\r\n                            d = input[3];\r\n                    v[index] = '\\\\prod\\\\limits_{' + this.braces(b) + '=' + this.braces(c) + '}^' + this.braces(d) + ' ' + this.braces(a) + '';\r\n                }\r\n                else if(fname === 'nthroot') {\r\n                    v[index] = '\\\\sqrt[' + input[1] + ']' + this.braces(input[0]);\r\n                }\r\n                else if(fname === 'mod') {\r\n                    v[index] = input[0] + ' \\\\bmod ' + input[1];\r\n                }\r\n                else if(fname === 'realpart') {\r\n                    v[index] = '\\\\operatorname{Re}' + this.brackets(input[0]);\r\n                }\r\n                else if(fname === 'imagpart') {\r\n                    v[index] = '\\\\operatorname{Im}' + this.brackets(input[0]);\r\n                }\r\n                else {\r\n                    var name = fname !== '' ? '\\\\mathrm' + this.braces(fname.replace(/_/g, '\\\\_')) : '';\r\n                    if(symbol.isConversion)\r\n                        v[index] = name + this.brackets(input.join(''), 'parens');\r\n                    else\r\n                        v[index] = name + this.brackets(input.join(','), 'parens');\r\n                }\r\n            }\r\n            else if(symbol.isComposite()) {\r\n                var collected = symbol.collectSymbols().sort(\r\n                        group === CP || previousGroup === CP ?\r\n                        function (a, b) {\r\n                            return b.group - a.group;\r\n                        } :\r\n                        function (a, b) {\r\n                            var x = isSymbol(a.power) ? -1 : a.power;\r\n                            var y = isSymbol(b.power) ? -1 : b.power;\r\n                            return y - x;\r\n                        }\r\n                ),\r\n                        symbols = [],\r\n                        l = collected.length;\r\n                for(var i = 0; i < l; i++) {\r\n                    symbols.push(LaTeX.latex(collected[i], option));\r\n                }\r\n                var value = symbols.join('+');\r\n\r\n                v[index] = !(symbol.isLinear() && symbol.multiplier.equals(1)) || negative ? this.brackets(value, 'parens') : value;\r\n            }\r\n            else if(group === CB || previousGroup === EX || previousGroup === CB) {\r\n                if(group === CB)\r\n                    symbol.distributeExponent();\r\n                // This almost feels a little like cheating but I need to know if I should be wrapping the symbol\r\n                // in brackets or not. We'll do this by checking the value of the numerator and then comparing it\r\n                // to whether the symbol value is \"simple\" or not.\r\n                var denominator = [],\r\n                        numerator = [];\r\n                // Generate a profile\r\n                var den_map = [], num_map = [], num_c = 0, den_c = 0;\r\n                var setBrackets = function (container, map, counter) {\r\n                    if(counter > 1 && map.length > 0) {\r\n                        var l = map.length;\r\n                        for(var i = 0; i < l; i++) {\r\n                            var idx = map[i], item = container[idx];\r\n                            if(!(/^\\\\left\\(.+\\\\right\\)\\^\\{.+\\}$/g.test(item) || /^\\\\left\\(.+\\\\right\\)$/g.test(item))) {\r\n                                container[idx] = LaTeX.brackets(item, 'parens');\r\n                            }\r\n                        }\r\n                    }\r\n                    return container;\r\n                };\r\n\r\n                // Generate latex for each of them\r\n                symbol.each(function (x) {\r\n                    var isDenom = isNegative(x.power),\r\n                            laTex;\r\n\r\n                    if(isDenom) {\r\n                        laTex = LaTeX.latex(x.invert(), option);\r\n                        den_c++;\r\n                        if(x.isComposite()) {\r\n                            if(symbol.multiplier.den != 1 && Math.abs(x.power) == 1)\r\n                                laTex = LaTeX.brackets(laTex, 'parens');\r\n                            den_map.push(denominator.length); // make a note of where the composite was found\r\n                        }\r\n\r\n                        denominator.push(laTex);\r\n                    }\r\n                    else {\r\n                        laTex = LaTeX.latex(x, option);\r\n                        num_c++;\r\n                        if(x.isComposite()) {\r\n                            if(symbol.multiplier.num != 1 && Math.abs(x.power) == 1)\r\n                                laTex = LaTeX.brackets(laTex, 'parens');\r\n                            num_map.push(numerator.length);   // make a note of where the composite was found\r\n                        }\r\n                        numerator.push(laTex);\r\n                    }\r\n                });\r\n\r\n                // Apply brackets\r\n                setBrackets(numerator, num_map, num_c);\r\n                v[0] = numerator.join(this.dot); // collapse the numerator into one string\r\n\r\n                setBrackets(denominator, den_map, den_c);\r\n                v[1] = denominator.join(this.dot);\r\n            }\r\n\r\n            return v;\r\n        },\r\n        set: function (m, v, p, combine_power) {\r\n            var isBracketed = function (v) {\r\n                return /^\\\\left\\(.+\\\\right\\)$/.test(v);\r\n            };\r\n            // format the power if it exists\r\n            if(p)\r\n                p = this.formatP(p);\r\n            // group CB will have to be wrapped since the power applies to both it's numerator and denominator\r\n            if(combine_power) {\r\n                // POSSIBLE BUG: If powers for group CB format wrong, investigate this since I might have overlooked something\r\n                // the assumption is that in every case the denonimator should be empty when dealing with CB. I can't think\r\n                // of a case where this isn't true\r\n                var tp = p[0];\r\n                p[0] = ''; // temporarily make p blank\r\n            }\r\n\r\n            // merge v and p. Not that v MUST be first since the order matters\r\n            v = this.merge(v, p);\r\n            var mn = m[0], md = m[1], vn = v[0], vd = v[1];\r\n            // filters\r\n            // if the top has a variable but the numerator is one drop it\r\n            if(vn && Number(mn) === 1)\r\n                mn = '';\r\n            // if denominator is 1 drop it always\r\n            if(Number(md) === 1)\r\n                md = '';\r\n            // prepare the top portion but check that it's not already bracketed. If it is then leave out the cdot\r\n            var top = this.join(mn, vn, !isBracketed(vn) ? this.dot : '');\r\n\r\n            // prepare the bottom portion but check that it's not already bracketed. If it is then leave out the cdot\r\n            var bottom = this.join(md, vd, !isBracketed(vd) ? this.dot : '');\r\n            // format the power if it exists\r\n            // make it a fraction if both top and bottom exists\r\n            if(top && bottom) {\r\n                var frac = this.frac(top, bottom);\r\n                if(combine_power && tp)\r\n                    frac = this.brackets(frac) + tp;\r\n                return frac;\r\n            }\r\n            // otherwise only the top exists so return that\r\n            else\r\n                return top;\r\n        },\r\n        merge: function (a, b) {\r\n            var r = [];\r\n            for(var i = 0; i < 2; i++)\r\n                r[i] = a[i] + b[i];\r\n            return r;\r\n        },\r\n        // joins together two strings if both exist\r\n        join: function (n, d, glue) {\r\n            if(!n && !d)\r\n                return '';\r\n            if(n && !d)\r\n                return n;\r\n            if(d && !n)\r\n                return d;\r\n            return n + glue + d;\r\n        },\r\n        /**\r\n         * Places subscripts in braces for proper formatting\r\n         * @param {String} v\r\n         * @returns {String}\r\n         */\r\n        formatSubscripts: function (v) {\r\n            // Split it at the underscore\r\n            var arr = v.toString().split('_');\r\n\r\n            var name = '';\r\n\r\n            // Loop over all entries except the first one\r\n            while(arr.length > 1) {\r\n                // Wrap all in braces except for the last one\r\n                if(arr.length > 0) {\r\n                    name = '_' + this.braces(arr.pop() + name);\r\n                }\r\n            }\r\n\r\n            return arr[0] + name;\r\n        },\r\n        formatP: function (p_array) {\r\n            for(var i = 0; i < 2; i++) {\r\n                var p = p_array[i];\r\n                if(p)\r\n                    p_array[i] = '^' + this.braces(p);\r\n            }\r\n            return p_array;\r\n        },\r\n        /**\r\n         * formats the fractions accordingly.\r\n         * @param {Frac} f\r\n         * @param {bool} is_pow\r\n         */\r\n        formatFrac: function (f, is_pow) {\r\n            var n = f.num.toString(),\r\n                    d = f.den.toString();\r\n            // no need to have x^1\r\n            if(is_pow && n === '1' && d === '1')\r\n                return '';\r\n            // no need to have x/1\r\n            if(d === '1')\r\n                return n;\r\n            return this.frac(n, d);\r\n        },\r\n        frac: function (n, d) {\r\n            return '\\\\frac' + this.braces(n) + this.braces(d);\r\n        },\r\n        braces: function (e) {\r\n            return '{' + e + '}';\r\n        },\r\n        brackets: function (e, typ) {\r\n            typ = typ || 'parens';\r\n            var bracketTypes = {\r\n                parens: ['(', ')'],\r\n                square: ['[', ']'],\r\n                brace: ['{', '}'],\r\n                abs: ['|', '|'],\r\n                angle: ['\\\\langle', '\\\\rangle']\r\n            };\r\n            var bracket = bracketTypes[typ];\r\n            return '\\\\left' + bracket[0] + e + '\\\\right' + bracket[1];\r\n        },\r\n        /**\r\n         * Removes extreneous tokens\r\n         * @param {Tokens[]} tokens\r\n         * @returns {Tokens[]}\r\n         */\r\n        filterTokens: function (tokens) {\r\n            var filtered = [];\r\n\r\n            // Copy over the type of the scope\r\n            if(isArray(tokens)) {\r\n                filtered.type = tokens.type;\r\n            }\r\n\r\n            // the items that need to be disposed\r\n            var d = ['\\\\', 'left', 'right', 'big', 'Big', 'large', 'Large'];\r\n            for(var i = 0, l = tokens.length; i < l; i++) {\r\n                var token = tokens[i];\r\n                var next_token = tokens[i + 1];\r\n                if(token.value === '\\\\' && next_token.value === '\\\\') {\r\n                    filtered.push(token);\r\n                }\r\n                else if(isArray(token)) {\r\n                    filtered.push(LaTeX.filterTokens(token));\r\n                }\r\n                else if(d.indexOf(token.value) === -1) {\r\n                    filtered.push(token);\r\n                }\r\n            }\r\n            return filtered;\r\n        },\r\n        /*\r\n         * Parses tokens from LaTeX string. Does not do any error checking\r\n         * @param {Tokens[]} rpn\r\n         * @returns {String}\r\n         */\r\n        parse: function (raw_tokens) {\r\n            var i, l;\r\n            var retval = '';\r\n            var tokens = this.filterTokens(raw_tokens);\r\n            var replace = {\r\n                'cdot': '',\r\n                'times': '',\r\n                'infty': 'Infinity'\r\n            };\r\n            // get the next token\r\n            var next = function (n) {\r\n                return tokens[(typeof n === 'undefined' ? ++i : i += n)];\r\n            };\r\n            var parse_next = function () {\r\n                return LaTeX.parse(next());\r\n            };\r\n            var get = function (token) {\r\n                if(token in replace) {\r\n                    return replace[token];\r\n                }\r\n                // A quirk with implicit multiplication forces us to check for *\r\n                if(token === '*' && tokens[i + 1].value === '&') {\r\n                    next(2); // skip this and the &\r\n                    return ',';\r\n                }\r\n\r\n                if(token === '&') {\r\n                    next();\r\n                    return ','; // Skip the *\r\n                }\r\n                // If it's the end of a row, return the row separator\r\n                if(token === '\\\\') {\r\n                    return '],[';\r\n                }\r\n                return token;\r\n            };\r\n\r\n            // start parsing the tokens\r\n            for(i = 0, l = tokens.length; i < l; i++) {\r\n                var token = tokens[i];\r\n                // fractions\r\n                if(token.value === 'frac') {\r\n                    // parse and wrap it in brackets\r\n                    var n = parse_next();\r\n                    var d = parse_next();\r\n                    retval += n + '/' + d;\r\n                }\r\n                else if(token.value in LaTeX.symbols) {\r\n                    if(token.value === SQRT && tokens[i + 1].type === 'vector' && tokens[i + 2].type === 'Set') {\r\n                        var base = parse_next();\r\n                        var expr = parse_next();\r\n                        retval += (expr + '^' + inBrackets('1/' + base));\r\n                    }\r\n                    else {\r\n                        retval += token.value + parse_next();\r\n                    }\r\n                }\r\n                else if(token.value === 'int') {\r\n                    var f = parse_next();\r\n                    // skip the comma\r\n                    i++;\r\n                    // get the variable of integration\r\n                    var dx = next().value;\r\n                    dx = get(dx.substring(1, dx.length));\r\n                    retval += 'integrate' + inBrackets(f + ',' + dx);\r\n                }\r\n                else if(token.value === 'int_') {\r\n                    var l = parse_next(); // lower\r\n                    i++; // skip the ^\r\n                    var u = next().value; // upper\r\n                    // if it is in brackets\r\n                    if (u === undefined) {\r\n                        i--;\r\n                        var u = parse_next();\r\n                    }\r\n                    var f = parse_next(); // function\r\n                    \r\n                    // get the variable of integration\r\n                    var dx = next().value;\r\n                    // skip the comma\r\n                    if (dx === ',') {\r\n                        var dx = next().value;\r\n                    }\r\n                    // if 'd', skip\r\n                    if (dx === 'differentialD') {\r\n                        // skip the *\r\n                        i++;\r\n                        var dx = next().value;\r\n                    }\r\n                    if (dx === 'mathrm') {\r\n                        // skip the mathrm{d}\r\n                        i++;\r\n                        var dx = next().value;\r\n                    }\r\n                    retval += 'defint' + inBrackets(f + ',' + l + ',' + u + ',' + dx);\r\n                }\r\n                else if(token.value && token.value.startsWith('int_')) {\r\n                    // var l = parse_next(); // lower\r\n                    var l = token.value.replace('int_', '')\r\n                    console.log('uppernow')\r\n                    i++; // skip the ^\r\n                    var u = next().value; // upper\r\n                    // if it is in brackets\r\n                    if (u === undefined) {\r\n                        i--;\r\n                        var u = parse_next();\r\n                    }\r\n                    var f = parse_next(); // function\r\n                    \r\n                    // get the variable of integration\r\n                    var dx = next().value;\r\n                    // skip the comma\r\n                    if (dx === ',') {\r\n                        var dx = next().value;\r\n                    }\r\n                    // if 'd', skip\r\n                    if (dx === 'differentialD') {\r\n                        // skip the *\r\n                        i++;\r\n                        var dx = next().value;\r\n                    }\r\n                    if (dx === 'mathrm') {\r\n                        // skip the mathrm{d}\r\n                        i++;\r\n                        var dx = next().value;\r\n                    }\r\n                    retval += 'defint' + inBrackets(f + ',' + l + ',' + u + ',' + dx);\r\n                }\r\n                else if(token.value === 'mathrm') {\r\n                    var f = tokens[++i][0].value;\r\n                    retval += f + parse_next();\r\n                }\r\n                // sum and product\r\n                else if(token.value === 'sum_' || token.value === 'prod_') {\r\n                    var fn = token.value === 'sum_' ? 'sum' : 'product';\r\n                    var nxt = next();\r\n                    i++; // skip the caret\r\n                    var end = parse_next();\r\n                    var f = parse_next();\r\n                    retval += fn + inBrackets([f, get(nxt[0]), get(nxt[2]), get(end)].join(','));\r\n                }\r\n                else if(token.value === 'lim_') {\r\n                    var nxt = next();\r\n                    retval += 'limit' + inBrackets([parse_next(), get(nxt[0]), get(nxt[2])].join(','));\r\n                }\r\n                else if(token.value === 'begin') {\r\n                    var nxt = next();\r\n                    if(Array.isArray(nxt)) {\r\n                        var v = nxt[0].value;\r\n                        if(v === 'matrix') {\r\n                            // Start a matrix\r\n                            retval += 'matrix([';\r\n                        }\r\n                    }\r\n                }\r\n                else if(token.value === 'end') {\r\n                    var nxt = next();\r\n                    if(Array.isArray(nxt)) {\r\n                        var v = nxt[0].value;\r\n                        if(v === 'matrix') {\r\n                            // End a matrix\r\n                            retval += '])';\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    if(Array.isArray(token)) {\r\n                        retval += get(LaTeX.parse(token));\r\n                    }\r\n                    else {\r\n                        retval += get(token.value.toString());\r\n                    }\r\n                }\r\n            }\r\n\r\n            return inBrackets(retval);\r\n        }\r\n    };\r\n//Vector =======================================================================\r\n    function Vector(v) {\r\n        if(isVector(v))\r\n            this.elements = v.items.slice(0);\r\n        else if(isArray(v))\r\n            this.elements = v.slice(0);\r\n        else\r\n            this.elements = [].slice.call(arguments);\r\n    }\r\n    /*\r\n     * Generates a pre-filled array\r\n     * @param {type} n\r\n     * @param {type} val\r\n     * @returns {unresolved}\r\n     */\r\n    Vector.arrayPrefill = function (n, val) {\r\n        var a = [];\r\n        val = val || 0;\r\n        for(var i = 0; i < n; i++)\r\n            a[i] = val;\r\n        return a;\r\n    };\r\n    /**\r\n     * Generate a vector from and array\r\n     * @param {type} a\r\n     * @returns {unresolved}\r\n     */\r\n    Vector.fromArray = function (a) {\r\n        var v = new Vector();\r\n        v.elements = a;\r\n        return v;\r\n    };\r\n\r\n    /**\r\n     * Convert a Set to a Vector\r\n     * @param {Set} set\r\n     * @returns {Vector}\r\n     */\r\n    Vector.fromSet = function (set) {\r\n        return Vector.fromArray(set.elements);\r\n    };\r\n\r\n    //Ported from Sylvester.js\r\n    Vector.prototype = {\r\n        custom: true,\r\n        // Returns element i of the vector\r\n        e: function (i) {\r\n            return (i < 1 || i > this.elements.length) ? null : this.elements[i - 1];\r\n        },\r\n\r\n        set: function (i, val) {\r\n            if(!isSymbol(val))\r\n                val = new Symbol(val);\r\n            this.elements[i] = val;\r\n        },\r\n\r\n        // Returns the number of elements the vector has\r\n        dimensions: function () {\r\n            return this.elements.length;\r\n        },\r\n\r\n        // Returns the modulus ('length') of the vector\r\n        modulus: function () {\r\n            return block('SAFE', function () {\r\n                return _.pow((this.dot(this.clone())), new Symbol(0.5));\r\n            }, undefined, this);\r\n        },\r\n\r\n        // Returns true iff the vector is equal to the argument\r\n        eql: function (vector) {\r\n            var n = this.elements.length;\r\n            var V = vector.elements || vector;\r\n            if(n !== V.length) {\r\n                return false;\r\n            }\r\n            do {\r\n                if(Math.abs(_.subtract(this.elements[n - 1], V[n - 1]).valueOf()) > PRECISION) {\r\n                    return false;\r\n                }\r\n            }\r\n            while(--n);\r\n            return true;\r\n        },\r\n\r\n        // Returns a clone of the vector\r\n        clone: function () {\r\n            var V = new Vector(),\r\n                    l = this.elements.length;\r\n            for(var i = 0; i < l; i++) {\r\n                //Rule: all items within the vector must have a clone method.\r\n                V.elements.push(this.elements[i].clone());\r\n            }\r\n            if(this.getter) {\r\n                V.getter = this.getter.clone();\r\n            }\r\n            return V;\r\n        },\r\n\r\n        // Maps the vector to another vector according to the given function\r\n        map: function (fn) {\r\n            var elements = [];\r\n            this.each(function (x, i) {\r\n                elements.push(fn(x, i));\r\n            });\r\n\r\n            return new Vector(elements);\r\n        },\r\n\r\n        // Calls the iterator for each element of the vector in turn\r\n        each: function (fn) {\r\n            var n = this.elements.length, k = n, i;\r\n            do {\r\n                i = k - n;\r\n                fn(this.elements[i], i + 1);\r\n            }\r\n            while(--n);\r\n        },\r\n\r\n        // Returns a new vector created by normalizing the receiver\r\n        toUnitVector: function () {\r\n            return block('SAFE', function () {\r\n                var r = this.modulus();\r\n                if(r.valueOf() === 0) {\r\n                    return this.clone();\r\n                }\r\n                return this.map(function (x) {\r\n                    return _.divide(x, r);\r\n                });\r\n            }, undefined, this);\r\n        },\r\n\r\n        // Returns the angle between the vector and the argument (also a vector)\r\n        angleFrom: function (vector) {\r\n            return block('SAFE', function () {\r\n                var V = vector.elements || vector;\r\n                var n = this.elements.length;\r\n                if(n !== V.length) {\r\n                    return null;\r\n                }\r\n                var dot = new Symbol(0), mod1 = new Symbol(0), mod2 = new Symbol(0);\r\n                // Work things out in parallel to save time\r\n                this.each(function (x, i) {\r\n                    dot = _.add(dot, _.multiply(x, V[i - 1]));\r\n                    mod1 = _.add(mod1, _.multiply(x, x));// will not conflict in safe block\r\n                    mod2 = _.add(mod2, _.multiply(V[i - 1], V[i - 1]));// will not conflict in safe block\r\n                });\r\n                mod1 = _.pow(mod1, new Symbol(0.5));\r\n                mod2 = _.pow(mod2, new Symbol(0.5));\r\n                var product = _.multiply(mod1, mod2);\r\n                if(product.valueOf() === 0) {\r\n                    return null;\r\n                }\r\n                var theta = _.divide(dot, product);\r\n                var theta_val = theta.valueOf();\r\n                if(theta_val < -1) {\r\n                    theta = -1;\r\n                }\r\n                if(theta_val > 1) {\r\n                    theta = 1;\r\n                }\r\n                return new Symbol(Math.acos(theta));\r\n            }, undefined, this);\r\n        },\r\n\r\n        // Returns true iff the vector is parallel to the argument\r\n        isParallelTo: function (vector) {\r\n            var angle = this.angleFrom(vector).valueOf();\r\n            return (angle === null) ? null : (angle <= PRECISION);\r\n        },\r\n\r\n        // Returns true iff the vector is antiparallel to the argument\r\n        isAntiparallelTo: function (vector) {\r\n            var angle = this.angleFrom(vector).valueOf();\r\n            return (angle === null) ? null : (Math.abs(angle - Math.PI) <= PRECISION);\r\n        },\r\n\r\n        // Returns true iff the vector is perpendicular to the argument\r\n        isPerpendicularTo: function (vector) {\r\n            var dot = this.dot(vector);\r\n            return (dot === null) ? null : (Math.abs(dot) <= PRECISION);\r\n        },\r\n\r\n        // Returns the result of adding the argument to the vector\r\n        add: function (vector) {\r\n            return block('SAFE', function () {\r\n                var V = vector.elements || vector;\r\n                if(this.elements.length !== V.length) {\r\n                    return null;\r\n                }\r\n                return this.map(function (x, i) {\r\n                    return _.add(x, V[i - 1]);\r\n                });\r\n            }, undefined, this);\r\n        },\r\n\r\n        // Returns the result of subtracting the argument from the vector\r\n        subtract: function (vector) {\r\n            return block('SAFE', function () {\r\n                var V = vector.elements || vector;\r\n                if(this.elements.length !== V.length) {\r\n                    return null;\r\n                }\r\n                return this.map(function (x, i) {\r\n                    return _.subtract(x, V[i - 1]);\r\n                });\r\n            }, undefined, this);\r\n        },\r\n\r\n        // Returns the result of multiplying the elements of the vector by the argument\r\n        multiply: function (k) {\r\n            return this.map(function (x) {\r\n                return x.clone() * k.clone();\r\n            });\r\n        },\r\n\r\n        x: function (k) {\r\n            return this.multiply(k);\r\n        },\r\n\r\n        // Returns the scalar product of the vector with the argument\r\n        // Both vectors must have equal dimensionality\r\n        dot: function (vector) {\r\n            return block('SAFE', function () {\r\n                var V = vector.elements || vector;\r\n                var product = new Symbol(0), n = this.elements.length;\r\n                if(n !== V.length) {\r\n                    return null;\r\n                }\r\n                do {\r\n                    product = _.add(product, _.multiply(this.elements[n - 1], V[n - 1]));\r\n                }\r\n                while(--n);\r\n                return product;\r\n            }, undefined, this);\r\n        },\r\n\r\n        // Returns the vector product of the vector with the argument\r\n        // Both vectors must have dimensionality 3\r\n        cross: function (vector) {\r\n            var B = vector.elements || vector;\r\n            if(this.elements.length !== 3 || B.length !== 3) {\r\n                return null;\r\n            }\r\n            var A = this.elements;\r\n            return block('SAFE', function () {\r\n                return new Vector([\r\n                    _.subtract(_.multiply(A[1], B[2]), _.multiply(A[2], B[1])),\r\n                    _.subtract(_.multiply(A[2], B[0]), _.multiply(A[0], B[2])),\r\n                    _.subtract(_.multiply(A[0], B[1]), _.multiply(A[1], B[0]))\r\n                ]);\r\n            }, undefined, this);\r\n        },\r\n\r\n        // Returns the (absolute) largest element of the vector\r\n        max: function () {\r\n            var m = 0, n = this.elements.length, k = n, i;\r\n            do {\r\n                i = k - n;\r\n                if(Math.abs(this.elements[i].valueOf()) > Math.abs(m.valueOf())) {\r\n                    m = this.elements[i];\r\n                }\r\n            }\r\n            while(--n);\r\n            return m;\r\n        },\r\n        magnitude: function () {\r\n            var magnitude = new Symbol(0);\r\n            this.each(function (e) {\r\n                magnitude = _.add(magnitude, _.pow(e, new Symbol(2)));\r\n            });\r\n            return _.sqrt(magnitude);\r\n        },\r\n        // Returns the index of the first match found\r\n        indexOf: function (x) {\r\n            var index = null, n = this.elements.length, k = n, i;\r\n            do {\r\n                i = k - n;\r\n                if(index === null && this.elements[i].valueOf() === x.valueOf()) {\r\n                    index = i + 1;\r\n                }\r\n            }\r\n            while(--n);\r\n            return index;\r\n        },\r\n        text: function (x) {\r\n            return text(this);\r\n        },\r\n        toString: function () {\r\n            return this.text();\r\n        },\r\n        latex: function (option) {\r\n            var tex = [];\r\n            for(var i = 0; i < this.elements.length; i++) {\r\n                tex.push(LaTeX.latex.call(LaTeX, this.elements[i], option));\r\n            }\r\n            return '[' + tex.join(', ') + ']';\r\n        }\r\n    };\r\n\r\n//Matrix =======================================================================\r\n    function Matrix() {\r\n        var m = arguments,\r\n                l = m.length, i, el = [];\r\n        if(isMatrix(m)) { // if it's a matrix then make a clone\r\n            for(i = 0; i < l; i++) {\r\n                el.push(m[i].slice(0));\r\n            }\r\n        }\r\n        else {\r\n            var row, lw, rl;\r\n            for(i = 0; i < l; i++) {\r\n                row = m[i];\r\n                if(isVector(row))\r\n                    row = row.elements;\r\n                if(!isArray(row))\r\n                    row = [row];\r\n                rl = row.length;\r\n                if(lw && lw !== rl)\r\n                    err('Unable to create Matrix. Row dimensions do not match!');\r\n                el.push(row);\r\n                lw = rl;\r\n            }\r\n        }\r\n        this.elements = el;\r\n    }\r\n    Matrix.identity = function (n) {\r\n        var m = new Matrix();\r\n        for(var i = 0; i < n; i++) {\r\n            m.elements.push([]);\r\n            for(var j = 0; j < n; j++) {\r\n                m.set(i, j, i === j ? new Symbol(1) : new Symbol(0));\r\n            }\r\n        }\r\n        return m;\r\n    };\r\n    Matrix.fromArray = function (arr) {\r\n        function F(args) {\r\n            return Matrix.apply(this, args);\r\n        }\r\n        F.prototype = Matrix.prototype;\r\n\r\n        return new F(arr);\r\n    };\r\n    Matrix.zeroMatrix = function (rows, cols) {\r\n        var m = new Matrix();\r\n        for(var i = 0; i < rows; i++) {\r\n            m.elements.push(Vector.arrayPrefill(cols, new Symbol(0)));\r\n        }\r\n        return m;\r\n    };\r\n    Matrix.prototype = {\r\n        // needs be true to let the parser know not to try to cast it to a symbol\r\n        custom: true,\r\n        get: function (row, column) {\r\n            if(!this.elements[row])\r\n                return undefined;\r\n            return this.elements[row][column];\r\n        },\r\n        map: function (f, raw_values) {\r\n            var M = new Matrix();\r\n            this.each(function (e, i, j) {\r\n                M.set(i, j, f.call(M, e), raw_values);\r\n            });\r\n            return M;\r\n        },\r\n        set: function (row, column, value, raw) {\r\n            if(!this.elements[row])\r\n                this.elements[row] = [];\r\n            this.elements[row][column] = raw ? value : (isSymbol(value) ? value : new Symbol(value));\r\n        },\r\n        cols: function () {\r\n            return this.elements[0].length;\r\n        },\r\n        rows: function () {\r\n            return this.elements.length;\r\n        },\r\n        row: function (n) {\r\n            if(!n || n > this.cols())\r\n                return [];\r\n            return this.elements[n - 1];\r\n        },\r\n        col: function (n) {\r\n            var nr = this.rows(),\r\n                    col = [];\r\n            if(n > this.cols() || !n)\r\n                return col;\r\n            for(var i = 0; i < nr; i++) {\r\n                col.push(this.elements[i][n - 1]);\r\n            }\r\n            return col;\r\n        },\r\n        eachElement: function (fn) {\r\n            var nr = this.rows(),\r\n                    nc = this.cols(), i, j;\r\n            for(i = 0; i < nr; i++) {\r\n                for(j = 0; j < nc; j++) {\r\n                    fn.call(this, this.elements[i][j], i, j);\r\n                }\r\n            }\r\n        },\r\n        // ported from Sylvester.js\r\n        determinant: function () {\r\n            if(!this.isSquare()) {\r\n                return null;\r\n            }\r\n            var M = this.toRightTriangular();\r\n            var det = M.elements[0][0], n = M.elements.length - 1, k = n, i;\r\n            do {\r\n                i = k - n + 1;\r\n                det = _.multiply(det, M.elements[i][i]);\r\n            }\r\n            while(--n);\r\n            return det;\r\n        },\r\n        isSquare: function () {\r\n            return this.elements.length === this.elements[0].length;\r\n        },\r\n        isSingular: function () {\r\n            return this.isSquare() && this.determinant() === 0;\r\n        },\r\n        augment: function (m) {\r\n            var r = this.rows(), rr = m.rows();\r\n            if(r !== rr)\r\n                err(\"Cannot augment matrix. Rows don't match.\");\r\n            for(var i = 0; i < r; i++) {\r\n                this.elements[i] = this.elements[i].concat(m.elements[i]);\r\n            }\r\n\r\n            return this;\r\n        },\r\n        clone: function () {\r\n            var r = this.rows(), c = this.cols(),\r\n                    m = new Matrix();\r\n            for(var i = 0; i < r; i++) {\r\n                m.elements[i] = [];\r\n                for(var j = 0; j < c; j++) {\r\n                    var symbol = this.elements[i][j];\r\n                    m.elements[i][j] = isSymbol(symbol) ? symbol.clone() : symbol;\r\n                }\r\n            }\r\n            return m;\r\n        },\r\n        // ported from Sylvester.js\r\n        invert: function () {\r\n            if(!this.isSquare())\r\n                err('Matrix is not square!');\r\n            return block('SAFE', function () {\r\n                var ni = this.elements.length, ki = ni, i, j;\r\n                var imatrix = Matrix.identity(ni);\r\n                var M = this.augment(imatrix).toRightTriangular();\r\n                var np, kp = M.elements[0].length, p, els, divisor;\r\n                var inverse_elements = [], new_element;\r\n                // Matrix is non-singular so there will be no zeros on the diagonal\r\n                // Cycle through rows from last to first\r\n                do {\r\n                    i = ni - 1;\r\n                    // First, normalise diagonal elements to 1\r\n                    els = [];\r\n                    np = kp;\r\n                    inverse_elements[i] = [];\r\n                    divisor = M.elements[i][i];\r\n                    do {\r\n                        p = kp - np;\r\n                        new_element = _.divide(M.elements[i][p], divisor.clone());\r\n                        els.push(new_element);\r\n                        // Shuffle of the current row of the right hand side into the results\r\n                        // array as it will not be modified by later runs through this loop\r\n                        if(p >= ki) {\r\n                            inverse_elements[i].push(new_element);\r\n                        }\r\n                    }\r\n                    while(--np);\r\n                    M.elements[i] = els;\r\n                    // Then, subtract this row from those above it to\r\n                    // give the identity matrix on the left hand side\r\n                    for(j = 0; j < i; j++) {\r\n                        els = [];\r\n                        np = kp;\r\n                        do {\r\n                            p = kp - np;\r\n                            els.push(_.subtract(M.elements[j][p].clone(), _.multiply(M.elements[i][p].clone(), M.elements[j][i].clone())));\r\n                        }\r\n                        while(--np);\r\n                        M.elements[j] = els;\r\n                    }\r\n                }\r\n                while(--ni);\r\n                return Matrix.fromArray(inverse_elements);\r\n            }, undefined, this);\r\n        },\r\n        // ported from Sylvester.js\r\n        toRightTriangular: function () {\r\n            return block('SAFE', function () {\r\n                var M = this.clone(), els, fel, nel,\r\n                        n = this.elements.length, k = n, i, np, kp = this.elements[0].length, p;\r\n                do {\r\n                    i = k - n;\r\n                    fel = M.elements[i][i];\r\n                    if(fel.valueOf() === 0) {\r\n                        for(var j = i + 1; j < k; j++) {\r\n                            nel = M.elements[j][i];\r\n                            if(nel && nel.valueOf() !== 0) {\r\n                                els = [];\r\n                                np = kp;\r\n                                do {\r\n                                    p = kp - np;\r\n                                    els.push(_.add(M.elements[i][p].clone(), M.elements[j][p].clone()));\r\n                                }\r\n                                while(--np);\r\n                                M.elements[i] = els;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                    var fel = M.elements[i][i];\r\n                    if(fel.valueOf() !== 0) {\r\n                        for(j = i + 1; j < k; j++) {\r\n                            var multiplier = _.divide(M.elements[j][i].clone(), M.elements[i][i].clone());\r\n                            els = [];\r\n                            np = kp;\r\n                            do {\r\n                                p = kp - np;\r\n                                // Elements with column numbers up to an including the number\r\n                                // of the row that we're subtracting can safely be set straight to\r\n                                // zero, since that's the point of this routine and it avoids having\r\n                                // to loop over and correct rounding errors later\r\n                                els.push(p <= i ? new Symbol(0) :\r\n                                        _.subtract(M.elements[j][p].clone(), _.multiply(M.elements[i][p].clone(), multiplier.clone())));\r\n                            }\r\n                            while(--np);\r\n                            M.elements[j] = els;\r\n                        }\r\n                    }\r\n                }\r\n                while(--n);\r\n\r\n                return M;\r\n            }, undefined, this);\r\n        },\r\n        transpose: function () {\r\n            var rows = this.elements.length, cols = this.elements[0].length;\r\n            var M = new Matrix(), ni = cols, i, nj, j;\r\n\r\n            do {\r\n                i = cols - ni;\r\n                M.elements[i] = [];\r\n                nj = rows;\r\n                do {\r\n                    j = rows - nj;\r\n                    M.elements[i][j] = this.elements[j][i].clone();\r\n                }\r\n                while(--nj);\r\n            }\r\n            while(--ni);\r\n            return M;\r\n        },\r\n        // Returns true if the matrix can multiply the argument from the left\r\n        canMultiplyFromLeft: function (matrix) {\r\n            var l = isMatrix(matrix) ? matrix.elements.length : matrix.length;\r\n            // this.columns should equal matrix.rows\r\n            return (this.elements[0].length === l);\r\n        },\r\n        sameSize: function (matrix) {\r\n            return this.rows() === matrix.rows() && this.cols() === matrix.cols();\r\n        },\r\n        multiply: function (matrix) {\r\n            return block('SAFE', function () {\r\n                var M = matrix.elements || matrix;\r\n                if(!this.canMultiplyFromLeft(M)) {\r\n                    if(this.sameSize(matrix)) {\r\n                        var MM = new Matrix();\r\n                        var rows = this.rows();\r\n                        for(var i = 0; i < rows; i++) {\r\n                            var e = _.multiply(new Vector(this.elements[i]), new Vector(matrix.elements[i]));\r\n                            MM.elements[i] = e.elements;\r\n                        }\r\n                        return MM;\r\n                    }\r\n                    return null;\r\n                }\r\n                var ni = this.elements.length, ki = ni, i, nj, kj = M[0].length, j;\r\n                var cols = this.elements[0].length, elements = [], sum, nc, c;\r\n                do {\r\n                    i = ki - ni;\r\n                    elements[i] = [];\r\n                    nj = kj;\r\n                    do {\r\n                        j = kj - nj;\r\n                        sum = new Symbol(0);\r\n                        nc = cols;\r\n                        do {\r\n                            c = cols - nc;\r\n                            sum = _.add(sum, _.multiply(this.elements[i][c], M[c][j]));\r\n                        }\r\n                        while(--nc);\r\n                        elements[i][j] = sum;\r\n                    }\r\n                    while(--nj);\r\n                }\r\n                while(--ni);\r\n                return Matrix.fromArray(elements);\r\n            }, undefined, this);\r\n        },\r\n        add: function (matrix, callback) {\r\n            var M = new Matrix();\r\n            if(this.sameSize(matrix)) {\r\n                this.eachElement(function (e, i, j) {\r\n                    var result = _.add(e.clone(), matrix.elements[i][j].clone());\r\n                    if(callback) {\r\n                        result = callback.call(M, result, e, matrix.elements[i][j]);\r\n                    }\r\n                    M.set(i, j, result);\r\n                });\r\n            }\r\n            return M;\r\n        },\r\n        subtract: function (matrix, callback) {\r\n            var M = new Matrix();\r\n            if(this.sameSize(matrix)) {\r\n                this.eachElement(function (e, i, j) {\r\n                    var result = _.subtract(e.clone(), matrix.elements[i][j].clone());\r\n                    if(callback) {\r\n                        result = callback.call(M, result, e, matrix.elements[i][j]);\r\n                    }\r\n                    M.set(i, j, result);\r\n                });\r\n            }\r\n            return M;\r\n        },\r\n        negate: function () {\r\n            this.each(function (e) {\r\n                return e.negate();\r\n            });\r\n            return this;\r\n        },\r\n        toVector: function () {\r\n            if(this.rows() === 1 || this.cols() === 1) {\r\n                var v = new Vector();\r\n                v.elements = this.elements;\r\n                return v;\r\n            }\r\n            return this;\r\n        },\r\n        toString: function (newline, to_decimal) {\r\n            var l = this.rows(),\r\n                    s = [];\r\n            newline = newline === undefined ? '\\n' : newline;\r\n            for(var i = 0; i < l; i++) {\r\n                s.push('[' + this.elements[i].map(function (x) {\r\n                    var v = to_decimal ? x.multiplier.toDecimal() : x.toString();\r\n                    return x !== undefined ? v : '';\r\n                }).join(',') + ']');\r\n            }\r\n            return 'matrix' + inBrackets(s.join(','));\r\n        },\r\n        text: function () {\r\n            return 'matrix(' + this.elements.toString('') + ')';\r\n        },\r\n        latex: function (option) {\r\n            var cols = this.cols(), elements = this.elements;\r\n            return format('\\\\begin{vmatrix}{0}\\\\end{vmatrix}', function () {\r\n                var tex = [];\r\n                for(var row in elements) {\r\n                    var row_tex = [];\r\n                    for(var i = 0; i < cols; i++) {\r\n                        row_tex.push(LaTeX.latex.call(LaTeX, elements[row][i], option));\r\n                    }\r\n                    tex.push(row_tex.join(' & '));\r\n                }\r\n                return tex.join(' \\\\cr ');\r\n            });\r\n        }\r\n    };\r\n    // aliases\r\n    Matrix.prototype.each = Matrix.prototype.eachElement;\r\n\r\n\r\n    function Set(set) {\r\n        this.elements = [];\r\n        // if the first object isn't an array, convert it to one.\r\n        if(!isVector(set))\r\n            set = Vector.fromArray(arguments);\r\n\r\n        if(set) {\r\n            var elements = set.elements;\r\n            for(var i = 0, l = elements.length; i < l; i++) {\r\n                this.add(elements[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    Set.fromArray = function (arr) {\r\n        function F(args) {\r\n            return Set.apply(this, args);\r\n        }\r\n        F.prototype = Set.prototype;\r\n\r\n        return new F(arr);\r\n    };\r\n\r\n    Set.prototype = {\r\n        add: function (x) {\r\n            if(!this.contains(x))\r\n                this.elements.push(x.clone());\r\n        },\r\n        contains: function (x) {\r\n            for(var i = 0; i < this.elements.length; i++) {\r\n                var e = this.elements[i];\r\n                if(x.equals(e))\r\n                    return true;\r\n            }\r\n            return false;\r\n        },\r\n        each: function (f) {\r\n            var elements = this.elements;\r\n            var set = new Set();\r\n            for(var i = 0, l = elements.length; i < l; i++) {\r\n                var e = elements[i];\r\n                f.call(this, e, set, i);\r\n            }\r\n            return set;\r\n        },\r\n        clone: function () {\r\n            var set = new Set();\r\n            this.each(function (e) {\r\n                set.add(e.clone());\r\n            });\r\n            return set;\r\n        },\r\n        union: function (set) {\r\n            var _union = this.clone();\r\n            set.each(function (e) {\r\n                _union.add(e);\r\n            });\r\n\r\n            return _union;\r\n        },\r\n        difference: function (set) {\r\n            var diff = this.clone();\r\n            set.each(function (e) {\r\n                diff.remove(e);\r\n            });\r\n            return diff;\r\n        },\r\n        remove: function (element) {\r\n            for(var i = 0, l = this.elements.length; i < l; i++) {\r\n                var e = this.elements[i];\r\n                if(e.equals(element)) {\r\n                    remove(this.elements, i);\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n        intersection: function (set) {\r\n            var _intersection = new Set();\r\n            var A = this;\r\n            set.each(function (e) {\r\n                if(A.contains(e)) {\r\n                    _intersection.add(e);\r\n                }\r\n                ;\r\n            });\r\n\r\n            return _intersection;\r\n        },\r\n        intersects: function (set) {\r\n            return this.intersection(set).elements.length > 0;\r\n        },\r\n        is_subset: function (set) {\r\n            var elements = set.elements;\r\n            for(var i = 0, l = elements.length; i < l; i++) {\r\n                if(!this.contains(elements[i])) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        },\r\n        toString: function () {\r\n            return '{' + this.elements.join(',') + '}';\r\n        }\r\n    };\r\n\r\n//build ========================================================================\r\n    var Build = {\r\n        dependencies: {\r\n            _rename: {\r\n                'Math2.factorial': 'factorial'\r\n            },\r\n            factorial: {\r\n                'Math2.gamma': Math2.gamma\r\n            },\r\n            gamma_incomplete: {\r\n                'Math2.factorial': Math2.factorial\r\n            },\r\n            Li: {\r\n                'Math2.Ei': Math2.Ei,\r\n                'Math2.bigLog': Math2.bigLog,\r\n                'Frac': Frac\r\n            },\r\n            Ci: {\r\n                'Math2.factorial': Math2.factorial\r\n            },\r\n            Ei: {\r\n                'Math2.factorial': Math2.factorial\r\n            },\r\n            Si: {\r\n                'Math2.factorial': Math2.factorial\r\n            },\r\n            Shi: {\r\n                'Math2.factorial': Math2.factorial\r\n            },\r\n            Chi: {\r\n                'isInt': isInt,\r\n                'nround': nround,\r\n                'Math2.num_integrate': Math2.num_integrate\r\n            },\r\n            factor: {\r\n                'Math2.ifactor': Math2.ifactor,\r\n                'Symbol': Symbol\r\n            },\r\n            num_integrate: {\r\n                'Math2.simpson': Math2.simpson,\r\n                'nround': nround\r\n            },\r\n            fib: {\r\n                'even': even\r\n            }\r\n        },\r\n        /* Some functions need to be made numeric safe. Build checks if there's a\r\n         * reformat option and calls that instead when compiling the function string.\r\n         */\r\n        reformat: {\r\n            // this simply extends the build function\r\n            diff: function (symbol, deps) {\r\n                var v = symbol.args[1].toString();\r\n                var f = 'var f = ' + Build.build(symbol.args[0].toString(), [v]) + ';';\r\n                deps[1] += 'var diff = ' + Math2.diff.toString() + ';';\r\n                deps[1] += f;\r\n\r\n                return ['diff(f)(' + v + ')', deps];\r\n            }\r\n        },\r\n        getProperName: function (f) {\r\n            var map = {\r\n                continued_fraction: 'continuedFraction'\r\n            };\r\n            return map[f] || f;\r\n        },\r\n        // assumes that dependences are at max 2 levels\r\n        compileDependencies: function (f, deps) {\r\n            // grab the predefined dependiences\r\n            var dependencies = Build.dependencies[f];\r\n\r\n            // the dependency string\r\n            var dep_string = deps && deps[1] ? deps[1] : '';\r\n\r\n            // the functions to be replaced\r\n            var replacements = deps && deps[0] ? deps[0] : {};\r\n\r\n            // loop through them and add them to the list\r\n            for(var x in dependencies) {\r\n                if(typeof dependencies[x] === 'object')\r\n                    continue; // skip object\r\n                var components = x.split('.'); //Math.f becomes f\r\n                // if the function isn't part of an object then reference the function itself\r\n                dep_string += 'var ' + (components.length > 1 ? components[1] : components[0]) + '=' + dependencies[x] + ';';\r\n                replacements[x] = components.pop();\r\n            }\r\n\r\n            return [replacements, dep_string];\r\n        },\r\n        getArgsDeps: function (symbol, dependencies) {\r\n            var args = symbol.args;\r\n            for(var i = 0; i < args.length; i++) {\r\n                symbol.args[i].each(function (x) {\r\n                    if(x.group === FN)\r\n                        dependencies = Build.compileDependencies(x.fname, dependencies);\r\n                });\r\n            }\r\n            return dependencies;\r\n        },\r\n        build: function (symbol, arg_array) {\r\n            symbol = block('PARSE2NUMBER', function () {\r\n                return _.parse(symbol);\r\n            }, true);\r\n            var args = variables(symbol);\r\n            var supplements = [];\r\n            var dependencies = [];\r\n            var ftext = function (symbol, xports) {\r\n                //Fix for #545 - Parentheses confuse build.\r\n                if(symbol.fname === '') {\r\n                    symbol = Symbol.unwrapPARENS(symbol);\r\n                }\r\n                xports = xports || [];\r\n                var c = [],\r\n                        group = symbol.group,\r\n                        prefix = '';\r\n\r\n                var ftext_complex = function (group) {\r\n                    var d = group === CB ? '*' : '+',\r\n                            cc = [];\r\n\r\n                    for(var x in symbol.symbols) {\r\n                        var sym = symbol.symbols[x],\r\n                                ft = ftext(sym, xports)[0];\r\n                        // wrap it in brackets if it's group PL or CP\r\n                        if(sym.isComposite())\r\n                            ft = inBrackets(ft);\r\n                        cc.push(ft);\r\n                    }\r\n                    var retval = cc.join(d);\r\n                    retval = retval && !symbol.multiplier.equals(1) ? inBrackets(retval) : retval;\r\n                    return retval;\r\n                },\r\n                        ftext_function = function (bn) {\r\n                            var retval;\r\n                            if(bn in Math)\r\n                                retval = 'Math.' + bn;\r\n                            else {\r\n                                bn = Build.getProperName(bn);\r\n                                if(supplements.indexOf(bn) === -1) { // make sure you're not adding the function twice\r\n                                    //Math2 functions aren't part of the standard javascript\r\n                                    //Math library and must be exported.\r\n                                    xports.push('var ' + bn + ' = ' + Math2[bn].toString() + '; ');\r\n                                    supplements.push(bn);\r\n                                }\r\n                                retval = bn;\r\n                            }\r\n                            retval = retval + inBrackets(symbol.args.map(function (x) {\r\n                                return ftext(x, xports)[0];\r\n                            }).join(','));\r\n\r\n                            return retval;\r\n                        };\r\n\r\n                // the multiplier\r\n                if(group === N)\r\n                    c.push(symbol.multiplier.toDecimal());\r\n                else if(symbol.multiplier.equals(-1))\r\n                    prefix = '-';\r\n                else if(!symbol.multiplier.equals(1))\r\n                    c.push(symbol.multiplier.toDecimal());\r\n                // the value\r\n                var value;\r\n\r\n                if(group === S || group === P)\r\n                    value = symbol.value;\r\n                else if(group === FN) {\r\n                    dependencies = Build.compileDependencies(symbol.fname, dependencies);\r\n                    dependencies = Build.getArgsDeps(symbol, dependencies);\r\n                    if(Build.reformat[symbol.fname]) {\r\n                        var components = Build.reformat[symbol.fname](symbol, dependencies);\r\n                        dependencies = components[1];\r\n                        value = components[0];\r\n                    }\r\n                    else {\r\n                        value = ftext_function(symbol.fname);\r\n                    }\r\n\r\n                }\r\n                else if(group === EX) {\r\n                    var pg = symbol.previousGroup;\r\n                    if(pg === N || pg === S)\r\n                        value = symbol.value;\r\n                    else if(pg === FN) {\r\n                        value = ftext_function(symbol.fname);\r\n                        dependencies = Build.compileDependencies(symbol.fname, dependencies);\r\n                        dependencies = Build.getArgsDeps(symbol, dependencies);\r\n                    }\r\n                    else\r\n                        value = ftext_complex(symbol.previousGroup);\r\n                }\r\n                else {\r\n                    value = ftext_complex(symbol.group);\r\n                }\r\n\r\n                if(symbol.group !== N && !symbol.power.equals(1)) {\r\n                    var pow = ftext(_.parse(symbol.power));\r\n                    xports.push(pow[1]);\r\n                    value = 'Math.pow' + inBrackets(value + ',' + pow[0]);\r\n                }\r\n\r\n                if(value)\r\n                    c.push(prefix + value);\r\n\r\n                return [c.join('*'), xports.join('').replace(/\\n+\\s+/g, ' ')];\r\n            };\r\n            if(arg_array) {\r\n                // Fix for issue #546\r\n                // Disable argument checking since it's a bit presumptuous.\r\n                // Consider f(x) = 5; If I explicitely pass in an argument array contain x \r\n                // this check will fail and complain since the function doesn't contain x.\r\n                /*\r\n                 for (var i = 0; i < args.length; i++) {\r\n                 var arg = args[i];\r\n                 if (arg_array.indexOf(arg) === -1)\r\n                 err(arg + ' not found in argument array');\r\n                 }\r\n                 */\r\n                args = arg_array;\r\n            }\r\n\r\n            var f_array = ftext(symbol);\r\n\r\n            // make all the substitutions;\r\n            for(var x in dependencies[0]) {\r\n                var alias = dependencies[0][x];\r\n                f_array[1] = f_array[1].replace(x, alias);\r\n                dependencies[1] = dependencies[1].replace(x, alias);\r\n            }\r\n\r\n            var f = new Function(args, (dependencies[1] || '') + f_array[1] + ' return ' + f_array[0] + ';');\r\n\r\n            return f;\r\n        }\r\n    };\r\n\r\n\r\n//finalize =====================================================================\r\n    /* FINALIZE */\r\n    (function () {\r\n        reserveNames(_.CONSTANTS);\r\n        reserveNames(_.functions);\r\n        _.initConstants();\r\n        //bug fix for error but needs to be revisited\r\n        if(!_.error)\r\n            _.error = err;\r\n\r\n        //Store the log and log10 functions\r\n        Settings.LOG_FNS = {\r\n            log: _.functions['log'],\r\n            log10: _.functions['log10']\r\n        };\r\n\r\n    })();\r\n\r\n    /* END FINALIZE */\r\n\r\n//Core =========================================================================\r\n    var Utils = {\r\n        allSame: allSame,\r\n        allNumeric: allNumeric,\r\n        arguments2Array: arguments2Array,\r\n        arrayAddSlices: arrayAddSlices,\r\n        arrayClone: arrayClone,\r\n        arrayMax: arrayMax,\r\n        arrayMin: arrayMin,\r\n        arrayEqual: arrayEqual,\r\n        arrayUnique: arrayUnique,\r\n        arrayGetVariables: arrayGetVariables,\r\n        arraySum: arraySum,\r\n        block: block,\r\n        build: Build.build,\r\n        clearU: clearU,\r\n        comboSort: comboSort,\r\n        compare: compare,\r\n        convertToVector: convertToVector,\r\n        customError: customError,\r\n        customType: customType,\r\n        decompose_fn: decompose_fn,\r\n        each: each,\r\n        evaluate: evaluate,\r\n        even: even,\r\n        evenFraction: evenFraction,\r\n        fillHoles: fillHoles,\r\n        firstObject: firstObject,\r\n        format: format,\r\n        generatePrimes: generatePrimes,\r\n        getCoeffs: getCoeffs,\r\n        getU: getU,\r\n        importFunctions: importFunctions,\r\n        inBrackets: inBrackets,\r\n        isArray: isArray,\r\n        isExpression: isExpression,\r\n        isFraction: isFraction,\r\n        isInt: isInt,\r\n        isMatrix: isMatrix,\r\n        isNegative: isNegative,\r\n        isNumericSymbol: isNumericSymbol,\r\n        isPrime: isPrime,\r\n        isReserved: isReserved,\r\n        isSymbol: isSymbol,\r\n        isVariableSymbol: isVariableSymbol,\r\n        isVector: isVector,\r\n        keys: keys,\r\n        knownVariable: knownVariable,\r\n        nroots: nroots,\r\n        remove: remove,\r\n        reserveNames: reserveNames,\r\n        range: range,\r\n        round: nround,\r\n        sameSign: sameSign,\r\n        scientificToDecimal: scientificToDecimal,\r\n        separate: separate,\r\n        stringReplace: stringReplace,\r\n        text: text,\r\n        validateName: validateName,\r\n        variables: variables,\r\n        warn: warn\r\n    };\r\n\r\n    //This contains all the parts of nerdamer and enables nerdamer's internal functions\r\n    //to be used.\r\n    var C = {\r\n        groups: Groups,\r\n        Symbol: Symbol,\r\n        Expression: Expression,\r\n        Frac: Frac,\r\n        Vector: Vector,\r\n        Matrix: Matrix,\r\n        Parser: Parser,\r\n        Scientific: Scientific,\r\n        Fraction: Fraction,\r\n        Math2: Math2,\r\n        LaTeX: LaTeX,\r\n        Utils: Utils,\r\n        PARSER: _,\r\n        PARENTHESIS: PARENTHESIS,\r\n        Settings: Settings,\r\n        err: err,\r\n        bigInt: bigInt,\r\n        bigDec: bigDec,\r\n        exceptions: exceptions\r\n    };\r\n\r\n//libExports ===================================================================\r\n    /**\r\n     *\r\n     * @param {String} expression the expression to be evaluated\r\n     * @param {Object} subs the object containing the variable values\r\n     * @param {Integer} location a specific location in the equation list to\r\n     * insert the evaluated expression\r\n     * @param {String} option additional options\r\n     * @returns {Expression}\r\n     */\r\n    var libExports = function (expression, subs, option, location) {\r\n        // Initiate the numer flag\r\n        var numer = false;\r\n\r\n        // Is the user declaring a function?\r\n        var fndec = /^([a-z_][a-z\\d\\_]*)\\(([a-z_,\\s]*)\\):=(.+)$/gi.exec(expression);\r\n        if(fndec)\r\n            return nerdamer.setFunction(fndec[1], fndec[2].split(','), fndec[3]);\r\n\r\n        // var variable, fn, args;\r\n        // Convert any expression passed in to a string\r\n        if(expression instanceof Expression)\r\n            expression = expression.toString();\r\n\r\n        // Convert it to an array for simplicity\r\n        if(!isArray(option)) {\r\n            option = typeof option === 'undefined' ? [] : [option];\r\n        }\r\n\r\n        option.forEach(function (o) {\r\n            // Turn on the numer flag if requested\r\n            if(o === 'numer') {\r\n                numer = true;\r\n                return;\r\n            }\r\n            // Wrap it in a function if requested. This only holds true for\r\n            // functions that take a single argument which is the expression\r\n            var f = _.functions[option];\r\n            // If there's a function and it takes a single argument, then wrap\r\n            // the expression in it\r\n            if(f && f[1] === 1) {\r\n                expression = `${o}(${expression})`;\r\n            }\r\n        });\r\n\r\n        var e = block('PARSE2NUMBER', function () {\r\n            return _.parse(expression, subs);\r\n        }, numer || Settings.PARSE2NUMBER);\r\n\r\n        if(location) {\r\n            EXPRESSIONS[location - 1] = e;\r\n        }\r\n        else {\r\n            EXPRESSIONS.push(e);\r\n        }\r\n\r\n        return new Expression(e);\r\n    };\r\n    /**\r\n     * Converts expression into rpn form\r\n     * @param {String} expression\r\n     * @returns {Token[]}\r\n     */\r\n    libExports.rpn = function (expression) {\r\n        return _.tokenize(_.toRPN(expression));\r\n    };\r\n\r\n    /**\r\n     * Generates LaTeX from expression string\r\n     * @param {String} e\r\n     * @param {object} opt\r\n     * @returns {String}\r\n     */\r\n    libExports.convertToLaTeX = function (e, opt) {\r\n        return _.toTeX(e, opt);\r\n    };\r\n\r\n    /**\r\n     * Converts latex to text - Very very very basic at the moment\r\n     * @param {String} e\r\n     * @returns {String}\r\n     */\r\n    libExports.convertFromLaTeX = function (e) {\r\n        var txt = LaTeX.parse(_.tokenize(e));\r\n        return new Expression(_.parse(txt));\r\n    };\r\n\r\n    /**\r\n     * Get the version of nerdamer or a loaded add-on\r\n     * @param {String} add_on - The add-on being checked\r\n     * @returns {String} returns the version of nerdamer\r\n     */\r\n    libExports.version = function (add_on) {\r\n        if(add_on) {\r\n            try {\r\n                return C[add_on].version;\r\n            }\r\n            catch(e) {\r\n                return \"No module named \" + add_on + \" found!\";\r\n            }\r\n        }\r\n        return version;\r\n    };\r\n\r\n    /**\r\n     * Get nerdamer generated warnings\r\n     * @returns {String[]}\r\n     */\r\n    libExports.getWarnings = function () {\r\n        return WARNINGS;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param {String} constant The name of the constant to be set\r\n     * @param {mixed} value The value of the constant\r\n     * @returns {Object} Returns the nerdamer object\r\n     */\r\n    libExports.setConstant = function (constant, value) {\r\n        validateName(constant);\r\n        if(!isReserved(constant)) {\r\n            //fix for issue #127\r\n            if(value === 'delete' || value === '') {\r\n                delete _.CONSTANTS[constant];\r\n            }\r\n            else {\r\n                if(isNaN(value))\r\n                    throw new NerdamerTypeError('Constant must be a number!');\r\n                _.CONSTANTS[constant] = value;\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n\r\n    /**\r\n     * Returns the value of a previously set constant\r\n     * @param {type} constant\r\n     * @returns {String}\r\n     */\r\n    libExports.getConstant = function (constant) {\r\n        return String(_.constant[constant]);\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param {String} name The name of the function\r\n     * @param {Array} params_array A list containing the parameter name of the functions\r\n     * @param {String} body The body of the function\r\n     * @returns {Boolean} returns true if succeeded and falls on fail\r\n     * @example nerdamer.setFunction('f',['x'], 'x^2+2');\r\n     */\r\n    libExports.setFunction = setFunction;\r\n\r\n    /**\r\n     *\r\n     * @returns {C} Exports the nerdamer core functions and objects\r\n     */\r\n    libExports.getCore = function () {\r\n        return C;\r\n    };\r\n\r\n    libExports.getExpression = libExports.getEquation = Expression.getExpression;\r\n\r\n    /**\r\n     *\r\n     * @param {Boolean} asArray The returned names are returned as an array if this is set to true;\r\n     * @returns {String|Array}\r\n     */\r\n    libExports.reserved = function (asArray) {\r\n        if(asArray) {\r\n            return RESERVED;\r\n        }\r\n        return RESERVED.join(', ');\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param {Integer} equation_number the number of the equation to clear.\r\n     * If 'all' is supplied then all equations are cleared\r\n     * @param {Boolean} keep_EXPRESSIONS_fixed use true if you don't want to keep EXPRESSIONS length fixed\r\n     * @returns {Object} Returns the nerdamer object\r\n     */\r\n    libExports.clear = function (equation_number, keep_EXPRESSIONS_fixed) {\r\n        if(equation_number === 'all') {\r\n            EXPRESSIONS = [];\r\n        }\r\n        else if(equation_number === 'last') {\r\n            EXPRESSIONS.pop();\r\n        }\r\n        else if(equation_number === 'first') {\r\n            EXPRESSIONS.shift();\r\n        }\r\n        else {\r\n            var index = !equation_number ? EXPRESSIONS.length : equation_number - 1;\r\n            keep_EXPRESSIONS_fixed === true ? EXPRESSIONS[index] = undefined : remove(EXPRESSIONS, index);\r\n        }\r\n        return this;\r\n    };\r\n\r\n    /**\r\n     * Alias for nerdamer.clear('all')\r\n     */\r\n    libExports.flush = function () {\r\n        this.clear('all');\r\n        return this;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param {Boolean} asObject\r\n     * @param {Boolean} asLaTeX\r\n     * @param {String|String[]} option\r\n     * @returns {Array}\r\n     */\r\n    libExports.expressions = function (asObject, asLaTeX, option) {\r\n        var result = asObject ? {} : [];\r\n        for(var i = 0; i < EXPRESSIONS.length; i++) {\r\n            var eq = asLaTeX ? LaTeX.latex(EXPRESSIONS[i], option) : text(EXPRESSIONS[i], option);\r\n            asObject ? result[i + 1] = eq : result.push(eq);\r\n        }\r\n        return result;\r\n    };\r\n\r\n    //the method for registering modules\r\n    libExports.register = function (obj) {\r\n        var core = this.getCore();\r\n\r\n        if(isArray(obj)) {\r\n            for(var i = 0; i < obj.length; i++) {\r\n                if(obj)\r\n                    this.register(obj[i]);\r\n            }\r\n        }\r\n        else if(obj && Settings.exclude.indexOf(obj.name) === -1) {\r\n            //make sure all the dependencies are available\r\n            if(obj.dependencies) {\r\n                for(var i = 0; i < obj.dependencies.length; i++)\r\n                    if(!core[obj.dependencies[i]])\r\n                        throw new Error(format('{0} requires {1} to be loaded!', obj.name, obj.dependencies[i]));\r\n            }\r\n            //if no parent object is provided then the function does not have an address and cannot be called directly\r\n            var parent_obj = obj.parent,\r\n                    fn = obj.build.call(core); //call constructor to get function\r\n            if(parent_obj) {\r\n                if(!core[parent_obj])\r\n                    core[obj.parent] = {};\r\n\r\n                var ref_obj = parent_obj === 'nerdamer' ? this : core[parent_obj];\r\n                //attach the function to the core\r\n                ref_obj[obj.name] = fn;\r\n            }\r\n            if(obj.visible)\r\n                _.functions[obj.name] = [fn, obj.numargs]; //make the function available\r\n\r\n        }\r\n    };\r\n\r\n    /**\r\n     * @param {String} name variable name\r\n     * @returns {boolean} validates if the profided string is a valid variable name\r\n     */\r\n    libExports.validateName = validateName;\r\n\r\n    /**\r\n     * @param {String} varname variable name\r\n     * @returns {boolean} validates if the profided string is a valid variable name\r\n     */\r\n    libExports.validVarName = function (varname) {\r\n        try {\r\n            validateName(varname);\r\n            return RESERVED.indexOf(varname) === -1;\r\n        }\r\n        catch(e) {\r\n            return false;\r\n        }\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @returns {Array} Array of functions currently supported by nerdamer\r\n     */\r\n    libExports.supported = function () {\r\n        return keys(_.functions);\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @returns {Number} The number equations/expressions currently loaded\r\n     */\r\n    libExports.numEquations = libExports.numExpressions = function () {\r\n        return EXPRESSIONS.length;\r\n    };\r\n    /* END EXPORTS */\r\n\r\n    /**\r\n     *\r\n     * @param {String} v variable to be set\r\n     * @param {String} val value of variable. This can be a variable expression or number\r\n     * @returns {Object} Returns the nerdamer object\r\n     */\r\n    libExports.setVar = function (v, val) {\r\n        validateName(v);\r\n        //check if it's not already a constant\r\n        if(v in _.CONSTANTS)\r\n            err('Cannot set value for constant ' + v);\r\n        if(val === 'delete' || val === '')\r\n            delete VARS[v];\r\n        else {\r\n            VARS[v] = isSymbol(val) ? val : _.parse(val);\r\n        }\r\n        return this;\r\n    };\r\n\r\n    /**\r\n     * Returns the value of a set variable\r\n     * @param {type} v\r\n     * @returns {varies}\r\n     */\r\n    libExports.getVar = function (v) {\r\n        return VARS[v];\r\n    };\r\n    /**\r\n     * Clear the variables from the VARS object\r\n     * @returns {Object} Returns the nerdamer object\r\n     */\r\n    libExports.clearVars = function () {\r\n        VARS = {};\r\n        return this;\r\n    };\r\n\r\n    /**\r\n     *\r\n     * @param {Function} loader\r\n     * @returns {nerdamer}\r\n     */\r\n    libExports.load = function (loader) {\r\n        loader.call(this);\r\n        return this;\r\n    };\r\n\r\n    /**\r\n     * @param {String} output - output format. Can be 'object' (just returns the VARS object), 'text' or 'latex'. Default: 'text'\r\n     * @param {String|String[]} option\r\n     * @returns {Object} Returns an object with the variables\r\n     */\r\n    libExports.getVars = function (output, option) {\r\n        output = output || 'text';\r\n        var variables = {};\r\n        if(output === 'object')\r\n            variables = VARS;\r\n        else {\r\n            for(var v in VARS) {\r\n                if(output === 'latex') {\r\n                    variables[v] = VARS[v].latex(option);\r\n                }\r\n                else if(output === 'text') {\r\n                    variables[v] = VARS[v].text(option);\r\n                }\r\n            }\r\n        }\r\n        return variables;\r\n    };\r\n\r\n    /**\r\n     * Set the value of a setting\r\n     * @param {String} setting The setting to be changed\r\n     * @param {boolean} value\r\n     */\r\n    libExports.set = function (setting, value) {\r\n        //current options:\r\n        //PARSE2NUMBER, suppress_errors\r\n        if(typeof setting === 'object')\r\n            for(var x in setting) {\r\n                libExports.set(x, setting[x]);\r\n            }\r\n\r\n        var disallowed = ['SAFE'];\r\n        if(disallowed.indexOf(setting) !== -1)\r\n            err('Cannot modify setting: ' + setting);\r\n\r\n        if(setting === 'PRECISION') {\r\n            bigDec.set({precision: value});\r\n            Settings.PRECISION = value;\r\n\r\n            // Avoid that nerdamer puts out garbage after 21 decimal place\r\n            if(value > 21) {\r\n                this.set('USE_BIG', true);\r\n            }\r\n        }\r\n        else if(setting === 'USE_LN' && value === true) {\r\n            //set log as LN\r\n            Settings.LOG = 'LN';\r\n            //set log10 as log\r\n            Settings.LOG10 = 'log';\r\n            //point the functions in the right direction\r\n            _.functions['log'] = Settings.LOG_FNS.log10; //log is now log10\r\n            //the log10 function must be explicitly set\r\n            _.functions['log'][0] = function (x) {\r\n                if(x.isConstant())\r\n                    return new Symbol(Math.log10(x));\r\n                return _.symfunction(Settings.LOG10, [x]);\r\n            };\r\n            _.functions['LN'] = Settings.LOG_FNS.log; //LN is now log\r\n\r\n            //remove log10\r\n            delete _.functions['log10'];\r\n        }\r\n        else\r\n            Settings[setting] = value;\r\n    };\r\n\r\n    /**\r\n     * Get the value of a setting\r\n     * @param {type} setting\r\n     * @returns {undefined}\r\n     */\r\n    libExports.get = function (setting) {\r\n        return Settings[setting];\r\n    };\r\n\r\n    /**\r\n     * This functions makes internal functions available externally\r\n     * @param {bool} override Override the functions when calling updateAPI if it exists\r\n     */\r\n    libExports.updateAPI = function (override) {\r\n        //Map internal functions to external ones\r\n        var linker = function (fname) {\r\n            return function () {\r\n                var args = [].slice.call(arguments);\r\n                for(var i = 0; i < args.length; i++)\r\n                    args[i] = _.parse(args[i]);\r\n                return new Expression(block('PARSE2NUMBER', function () {\r\n                    return _.callfunction(fname, args);\r\n                }));\r\n            };\r\n        };\r\n        //perform the mapping\r\n        for(var x in _.functions)\r\n            if(!(x in libExports) || override)\r\n                libExports[x] = linker(x);\r\n    };\r\n\r\n    libExports.replaceFunction = function (name, fn, num_args) {\r\n        var existing = _.functions[name];\r\n        var new_num_args = typeof num_args === 'undefined' ? existing[1] : num_args;\r\n        _.functions[name] = [fn.call(undefined, existing[0], C), new_num_args];\r\n    };\r\n\r\n    libExports.setOperator = function (operator, shift) {\r\n        _.setOperator(operator, shift);\r\n    };\r\n\r\n    libExports.getOperator = function (operator) {\r\n        return _.getOperator(operator);\r\n    };\r\n\r\n    libExports.aliasOperator = function (operator, withOperator) {\r\n        _.aliasOperator(operator, withOperator);\r\n    };\r\n\r\n    libExports.tree = function (expression) {\r\n        return _.tree(_.toRPN(_.tokenize(expression)));\r\n    };\r\n\r\n    libExports.htmlTree = function (expression, indent) {\r\n        var tree = this.tree(expression);\r\n\r\n        return '<div class=\"tree\">\\n' +\r\n                '    <ul>\\n' +\r\n                '        <li>\\n' +\r\n                tree.toHTML(3, indent) + '\\n' +\r\n                '        </li>\\n' +\r\n                '    </ul>\\n' +\r\n                '</div>';\r\n    };\r\n\r\n    libExports.addPeeker = function (name, f) {\r\n        if(_.peekers[name])\r\n            _.peekers[name].push(f);\r\n    };\r\n\r\n    libExports.removePeeker = function (name, f) {\r\n        remove(_.peekers[name], f);\r\n    };\r\n\r\n    libExports.parse = function (e) {\r\n        return String(e).split(';').map(function (x) {\r\n            return _.parse(x);\r\n        });\r\n    };\r\n\r\n    libExports.updateAPI();\r\n\r\n    return libExports; //Done\r\n//imports ======================================================================\r\n})({\r\n    //https://github.com/peterolson/BigInteger.js\r\n    bigInt: (function(){\r\n        var bigInt=function(undefined){\"use strict\";var BASE=1e7,LOG_BASE=7,MAX_INT=9007199254740992,MAX_INT_ARR=smallToArray(MAX_INT),LOG_MAX_INT=Math.log(MAX_INT);function Integer(v,radix){if(typeof v===\"undefined\")return Integer[0];if(typeof radix!==\"undefined\")return+radix===10?parseValue(v):parseBase(v,radix);return parseValue(v)}function BigInteger(value,sign){this.value=value;this.sign=sign;this.isSmall=false}BigInteger.prototype=Object.create(Integer.prototype);function SmallInteger(value){this.value=value;this.sign=value<0;this.isSmall=true}SmallInteger.prototype=Object.create(Integer.prototype);function isPrecise(n){return-MAX_INT<n&&n<MAX_INT}function smallToArray(n){if(n<1e7)return[n];if(n<1e14)return[n%1e7,Math.floor(n/1e7)];return[n%1e7,Math.floor(n/1e7)%1e7,Math.floor(n/1e14)]}function arrayToSmall(arr){trim(arr);var length=arr.length;if(length<4&&compareAbs(arr,MAX_INT_ARR)<0){switch(length){case 0:return 0;case 1:return arr[0];case 2:return arr[0]+arr[1]*BASE;default:return arr[0]+(arr[1]+arr[2]*BASE)*BASE}}return arr}function trim(v){var i=v.length;while(v[--i]===0);v.length=i+1}function createArray(length){var x=new Array(length);var i=-1;while(++i<length){x[i]=0}return x}function truncate(n){if(n>0)return Math.floor(n);return Math.ceil(n)}function add(a,b){var l_a=a.length,l_b=b.length,r=new Array(l_a),carry=0,base=BASE,sum,i;for(i=0;i<l_b;i++){sum=a[i]+b[i]+carry;carry=sum>=base?1:0;r[i]=sum-carry*base}while(i<l_a){sum=a[i]+carry;carry=sum===base?1:0;r[i++]=sum-carry*base}if(carry>0)r.push(carry);return r}function addAny(a,b){if(a.length>=b.length)return add(a,b);return add(b,a)}function addSmall(a,carry){var l=a.length,r=new Array(l),base=BASE,sum,i;for(i=0;i<l;i++){sum=a[i]-base+carry;carry=Math.floor(sum/base);r[i]=sum-carry*base;carry+=1}while(carry>0){r[i++]=carry%base;carry=Math.floor(carry/base)}return r}BigInteger.prototype.add=function(v){var n=parseValue(v);if(this.sign!==n.sign){return this.subtract(n.negate())}var a=this.value,b=n.value;if(n.isSmall){return new BigInteger(addSmall(a,Math.abs(b)),this.sign)}return new BigInteger(addAny(a,b),this.sign)};BigInteger.prototype.plus=BigInteger.prototype.add;SmallInteger.prototype.add=function(v){var n=parseValue(v);var a=this.value;if(a<0!==n.sign){return this.subtract(n.negate())}var b=n.value;if(n.isSmall){if(isPrecise(a+b))return new SmallInteger(a+b);b=smallToArray(Math.abs(b))}return new BigInteger(addSmall(b,Math.abs(a)),a<0)};SmallInteger.prototype.plus=SmallInteger.prototype.add;function subtract(a,b){var a_l=a.length,b_l=b.length,r=new Array(a_l),borrow=0,base=BASE,i,difference;for(i=0;i<b_l;i++){difference=a[i]-borrow-b[i];if(difference<0){difference+=base;borrow=1}else borrow=0;r[i]=difference}for(i=b_l;i<a_l;i++){difference=a[i]-borrow;if(difference<0)difference+=base;else{r[i++]=difference;break}r[i]=difference}for(;i<a_l;i++){r[i]=a[i]}trim(r);return r}function subtractAny(a,b,sign){var value;if(compareAbs(a,b)>=0){value=subtract(a,b)}else{value=subtract(b,a);sign=!sign}value=arrayToSmall(value);if(typeof value===\"number\"){if(sign)value=-value;return new SmallInteger(value)}return new BigInteger(value,sign)}function subtractSmall(a,b,sign){var l=a.length,r=new Array(l),carry=-b,base=BASE,i,difference;for(i=0;i<l;i++){difference=a[i]+carry;carry=Math.floor(difference/base);difference%=base;r[i]=difference<0?difference+base:difference}r=arrayToSmall(r);if(typeof r===\"number\"){if(sign)r=-r;return new SmallInteger(r)}return new BigInteger(r,sign)}BigInteger.prototype.subtract=function(v){var n=parseValue(v);if(this.sign!==n.sign){return this.add(n.negate())}var a=this.value,b=n.value;if(n.isSmall)return subtractSmall(a,Math.abs(b),this.sign);return subtractAny(a,b,this.sign)};BigInteger.prototype.minus=BigInteger.prototype.subtract;SmallInteger.prototype.subtract=function(v){var n=parseValue(v);var a=this.value;if(a<0!==n.sign){return this.add(n.negate())}var b=n.value;if(n.isSmall){return new SmallInteger(a-b)}return subtractSmall(b,Math.abs(a),a>=0)};SmallInteger.prototype.minus=SmallInteger.prototype.subtract;BigInteger.prototype.negate=function(){return new BigInteger(this.value,!this.sign)};SmallInteger.prototype.negate=function(){var sign=this.sign;var small=new SmallInteger(-this.value);small.sign=!sign;return small};BigInteger.prototype.abs=function(){return new BigInteger(this.value,false)};SmallInteger.prototype.abs=function(){return new SmallInteger(Math.abs(this.value))};function multiplyLong(a,b){var a_l=a.length,b_l=b.length,l=a_l+b_l,r=createArray(l),base=BASE,product,carry,i,a_i,b_j;for(i=0;i<a_l;++i){a_i=a[i];for(var j=0;j<b_l;++j){b_j=b[j];product=a_i*b_j+r[i+j];carry=Math.floor(product/base);r[i+j]=product-carry*base;r[i+j+1]+=carry}}trim(r);return r}function multiplySmall(a,b){var l=a.length,r=new Array(l),base=BASE,carry=0,product,i;for(i=0;i<l;i++){product=a[i]*b+carry;carry=Math.floor(product/base);r[i]=product-carry*base}while(carry>0){r[i++]=carry%base;carry=Math.floor(carry/base)}return r}function shiftLeft(x,n){var r=[];while(n-- >0)r.push(0);return r.concat(x)}function multiplyKaratsuba(x,y){var n=Math.max(x.length,y.length);if(n<=30)return multiplyLong(x,y);n=Math.ceil(n/2);var b=x.slice(n),a=x.slice(0,n),d=y.slice(n),c=y.slice(0,n);var ac=multiplyKaratsuba(a,c),bd=multiplyKaratsuba(b,d),abcd=multiplyKaratsuba(addAny(a,b),addAny(c,d));var product=addAny(addAny(ac,shiftLeft(subtract(subtract(abcd,ac),bd),n)),shiftLeft(bd,2*n));trim(product);return product}function useKaratsuba(l1,l2){return-.012*l1-.012*l2+15e-6*l1*l2>0}BigInteger.prototype.multiply=function(v){var n=parseValue(v),a=this.value,b=n.value,sign=this.sign!==n.sign,abs;if(n.isSmall){if(b===0)return Integer[0];if(b===1)return this;if(b===-1)return this.negate();abs=Math.abs(b);if(abs<BASE){return new BigInteger(multiplySmall(a,abs),sign)}b=smallToArray(abs)}if(useKaratsuba(a.length,b.length))return new BigInteger(multiplyKaratsuba(a,b),sign);return new BigInteger(multiplyLong(a,b),sign)};BigInteger.prototype.times=BigInteger.prototype.multiply;function multiplySmallAndArray(a,b,sign){if(a<BASE){return new BigInteger(multiplySmall(b,a),sign)}return new BigInteger(multiplyLong(b,smallToArray(a)),sign)}SmallInteger.prototype._multiplyBySmall=function(a){if(isPrecise(a.value*this.value)){return new SmallInteger(a.value*this.value)}return multiplySmallAndArray(Math.abs(a.value),smallToArray(Math.abs(this.value)),this.sign!==a.sign)};BigInteger.prototype._multiplyBySmall=function(a){if(a.value===0)return Integer[0];if(a.value===1)return this;if(a.value===-1)return this.negate();return multiplySmallAndArray(Math.abs(a.value),this.value,this.sign!==a.sign)};SmallInteger.prototype.multiply=function(v){return parseValue(v)._multiplyBySmall(this)};SmallInteger.prototype.times=SmallInteger.prototype.multiply;function square(a){var l=a.length,r=createArray(l+l),base=BASE,product,carry,i,a_i,a_j;for(i=0;i<l;i++){a_i=a[i];carry=0-a_i*a_i;for(var j=i;j<l;j++){a_j=a[j];product=2*(a_i*a_j)+r[i+j]+carry;carry=Math.floor(product/base);r[i+j]=product-carry*base}r[i+l]=carry}trim(r);return r}BigInteger.prototype.square=function(){return new BigInteger(square(this.value),false)};SmallInteger.prototype.square=function(){var value=this.value*this.value;if(isPrecise(value))return new SmallInteger(value);return new BigInteger(square(smallToArray(Math.abs(this.value))),false)};function divMod1(a,b){var a_l=a.length,b_l=b.length,base=BASE,result=createArray(b.length),divisorMostSignificantDigit=b[b_l-1],lambda=Math.ceil(base/(2*divisorMostSignificantDigit)),remainder=multiplySmall(a,lambda),divisor=multiplySmall(b,lambda),quotientDigit,shift,carry,borrow,i,l,q;if(remainder.length<=a_l)remainder.push(0);divisor.push(0);divisorMostSignificantDigit=divisor[b_l-1];for(shift=a_l-b_l;shift>=0;shift--){quotientDigit=base-1;if(remainder[shift+b_l]!==divisorMostSignificantDigit){quotientDigit=Math.floor((remainder[shift+b_l]*base+remainder[shift+b_l-1])/divisorMostSignificantDigit)}carry=0;borrow=0;l=divisor.length;for(i=0;i<l;i++){carry+=quotientDigit*divisor[i];q=Math.floor(carry/base);borrow+=remainder[shift+i]-(carry-q*base);carry=q;if(borrow<0){remainder[shift+i]=borrow+base;borrow=-1}else{remainder[shift+i]=borrow;borrow=0}}while(borrow!==0){quotientDigit-=1;carry=0;for(i=0;i<l;i++){carry+=remainder[shift+i]-base+divisor[i];if(carry<0){remainder[shift+i]=carry+base;carry=0}else{remainder[shift+i]=carry;carry=1}}borrow+=carry}result[shift]=quotientDigit}remainder=divModSmall(remainder,lambda)[0];return[arrayToSmall(result),arrayToSmall(remainder)]}function divMod2(a,b){var a_l=a.length,b_l=b.length,result=[],part=[],base=BASE,guess,xlen,highx,highy,check;while(a_l){part.unshift(a[--a_l]);trim(part);if(compareAbs(part,b)<0){result.push(0);continue}xlen=part.length;highx=part[xlen-1]*base+part[xlen-2];highy=b[b_l-1]*base+b[b_l-2];if(xlen>b_l){highx=(highx+1)*base}guess=Math.ceil(highx/highy);do{check=multiplySmall(b,guess);if(compareAbs(check,part)<=0)break;guess--}while(guess);result.push(guess);part=subtract(part,check)}result.reverse();return[arrayToSmall(result),arrayToSmall(part)]}function divModSmall(value,lambda){var length=value.length,quotient=createArray(length),base=BASE,i,q,remainder,divisor;remainder=0;for(i=length-1;i>=0;--i){divisor=remainder*base+value[i];q=truncate(divisor/lambda);remainder=divisor-q*lambda;quotient[i]=q|0}return[quotient,remainder|0]}function divModAny(self,v){var value,n=parseValue(v);var a=self.value,b=n.value;var quotient;if(b===0)throw new Error(\"Cannot divide by zero\");if(self.isSmall){if(n.isSmall){return[new SmallInteger(truncate(a/b)),new SmallInteger(a%b)]}return[Integer[0],self]}if(n.isSmall){if(b===1)return[self,Integer[0]];if(b==-1)return[self.negate(),Integer[0]];var abs=Math.abs(b);if(abs<BASE){value=divModSmall(a,abs);quotient=arrayToSmall(value[0]);var remainder=value[1];if(self.sign)remainder=-remainder;if(typeof quotient===\"number\"){if(self.sign!==n.sign)quotient=-quotient;return[new SmallInteger(quotient),new SmallInteger(remainder)]}return[new BigInteger(quotient,self.sign!==n.sign),new SmallInteger(remainder)]}b=smallToArray(abs)}var comparison=compareAbs(a,b);if(comparison===-1)return[Integer[0],self];if(comparison===0)return[Integer[self.sign===n.sign?1:-1],Integer[0]];if(a.length+b.length<=200)value=divMod1(a,b);else value=divMod2(a,b);quotient=value[0];var qSign=self.sign!==n.sign,mod=value[1],mSign=self.sign;if(typeof quotient===\"number\"){if(qSign)quotient=-quotient;quotient=new SmallInteger(quotient)}else quotient=new BigInteger(quotient,qSign);if(typeof mod===\"number\"){if(mSign)mod=-mod;mod=new SmallInteger(mod)}else mod=new BigInteger(mod,mSign);return[quotient,mod]}BigInteger.prototype.divmod=function(v){var result=divModAny(this,v);return{quotient:result[0],remainder:result[1]}};SmallInteger.prototype.divmod=BigInteger.prototype.divmod;BigInteger.prototype.divide=function(v){return divModAny(this,v)[0]};SmallInteger.prototype.over=SmallInteger.prototype.divide=BigInteger.prototype.over=BigInteger.prototype.divide;BigInteger.prototype.mod=function(v){return divModAny(this,v)[1]};SmallInteger.prototype.remainder=SmallInteger.prototype.mod=BigInteger.prototype.remainder=BigInteger.prototype.mod;BigInteger.prototype.pow=function(v){var n=parseValue(v),a=this.value,b=n.value,value,x,y;if(b===0)return Integer[1];if(a===0)return Integer[0];if(a===1)return Integer[1];if(a===-1)return n.isEven()?Integer[1]:Integer[-1];if(n.sign){return Integer[0]}if(!n.isSmall)throw new Error(\"The exponent \"+n.toString()+\" is too large.\");if(this.isSmall){if(isPrecise(value=Math.pow(a,b)))return new SmallInteger(truncate(value))}x=this;y=Integer[1];while(true){if(b&1===1){y=y.times(x);--b}if(b===0)break;b/=2;x=x.square()}return y};SmallInteger.prototype.pow=BigInteger.prototype.pow;BigInteger.prototype.modPow=function(exp,mod){exp=parseValue(exp);mod=parseValue(mod);if(mod.isZero())throw new Error(\"Cannot take modPow with modulus 0\");var r=Integer[1],base=this.mod(mod);while(exp.isPositive()){if(base.isZero())return Integer[0];if(exp.isOdd())r=r.multiply(base).mod(mod);exp=exp.divide(2);base=base.square().mod(mod)}return r};SmallInteger.prototype.modPow=BigInteger.prototype.modPow;function compareAbs(a,b){if(a.length!==b.length){return a.length>b.length?1:-1}for(var i=a.length-1;i>=0;i--){if(a[i]!==b[i])return a[i]>b[i]?1:-1}return 0}BigInteger.prototype.compareAbs=function(v){var n=parseValue(v),a=this.value,b=n.value;if(n.isSmall)return 1;return compareAbs(a,b)};SmallInteger.prototype.compareAbs=function(v){var n=parseValue(v),a=Math.abs(this.value),b=n.value;if(n.isSmall){b=Math.abs(b);return a===b?0:a>b?1:-1}return-1};BigInteger.prototype.compare=function(v){if(v===Infinity){return-1}if(v===-Infinity){return 1}var n=parseValue(v),a=this.value,b=n.value;if(this.sign!==n.sign){return n.sign?1:-1}if(n.isSmall){return this.sign?-1:1}return compareAbs(a,b)*(this.sign?-1:1)};BigInteger.prototype.compareTo=BigInteger.prototype.compare;SmallInteger.prototype.compare=function(v){if(v===Infinity){return-1}if(v===-Infinity){return 1}var n=parseValue(v),a=this.value,b=n.value;if(n.isSmall){return a==b?0:a>b?1:-1}if(a<0!==n.sign){return a<0?-1:1}return a<0?1:-1};SmallInteger.prototype.compareTo=SmallInteger.prototype.compare;BigInteger.prototype.equals=function(v){return this.compare(v)===0};SmallInteger.prototype.eq=SmallInteger.prototype.equals=BigInteger.prototype.eq=BigInteger.prototype.equals;BigInteger.prototype.notEquals=function(v){return this.compare(v)!==0};SmallInteger.prototype.neq=SmallInteger.prototype.notEquals=BigInteger.prototype.neq=BigInteger.prototype.notEquals;BigInteger.prototype.greater=function(v){return this.compare(v)>0};SmallInteger.prototype.gt=SmallInteger.prototype.greater=BigInteger.prototype.gt=BigInteger.prototype.greater;BigInteger.prototype.lesser=function(v){return this.compare(v)<0};SmallInteger.prototype.lt=SmallInteger.prototype.lesser=BigInteger.prototype.lt=BigInteger.prototype.lesser;BigInteger.prototype.greaterOrEquals=function(v){return this.compare(v)>=0};SmallInteger.prototype.geq=SmallInteger.prototype.greaterOrEquals=BigInteger.prototype.geq=BigInteger.prototype.greaterOrEquals;BigInteger.prototype.lesserOrEquals=function(v){return this.compare(v)<=0};SmallInteger.prototype.leq=SmallInteger.prototype.lesserOrEquals=BigInteger.prototype.leq=BigInteger.prototype.lesserOrEquals;BigInteger.prototype.isEven=function(){return(this.value[0]&1)===0};SmallInteger.prototype.isEven=function(){return(this.value&1)===0};BigInteger.prototype.isOdd=function(){return(this.value[0]&1)===1};SmallInteger.prototype.isOdd=function(){return(this.value&1)===1};BigInteger.prototype.isPositive=function(){return!this.sign};SmallInteger.prototype.isPositive=function(){return this.value>0};BigInteger.prototype.isNegative=function(){return this.sign};SmallInteger.prototype.isNegative=function(){return this.value<0};BigInteger.prototype.isUnit=function(){return false};SmallInteger.prototype.isUnit=function(){return Math.abs(this.value)===1};BigInteger.prototype.isZero=function(){return false};SmallInteger.prototype.isZero=function(){return this.value===0};BigInteger.prototype.isDivisibleBy=function(v){var n=parseValue(v);var value=n.value;if(value===0)return false;if(value===1)return true;if(value===2)return this.isEven();return this.mod(n).equals(Integer[0])};SmallInteger.prototype.isDivisibleBy=BigInteger.prototype.isDivisibleBy;function isBasicPrime(v){var n=v.abs();if(n.isUnit())return false;if(n.equals(2)||n.equals(3)||n.equals(5))return true;if(n.isEven()||n.isDivisibleBy(3)||n.isDivisibleBy(5))return false;if(n.lesser(49))return true}function millerRabinTest(n,a){var nPrev=n.prev(),b=nPrev,r=0,d,t,i,x;while(b.isEven())b=b.divide(2),r++;next:for(i=0;i<a.length;i++){if(n.lesser(a[i]))continue;x=bigInt(a[i]).modPow(b,n);if(x.equals(Integer[1])||x.equals(nPrev))continue;for(d=r-1;d!=0;d--){x=x.square().mod(n);if(x.isUnit())return false;if(x.equals(nPrev))continue next}return false}return true}BigInteger.prototype.isPrime=function(strict){var isPrime=isBasicPrime(this);if(isPrime!==undefined)return isPrime;var n=this.abs();var bits=n.bitLength();if(bits<=64)return millerRabinTest(n,[2,325,9375,28178,450775,9780504,1795265022]);var logN=Math.log(2)*bits;var t=Math.ceil(strict===true?2*Math.pow(logN,2):logN);for(var a=[],i=0;i<t;i++){a.push(bigInt(i+2))}return millerRabinTest(n,a)};SmallInteger.prototype.isPrime=BigInteger.prototype.isPrime;BigInteger.prototype.isProbablePrime=function(iterations){var isPrime=isBasicPrime(this);if(isPrime!==undefined)return isPrime;var n=this.abs();var t=iterations===undefined?5:iterations;for(var a=[],i=0;i<t;i++){a.push(bigInt.randBetween(2,n.minus(2)))}return millerRabinTest(n,a)};SmallInteger.prototype.isProbablePrime=BigInteger.prototype.isProbablePrime;BigInteger.prototype.modInv=function(n){var t=bigInt.zero,newT=bigInt.one,r=parseValue(n),newR=this.abs(),q,lastT,lastR;while(!newR.equals(bigInt.zero)){q=r.divide(newR);lastT=t;lastR=r;t=newT;r=newR;newT=lastT.subtract(q.multiply(newT));newR=lastR.subtract(q.multiply(newR))}if(!r.equals(1))throw new Error(this.toString()+\" and \"+n.toString()+\" are not co-prime\");if(t.compare(0)===-1){t=t.add(n)}if(this.isNegative()){return t.negate()}return t};SmallInteger.prototype.modInv=BigInteger.prototype.modInv;BigInteger.prototype.next=function(){var value=this.value;if(this.sign){return subtractSmall(value,1,this.sign)}return new BigInteger(addSmall(value,1),this.sign)};SmallInteger.prototype.next=function(){var value=this.value;if(value+1<MAX_INT)return new SmallInteger(value+1);return new BigInteger(MAX_INT_ARR,false)};BigInteger.prototype.prev=function(){var value=this.value;if(this.sign){return new BigInteger(addSmall(value,1),true)}return subtractSmall(value,1,this.sign)};SmallInteger.prototype.prev=function(){var value=this.value;if(value-1>-MAX_INT)return new SmallInteger(value-1);return new BigInteger(MAX_INT_ARR,true)};var powersOfTwo=[1];while(2*powersOfTwo[powersOfTwo.length-1]<=BASE)powersOfTwo.push(2*powersOfTwo[powersOfTwo.length-1]);var powers2Length=powersOfTwo.length,highestPower2=powersOfTwo[powers2Length-1];function shift_isSmall(n){return(typeof n===\"number\"||typeof n===\"string\")&&+Math.abs(n)<=BASE||n instanceof BigInteger&&n.value.length<=1}BigInteger.prototype.shiftLeft=function(n){if(!shift_isSmall(n)){throw new Error(String(n)+\" is too large for shifting.\")}n=+n;if(n<0)return this.shiftRight(-n);var result=this;if(result.isZero())return result;while(n>=powers2Length){result=result.multiply(highestPower2);n-=powers2Length-1}return result.multiply(powersOfTwo[n])};SmallInteger.prototype.shiftLeft=BigInteger.prototype.shiftLeft;BigInteger.prototype.shiftRight=function(n){var remQuo;if(!shift_isSmall(n)){throw new Error(String(n)+\" is too large for shifting.\")}n=+n;if(n<0)return this.shiftLeft(-n);var result=this;while(n>=powers2Length){if(result.isZero()||result.isNegative()&&result.isUnit())return result;remQuo=divModAny(result,highestPower2);result=remQuo[1].isNegative()?remQuo[0].prev():remQuo[0];n-=powers2Length-1}remQuo=divModAny(result,powersOfTwo[n]);return remQuo[1].isNegative()?remQuo[0].prev():remQuo[0]};SmallInteger.prototype.shiftRight=BigInteger.prototype.shiftRight;function bitwise(x,y,fn){y=parseValue(y);var xSign=x.isNegative(),ySign=y.isNegative();var xRem=xSign?x.not():x,yRem=ySign?y.not():y;var xDigit=0,yDigit=0;var xDivMod=null,yDivMod=null;var result=[];while(!xRem.isZero()||!yRem.isZero()){xDivMod=divModAny(xRem,highestPower2);xDigit=xDivMod[1].toJSNumber();if(xSign){xDigit=highestPower2-1-xDigit}yDivMod=divModAny(yRem,highestPower2);yDigit=yDivMod[1].toJSNumber();if(ySign){yDigit=highestPower2-1-yDigit}xRem=xDivMod[0];yRem=yDivMod[0];result.push(fn(xDigit,yDigit))}var sum=fn(xSign?1:0,ySign?1:0)!==0?bigInt(-1):bigInt(0);for(var i=result.length-1;i>=0;i-=1){sum=sum.multiply(highestPower2).add(bigInt(result[i]))}return sum}BigInteger.prototype.not=function(){return this.negate().prev()};SmallInteger.prototype.not=BigInteger.prototype.not;BigInteger.prototype.and=function(n){return bitwise(this,n,function(a,b){return a&b})};SmallInteger.prototype.and=BigInteger.prototype.and;BigInteger.prototype.or=function(n){return bitwise(this,n,function(a,b){return a|b})};SmallInteger.prototype.or=BigInteger.prototype.or;BigInteger.prototype.xor=function(n){return bitwise(this,n,function(a,b){return a^b})};SmallInteger.prototype.xor=BigInteger.prototype.xor;var LOBMASK_I=1<<30,LOBMASK_BI=(BASE&-BASE)*(BASE&-BASE)|LOBMASK_I;function roughLOB(n){var v=n.value,x=typeof v===\"number\"?v|LOBMASK_I:v[0]+v[1]*BASE|LOBMASK_BI;return x&-x}function integerLogarithm(value,base){if(base.compareTo(value)<=0){var tmp=integerLogarithm(value,base.square(base));var p=tmp.p;var e=tmp.e;var t=p.multiply(base);return t.compareTo(value)<=0?{p:t,e:e*2+1}:{p:p,e:e*2}}return{p:bigInt(1),e:0}}BigInteger.prototype.bitLength=function(){var n=this;if(n.compareTo(bigInt(0))<0){n=n.negate().subtract(bigInt(1))}if(n.compareTo(bigInt(0))===0){return bigInt(0)}return bigInt(integerLogarithm(n,bigInt(2)).e).add(bigInt(1))};SmallInteger.prototype.bitLength=BigInteger.prototype.bitLength;function max(a,b){a=parseValue(a);b=parseValue(b);return a.greater(b)?a:b}function min(a,b){a=parseValue(a);b=parseValue(b);return a.lesser(b)?a:b}function gcd(a,b){a=parseValue(a).abs();b=parseValue(b).abs();if(a.equals(b))return a;if(a.isZero())return b;if(b.isZero())return a;var c=Integer[1],d,t;while(a.isEven()&&b.isEven()){d=Math.min(roughLOB(a),roughLOB(b));a=a.divide(d);b=b.divide(d);c=c.multiply(d)}while(a.isEven()){a=a.divide(roughLOB(a))}do{while(b.isEven()){b=b.divide(roughLOB(b))}if(a.greater(b)){t=b;b=a;a=t}b=b.subtract(a)}while(!b.isZero());return c.isUnit()?a:a.multiply(c)}function lcm(a,b){a=parseValue(a).abs();b=parseValue(b).abs();return a.divide(gcd(a,b)).multiply(b)}function randBetween(a,b){a=parseValue(a);b=parseValue(b);var low=min(a,b),high=max(a,b);var range=high.subtract(low).add(1);if(range.isSmall)return low.add(Math.floor(Math.random()*range));var length=range.value.length-1;var result=[],restricted=true;for(var i=length;i>=0;i--){var top=restricted?range.value[i]:BASE;var digit=truncate(Math.random()*top);result.unshift(digit);if(digit<top)restricted=false}result=arrayToSmall(result);return low.add(typeof result===\"number\"?new SmallInteger(result):new BigInteger(result,false))}var parseBase=function(text,base){var length=text.length;var i;var absBase=Math.abs(base);for(var i=0;i<length;i++){var c=text[i].toLowerCase();if(c===\"-\")continue;if(/[a-z0-9]/.test(c)){if(/[0-9]/.test(c)&&+c>=absBase){if(c===\"1\"&&absBase===1)continue;throw new Error(c+\" is not a valid digit in base \"+base+\".\")}else if(c.charCodeAt(0)-87>=absBase){throw new Error(c+\" is not a valid digit in base \"+base+\".\")}}}if(2<=base&&base<=36){if(length<=LOG_MAX_INT/Math.log(base)){var result=parseInt(text,base);if(isNaN(result)){throw new Error(c+\" is not a valid digit in base \"+base+\".\")}return new SmallInteger(parseInt(text,base))}}base=parseValue(base);var digits=[];var isNegative=text[0]===\"-\";for(i=isNegative?1:0;i<text.length;i++){var c=text[i].toLowerCase(),charCode=c.charCodeAt(0);if(48<=charCode&&charCode<=57)digits.push(parseValue(c));else if(97<=charCode&&charCode<=122)digits.push(parseValue(c.charCodeAt(0)-87));else if(c===\"<\"){var start=i;do{i++}while(text[i]!==\">\");digits.push(parseValue(text.slice(start+1,i)))}else throw new Error(c+\" is not a valid character\")}return parseBaseFromArray(digits,base,isNegative)};function parseBaseFromArray(digits,base,isNegative){var val=Integer[0],pow=Integer[1],i;for(i=digits.length-1;i>=0;i--){val=val.add(digits[i].times(pow));pow=pow.times(base)}return isNegative?val.negate():val}function stringify(digit){if(digit<=35){return\"0123456789abcdefghijklmnopqrstuvwxyz\".charAt(digit)}return\"<\"+digit+\">\"}function toBase(n,base){base=bigInt(base);if(base.isZero()){if(n.isZero())return{value:[0],isNegative:false};throw new Error(\"Cannot convert nonzero numbers to base 0.\")}if(base.equals(-1)){if(n.isZero())return{value:[0],isNegative:false};if(n.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-n)).map(Array.prototype.valueOf,[1,0])),isNegative:false};var arr=Array.apply(null,Array(+n-1)).map(Array.prototype.valueOf,[0,1]);arr.unshift([1]);return{value:[].concat.apply([],arr),isNegative:false}}var neg=false;if(n.isNegative()&&base.isPositive()){neg=true;n=n.abs()}if(base.equals(1)){if(n.isZero())return{value:[0],isNegative:false};return{value:Array.apply(null,Array(+n)).map(Number.prototype.valueOf,1),isNegative:neg}}var out=[];var left=n,divmod;while(left.isNegative()||left.compareAbs(base)>=0){divmod=left.divmod(base);left=divmod.quotient;var digit=divmod.remainder;if(digit.isNegative()){digit=base.minus(digit).abs();left=left.next()}out.push(digit.toJSNumber())}out.push(left.toJSNumber());return{value:out.reverse(),isNegative:neg}}function toBaseString(n,base){var arr=toBase(n,base);return(arr.isNegative?\"-\":\"\")+arr.value.map(stringify).join(\"\")}BigInteger.prototype.toArray=function(radix){return toBase(this,radix)};SmallInteger.prototype.toArray=function(radix){return toBase(this,radix)};BigInteger.prototype.toString=function(radix){if(radix===undefined)radix=10;if(radix!==10)return toBaseString(this,radix);var v=this.value,l=v.length,str=String(v[--l]),zeros=\"0000000\",digit;while(--l>=0){digit=String(v[l]);str+=zeros.slice(digit.length)+digit}var sign=this.sign?\"-\":\"\";return sign+str};SmallInteger.prototype.toString=function(radix){if(radix===undefined)radix=10;if(radix!=10)return toBaseString(this,radix);return String(this.value)};BigInteger.prototype.toJSON=SmallInteger.prototype.toJSON=function(){return this.toString()};BigInteger.prototype.valueOf=function(){return parseInt(this.toString(),10)};BigInteger.prototype.toJSNumber=BigInteger.prototype.valueOf;SmallInteger.prototype.valueOf=function(){return this.value};SmallInteger.prototype.toJSNumber=SmallInteger.prototype.valueOf;function parseStringValue(v){if(isPrecise(+v)){var x=+v;if(x===truncate(x))return new SmallInteger(x);throw new Error(\"Invalid integer: \"+v)}var sign=v[0]===\"-\";if(sign)v=v.slice(1);var split=v.split(/e/i);if(split.length>2)throw new Error(\"Invalid integer: \"+split.join(\"e\"));if(split.length===2){var exp=split[1];if(exp[0]===\"+\")exp=exp.slice(1);exp=+exp;if(exp!==truncate(exp)||!isPrecise(exp))throw new Error(\"Invalid integer: \"+exp+\" is not a valid exponent.\");var text=split[0];var decimalPlace=text.indexOf(\".\");if(decimalPlace>=0){exp-=text.length-decimalPlace-1;text=text.slice(0,decimalPlace)+text.slice(decimalPlace+1)}if(exp<0)throw new Error(\"Cannot include negative exponent part for integers\");text+=new Array(exp+1).join(\"0\");v=text}var isValid=/^([0-9][0-9]*)$/.test(v);if(!isValid)throw new Error(\"Invalid integer: \"+v);var r=[],max=v.length,l=LOG_BASE,min=max-l;while(max>0){r.push(+v.slice(min,max));min-=l;if(min<0)min=0;max-=l}trim(r);return new BigInteger(r,sign)}function parseNumberValue(v){if(isPrecise(v)){if(v!==truncate(v))throw new Error(v+\" is not an integer.\");return new SmallInteger(v)}return parseStringValue(v.toString())}function parseValue(v){if(typeof v===\"number\"){return parseNumberValue(v)}if(typeof v===\"string\"){return parseStringValue(v)}return v}for(var i=0;i<1e3;i++){Integer[i]=new SmallInteger(i);if(i>0)Integer[-i]=new SmallInteger(-i)}Integer.one=Integer[1];Integer.zero=Integer[0];Integer.minusOne=Integer[-1];Integer.max=max;Integer.min=min;Integer.gcd=gcd;Integer.lcm=lcm;Integer.isInstance=function(x){return x instanceof BigInteger||x instanceof SmallInteger};Integer.randBetween=randBetween;Integer.fromArray=function(digits,base,isNegative){return parseBaseFromArray(digits.map(parseValue),parseValue(base||10),isNegative)};return Integer}();if(typeof module!==\"undefined\"&&module.hasOwnProperty(\"exports\")){module.exports=bigInt}if(typeof define===\"function\"&&define.amd){define(\"big-integer\",[],function(){return bigInt})}\r\n        return bigInt;\r\n    })(),\r\n    /*\r\n     *  decimal.js v10.2.1\r\n     *  An arbitrary-precision Decimal type for JavaScript.\r\n     *  https://github.com/MikeMcl/decimal.js\r\n     *  Copyright (c) 2020 Michael Mclaughlin <M8ch88l@gmail.com>\r\n     *  MIT Licence\r\n     */\r\n    bigDec: function(n){\"use strict\";var e,i,t,r,s=9e15,o=1e9,u=\"0123456789abcdef\",c=\"2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058\",f=\"3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789\",a={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-s,maxE:s,crypto:!1},h=!0,d=\"[DecimalError] \",l=d+\"Invalid argument: \",p=d+\"Precision limit exceeded\",g=d+\"crypto unavailable\",m=Math.floor,w=Math.pow,v=/^0b([01]+(\\.[01]*)?|\\.[01]+)(p[+-]?\\d+)?$/i,N=/^0x([0-9a-f]+(\\.[0-9a-f]*)?|\\.[0-9a-f]+)(p[+-]?\\d+)?$/i,b=/^0o([0-7]+(\\.[0-7]*)?|\\.[0-7]+)(p[+-]?\\d+)?$/i,E=/^(\\d+(\\.\\d*)?|\\.\\d+)(e[+-]?\\d+)?$/i,x=1e7,y=7,M=c.length-1,q=f.length-1,O={name:\"[object Decimal]\"};function D(n){var e,i,t,r=n.length-1,s=\"\",o=n[0];if(r>0){for(s+=o,e=1;e<r;e++)t=n[e]+\"\",(i=y-t.length)&&(s+=k(i)),s+=t;o=n[e],(i=y-(t=o+\"\").length)&&(s+=k(i))}else if(0===o)return\"0\";for(;o%10==0;)o/=10;return s+o}function F(n,e,i){if(n!==~~n||n<e||n>i)throw Error(l+n)}function A(n,e,i,t){var r,s,o,u;for(s=n[0];s>=10;s/=10)--e;return--e<0?(e+=y,r=0):(r=Math.ceil((e+1)/y),e%=y),s=w(10,y-e),u=n[r]%s|0,null==t?e<3?(0==e?u=u/100|0:1==e&&(u=u/10|0),o=i<4&&99999==u||i>3&&49999==u||5e4==u||0==u):o=(i<4&&u+1==s||i>3&&u+1==s/2)&&(n[r+1]/s/100|0)==w(10,e-2)-1||(u==s/2||0==u)&&0==(n[r+1]/s/100|0):e<4?(0==e?u=u/1e3|0:1==e?u=u/100|0:2==e&&(u=u/10|0),o=(t||i<4)&&9999==u||!t&&i>3&&4999==u):o=((t||i<4)&&u+1==s||!t&&i>3&&u+1==s/2)&&(n[r+1]/s/1e3|0)==w(10,e-3)-1,o}function S(n,e,i){for(var t,r,s=[0],o=0,c=n.length;o<c;){for(r=s.length;r--;)s[r]*=e;for(s[0]+=u.indexOf(n.charAt(o++)),t=0;t<s.length;t++)s[t]>i-1&&(void 0===s[t+1]&&(s[t+1]=0),s[t+1]+=s[t]/i|0,s[t]%=i)}return s.reverse()}O.absoluteValue=O.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),P(n)},O.ceil=function(){return P(new this.constructor(this),this.e+1,2)},O.comparedTo=O.cmp=function(n){var e,i,t,r,s=this,o=s.d,u=(n=new s.constructor(n)).d,c=s.s,f=n.s;if(!o||!u)return c&&f?c!==f?c:o===u?0:!o^c<0?1:-1:NaN;if(!o[0]||!u[0])return o[0]?c:u[0]?-f:0;if(c!==f)return c;if(s.e!==n.e)return s.e>n.e^c<0?1:-1;for(e=0,i=(t=o.length)<(r=u.length)?t:r;e<i;++e)if(o[e]!==u[e])return o[e]>u[e]^c<0?1:-1;return t===r?0:t>r^c<0?1:-1},O.cosine=O.cos=function(){var n,e,i=this,t=i.constructor;return i.d?i.d[0]?(n=t.precision,e=t.rounding,t.precision=n+Math.max(i.e,i.sd())+y,t.rounding=1,i=function(n,e){var i,t,r=e.d.length;r<32?(i=Math.ceil(r/3),t=(1/z(4,i)).toString()):(i=16,t=\"2.3283064365386962890625e-10\");n.precision+=i,e=J(n,1,e.times(t),new n(1));for(var s=i;s--;){var o=e.times(e);e=o.times(o).minus(o).times(8).plus(1)}return n.precision-=i,e}(t,G(t,i)),t.precision=n,t.rounding=e,P(2==r||3==r?i.neg():i,n,e,!0)):new t(1):new t(NaN)},O.cubeRoot=O.cbrt=function(){var n,e,i,t,r,s,o,u,c,f,a=this,d=a.constructor;if(!a.isFinite()||a.isZero())return new d(a);for(h=!1,(s=a.s*w(a.s*a,1/3))&&Math.abs(s)!=1/0?t=new d(s.toString()):(i=D(a.d),(s=((n=a.e)-i.length+1)%3)&&(i+=1==s||-2==s?\"0\":\"00\"),s=w(i,1/3),n=m((n+1)/3)-(n%3==(n<0?-1:2)),(t=new d(i=s==1/0?\"5e\"+n:(i=s.toExponential()).slice(0,i.indexOf(\"e\")+1)+n)).s=a.s),o=(n=d.precision)+3;;)if(f=(c=(u=t).times(u).times(u)).plus(a),t=Z(f.plus(a).times(u),f.plus(c),o+2,1),D(u.d).slice(0,o)===(i=D(t.d)).slice(0,o)){if(\"9999\"!=(i=i.slice(o-3,o+1))&&(r||\"4999\"!=i)){+i&&(+i.slice(1)||\"5\"!=i.charAt(0))||(P(t,n+1,1),e=!t.times(t).times(t).eq(a));break}if(!r&&(P(u,n+1,0),u.times(u).times(u).eq(a))){t=u;break}o+=4,r=1}return h=!0,P(t,n,d.rounding,e)},O.decimalPlaces=O.dp=function(){var n,e=this.d,i=NaN;if(e){if(i=((n=e.length-1)-m(this.e/y))*y,n=e[n])for(;n%10==0;n/=10)i--;i<0&&(i=0)}return i},O.dividedBy=O.div=function(n){return Z(this,new this.constructor(n))},O.dividedToIntegerBy=O.divToInt=function(n){var e=this.constructor;return P(Z(this,new e(n),0,1,1),e.precision,e.rounding)},O.equals=O.eq=function(n){return 0===this.cmp(n)},O.floor=function(){return P(new this.constructor(this),this.e+1,3)},O.greaterThan=O.gt=function(n){return this.cmp(n)>0},O.greaterThanOrEqualTo=O.gte=function(n){var e=this.cmp(n);return 1==e||0===e},O.hyperbolicCosine=O.cosh=function(){var n,e,i,t,r,s=this,o=s.constructor,u=new o(1);if(!s.isFinite())return new o(s.s?1/0:NaN);if(s.isZero())return u;i=o.precision,t=o.rounding,o.precision=i+Math.max(s.e,s.sd())+4,o.rounding=1,(r=s.d.length)<32?e=(1/z(4,n=Math.ceil(r/3))).toString():(n=16,e=\"2.3283064365386962890625e-10\"),s=J(o,1,s.times(e),new o(1),!0);for(var c,f=n,a=new o(8);f--;)c=s.times(s),s=u.minus(c.times(a.minus(c.times(a))));return P(s,o.precision=i,o.rounding=t,!0)},O.hyperbolicSine=O.sinh=function(){var n,e,i,t,r=this,s=r.constructor;if(!r.isFinite()||r.isZero())return new s(r);if(e=s.precision,i=s.rounding,s.precision=e+Math.max(r.e,r.sd())+4,s.rounding=1,(t=r.d.length)<3)r=J(s,2,r,r,!0);else{n=(n=1.4*Math.sqrt(t))>16?16:0|n,r=J(s,2,r=r.times(1/z(5,n)),r,!0);for(var o,u=new s(5),c=new s(16),f=new s(20);n--;)o=r.times(r),r=r.times(u.plus(o.times(c.times(o).plus(f))))}return s.precision=e,s.rounding=i,P(r,e,i,!0)},O.hyperbolicTangent=O.tanh=function(){var n,e,i=this,t=i.constructor;return i.isFinite()?i.isZero()?new t(i):(n=t.precision,e=t.rounding,t.precision=n+7,t.rounding=1,Z(i.sinh(),i.cosh(),t.precision=n,t.rounding=e)):new t(i.s)},O.inverseCosine=O.acos=function(){var n,e=this,i=e.constructor,t=e.abs().cmp(1),r=i.precision,s=i.rounding;return-1!==t?0===t?e.isNeg()?U(i,r,s):new i(0):new i(NaN):e.isZero()?U(i,r+4,s).times(.5):(i.precision=r+6,i.rounding=1,e=e.asin(),n=U(i,r+4,s).times(.5),i.precision=r,i.rounding=s,n.minus(e))},O.inverseHyperbolicCosine=O.acosh=function(){var n,e,i=this,t=i.constructor;return i.lte(1)?new t(i.eq(1)?0:NaN):i.isFinite()?(n=t.precision,e=t.rounding,t.precision=n+Math.max(Math.abs(i.e),i.sd())+4,t.rounding=1,h=!1,i=i.times(i).minus(1).sqrt().plus(i),h=!0,t.precision=n,t.rounding=e,i.ln()):new t(i)},O.inverseHyperbolicSine=O.asinh=function(){var n,e,i=this,t=i.constructor;return!i.isFinite()||i.isZero()?new t(i):(n=t.precision,e=t.rounding,t.precision=n+2*Math.max(Math.abs(i.e),i.sd())+6,t.rounding=1,h=!1,i=i.times(i).plus(1).sqrt().plus(i),h=!0,t.precision=n,t.rounding=e,i.ln())},O.inverseHyperbolicTangent=O.atanh=function(){var n,e,i,t,r=this,s=r.constructor;return r.isFinite()?r.e>=0?new s(r.abs().eq(1)?r.s/0:r.isZero()?r:NaN):(n=s.precision,e=s.rounding,t=r.sd(),Math.max(t,n)<2*-r.e-1?P(new s(r),n,e,!0):(s.precision=i=t-r.e,r=Z(r.plus(1),new s(1).minus(r),i+n,1),s.precision=n+4,s.rounding=1,r=r.ln(),s.precision=n,s.rounding=e,r.times(.5))):new s(NaN)},O.inverseSine=O.asin=function(){var n,e,i,t,r=this,s=r.constructor;return r.isZero()?new s(r):(e=r.abs().cmp(1),i=s.precision,t=s.rounding,-1!==e?0===e?((n=U(s,i+4,t).times(.5)).s=r.s,n):new s(NaN):(s.precision=i+6,s.rounding=1,r=r.div(new s(1).minus(r.times(r)).sqrt().plus(1)).atan(),s.precision=i,s.rounding=t,r.times(2)))},O.inverseTangent=O.atan=function(){var n,e,i,t,r,s,o,u,c,f=this,a=f.constructor,d=a.precision,l=a.rounding;if(f.isFinite()){if(f.isZero())return new a(f);if(f.abs().eq(1)&&d+4<=q)return(o=U(a,d+4,l).times(.25)).s=f.s,o}else{if(!f.s)return new a(NaN);if(d+4<=q)return(o=U(a,d+4,l).times(.5)).s=f.s,o}for(a.precision=u=d+10,a.rounding=1,n=i=Math.min(28,u/y+2|0);n;--n)f=f.div(f.times(f).plus(1).sqrt().plus(1));for(h=!1,e=Math.ceil(u/y),t=1,c=f.times(f),o=new a(f),r=f;-1!==n;)if(r=r.times(c),s=o.minus(r.div(t+=2)),r=r.times(c),void 0!==(o=s.plus(r.div(t+=2))).d[e])for(n=e;o.d[n]===s.d[n]&&n--;);return i&&(o=o.times(2<<i-1)),h=!0,P(o,a.precision=d,a.rounding=l,!0)},O.isFinite=function(){return!!this.d},O.isInteger=O.isInt=function(){return!!this.d&&m(this.e/y)>this.d.length-2},O.isNaN=function(){return!this.s},O.isNegative=O.isNeg=function(){return this.s<0},O.isPositive=O.isPos=function(){return this.s>0},O.isZero=function(){return!!this.d&&0===this.d[0]},O.lessThan=O.lt=function(n){return this.cmp(n)<0},O.lessThanOrEqualTo=O.lte=function(n){return this.cmp(n)<1},O.logarithm=O.log=function(n){var e,i,t,r,s,o,u,c,f=this.constructor,a=f.precision,d=f.rounding;if(null==n)n=new f(10),e=!0;else{if(i=(n=new f(n)).d,n.s<0||!i||!i[0]||n.eq(1))return new f(NaN);e=n.eq(10)}if(i=this.d,this.s<0||!i||!i[0]||this.eq(1))return new f(i&&!i[0]?-1/0:1!=this.s?NaN:i?0:1/0);if(e)if(i.length>1)s=!0;else{for(r=i[0];r%10==0;)r/=10;s=1!==r}if(h=!1,o=V(this,u=a+5),t=e?T(f,u+10):V(n,u),A((c=Z(o,t,u,1)).d,r=a,d))do{if(o=V(this,u+=10),t=e?T(f,u+10):V(n,u),c=Z(o,t,u,1),!s){+D(c.d).slice(r+1,r+15)+1==1e14&&(c=P(c,a+1,0));break}}while(A(c.d,r+=10,d));return h=!0,P(c,a,d)},O.minus=O.sub=function(n){var e,i,t,r,s,o,u,c,f,a,d,l,p=this,g=p.constructor;if(n=new g(n),!p.d||!n.d)return p.s&&n.s?p.d?n.s=-n.s:n=new g(n.d||p.s!==n.s?p:NaN):n=new g(NaN),n;if(p.s!=n.s)return n.s=-n.s,p.plus(n);if(f=p.d,l=n.d,u=g.precision,c=g.rounding,!f[0]||!l[0]){if(l[0])n.s=-n.s;else{if(!f[0])return new g(3===c?-0:0);n=new g(p)}return h?P(n,u,c):n}if(i=m(n.e/y),a=m(p.e/y),f=f.slice(),s=a-i){for((d=s<0)?(e=f,s=-s,o=l.length):(e=l,i=a,o=f.length),s>(t=Math.max(Math.ceil(u/y),o)+2)&&(s=t,e.length=1),e.reverse(),t=s;t--;)e.push(0);e.reverse()}else{for((d=(t=f.length)<(o=l.length))&&(o=t),t=0;t<o;t++)if(f[t]!=l[t]){d=f[t]<l[t];break}s=0}for(d&&(e=f,f=l,l=e,n.s=-n.s),o=f.length,t=l.length-o;t>0;--t)f[o++]=0;for(t=l.length;t>s;){if(f[--t]<l[t]){for(r=t;r&&0===f[--r];)f[r]=x-1;--f[r],f[t]+=x}f[t]-=l[t]}for(;0===f[--o];)f.pop();for(;0===f[0];f.shift())--i;return f[0]?(n.d=f,n.e=L(f,i),h?P(n,u,c):n):new g(3===c?-0:0)},O.modulo=O.mod=function(n){var e,i=this,t=i.constructor;return n=new t(n),!i.d||!n.s||n.d&&!n.d[0]?new t(NaN):!n.d||i.d&&!i.d[0]?P(new t(i),t.precision,t.rounding):(h=!1,9==t.modulo?(e=Z(i,n.abs(),0,3,1)).s*=n.s:e=Z(i,n,0,t.modulo,1),e=e.times(n),h=!0,i.minus(e))},O.naturalExponential=O.exp=function(){return B(this)},O.naturalLogarithm=O.ln=function(){return V(this)},O.negated=O.neg=function(){var n=new this.constructor(this);return n.s=-n.s,P(n)},O.plus=O.add=function(n){var e,i,t,r,s,o,u,c,f,a,d=this,l=d.constructor;if(n=new l(n),!d.d||!n.d)return d.s&&n.s?d.d||(n=new l(n.d||d.s===n.s?d:NaN)):n=new l(NaN),n;if(d.s!=n.s)return n.s=-n.s,d.minus(n);if(f=d.d,a=n.d,u=l.precision,c=l.rounding,!f[0]||!a[0])return a[0]||(n=new l(d)),h?P(n,u,c):n;if(s=m(d.e/y),t=m(n.e/y),f=f.slice(),r=s-t){for(r<0?(i=f,r=-r,o=a.length):(i=a,t=s,o=f.length),r>(o=(s=Math.ceil(u/y))>o?s+1:o+1)&&(r=o,i.length=1),i.reverse();r--;)i.push(0);i.reverse()}for((o=f.length)-(r=a.length)<0&&(r=o,i=a,a=f,f=i),e=0;r;)e=(f[--r]=f[r]+a[r]+e)/x|0,f[r]%=x;for(e&&(f.unshift(e),++t),o=f.length;0==f[--o];)f.pop();return n.d=f,n.e=L(f,t),h?P(n,u,c):n},O.precision=O.sd=function(n){var e,i=this;if(void 0!==n&&n!==!!n&&1!==n&&0!==n)throw Error(l+n);return i.d?(e=_(i.d),n&&i.e+1>e&&(e=i.e+1)):e=NaN,e},O.round=function(){var n=this,e=n.constructor;return P(new e(n),n.e+1,e.rounding)},O.sine=O.sin=function(){var n,e,i=this,t=i.constructor;return i.isFinite()?i.isZero()?new t(i):(n=t.precision,e=t.rounding,t.precision=n+Math.max(i.e,i.sd())+y,t.rounding=1,i=function(n,e){var i,t=e.d.length;if(t<3)return J(n,2,e,e);i=(i=1.4*Math.sqrt(t))>16?16:0|i,e=e.times(1/z(5,i)),e=J(n,2,e,e);for(var r,s=new n(5),o=new n(16),u=new n(20);i--;)r=e.times(e),e=e.times(s.plus(r.times(o.times(r).minus(u))));return e}(t,G(t,i)),t.precision=n,t.rounding=e,P(r>2?i.neg():i,n,e,!0)):new t(NaN)},O.squareRoot=O.sqrt=function(){var n,e,i,t,r,s,o=this,u=o.d,c=o.e,f=o.s,a=o.constructor;if(1!==f||!u||!u[0])return new a(!f||f<0&&(!u||u[0])?NaN:u?o:1/0);for(h=!1,0==(f=Math.sqrt(+o))||f==1/0?(((e=D(u)).length+c)%2==0&&(e+=\"0\"),f=Math.sqrt(e),c=m((c+1)/2)-(c<0||c%2),t=new a(e=f==1/0?\"5e\"+c:(e=f.toExponential()).slice(0,e.indexOf(\"e\")+1)+c)):t=new a(f.toString()),i=(c=a.precision)+3;;)if(t=(s=t).plus(Z(o,s,i+2,1)).times(.5),D(s.d).slice(0,i)===(e=D(t.d)).slice(0,i)){if(\"9999\"!=(e=e.slice(i-3,i+1))&&(r||\"4999\"!=e)){+e&&(+e.slice(1)||\"5\"!=e.charAt(0))||(P(t,c+1,1),n=!t.times(t).eq(o));break}if(!r&&(P(s,c+1,0),s.times(s).eq(o))){t=s;break}i+=4,r=1}return h=!0,P(t,c,a.rounding,n)},O.tangent=O.tan=function(){var n,e,i=this,t=i.constructor;return i.isFinite()?i.isZero()?new t(i):(n=t.precision,e=t.rounding,t.precision=n+10,t.rounding=1,(i=i.sin()).s=1,i=Z(i,new t(1).minus(i.times(i)).sqrt(),n+10,0),t.precision=n,t.rounding=e,P(2==r||4==r?i.neg():i,n,e,!0)):new t(NaN)},O.times=O.mul=function(n){var e,i,t,r,s,o,u,c,f,a=this,d=a.constructor,l=a.d,p=(n=new d(n)).d;if(n.s*=a.s,!(l&&l[0]&&p&&p[0]))return new d(!n.s||l&&!l[0]&&!p||p&&!p[0]&&!l?NaN:l&&p?0*n.s:n.s/0);for(i=m(a.e/y)+m(n.e/y),(c=l.length)<(f=p.length)&&(s=l,l=p,p=s,o=c,c=f,f=o),s=[],t=o=c+f;t--;)s.push(0);for(t=f;--t>=0;){for(e=0,r=c+t;r>t;)u=s[r]+p[t]*l[r-t-1]+e,s[r--]=u%x|0,e=u/x|0;s[r]=(s[r]+e)%x|0}for(;!s[--o];)s.pop();return e?++i:s.shift(),n.d=s,n.e=L(s,i),h?P(n,d.precision,d.rounding):n},O.toBinary=function(n,e){return K(this,2,n,e)},O.toDecimalPlaces=O.toDP=function(n,e){var i=this,t=i.constructor;return i=new t(i),void 0===n?i:(F(n,0,o),void 0===e?e=t.rounding:F(e,0,8),P(i,n+i.e+1,e))},O.toExponential=function(n,e){var i,t=this,r=t.constructor;return void 0===n?i=R(t,!0):(F(n,0,o),void 0===e?e=r.rounding:F(e,0,8),i=R(t=P(new r(t),n+1,e),!0,n+1)),t.isNeg()&&!t.isZero()?\"-\"+i:i},O.toFixed=function(n,e){var i,t,r=this,s=r.constructor;return void 0===n?i=R(r):(F(n,0,o),void 0===e?e=s.rounding:F(e,0,8),i=R(t=P(new s(r),n+r.e+1,e),!1,n+t.e+1)),r.isNeg()&&!r.isZero()?\"-\"+i:i},O.toFraction=function(n){var e,i,t,r,s,o,u,c,f,a,d,p,g=this,m=g.d,v=g.constructor;if(!m)return new v(g);if(f=i=new v(1),t=c=new v(0),o=(s=(e=new v(t)).e=_(m)-g.e-1)%y,e.d[0]=w(10,o<0?y+o:o),null==n)n=s>0?e:f;else{if(!(u=new v(n)).isInt()||u.lt(f))throw Error(l+u);n=u.gt(e)?s>0?e:f:u}for(h=!1,u=new v(D(m)),a=v.precision,v.precision=s=m.length*y*2;d=Z(u,e,0,1,1),1!=(r=i.plus(d.times(t))).cmp(n);)i=t,t=r,r=f,f=c.plus(d.times(r)),c=r,r=e,e=u.minus(d.times(r)),u=r;return r=Z(n.minus(i),t,0,1,1),c=c.plus(r.times(f)),i=i.plus(r.times(t)),c.s=f.s=g.s,p=Z(f,t,s,1).minus(g).abs().cmp(Z(c,i,s,1).minus(g).abs())<1?[f,t]:[c,i],v.precision=a,h=!0,p},O.toHexadecimal=O.toHex=function(n,e){return K(this,16,n,e)},O.toNearest=function(n,e){var i=this,t=i.constructor;if(i=new t(i),null==n){if(!i.d)return i;n=new t(1),e=t.rounding}else{if(n=new t(n),void 0===e?e=t.rounding:F(e,0,8),!i.d)return n.s?i:n;if(!n.d)return n.s&&(n.s=i.s),n}return n.d[0]?(h=!1,i=Z(i,n,0,e,1).times(n),h=!0,P(i)):(n.s=i.s,i=n),i},O.toNumber=function(){return+this},O.toOctal=function(n,e){return K(this,8,n,e)},O.toPower=O.pow=function(n){var e,i,t,r,s,o,u=this,c=u.constructor,f=+(n=new c(n));if(!(u.d&&n.d&&u.d[0]&&n.d[0]))return new c(w(+u,f));if((u=new c(u)).eq(1))return u;if(t=c.precision,s=c.rounding,n.eq(1))return P(u,t,s);if((e=m(n.e/y))>=n.d.length-1&&(i=f<0?-f:f)<=9007199254740991)return r=C(c,u,i,t),n.s<0?new c(1).div(r):P(r,t,s);if((o=u.s)<0){if(e<n.d.length-1)return new c(NaN);if(0==(1&n.d[e])&&(o=1),0==u.e&&1==u.d[0]&&1==u.d.length)return u.s=o,u}return(e=0!=(i=w(+u,f))&&isFinite(i)?new c(i+\"\").e:m(f*(Math.log(\"0.\"+D(u.d))/Math.LN10+u.e+1)))>c.maxE+1||e<c.minE-1?new c(e>0?o/0:0):(h=!1,c.rounding=u.s=1,i=Math.min(12,(e+\"\").length),(r=B(n.times(V(u,t+i)),t)).d&&A((r=P(r,t+5,1)).d,t,s)&&(e=t+10,+D((r=P(B(n.times(V(u,e+i)),e),e+5,1)).d).slice(t+1,t+15)+1==1e14&&(r=P(r,t+1,0))),r.s=o,h=!0,c.rounding=s,P(r,t,s))},O.toPrecision=function(n,e){var i,t=this,r=t.constructor;return void 0===n?i=R(t,t.e<=r.toExpNeg||t.e>=r.toExpPos):(F(n,1,o),void 0===e?e=r.rounding:F(e,0,8),i=R(t=P(new r(t),n,e),n<=t.e||t.e<=r.toExpNeg,n)),t.isNeg()&&!t.isZero()?\"-\"+i:i},O.toSignificantDigits=O.toSD=function(n,e){var i=this.constructor;return void 0===n?(n=i.precision,e=i.rounding):(F(n,1,o),void 0===e?e=i.rounding:F(e,0,8)),P(new i(this),n,e)},O.toString=function(){var n=this,e=n.constructor,i=R(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()&&!n.isZero()?\"-\"+i:i},O.truncated=O.trunc=function(){return P(new this.constructor(this),this.e+1,1)},O.valueOf=O.toJSON=function(){var n=this,e=n.constructor,i=R(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()?\"-\"+i:i};var Z=function(){function n(n,e,i){var t,r=0,s=n.length;for(n=n.slice();s--;)t=n[s]*e+r,n[s]=t%i|0,r=t/i|0;return r&&n.unshift(r),n}function e(n,e,i,t){var r,s;if(i!=t)s=i>t?1:-1;else for(r=s=0;r<i;r++)if(n[r]!=e[r]){s=n[r]>e[r]?1:-1;break}return s}function t(n,e,i,t){for(var r=0;i--;)n[i]-=r,r=n[i]<e[i]?1:0,n[i]=r*t+n[i]-e[i];for(;!n[0]&&n.length>1;)n.shift()}return function(r,s,o,u,c,f){var a,h,d,l,p,g,w,v,N,b,E,M,q,O,D,F,A,S,Z,R,L=r.constructor,T=r.s==s.s?1:-1,U=r.d,_=s.d;if(!(U&&U[0]&&_&&_[0]))return new L(r.s&&s.s&&(U?!_||U[0]!=_[0]:_)?U&&0==U[0]||!_?0*T:T/0:NaN);for(f?(p=1,h=r.e-s.e):(f=x,p=y,h=m(r.e/p)-m(s.e/p)),Z=_.length,A=U.length,b=(N=new L(T)).d=[],d=0;_[d]==(U[d]||0);d++);if(_[d]>(U[d]||0)&&h--,null==o?(O=o=L.precision,u=L.rounding):O=c?o+(r.e-s.e)+1:o,O<0)b.push(1),g=!0;else{if(O=O/p+2|0,d=0,1==Z){for(l=0,_=_[0],O++;(d<A||l)&&O--;d++)D=l*f+(U[d]||0),b[d]=D/_|0,l=D%_|0;g=l||d<A}else{for((l=f/(_[0]+1)|0)>1&&(_=n(_,l,f),U=n(U,l,f),Z=_.length,A=U.length),F=Z,M=(E=U.slice(0,Z)).length;M<Z;)E[M++]=0;(R=_.slice()).unshift(0),S=_[0],_[1]>=f/2&&++S;do{l=0,(a=e(_,E,Z,M))<0?(q=E[0],Z!=M&&(q=q*f+(E[1]||0)),(l=q/S|0)>1?(l>=f&&(l=f-1),1==(a=e(w=n(_,l,f),E,v=w.length,M=E.length))&&(l--,t(w,Z<v?R:_,v,f))):(0==l&&(a=l=1),w=_.slice()),(v=w.length)<M&&w.unshift(0),t(E,w,M,f),-1==a&&(a=e(_,E,Z,M=E.length))<1&&(l++,t(E,Z<M?R:_,M,f)),M=E.length):0===a&&(l++,E=[0]),b[d++]=l,a&&E[0]?E[M++]=U[F]||0:(E=[U[F]],M=1)}while((F++<A||void 0!==E[0])&&O--);g=void 0!==E[0]}b[0]||b.shift()}if(1==p)N.e=h,i=g;else{for(d=1,l=b[0];l>=10;l/=10)d++;N.e=d+h*p-1,P(N,c?o+N.e+1:o,u,g)}return N}}();function P(n,e,i,t){var r,s,o,u,c,f,a,d,l,p=n.constructor;n:if(null!=e){if(!(d=n.d))return n;for(r=1,u=d[0];u>=10;u/=10)r++;if((s=e-r)<0)s+=y,o=e,c=(a=d[l=0])/w(10,r-o-1)%10|0;else if((l=Math.ceil((s+1)/y))>=(u=d.length)){if(!t)break n;for(;u++<=l;)d.push(0);a=c=0,r=1,o=(s%=y)-y+1}else{for(a=u=d[l],r=1;u>=10;u/=10)r++;c=(o=(s%=y)-y+r)<0?0:a/w(10,r-o-1)%10|0}if(t=t||e<0||void 0!==d[l+1]||(o<0?a:a%w(10,r-o-1)),f=i<4?(c||t)&&(0==i||i==(n.s<0?3:2)):c>5||5==c&&(4==i||t||6==i&&(s>0?o>0?a/w(10,r-o):0:d[l-1])%10&1||i==(n.s<0?8:7)),e<1||!d[0])return d.length=0,f?(e-=n.e+1,d[0]=w(10,(y-e%y)%y),n.e=-e||0):d[0]=n.e=0,n;if(0==s?(d.length=l,u=1,l--):(d.length=l+1,u=w(10,y-s),d[l]=o>0?(a/w(10,r-o)%w(10,o)|0)*u:0),f)for(;;){if(0==l){for(s=1,o=d[0];o>=10;o/=10)s++;for(o=d[0]+=u,u=1;o>=10;o/=10)u++;s!=u&&(n.e++,d[0]==x&&(d[0]=1));break}if(d[l]+=u,d[l]!=x)break;d[l--]=0,u=1}for(s=d.length;0===d[--s];)d.pop()}return h&&(n.e>p.maxE?(n.d=null,n.e=NaN):n.e<p.minE&&(n.e=0,n.d=[0])),n}function R(n,e,i){if(!n.isFinite())return j(n);var t,r=n.e,s=D(n.d),o=s.length;return e?(i&&(t=i-o)>0?s=s.charAt(0)+\".\"+s.slice(1)+k(t):o>1&&(s=s.charAt(0)+\".\"+s.slice(1)),s=s+(n.e<0?\"e\":\"e+\")+n.e):r<0?(s=\"0.\"+k(-r-1)+s,i&&(t=i-o)>0&&(s+=k(t))):r>=o?(s+=k(r+1-o),i&&(t=i-r-1)>0&&(s=s+\".\"+k(t))):((t=r+1)<o&&(s=s.slice(0,t)+\".\"+s.slice(t)),i&&(t=i-o)>0&&(r+1===o&&(s+=\".\"),s+=k(t))),s}function L(n,e){var i=n[0];for(e*=y;i>=10;i/=10)e++;return e}function T(n,e,i){if(e>M)throw h=!0,i&&(n.precision=i),Error(p);return P(new n(c),e,1,!0)}function U(n,e,i){if(e>q)throw Error(p);return P(new n(f),e,i,!0)}function _(n){var e=n.length-1,i=e*y+1;if(e=n[e]){for(;e%10==0;e/=10)i--;for(e=n[0];e>=10;e/=10)i++}return i}function k(n){for(var e=\"\";n--;)e+=\"0\";return e}function C(n,e,i,t){var r,s=new n(1),o=Math.ceil(t/y+4);for(h=!1;;){if(i%2&&Q((s=s.times(e)).d,o)&&(r=!0),0===(i=m(i/2))){i=s.d.length-1,r&&0===s.d[i]&&++s.d[i];break}Q((e=e.times(e)).d,o)}return h=!0,s}function I(n){return 1&n.d[n.d.length-1]}function H(n,e,i){for(var t,r=new n(e[0]),s=0;++s<e.length;){if(!(t=new n(e[s])).s){r=t;break}r[i](t)&&(r=t)}return r}function B(n,e){var i,t,r,s,o,u,c,f=0,a=0,d=0,l=n.constructor,p=l.rounding,g=l.precision;if(!n.d||!n.d[0]||n.e>17)return new l(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:NaN);for(null==e?(h=!1,c=g):c=e,u=new l(.03125);n.e>-2;)n=n.times(u),d+=5;for(c+=t=Math.log(w(2,d))/Math.LN10*2+5|0,i=s=o=new l(1),l.precision=c;;){if(s=P(s.times(n),c,1),i=i.times(++a),D((u=o.plus(Z(s,i,c,1))).d).slice(0,c)===D(o.d).slice(0,c)){for(r=d;r--;)o=P(o.times(o),c,1);if(null!=e)return l.precision=g,o;if(!(f<3&&A(o.d,c-t,p,f)))return P(o,l.precision=g,p,h=!0);l.precision=c+=10,i=s=u=new l(1),a=0,f++}o=u}}function V(n,e){var i,t,r,s,o,u,c,f,a,d,l,p=1,g=n,m=g.d,w=g.constructor,v=w.rounding,N=w.precision;if(g.s<0||!m||!m[0]||!g.e&&1==m[0]&&1==m.length)return new w(m&&!m[0]?-1/0:1!=g.s?NaN:m?0:g);if(null==e?(h=!1,a=N):a=e,w.precision=a+=10,t=(i=D(m)).charAt(0),!(Math.abs(s=g.e)<15e14))return f=T(w,a+2,N).times(s+\"\"),g=V(new w(t+\".\"+i.slice(1)),a-10).plus(f),w.precision=N,null==e?P(g,N,v,h=!0):g;for(;t<7&&1!=t||1==t&&i.charAt(1)>3;)t=(i=D((g=g.times(n)).d)).charAt(0),p++;for(s=g.e,t>1?(g=new w(\"0.\"+i),s++):g=new w(t+\".\"+i.slice(1)),d=g,c=o=g=Z(g.minus(1),g.plus(1),a,1),l=P(g.times(g),a,1),r=3;;){if(o=P(o.times(l),a,1),D((f=c.plus(Z(o,new w(r),a,1))).d).slice(0,a)===D(c.d).slice(0,a)){if(c=c.times(2),0!==s&&(c=c.plus(T(w,a+2,N).times(s+\"\"))),c=Z(c,new w(p),a,1),null!=e)return w.precision=N,c;if(!A(c.d,a-10,v,u))return P(c,w.precision=N,v,h=!0);w.precision=a+=10,f=o=g=Z(d.minus(1),d.plus(1),a,1),l=P(g.times(g),a,1),r=u=1}c=f,r+=2}}function j(n){return String(n.s*n.s/0)}function $(n,e){var i,t,r;for((i=e.indexOf(\".\"))>-1&&(e=e.replace(\".\",\"\")),(t=e.search(/e/i))>0?(i<0&&(i=t),i+=+e.slice(t+1),e=e.substring(0,t)):i<0&&(i=e.length),t=0;48===e.charCodeAt(t);t++);for(r=e.length;48===e.charCodeAt(r-1);--r);if(e=e.slice(t,r)){if(r-=t,n.e=i=i-t-1,n.d=[],t=(i+1)%y,i<0&&(t+=y),t<r){for(t&&n.d.push(+e.slice(0,t)),r-=y;t<r;)n.d.push(+e.slice(t,t+=y));e=e.slice(t),t=y-e.length}else t-=r;for(;t--;)e+=\"0\";n.d.push(+e),h&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function W(n,i){var t,r,s,o,u,c,f,a,d;if(\"Infinity\"===i||\"NaN\"===i)return+i||(n.s=NaN),n.e=NaN,n.d=null,n;if(N.test(i))t=16,i=i.toLowerCase();else if(v.test(i))t=2;else{if(!b.test(i))throw Error(l+i);t=8}for((o=i.search(/p/i))>0?(f=+i.slice(o+1),i=i.substring(2,o)):i=i.slice(2),u=(o=i.indexOf(\".\"))>=0,r=n.constructor,u&&(o=(c=(i=i.replace(\".\",\"\")).length)-o,s=C(r,new r(t),o,2*o)),o=d=(a=S(i,t,x)).length-1;0===a[o];--o)a.pop();return o<0?new r(0*n.s):(n.e=L(a,d),n.d=a,h=!1,u&&(n=Z(n,s,4*c)),f&&(n=n.times(Math.abs(f)<54?w(2,f):e.pow(2,f))),h=!0,n)}function J(n,e,i,t,r){var s,o,u,c,f=n.precision,a=Math.ceil(f/y);for(h=!1,c=i.times(i),u=new n(t);;){if(o=Z(u.times(c),new n(e++*e++),f,1),u=r?t.plus(o):t.minus(o),t=Z(o.times(c),new n(e++*e++),f,1),void 0!==(o=u.plus(t)).d[a]){for(s=a;o.d[s]===u.d[s]&&s--;);if(-1==s)break}s=u,u=t,t=o,o=s,0}return h=!0,o.d.length=a+1,o}function z(n,e){for(var i=n;--e;)i*=n;return i}function G(n,e){var i,t=e.s<0,s=U(n,n.precision,1),o=s.times(.5);if((e=e.abs()).lte(o))return r=t?4:1,e;if((i=e.divToInt(s)).isZero())r=t?3:2;else{if((e=e.minus(i.times(s))).lte(o))return r=I(i)?t?2:3:t?4:1,e;r=I(i)?t?1:4:t?3:2}return e.minus(s).abs()}function K(n,e,t,r){var s,c,f,a,h,d,l,p,g,m=n.constructor,w=void 0!==t;if(w?(F(t,1,o),void 0===r?r=m.rounding:F(r,0,8)):(t=m.precision,r=m.rounding),n.isFinite()){for(w?(s=2,16==e?t=4*t-3:8==e&&(t=3*t-2)):s=e,(f=(l=R(n)).indexOf(\".\"))>=0&&(l=l.replace(\".\",\"\"),(g=new m(1)).e=l.length-f,g.d=S(R(g),10,s),g.e=g.d.length),c=h=(p=S(l,10,s)).length;0==p[--h];)p.pop();if(p[0]){if(f<0?c--:((n=new m(n)).d=p,n.e=c,p=(n=Z(n,g,t,r,0,s)).d,c=n.e,d=i),f=p[t],a=s/2,d=d||void 0!==p[t+1],d=r<4?(void 0!==f||d)&&(0===r||r===(n.s<0?3:2)):f>a||f===a&&(4===r||d||6===r&&1&p[t-1]||r===(n.s<0?8:7)),p.length=t,d)for(;++p[--t]>s-1;)p[t]=0,t||(++c,p.unshift(1));for(h=p.length;!p[h-1];--h);for(f=0,l=\"\";f<h;f++)l+=u.charAt(p[f]);if(w){if(h>1)if(16==e||8==e){for(f=16==e?4:3,--h;h%f;h++)l+=\"0\";for(h=(p=S(l,s,e)).length;!p[h-1];--h);for(f=1,l=\"1.\";f<h;f++)l+=u.charAt(p[f])}else l=l.charAt(0)+\".\"+l.slice(1);l=l+(c<0?\"p\":\"p+\")+c}else if(c<0){for(;++c;)l=\"0\"+l;l=\"0.\"+l}else if(++c>h)for(c-=h;c--;)l+=\"0\";else c<h&&(l=l.slice(0,c)+\".\"+l.slice(c))}else l=w?\"0p+0\":\"0\";l=(16==e?\"0x\":2==e?\"0b\":8==e?\"0o\":\"\")+l}else l=j(n);return n.s<0?\"-\"+l:l}function Q(n,e){if(n.length>e)return n.length=e,!0}function X(n){return new this(n).abs()}function Y(n){return new this(n).acos()}function nn(n){return new this(n).acosh()}function en(n,e){return new this(n).plus(e)}function tn(n){return new this(n).asin()}function rn(n){return new this(n).asinh()}function sn(n){return new this(n).atan()}function on(n){return new this(n).atanh()}function un(n,e){n=new this(n),e=new this(e);var i,t=this.precision,r=this.rounding,s=t+4;return n.s&&e.s?n.d||e.d?!e.d||n.isZero()?(i=e.s<0?U(this,t,r):new this(0)).s=n.s:!n.d||e.isZero()?(i=U(this,s,1).times(.5)).s=n.s:e.s<0?(this.precision=s,this.rounding=1,i=this.atan(Z(n,e,s,1)),e=U(this,s,1),this.precision=t,this.rounding=r,i=n.s<0?i.minus(e):i.plus(e)):i=this.atan(Z(n,e,s,1)):(i=U(this,s,1).times(e.s>0?.25:.75)).s=n.s:i=new this(NaN),i}function cn(n){return new this(n).cbrt()}function fn(n){return P(n=new this(n),n.e+1,2)}function an(n){if(!n||\"object\"!=typeof n)throw Error(d+\"Object expected\");var e,i,t,r=!0===n.defaults,u=[\"precision\",1,o,\"rounding\",0,8,\"toExpNeg\",-s,0,\"toExpPos\",0,s,\"maxE\",0,s,\"minE\",-s,0,\"modulo\",0,9];for(e=0;e<u.length;e+=3)if(i=u[e],r&&(this[i]=a[i]),void 0!==(t=n[i])){if(!(m(t)===t&&t>=u[e+1]&&t<=u[e+2]))throw Error(l+i+\": \"+t);this[i]=t}if(i=\"crypto\",r&&(this[i]=a[i]),void 0!==(t=n[i])){if(!0!==t&&!1!==t&&0!==t&&1!==t)throw Error(l+i+\": \"+t);if(t){if(\"undefined\"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(g);this[i]=!0}else this[i]=!1}return this}function hn(n){return new this(n).cos()}function dn(n){return new this(n).cosh()}function ln(n,e){return new this(n).div(e)}function pn(n){return new this(n).exp()}function gn(n){return P(n=new this(n),n.e+1,3)}function mn(){var n,e,i=new this(0);for(h=!1,n=0;n<arguments.length;)if((e=new this(arguments[n++])).d)i.d&&(i=i.plus(e.times(e)));else{if(e.s)return h=!0,new this(1/0);i=e}return h=!0,i.sqrt()}function wn(n){return n instanceof e||n&&\"[object Decimal]\"===n.name||!1}function vn(n){return new this(n).ln()}function Nn(n,e){return new this(n).log(e)}function bn(n){return new this(n).log(2)}function En(n){return new this(n).log(10)}function xn(){return H(this,arguments,\"lt\")}function yn(){return H(this,arguments,\"gt\")}function Mn(n,e){return new this(n).mod(e)}function qn(n,e){return new this(n).mul(e)}function On(n,e){return new this(n).pow(e)}function Dn(n){var e,i,t,r,s=0,u=new this(1),c=[];if(void 0===n?n=this.precision:F(n,1,o),t=Math.ceil(n/y),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(t));s<t;)(r=e[s])>=429e7?e[s]=crypto.getRandomValues(new Uint32Array(1))[0]:c[s++]=r%1e7;else{if(!crypto.randomBytes)throw Error(g);for(e=crypto.randomBytes(t*=4);s<t;)(r=e[s]+(e[s+1]<<8)+(e[s+2]<<16)+((127&e[s+3])<<24))>=214e7?crypto.randomBytes(4).copy(e,s):(c.push(r%1e7),s+=4);s=t/4}else for(;s<t;)c[s++]=1e7*Math.random()|0;for(t=c[--s],n%=y,t&&n&&(r=w(10,y-n),c[s]=(t/r|0)*r);0===c[s];s--)c.pop();if(s<0)i=0,c=[0];else{for(i=-1;0===c[0];i-=y)c.shift();for(t=1,r=c[0];r>=10;r/=10)t++;t<y&&(i-=y-t)}return u.e=i,u.d=c,u}function Fn(n){return P(n=new this(n),n.e+1,this.rounding)}function An(n){return(n=new this(n)).d?n.d[0]?n.s:0*n.s:n.s||NaN}function Sn(n){return new this(n).sin()}function Zn(n){return new this(n).sinh()}function Pn(n){return new this(n).sqrt()}function Rn(n,e){return new this(n).sub(e)}function Ln(n){return new this(n).tan()}function Tn(n){return new this(n).tanh()}function Un(n){return P(n=new this(n),n.e+1,1)}return(e=function n(e){var i,t,r;function s(n){var e,i,t,r=this;if(!(r instanceof s))return new s(n);if(r.constructor=s,n instanceof s)return r.s=n.s,void(h?!n.d||n.e>s.maxE?(r.e=NaN,r.d=null):n.e<s.minE?(r.e=0,r.d=[0]):(r.e=n.e,r.d=n.d.slice()):(r.e=n.e,r.d=n.d?n.d.slice():n.d));if(\"number\"==(t=typeof n)){if(0===n)return r.s=1/n<0?-1:1,r.e=0,void(r.d=[0]);if(n<0?(n=-n,r.s=-1):r.s=1,n===~~n&&n<1e7){for(e=0,i=n;i>=10;i/=10)e++;return void(h?e>s.maxE?(r.e=NaN,r.d=null):e<s.minE?(r.e=0,r.d=[0]):(r.e=e,r.d=[n]):(r.e=e,r.d=[n]))}return 0*n!=0?(n||(r.s=NaN),r.e=NaN,void(r.d=null)):$(r,n.toString())}if(\"string\"!==t)throw Error(l+n);return 45===(i=n.charCodeAt(0))?(n=n.slice(1),r.s=-1):(43===i&&(n=n.slice(1)),r.s=1),E.test(n)?$(r,n):W(r,n)}if(s.prototype=O,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.EUCLID=9,s.config=s.set=an,s.clone=n,s.isDecimal=wn,s.abs=X,s.acos=Y,s.acosh=nn,s.add=en,s.asin=tn,s.asinh=rn,s.atan=sn,s.atanh=on,s.atan2=un,s.cbrt=cn,s.ceil=fn,s.cos=hn,s.cosh=dn,s.div=ln,s.exp=pn,s.floor=gn,s.hypot=mn,s.ln=vn,s.log=Nn,s.log10=En,s.log2=bn,s.max=xn,s.min=yn,s.mod=Mn,s.mul=qn,s.pow=On,s.random=Dn,s.round=Fn,s.sign=An,s.sin=Sn,s.sinh=Zn,s.sqrt=Pn,s.sub=Rn,s.tan=Ln,s.tanh=Tn,s.trunc=Un,void 0===e&&(e={}),e&&!0!==e.defaults)for(r=[\"precision\",\"rounding\",\"toExpNeg\",\"toExpPos\",\"maxE\",\"minE\",\"modulo\",\"crypto\"],i=0;i<r.length;)e.hasOwnProperty(t=r[i++])||(e[t]=this[t]);return s.config(e),s}(a)).default=e.Decimal=e,c=new e(c),f=new e(f),\"function\"==typeof define&&define.amd?define(function(){return e}):\"undefined\"!=typeof module&&module.exports?(\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator&&(O[Symbol.for(\"nodejs.util.inspect.custom\")]=O.toString,O[Symbol.toStringTag]=\"Decimal\"),module.exports=e):(n||(n=\"undefined\"!=typeof self&&self&&self.self==self?self:window),t=n.Decimal,e.noConflict=function(){return n.Decimal=t,e},n.Decimal=e),e}(this)\r\n//    bigDec: require('decimal.js')\r\n});\r\n\r\nif((typeof module) !== 'undefined') {\r\n    module.exports = nerdamer;\r\n};","/* global module */\r\n\r\n/*\r\n * Author : Martin Donk\r\n * Website : http://www.nerdamer.com\r\n * Email : martin.r.donk@gmail.com\r\n * Source : https://github.com/jiggzson/nerdamer\r\n */\r\n\r\nif((typeof module) !== 'undefined' && typeof nerdamer === 'undefined') {\r\n    var nerdamer = require('./nerdamer.core.js');\r\n    require('./Algebra.js');\r\n}\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    var core = nerdamer.getCore(),\r\n            _ = core.PARSER,\r\n            Frac = core.Frac,\r\n            Settings = core.Settings,\r\n            isSymbol = core.Utils.isSymbol,\r\n            FN = core.groups.FN,\r\n            Symbol = core.Symbol,\r\n            text = core.Utils.text,\r\n            inBrackets = core.Utils.inBrackets,\r\n            isInt = core.Utils.isInt,\r\n            format = core.Utils.format,\r\n            even = core.Utils.even,\r\n            evaluate = core.Utils.evaluate,\r\n            N = core.groups.N,\r\n            S = core.groups.S,\r\n            FN = core.groups.FN,\r\n            PL = core.groups.PL,\r\n            CP = core.groups.CP,\r\n            CB = core.groups.CB,\r\n            EX = core.groups.EX,\r\n            P = core.groups.P,\r\n            LOG = Settings.LOG,\r\n            EXP = 'exp',\r\n            ABS = 'abs',\r\n            SQRT = 'sqrt',\r\n            SIN = 'sin',\r\n            COS = 'cos',\r\n            TAN = 'tan',\r\n            SEC = 'sec',\r\n            CSC = 'csc',\r\n            COT = 'cot',\r\n            ASIN = 'asin',\r\n            ACOS = 'acos',\r\n            ATAN = 'atan',\r\n            ASEC = 'asec',\r\n            ACSC = 'acsc',\r\n            ACOT = 'acot',\r\n            SINH = 'sinh',\r\n            COSH = 'cosh',\r\n            TANH = 'tanh',\r\n            CSCH = 'csch',\r\n            SECH = 'sech',\r\n            COTH = 'coth',\r\n            ASECH = 'asech',\r\n            ACSCH = 'acsch',\r\n            ACOTH = 'acoth';\r\n\r\n    //custom errors\r\n    function NoIntegralFound(msg) {\r\n        this.message = msg || \"\";\r\n    }\r\n    NoIntegralFound.prototype = new Error();\r\n\r\n    //Preparations\r\n    Symbol.prototype.hasIntegral = function () {\r\n        return this.containsFunction('integrate');\r\n    };\r\n    //transforms a function\r\n    Symbol.prototype.fnTransform = function () {\r\n        if(this.group !== FN)\r\n            return this;\r\n        var retval, a = this.args[0];\r\n        var m = new Symbol(this.multiplier);\r\n        var sym = this.clone().toUnitMultiplier();\r\n        if(this.isLinear()) {\r\n            switch(this.fname) {\r\n                case SINH:\r\n                    retval = _.parse(format('(e^({0})-e^(-({0})))/2', a));\r\n                    break;\r\n                case COSH:\r\n                    retval = _.parse(format('(e^({0})+e^(-({0})))/2', a));\r\n                    break;\r\n                case TANH:\r\n                    retval = _.parse(format('(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))', a));\r\n                    break;\r\n                case TAN:\r\n                    retval = _.parse(format('sin({0})/cos({0})', a));\r\n                    break;\r\n                case CSC:\r\n                    retval = _.parse(format('1/sin({0})', a));\r\n                    break;\r\n                case SEC:\r\n                    retval = _.parse(format('1/cos({0})', a));\r\n                    break;\r\n                default:\r\n                    retval = sym;\r\n            }\r\n        }\r\n        else if(this.power.equals(2)) {\r\n            switch(this.fname) {\r\n                case SIN:\r\n                    retval = _.parse(format('1/2-cos(2*({0}))/2', a));\r\n                    break;\r\n                case COS:\r\n                    retval = _.parse(format('1/2+cos(2*({0}))/2', a));\r\n                    break;\r\n                case TAN:\r\n                    //retval = _.parse(format('(1-cos(2*({0})))/(1+cos(2*({0})))', a));\r\n                    retval = _.parse(format('sin({0})^2/cos({0})^2', a));\r\n                    break;\r\n                case COSH:\r\n                    retval = _.parse(format('1/2+cosh(2*({0}))/2', a));\r\n                    break;\r\n                case SINH:\r\n                    retval = _.parse(format('-1/2+cosh(2*({0}))/2', a));\r\n                    break;\r\n                case TANH:\r\n                    retval = _.parse(format('(1+cosh(2*({0})))/(-1+cosh(2*({0})))', a));\r\n                    break;\r\n                case SEC:\r\n                    retval = _.parse(format('(1-cos(2*({0})))/(1+cos(2*({0})))+1', a));\r\n                    break;\r\n                default:\r\n                    retval = sym;\r\n            }\r\n        }\r\n        else if(this.fname === SEC) {\r\n            retval = _.parse(format('1/cos({0})^({1})', this.args[0], this.power));\r\n        }\r\n        else if(this.fname === CSC) {\r\n            retval = _.parse(format('1/sin({0})^({1})', this.args[0], this.power));\r\n        }\r\n        else if(this.fname === TAN) {\r\n            if(this.power.lessThan(0)) {\r\n                retval = _.parse(format('cos({0})^(-({1}))/sin({0})^({1})', this.args[0], this.power.negate()));\r\n            }\r\n            else {\r\n                retval = _.parse(format('sin({0})^({1})/cos({0})^({1})', this.args[0], this.power));\r\n            }\r\n        }\r\n        else if(this.fname === SIN && this.power.lessThan(0)) {\r\n            retval = _.parse(format('csc({0})^(-({1}))', this.args[0], this.power.negate()));\r\n        }\r\n        else if(this.fname === COS && this.power.lessThan(0)) {\r\n            retval = _.parse(format('sec({0})^(-({1}))', this.args[0], this.power.negate()));\r\n        }\r\n        else if(this.fname === SIN && this.power.equals(3)) {\r\n            retval = _.parse(format('(3*sin({0})-sin(3*({0})))/4', this.args[0]));\r\n        }\r\n        else if(this.fname === COS && this.power.equals(3)) {\r\n            retval = _.parse(format('(cos(3*({0}))+3*cos({0}))/4', this.args[0]));\r\n        }\r\n        //cos(a*x)^(2*n) or sin(a*x)^(2*n)\r\n        else if((this.fname === COS || this.fname === SIN) && even(this.power)) {\r\n            var n = this.power / 2;\r\n            //convert to a double angle\r\n            var double_angle = _.pow(this.clone().toLinear(), _.parse(2)).fnTransform();\r\n            //raise to the n and expand\r\n            var transformed = _.expand(_.pow(double_angle, _.parse(n)));\r\n\r\n            retval = new Symbol(0);\r\n\r\n            transformed.each(function (s) {\r\n                var t = s.fnTransform();\r\n                retval = _.add(retval, t);\r\n            }, true);\r\n        }\r\n        else\r\n            retval = sym;\r\n\r\n        return _.multiply(retval, m);\r\n    };\r\n\r\n    Symbol.prototype.hasTrig = function () {\r\n        if(this.isConstant(true) || this.group === S)\r\n            return false;\r\n        if(this.fname && (core.Utils.in_trig(this.fname) || core.Utils.in_inverse_trig(this.fname)))\r\n            return true;\r\n        if(this.symbols) {\r\n            for(var x in this.symbols)\r\n                if(this.symbols[x].hasTrig())\r\n                    return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    core.Expression.prototype.hasIntegral = function () {\r\n        return this.symbol.hasIntegral();\r\n    };\r\n    /**\r\n     * Attempts to rewrite a symbol under one common denominator\r\n     * @param {Symbol} symbol \r\n     */\r\n    core.Utils.toCommonDenominator = function (symbol) {\r\n        //transform x/a+x -> (ax+x)/a\r\n        if(symbol.isComposite() && symbol.isLinear()) {\r\n            var m = new Symbol(symbol.multiplier);\r\n            var denominator = new Symbol(1);\r\n            var numerator = new Symbol(0);\r\n            symbol.each(function (x) {\r\n                denominator = _.multiply(denominator, x.getDenom());\r\n            }, true);\r\n\r\n            //remove the denomitor in each term\r\n            symbol.each(function (x) {\r\n                var num = x.getNum();\r\n                var den = x.getDenom();\r\n                var factor = _.multiply(num, _.divide(denominator.clone(), den));\r\n                numerator = _.add(numerator, factor);\r\n            });\r\n            var retval = _.multiply(m, core.Algebra.divide(_.expand(numerator), _.expand(denominator)));\r\n            return retval;\r\n        }\r\n        return symbol;\r\n    };\r\n    //A function to check if a function name is an inverse trig function\r\n    core.Utils.in_inverse_trig = function (x) {\r\n        var inv_trig_fns = [ASIN, ACOS, ATAN, ACSC, ASEC, ACOT];\r\n        return inv_trig_fns.indexOf(x) !== -1;\r\n    };\r\n    //A function to check if a function name is a trig function\r\n    core.Utils.in_trig = function (x) {\r\n        var trig_fns = [COS, SIN, TAN, SEC, CSC, COT];\r\n        return trig_fns.indexOf(x) !== -1;\r\n    };\r\n\r\n    core.Utils.in_htrig = function (x) {\r\n        var trig_fns = [SINH, COSH, TANH, ACSCH, ASECH, ACOTH];\r\n        return trig_fns.indexOf(x) !== -1;\r\n    };\r\n\r\n    // Matrix functions\r\n    core.Matrix.jacobian = function (eqns, vars) {\r\n        var jacobian = new core.Matrix();\r\n        //get the variables if not supplied\r\n        if(!vars) {\r\n            vars = core.Utils.arrayGetVariables(eqns);\r\n        }\r\n\r\n        vars.forEach(function (v, i) {\r\n            eqns.forEach(function (eq, j) {\r\n                var e = core.Calculus.diff(eq.clone(), v);\r\n                jacobian.set(j, i, e);\r\n            });\r\n        });\r\n\r\n        return jacobian;\r\n    };\r\n\r\n    core.Matrix.prototype.max = function () {\r\n        var max = new Symbol(0);\r\n        this.each(function (x) {\r\n            var e = x.abs();\r\n            if(e.gt(max))\r\n                max = e;\r\n        });\r\n        return max;\r\n    };\r\n\r\n    core.Matrix.cMatrix = function (value, vars) {\r\n        var m = new core.Matrix();\r\n        //make an initial guess\r\n        vars.forEach(function (v, i) {\r\n            m.set(i, 0, _.parse(value));\r\n        });\r\n        return m;\r\n    };\r\n\r\n    var all_functions = core.Utils.all_functions = function (arr) {\r\n        for(var i = 0, l = arr.length; i < l; i++)\r\n            if(arr[i].group !== FN)\r\n                return false;\r\n        return true;\r\n    },\r\n            cosAsinBtransform = core.Utils.cosAsinBtranform = function (symbol1, symbol2) {\r\n                var a, b;\r\n                a = symbol1.args[0];\r\n                b = symbol2.args[0];\r\n                return _.parse(format('(sin(({0})+({1}))-sin(({0})-({1})))/2', a, b));\r\n            },\r\n            cosAsinAtransform = core.Utils.cosAsinAtranform = function (symbol1, symbol2) {\r\n                //TODO: temporary fix for integrate(e^x*sin(x)*cos(x)^2).\r\n                //we technically know how to do this transform but more is needed for correct output\r\n                if(Number(symbol2.power) !== 1)\r\n                    return _.multiply(symbol1, symbol2);\r\n                var a;\r\n                a = symbol1.args[0];\r\n                return _.parse(format('(sin(2*({0})))/2', a));\r\n            },\r\n            sinAsinBtransform = core.Utils.cosAsinBtranform = function (symbol1, symbol2) {\r\n                var a, b;\r\n                a = symbol1.args[0];\r\n                b = symbol2.args[0];\r\n                return _.parse(format('(cos(({0})+({1}))-cos(({0})-({1})))/2', a, b));\r\n            },\r\n            trigTransform = core.Utils.trigTransform = function (arr) {\r\n                var map = {}, symbol, t,\r\n                        retval = new Symbol(1);\r\n                for(var i = 0, l = arr.length; i < l; i++) {\r\n                    symbol = arr[i];\r\n\r\n                    if(symbol.group === FN) {\r\n                        var fname = symbol.fname;\r\n\r\n                        if(fname === COS && map[SIN]) {\r\n\r\n                            if(map[SIN].args[0].toString() !== symbol.args[0].toString()) {\r\n                                t = cosAsinBtransform(symbol, map[SIN]);\r\n                            }\r\n                            else {\r\n                                t = cosAsinAtransform(symbol, map[SIN]);\r\n                            }\r\n                            delete map[SIN];\r\n\r\n                            retval = _.multiply(retval, t);\r\n                        }\r\n                        else if(fname === SIN && map[COS]) {\r\n                            if(map[COS].args[0].toString() !== symbol.args[0].toString()) {\r\n                                t = cosAsinBtransform(symbol, map[COS]);\r\n                            }\r\n                            else {\r\n                                t = cosAsinAtransform(symbol, map[COS]);\r\n                            }\r\n                            delete map[COS];\r\n\r\n                            retval = _.multiply(retval, t);\r\n                        }\r\n                        else if(fname === SIN && map[SIN]) {\r\n                            if(map[SIN].args[0].toString() !== symbol.args[0].toString()) {\r\n                                t = sinAsinBtransform(symbol, map[SIN]);\r\n                                delete map[SIN];\r\n                            }\r\n                            else {\r\n                                //This should actually be redundant code but let's put just in case\r\n                                t = _.multiply(symbol, map[SIN]);\r\n                                delete map[SIN];\r\n                            }\r\n\r\n                            retval = t;\r\n                        }\r\n                        else {\r\n                            map[fname] = symbol;\r\n                        }\r\n                    }\r\n                    else\r\n                        retval = _.multiply(retval, symbol);\r\n                }\r\n\r\n                //put back the remaining functions\r\n                for(var x in map)\r\n                    retval = _.multiply(retval, map[x]);\r\n\r\n                return retval;\r\n\r\n            };\r\n\r\n    core.Settings.integration_depth = 10;\r\n\r\n    core.Settings.max_lim_depth = 10;\r\n\r\n    var __ = core.Calculus = {\r\n\r\n        version: '1.4.6',\r\n\r\n        sum: function (fn, index, start, end) {\r\n            if(!(index.group === core.groups.S))\r\n                throw new core.exceptions.NerdamerTypeError('Index must be symbol. ' + text(index) + ' provided');\r\n            index = index.value;\r\n            var retval;\r\n            if(core.Utils.isNumericSymbol(start) && core.Utils.isNumericSymbol(end)) {\r\n                var modifier = end - start < 200 ? '' : 'PARSE2NUMBER';\r\n                start = Number(start);\r\n                end = Number(end);\r\n                retval = core.Utils.block(modifier, function () {\r\n                    var f = fn.text(),\r\n                            subs = {'~': true}, //lock subs. Is this even being used?\r\n                            retval = new core.Symbol(0);\r\n\r\n                    for(var i = start; i <= end; i++) {\r\n                        subs[index] = new Symbol(i);\r\n                        var ans = _.parse(f, subs);\r\n                        retval = _.add(retval, ans);\r\n                    }\r\n                    return retval;\r\n                });\r\n            }\r\n            else {\r\n                retval = _.symfunction('sum', arguments);\r\n            }\r\n\r\n            return retval;\r\n        },\r\n        product: function (fn, index, start, end) {\r\n            if(!(index.group === core.groups.S))\r\n                throw new core.exceptions.NerdamerTypeError('Index must be symbol. ' + text(index) + ' provided');\r\n            index = index.value;\r\n            var retval;\r\n            if(core.Utils.isNumericSymbol(start) && core.Utils.isNumericSymbol(end)) {\r\n                var modifier = end - start < 200 ? '' : 'PARSE2NUMBER';\r\n                retval = core.Utils.block(modifier, function () {\r\n                    start = Number(start);\r\n                    end = Number(end.multiplier);\r\n\r\n                    var f = fn.text(),\r\n                            subs = {},\r\n                            retval = new core.Symbol(1);\r\n\r\n                    for(var i = start; i <= end; i++) {\r\n                        subs[index] = new Symbol(i);\r\n                        retval = _.multiply(retval, _.parse(f, subs));\r\n                    }\r\n                    return retval;\r\n                });\r\n            }\r\n            else {\r\n                retval = _.symfunction('product', arguments);\r\n            }\r\n\r\n            return retval;\r\n        },\r\n        diff: function (symbol, wrt, nth) {\r\n            if(core.Utils.isVector(symbol)) {\r\n                var vector = new core.Vector([]);\r\n                symbol.each(function (x) {\r\n                    vector.elements.push(__.diff(x, wrt, nth));\r\n                });\r\n                return vector;\r\n            }\r\n            else if(core.Utils.isMatrix(symbol)) {\r\n                var matrix = new core.Matrix();\r\n                symbol.each(function (x, i, j) {\r\n                    matrix.set(i, j, __.diff(x, wrt, nth));\r\n                });\r\n                return matrix;\r\n            }\r\n\r\n            var d = isSymbol(wrt) ? wrt.text() : wrt;\r\n            //the nth derivative\r\n            nth = isSymbol(nth) ? nth.multiplier : nth || 1;\r\n\r\n            if(d === undefined)\r\n                d = core.Utils.variables(symbol)[0];\r\n\r\n            //unwrap sqrt\r\n            if(symbol.group === FN && symbol.fname === SQRT) {\r\n                var s = symbol.args[0],\r\n                        sp = symbol.power.clone();\r\n                //these groups go to zero anyway so why waste time?\r\n                if(s.group !== N || s.group !== P) {\r\n                    s.power = isSymbol(s.power) ? _.multiply(s.power, _.multiply(new Symbol(1 / 2)), sp) : s.power.multiply(new Frac(0.5)).multiply(sp);\r\n                    s.multiplier = s.multiplier.multiply(symbol.multiplier);\r\n                }\r\n\r\n                symbol = s;\r\n            }\r\n\r\n            if(symbol.group === FN && !isSymbol(symbol.power)) {\r\n                var a = derive(_.parse(symbol));\r\n                var b = __.diff(symbol.args[0].clone(), d);\r\n                symbol = _.multiply(a, b);//chain rule\r\n            }\r\n            else {\r\n                symbol = derive(symbol);\r\n            }\r\n\r\n            if(nth > 1) {\r\n                nth--;\r\n                symbol = __.diff(symbol, wrt, nth);\r\n            }\r\n\r\n            return symbol;\r\n\r\n            // Equivalent to \"derivative of the outside\".\r\n            function polydiff(symbol) {\r\n                if(symbol.value === d || symbol.contains(d, true)) {\r\n                    symbol.multiplier = symbol.multiplier.multiply(symbol.power);\r\n                    symbol.power = symbol.power.subtract(new Frac(1));\r\n                    if(symbol.power.equals(0)) {\r\n                        symbol = Symbol(symbol.multiplier);\r\n                    }\r\n                }\r\n\r\n                return symbol;\r\n            }\r\n            \r\n            function derive(symbol) {\r\n                var g = symbol.group, a, b, cp;\r\n\r\n                if(g === N || g === S && symbol.value !== d || g === P) {\r\n                    symbol = Symbol(0);\r\n                }\r\n                else if(g === S) {\r\n                    symbol = polydiff(symbol);\r\n                }\r\n                else if(g === CB) {\r\n                    var m = symbol.multiplier.clone();\r\n                    symbol.toUnitMultiplier();\r\n                    var retval = _.multiply(product_rule(symbol), polydiff(symbol));\r\n                    retval.multiplier = retval.multiplier.multiply(m);\r\n                    return retval;\r\n                }\r\n                else if(g === FN && symbol.power.equals(1)) {\r\n                    // Table of known derivatives\r\n                    switch(symbol.fname) {\r\n                        case LOG:\r\n                            cp = symbol.clone();\r\n                            symbol = symbol.args[0].clone();//get the arguments\r\n                            symbol.power = symbol.power.negate();\r\n                            symbol.multiplier = cp.multiplier.divide(symbol.multiplier);\r\n                            break;\r\n                        case COS:\r\n                            //cos -> -sin\r\n                            symbol.fname = SIN;\r\n                            symbol.multiplier.negate();\r\n                            break;\r\n                        case SIN:\r\n                            //sin -> cos\r\n                            symbol.fname = COS;\r\n                            break;\r\n                        case TAN:\r\n                            //tan -> sec^2\r\n                            symbol.fname = SEC;\r\n                            symbol.power = new Frac(2);\r\n                            break;\r\n                        case SEC:\r\n                            // Use a clone if this gives errors\r\n                            symbol = qdiff(symbol, TAN);\r\n                            break;\r\n                        case CSC:\r\n                            symbol = qdiff(symbol, '-cot');\r\n                            break;\r\n                        case COT:\r\n                            symbol.fname = CSC;\r\n                            symbol.multiplier.negate();\r\n                            symbol.power = new Frac(2);\r\n                            break;\r\n                        case ASIN:\r\n                            symbol = _.parse('(sqrt(1-(' + text(symbol.args[0]) + ')^2))^(-1)');\r\n                            break;\r\n                        case ACOS:\r\n                            symbol = _.parse('-(sqrt(1-(' + text(symbol.args[0]) + ')^2))^(-1)');\r\n                            break;\r\n                        case ATAN:\r\n                            symbol = _.parse('(1+(' + text(symbol.args[0]) + ')^2)^(-1)');\r\n                            break;\r\n                        case ABS:\r\n                            m = symbol.multiplier.clone();\r\n                            symbol.toUnitMultiplier();\r\n                            //depending on the complexity of the symbol it's easier to just parse it into a new symbol\r\n                            //this should really be readdressed soon\r\n                            b = symbol.args[0].clone();\r\n                            b.toUnitMultiplier();\r\n                            symbol = _.parse(inBrackets(text(symbol.args[0])) + '/abs' + inBrackets(text(b)));\r\n                            symbol.multiplier = m;\r\n                            break;\r\n                        case 'parens':\r\n                            //see product rule: f'.g goes to zero since f' will return zero. This way we only get back\r\n                            //1*g'\r\n                            symbol = Symbol(1);\r\n                            break;\r\n                        case 'cosh':\r\n                            //cosh -> -sinh\r\n                            symbol.fname = 'sinh';\r\n                            break;\r\n                        case 'sinh':\r\n                            //sinh -> cosh\r\n                            symbol.fname = 'cosh';\r\n                            break;\r\n                        case TANH:\r\n                            //tanh -> sech^2\r\n                            symbol.fname = SECH;\r\n                            symbol.power = new Frac(2);\r\n                            break;\r\n                        case SECH:\r\n                            // Use a clone if this gives errors\r\n                            symbol = qdiff(symbol, '-tanh');\r\n                            break;\r\n                        case CSCH:\r\n                            var arg = String(symbol.args[0]);\r\n                            return _.parse('-coth(' + arg + ')*csch(' + arg + ')');\r\n                            break;\r\n                        case COTH:\r\n                            var arg = String(symbol.args[0]);\r\n                            return _.parse('-csch(' + arg + ')^2');\r\n                            break;\r\n                        case 'asinh':\r\n                            symbol = _.parse('(sqrt(1+(' + text(symbol.args[0]) + ')^2))^(-1)');\r\n                            break;\r\n                        case 'acosh':\r\n                            symbol = _.parse('(sqrt(-1+(' + text(symbol.args[0]) + ')^2))^(-1)');\r\n                            break;\r\n                        case 'atanh':\r\n                            symbol = _.parse('(1-(' + text(symbol.args[0]) + ')^2)^(-1)');\r\n                            break;\r\n                        case ASECH:\r\n                            var arg = String(symbol.args[0]);\r\n                            symbol = _.parse('-1/(sqrt(1/(' + arg + ')^2-1)*(' + arg + ')^2)');\r\n                            break;\r\n                        case ACOTH:\r\n                            symbol = _.parse('-1/((' + symbol.args[0] + ')^2-1)');\r\n                            break;\r\n                        case ACSCH:\r\n                            var arg = String(symbol.args[0]);\r\n                            symbol = _.parse('-1/(sqrt(1/(' + arg + ')^2+1)*(' + arg + ')^2)');\r\n                            break;\r\n                        case ASEC:\r\n                            var arg = String(symbol.args[0]);\r\n                            symbol = _.parse('1/(sqrt(1-1/(' + arg + ')^2)*(' + arg + ')^2)');\r\n                            break;\r\n                        case ACSC:\r\n                            var arg = String(symbol.args[0]);\r\n                            symbol = _.parse('-1/(sqrt(1-1/(' + arg + ')^2)*(' + arg + ')^2)');\r\n                            break;\r\n                        case ACOT:\r\n                            symbol = _.parse('-1/((' + symbol.args[0] + ')^2+1)');\r\n                            break;\r\n                        case 'S':\r\n                            var arg = String(symbol.args[0]);\r\n                            symbol = _.parse('sin((pi*(' + arg + ')^2)/2)');\r\n                            break;\r\n                        case 'C':\r\n                            var arg = String(symbol.args[0]);\r\n                            symbol = _.parse('cos((pi*(' + arg + ')^2)/2)');\r\n                            break;\r\n                        case 'Si':\r\n                            var arg = symbol.args[0];\r\n                            symbol = _.parse('sin(' + arg + ')/(' + arg + ')');\r\n                            break;\r\n                        case 'Shi':\r\n                            var arg = symbol.args[0];\r\n                            symbol = _.parse('sinh(' + arg + ')/(' + arg + ')');\r\n                            break;\r\n                        case 'Ci':\r\n                            var arg = symbol.args[0];\r\n                            symbol = _.parse('cos(' + arg + ')/(' + arg + ')');\r\n                            break;\r\n                        case 'Chi':\r\n                            var arg = symbol.args[0];\r\n                            symbol = _.parse('cosh(' + arg + ')/(' + arg + ')');\r\n                            break;\r\n                        case 'Ei':\r\n                            var arg = symbol.args[0];\r\n                            symbol = _.parse('e^(' + arg + ')/(' + arg + ')');\r\n                            break;\r\n                        case 'Li':\r\n                            var arg = symbol.args[0];\r\n                            symbol = _.parse('1/' + Settings.LOG + '(' + arg + ')');\r\n                            break;\r\n                        case 'erf':\r\n                            symbol = _.parse('(2*e^(-(' + symbol.args[0] + ')^2))/sqrt(pi)');\r\n                            break;\r\n                        case 'atan2':\r\n                            var x_ = String(symbol.args[0]),\r\n                                    y_ = String(symbol.args[1]);\r\n                            symbol = _.parse('(' + y_ + ')/((' + y_ + ')^2+(' + x_ + ')^2)');\r\n                            break;\r\n                        case 'sign':\r\n                            symbol = new Symbol(0);\r\n                            break;\r\n                        case 'sinc':\r\n                            symbol = _.parse(format('(({0})*cos({0})-sin({0}))*({0})^(-2)', symbol.args[0]));\r\n                            break;\r\n                        case Settings.LOG10:\r\n                            symbol = _.parse('1/((' + symbol.args[0] + ')*' + Settings.LOG + '(10))');\r\n                            break;\r\n                        default:\r\n                            symbol = _.symfunction('diff', [symbol, wrt]);\r\n                    }\r\n                }\r\n                else if(g === EX || g === FN && isSymbol(symbol.power)) {\r\n                    var value;\r\n                    if(g === EX) {\r\n                        value = symbol.value;\r\n                    }\r\n                    else if(g === FN && symbol.contains(d)) {\r\n                        value = symbol.fname + inBrackets(text(symbol.args[0]));\r\n                    }\r\n                    else {\r\n                        value = symbol.value + inBrackets(text(symbol.args[0]));\r\n                    }\r\n                    a = _.multiply(_.parse(LOG + inBrackets(value)), symbol.power.clone());\r\n                    b = __.diff(_.multiply(_.parse(LOG + inBrackets(value)), symbol.power.clone()), d);\r\n                    symbol = _.multiply(symbol, b);\r\n                }\r\n                else if(g === FN && !symbol.power.equals(1)) {\r\n                    b = symbol.clone();\r\n                    b.toLinear();\r\n                    b.toUnitMultiplier();\r\n                    symbol = _.multiply(polydiff(symbol.clone()), derive(b));\r\n                }\r\n                else if(g === CP || g === PL) {\r\n                    // Note: Do not use `parse` since this puts back the sqrt and causes a bug as in #610. Use clone.\r\n                    var c = symbol.clone();\r\n                    var result = new Symbol(0);\r\n                    for(var x in symbol.symbols) {\r\n                        result = _.add(result, __.diff(symbol.symbols[x].clone(), d));\r\n                    }\r\n                    symbol = _.multiply(polydiff(c), result);\r\n                }\r\n\r\n                symbol.updateHash();\r\n\r\n                return symbol;\r\n            }\r\n            ;\r\n\r\n            function qdiff(symbol, val, altVal) {\r\n                return _.multiply(symbol, _.parse(val + inBrackets(altVal || text(symbol.args[0]))));\r\n            }\r\n            ;\r\n\r\n            function product_rule(symbol) {\r\n                //grab all the symbols within the CB symbol\r\n                var symbols = symbol.collectSymbols(),\r\n                        result = new Symbol(0),\r\n                        l = symbols.length;\r\n                //loop over all the symbols\r\n                for(var i = 0; i < l; i++) {\r\n                    var df = __.diff(symbols[i].clone(), d);\r\n                    for(var j = 0; j < l; j++) {\r\n                        //skip the symbol of which we just pulled the derivative\r\n                        if(i !== j) {\r\n                            //multiply out the remaining symbols\r\n                            df = _.multiply(df, symbols[j].clone());\r\n                        }\r\n                    }\r\n                    //add the derivative to the result\r\n                    result = _.add(result, df);\r\n                }\r\n                return result; //done\r\n            }\r\n            ;\r\n        },\r\n        integration: {\r\n            u_substitution: function (symbols, dx) {\r\n                function try_combo(a, b, f) {\r\n                    var d = __.diff(b, dx);\r\n                    var q = f ? f(a, b) : _.divide(a.clone(), d);\r\n                    if(!q.contains(dx, true))\r\n                        return q;\r\n                    return null;\r\n                }\r\n                function do_fn_sub(fname, arg) {\r\n                    var subbed = __.integrate(_.symfunction(fname, [new Symbol(u)]), u, 0);\r\n                    subbed = subbed.sub(new Symbol(u), arg);\r\n                    subbed.updateHash();\r\n                    return subbed;\r\n                }\r\n\r\n                var a = symbols[0].clone(),\r\n                        b = symbols[1].clone(),\r\n                        g1 = a.group,\r\n                        g2 = b.group,\r\n                        //may cause problems if person is using this already. Will need\r\n                        //to find algorithm for detecting conflict\r\n                        u = '__u__',\r\n                        Q;\r\n                if(g1 === FN && g2 !== FN) {\r\n                    //e.g. 2*x*cos(x^2)\r\n                    var arg = a.args[0];\r\n                    Q = try_combo(b, arg.clone());\r\n                    if(Q)\r\n                        return _.multiply(Q, do_fn_sub(a.fname, arg));\r\n                    Q = try_combo(b, a);\r\n                    if(Q) {\r\n                        return __.integration.poly_integrate(a);\r\n                    }\r\n                }\r\n                else if(g2 === FN && g1 !== FN) {\r\n                    //e.g. 2*(x+1)*cos((x+1)^2\r\n                    var arg = b.args[0];\r\n                    Q = try_combo(a, arg.clone());\r\n                    if(Q)\r\n                        return _.multiply(Q, do_fn_sub(b.fname, arg));\r\n                }\r\n                else if(g1 === FN && g2 === FN) {\r\n                    Q = try_combo(a.clone(), b.clone());\r\n                    if(Q)\r\n                        return _.multiply(__.integration.poly_integrate(b), Q);\r\n                    Q = try_combo(b.clone(), a.clone());\r\n                    if(Q)\r\n                        return _.multiply(__.integration.poly_integrate(b), Q);\r\n                }\r\n                else if(g1 === EX && g2 !== EX) {\r\n                    var p = a.power;\r\n                    Q = try_combo(b, p.clone());\r\n                    if(!Q) {\r\n                        //one more try\r\n                        var dc = __.integration.decompose_arg(p.clone(), dx);\r\n                        //consider the possibility of a^x^(n-1)*x^n dx\r\n                        var xp = __.diff(dc[2].clone(), dx);\r\n                        var dc2 = __.integration.decompose_arg(xp.clone(), dx);\r\n                        //if their powers equal, so if dx*p == b\r\n                        if(_.multiply(dc[1], dc2[1]).power.equals(b.power)) {\r\n                            var m = _.divide(dc[0].clone(), dc2[0].clone());\r\n\r\n                            var new_val = _.multiply(m.clone(), _.pow(new Symbol(a.value), _.multiply(dc[0], new Symbol(u))));\r\n                            new_val = _.multiply(new_val, new Symbol(u));\r\n                            return __.integration.by_parts(new_val, u, 0, {}).sub(u, dc[1].clone());\r\n                        }\r\n\r\n                    }\r\n                    var integrated = __.integrate(a.sub(p.clone(), new Symbol(u)), u, 0),\r\n                            retval = _.multiply(integrated.sub(new Symbol(u), p), Q);\r\n\r\n\r\n                    return retval;\r\n                }\r\n                else if(g2 === EX && g1 !== EX) {\r\n                    var p = b.power;\r\n                    Q = try_combo(a, p.clone());\r\n                    var integrated = __.integrate(b.sub(p, new Symbol(u)), u, 0);\r\n                    return _.multiply(integrated.sub(new Symbol(u), p), Q);\r\n                }\r\n                else if(a.isComposite() || b.isComposite()) {\r\n                    var f = function (a, b) {\r\n                        var d = __.diff(b, dx);\r\n                        var A = core.Algebra.Factor.factor(a),\r\n                                B = core.Algebra.Factor.factor(d);\r\n                        var q = _.divide(A, B);\r\n                        return q;\r\n                    };\r\n                    var f1 = a.isComposite() ? a.clone().toLinear() : a.clone(),\r\n                            f2 = b.isComposite() ? b.clone().toLinear() : b.clone();\r\n                    Q = try_combo(f1.clone(), f2.clone(), f);\r\n                    if(Q)\r\n                        return _.multiply(__.integration.poly_integrate(b), Q);\r\n                    Q = try_combo(f2.clone(), f1.clone(), f);\r\n                    if(Q)\r\n                        return _.multiply(__.integration.poly_integrate(a), Q);\r\n                }\r\n            },\r\n            //simple integration of a single polynomial x^(n+1)/(n+1)\r\n            poly_integrate: function (x) {\r\n                var p = x.power.toString(),\r\n                        m = x.multiplier.toDecimal(),\r\n                        s = x.toUnitMultiplier().toLinear();\r\n                if(Number(p) === -1) {\r\n                    return _.multiply(new Symbol(m), _.symfunction(LOG, [s]));\r\n                }\r\n                return _.parse(format('({0})*({1})^(({2})+1)/(({2})+1)', m, s, p));\r\n            },\r\n            //If we're just spinning wheels we want to stop. This is why we \r\n            //wrap integration in a try catch block and call this to stop.\r\n            stop: function (msg) {\r\n                msg = msg || 'Unable to compute integral!';\r\n                core.Utils.warn(msg);\r\n                throw new NoIntegralFound(msg);\r\n            },\r\n            partial_fraction: function (input, dx, depth, opt) {\r\n                //TODO: This whole thing needs to be rolled into one but for now I'll leave it as two separate parts\r\n                if(!isSymbol(dx))\r\n                    dx = _.parse(dx);\r\n\r\n                var result, partial_fractions;\r\n                result = new Symbol(0);\r\n                partial_fractions = core.Algebra.PartFrac.partfrac(input, dx);\r\n\r\n                if(partial_fractions.group === CB && partial_fractions.isLinear()) {\r\n                    //perform a quick check to make sure that all partial fractions are linear\r\n                    partial_fractions.each(function (x) {\r\n                        if(!x.isLinear())\r\n                            __.integration.stop();\r\n                    });\r\n                    partial_fractions.each(function (x) {\r\n                        result = _.add(result, __.integrate(x, dx, depth, opt));\r\n                    });\r\n                }\r\n                else {\r\n                    result = _.add(result, __.integrate(partial_fractions, dx, depth, opt));\r\n                }\r\n                return result;\r\n            },\r\n            get_udv: function (symbol) {\r\n                var parts = [[/*L*/], [/*I*/], [/*A*/], [/*T*/], [/*E*/]];\r\n                //first we sort them \r\n                var setSymbol = function (x) {\r\n                    var g = x.group;\r\n                    if(g === FN) {\r\n                        var fname = x.fname;\r\n                        if(core.Utils.in_trig(fname) || core.Utils.in_htrig(fname))\r\n                            parts[3].push(x);\r\n                        else if(core.Utils.in_inverse_trig(fname))\r\n                            parts[1].push(x);\r\n                        else if(fname === LOG)\r\n                            parts[0].push(x);\r\n                        else {\r\n                            __.integration.stop();\r\n                        }\r\n                    }\r\n                    else if(g === S || x.isComposite() && x.isLinear() || g === CB && x.isLinear()) {\r\n                        parts[2].push(x);\r\n                    }\r\n                    else if(g === EX || x.isComposite() && !x.isLinear())\r\n                        parts[4].push(x);\r\n                    else\r\n                        __.integration.stop();\r\n                };\r\n\r\n                if(symbol.group === CB)\r\n                    symbol.each(function (x) {\r\n                        setSymbol(Symbol.unwrapSQRT(x, true));\r\n                    });\r\n                else\r\n                    setSymbol(symbol);\r\n                var u, dv = new Symbol(1);\r\n                //compile u and dv\r\n                for(var i = 0; i < 5; i++) {\r\n                    var part = parts[i], t,\r\n                            l = part.length;\r\n                    if(l > 0) {\r\n                        if(l > 1) {\r\n                            t = new Symbol(1);\r\n                            for(var j = 0; j < l; j++)\r\n                                t = _.multiply(t, part[j].clone());\r\n                        }\r\n                        else\r\n                            t = part[0].clone();\r\n\r\n                        if(!u) {\r\n                            u = t;//the first u encountered gets chosen\r\n                            u.multiplier = u.multiplier.multiply(symbol.multiplier); //the first one gets the mutliplier\r\n                        }\r\n                        else\r\n                            dv = _.multiply(dv, t); //everything else belongs to dv\r\n                    }\r\n                }\r\n\r\n                return [u, dv];\r\n            },\r\n\r\n            trig_sub: function (symbol, dx, depth, opt, parts, symbols) {\r\n                parts = parts || __.integration.decompose_arg(symbol.clone().toLinear(), dx);\r\n                var b = parts[3],\r\n                        ax = parts[2],\r\n                        a = parts[0],\r\n                        x = parts[1];\r\n                if(x.power.equals(2) && a.greaterThan(0)) {\r\n                    //use tan(x)\r\n                    var t = core.Utils.getU(symbol), //get an appropriate u\r\n                            u = _.parse(TAN + inBrackets(t)), //u\r\n                            du = _.parse(SEC + inBrackets(t) + '^2'), //du\r\n                            f = _.multiply(symbol.sub(x, u), du);\r\n                    var integral = __.integrate(f, t, depth, opt).sub(u, x);\r\n                    core.Utils.clearU(u);\r\n                    return integral;\r\n                }\r\n            },\r\n\r\n            by_parts: function (symbol, dx, depth, o) {\r\n                o.previous = o.previous || [];\r\n                var udv, u, dv, du, v, vdu, uv, retval, integral_vdu, m, c, vdu_s;\r\n                //first LIATE\r\n                udv = __.integration.get_udv(symbol);\r\n                u = udv[0];\r\n                dv = udv[1];\r\n                du = Symbol.unwrapSQRT(_.expand(__.diff(u.clone(), dx)), true);\r\n                c = du.clone().stripVar(dx);\r\n                //strip any coefficients\r\n                du = _.divide(du, c.clone());\r\n                v = __.integrate(dv.clone(), dx, depth || 0);\r\n                vdu = _.multiply(v.clone(), du);\r\n                vdu_s = vdu.toString();\r\n                //currently only supports e^x*(some trig)\r\n                if(o.previous.indexOf(vdu_s) !== -1 && (core.Utils.in_trig(u.fname)) && dv.isE()) {\r\n                    //We're going to exploit the fact that vdu can never be constant\r\n                    //to work out way out of this cycle. We'll return the length of\r\n                    //the this.previous array until we're back at level one\r\n                    o.is_cyclic = true;\r\n                    //return the integral. \r\n                    return new Symbol(1);\r\n                }\r\n                else\r\n                    o.previous.push(vdu_s);\r\n\r\n                uv = _.multiply(u, v);\r\n                //clear the multiplier so we're dealing with a bare integral\r\n                m = vdu.multiplier.clone();\r\n                vdu.toUnitMultiplier();\r\n                integral_vdu = _.multiply(__.integrate(vdu.clone(), dx, depth, o), c);\r\n                integral_vdu.multiplier = integral_vdu.multiplier.multiply(m);\r\n                retval = _.subtract(uv, integral_vdu);\r\n                //we know that there cannot be constants so they're a holdover from a cyclic integral\r\n                if(o.is_cyclic) {\r\n                    //start popping the previous stack so we know how deep in we are\r\n                    o.previous.pop();\r\n                    if(o.previous.length === 0) {\r\n                        retval = _.expand(retval);\r\n                        var rem = new Symbol(0);\r\n                        retval.each(function (x) {\r\n                            if(!x.contains(dx))\r\n                                rem = _.add(rem, x.clone());\r\n                        });\r\n                        //get the actual uv\r\n                        retval = _.divide(_.subtract(retval, rem.clone()), _.subtract(new Symbol(1), rem));\r\n                    }\r\n                }\r\n\r\n                return retval;\r\n            },\r\n            /*\r\n             * dependents: [Solve, integrate]\r\n             */\r\n            decompose_arg: core.Utils.decompose_fn\r\n        },\r\n        //TODO: nerdamer.integrate('-e^(-a*t)*sin(t)', 't') -> gives incorrect output\r\n        integrate: function (original_symbol, dt, depth, opt) {\r\n            //assume integration wrt independent variable if expression only has one variable\r\n            if(!dt) {\r\n                var vars = core.Utils.variables(original_symbol);\r\n                if(vars.length === 1)\r\n                    dt = vars[0];\r\n                //defaults to x\r\n                dt = dt || 'x';\r\n            }\r\n            //add support for integrating vectors\r\n            if(core.Utils.isVector(original_symbol)) {\r\n                var vector = new core.Vector([]);\r\n                original_symbol.each(function (x) {\r\n                    vector.elements.push(__.integrate(x, dt));\r\n                });\r\n                return vector;\r\n            }\r\n            if(!isNaN(dt))\r\n                _.error('variable expected but received ' + dt);\r\n            //get rid of constants right away\r\n            if(original_symbol.isConstant(true))\r\n                return _.multiply(original_symbol.clone(), _.parse(dt));\r\n\r\n            //configurations options for integral. This is needed for tracking extra options\r\n            //e.g. cyclic integrals or additional settings\r\n            opt = opt || {};\r\n            return core.Utils.block('PARSE2NUMBER', function () {\r\n                //make a note of the original symbol. Set only if undefined\r\n                depth = depth || 0;\r\n                var dx = isSymbol(dt) ? dt.toString() : dt,\r\n                        //we don't want the symbol in sqrt form. x^(1/2) is prefererred\r\n                        symbol = Symbol.unwrapSQRT(original_symbol.clone(), true),\r\n                        g = symbol.group,\r\n                        retval;\r\n\r\n                try {\r\n                    //We stop integration after x amount of recursive calls\r\n                    if(++depth > core.Settings.integration_depth)\r\n                        __.integration.stop('Maximum depth reached. Exiting!');\r\n\r\n                    //constants. We first eliminate anything that doesn't have dx. Everything after this has \r\n                    //to have dx or else it would have been taken care of below\r\n                    if(!symbol.contains(dx, true)) {\r\n                        retval = _.multiply(symbol.clone(), _.parse(dx));\r\n                    }\r\n                    //e.g. 2*x\r\n                    else if(g === S) {\r\n                        retval = __.integration.poly_integrate(symbol, dx, depth);\r\n                    }\r\n                    else if(g === EX) {\r\n                        if(symbol.previousGroup === FN && !(symbol.fname === 'sqrt' || symbol.fname === Settings.PARENTHESIS))\r\n                            __.integration.stop();\r\n                        //check the base\r\n                        if(symbol.contains(dx) && symbol.previousGroup !== FN) {\r\n                            //if the symbol also contains dx then we stop since we currently \r\n                            //don't know what to do with it e.g. x^x\r\n                            if(symbol.power.contains(dx))\r\n                                __.integration.stop();\r\n                            else {\r\n                                var t = __.diff(symbol.clone().toLinear(), dx);\r\n                                if(t.contains(dx))\r\n                                    __.integration.stop();\r\n                                //since at this point it's the base only then we do standard single poly integration\r\n                                //e.g. x^y\r\n                                retval = __.integration.poly_integrate(symbol, dx, depth);\r\n                            }\r\n                        }\r\n                        //e.g. a^x or 9^x\r\n                        else {\r\n                            var a = __.diff(symbol.power.clone(), dx);\r\n                            if(a.contains(dx)) {\r\n                                var aa = a.stripVar(dx),\r\n                                        x = _.divide(a.clone(), aa.clone());\r\n                                if(x.group === S && x.isLinear()) {\r\n                                    aa.multiplier = aa.multiplier.divide(new Frac(2));\r\n                                    return _.parse(format('({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))', aa, dx, symbol.multiplier));\r\n                                }\r\n                                else\r\n                                    __.integration.stop();\r\n                            }\r\n                            if(symbol.isE()) {\r\n                                if(a.isLinear())\r\n                                    retval = symbol;\r\n                                else {\r\n                                    if(a.isE() && a.power.group === S && a.power.power.equals(1))\r\n                                        retval = _.multiply(_.symfunction('Ei', [symbol.power.clone()]), symbol.power);\r\n                                    else\r\n                                        __.integration.stop();\r\n                                }\r\n                            }\r\n                            else {\r\n                                var d = _.symfunction(LOG, [_.parse(symbol.value)]);\r\n                                retval = _.divide(symbol, d);\r\n                            }\r\n                            retval = _.divide(retval, a);\r\n                        }\r\n                    }\r\n                    else if(symbol.isComposite() && symbol.isLinear()) {\r\n                        var m = _.parse(symbol.multiplier);\r\n                        symbol.toUnitMultiplier();\r\n                        retval = new Symbol(0);\r\n                        symbol.each(function (x) {\r\n                            retval = _.add(retval, __.integrate(x, dx, depth));\r\n                        });\r\n                        retval = _.multiply(m, retval);\r\n                    }\r\n                    else if(g === CP) {\r\n                        if(symbol.power.greaterThan(1))\r\n                            symbol = _.expand(symbol);\r\n                        if(symbol.power.equals(1)) {\r\n                            retval = new Symbol(0);\r\n                            symbol.each(function (x) {\r\n                                retval = _.add(retval, __.integrate(x, dx, depth));\r\n                            }, true);\r\n                        }\r\n                        else {\r\n                            var p = Number(symbol.power),\r\n                                    m = symbol.multiplier.clone();//temporarily remove the multiplier\r\n                            symbol.toUnitMultiplier();\r\n                            var //below we consider the form ax+b\r\n                                    fn = symbol.clone().toLinear(), //get just the pure function without the power\r\n                                    decomp = __.integration.decompose_arg(fn, dx),\r\n                                    //I have no idea why I used bx+a and not ax+b. TODO change this to something that makes sense\r\n                                    b = decomp[3],\r\n                                    ax = decomp[2],\r\n                                    a = decomp[0],\r\n                                    x = decomp[1];\r\n                            if(p === -1 && x.group !== PL && x.power.equals(2)) {\r\n                                var b_is_positive = isInt(b) ? b > 0 : true;\r\n                                //we can now check for atan\r\n                                if(x.group === S && x.power.equals(2) && b_is_positive) {\r\n                                    ////then we have atan\r\n                                    //abs is redundants since the sign appears in both denom and num.\r\n                                    var unwrapAbs = function (s) {\r\n                                        var result = new Symbol(1);\r\n                                        s.each(function (x) {\r\n                                            result = _.multiply(result, x.fname === 'abs' ? x.args[0] : x);\r\n                                        });\r\n                                        return result;\r\n                                    };\r\n                                    var A = a.clone(),\r\n                                            B = b.clone();\r\n                                    A = _.pow(A, new Symbol(1 / 2));\r\n                                    B = _.pow(B, new Symbol(1 / 2));\r\n                                    //unwrap abs\r\n\r\n                                    var d = _.multiply(unwrapAbs(B), unwrapAbs(A)),\r\n                                            f = _.symfunction(ATAN, [_.divide(_.multiply(a, x.toLinear()), d.clone())]);\r\n                                    retval = _.divide(f, d);\r\n                                }\r\n                                else if(x.group === S && x.isLinear()) {\r\n                                    retval = _.divide(__.integration.poly_integrate(symbol), a);\r\n                                }\r\n                                else {\r\n                                    //1/(x^4+1)\r\n                                    if(x.power.equals(4)) {\r\n                                        //https://www.freemathhelp.com/forum/threads/55678-difficult-integration-int-1-(1-x-4)-dx\r\n                                        var A, B, C, D, E, F, f1, f2, f3, f4, L1, L2;\r\n                                        var br = inBrackets;\r\n                                        //apply rule: ax^4+b = (√ax^2+√2∜a∜bx+√b)(√ax^2-√2∜a∜bx+√b)\r\n                                        //get quadratic factors\r\n                                        A = _.parse(SQRT + br(a) + '*' + dx + '^2');\r\n                                        B = _.parse(SQRT + br(2) + '*' + br(a) + '^' + br('1/4') + '*' + br(b) + '^' + br('1/4') + '*' + dx);\r\n                                        C = _.parse(SQRT + br(b));\r\n                                        f1 = _.add(_.add(A.clone(), B.clone()), C.clone());\r\n                                        f2 = _.add(_.subtract(A, B), C);\r\n                                        //calculate numerators: [D+E, D-E] -> [√2*b^(3/4)+√b∜ax, √2*b^(3/4)-√b∜ax]\r\n                                        D = _.parse(SQRT + br(2) + '*' + br(b) + '^' + br('3/4'));\r\n                                        E = _.parse(SQRT + br(b) + '*' + br(b) + '^' + br('1/4') + '*' + dx);\r\n                                        //let F = 2b√2∜b\r\n                                        F = _.parse(2 + '*' + br(b) + '*' + SQRT + br(2) + '*' + br(b) + '^' + br('1/4'));\r\n                                        //calculate the factors\r\n                                        L1 = _.divide(_.subtract(D.clone(), E.clone()), _.multiply(F.clone(), f2));\r\n                                        L2 = _.divide(_.add(D, E), _.multiply(F, f1.clone()));\r\n                                        retval = _.add(\r\n                                                __.integrate(L1, dx, depth, opt),\r\n                                                __.integrate(L2, dx, depth, opt)\r\n                                                );\r\n                                    }\r\n                                    else\r\n                                        //let's try partial fractions\r\n                                        retval = __.integration.partial_fraction(symbol, dx, depth);\r\n                                }\r\n                            }\r\n                            else if(p === -1 / 2) {\r\n                                //detect asin and atan\r\n                                if(x.group === S && x.power.equals(2)) {\r\n                                    if(ax.multiplier.lessThan(0) && !b.multiplier.lessThan(0)) {\r\n                                        a.negate();\r\n                                        //it's asin\r\n                                        if(b.isConstant() && a.isConstant()) {\r\n                                            var d = _.symfunction(SQRT, [a.clone()]),\r\n                                                    d2 = _.symfunction(SQRT, [_.multiply(a.clone(), b)]);\r\n                                            retval = _.divide(_.symfunction(ASIN, [_.divide(ax.toLinear(), d2)]), d);\r\n                                        }\r\n                                        //I'm not sure about this one. I'm trusting Wolfram Alpha here\r\n                                        else {\r\n                                            var sqrt_a = _.symfunction(SQRT, [a]),\r\n                                                    sqrt_ax = _.multiply(sqrt_a.clone(), x.clone().toLinear());\r\n                                            retval = _.divide(_.symfunction(ATAN, [_.divide(sqrt_ax, _.symfunction(SQRT, [fn.clone()]))]), sqrt_a);\r\n                                        }\r\n                                    }\r\n                                    else {\r\n                                        /*WHAT HAPPENS HERE???? e.g. integrate(3/sqrt(-a+b*x^2),x) or integrate(3/sqrt(a+b*x^2),x)*/\r\n                                        __.integration.stop();\r\n                                    }\r\n                                }\r\n                                else {\r\n                                    //This would be a case like 1/(sqrt(1-x^3) or 1/(1-(x+1)^2)\r\n                                    __.integration.stop();\r\n                                }\r\n                            }\r\n                            else if(p === 1/2 && x.power.equals(2) && a.greaterThan(0)) {\r\n                                // TODO: Revisit\r\n                                __.integration.stop();\r\n                            }\r\n                            else {\r\n                                if(x.isLinear() && x.group !== PL)\r\n                                    retval = _.divide(__.integration.poly_integrate(symbol), a);\r\n                                else if(x.power.equals(2) && a.greaterThan(0)) {\r\n                                    var sqa, sqb, aob, bsqi, n, integral, u, v, uv;\r\n                                    //1/(a*x^2+b^2)^n\r\n                                    //strip the value of b so b = 1\r\n                                    sqa = _.parse(SQRT + inBrackets(a)); //strip a so b = 1\r\n                                    sqb = _.parse(SQRT + inBrackets(b));\r\n                                    aob = _.multiply(sqa.clone(), sqb.clone()).invert();\r\n                                    bsqi = _.pow(b, new Symbol(symbol.power));\r\n                                    uv = core.Utils.getU(symbol);\r\n                                    u = _.multiply(aob, x.clone().toLinear());\r\n                                    v = _.parse(ATAN + inBrackets(u));\r\n                                    //the conversion will be 1+tan(x)^2 -> sec(x)^2\r\n                                    //since the denominator is now (sec(x)^2)^n and the numerator is sec(x)^2 \r\n                                    //then the remaining sec will be (n-1)*2;\r\n                                    var n = (Math.abs(symbol.power) - 1) * 2;\r\n                                    //1/sec(x)^n can now be converted to cos(x)^n and we can pull the integral of that\r\n                                    var integral = __.integrate(_.parse(COS + inBrackets(uv) + '^' + n));\r\n                                    core.Utils.clearU(uv);\r\n                                    return _.multiply(integral.sub(uv, v), bsqi);\r\n                                }\r\n                                else {\r\n                                    if(symbol.group !== CB && !symbol.power.lessThan(0)) {\r\n                                        retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                    }\r\n                                    else {\r\n                                        var f = symbol.clone().toLinear();\r\n                                        var factored = core.Algebra.Factor.factor(f);\r\n                                        var was_factored = factored.toString() !== f.toString();\r\n                                        if(core.Algebra.degree(f, _.parse(dx)).equals(2) && !was_factored) {\r\n                                            try {\r\n                                                var f1, fx, u, sq;\r\n                                                sq = core.Algebra.sqComplete(f, dx);\r\n                                                u = core.Utils.getU(f);\r\n                                                f1 = sq.f.sub(sq.a, u);\r\n                                                fx = _.pow(f1, _.parse(symbol.power));\r\n                                                retval = __.integrate(fx, u).sub(u, sq.a);\r\n                                            }\r\n                                            catch(e) {\r\n                                                __.integration.stop();\r\n                                            }\r\n                                        }\r\n                                        else\r\n                                            retval = __.integration.partial_fraction(symbol, dx, depth, opt);\r\n                                    }\r\n                                }\r\n                            }\r\n                            retval.multiplier = retval.multiplier.multiply(m);\r\n                        }\r\n                    }\r\n                    else if(g === FN) {\r\n                        var arg = symbol.args[0],\r\n                                m = symbol.multiplier.clone();\r\n                        symbol.toUnitMultiplier();\r\n                        var decomp = __.integration.decompose_arg(arg, dx);\r\n                        //easies way I can think of to get the coefficient and to make sure\r\n                        //that the symbol is linear wrt dx. I'm not actually trying to get the \r\n                        //derivative\r\n                        var a = decomp[0],\r\n                                x = decomp[1],\r\n                                fname = symbol.fname;\r\n                        //log is a special case that can be handled with integration by parts\r\n                        if(fname === LOG || (fname === ASIN || fname === ACOS || fname === ATAN && x.isLinear())) {\r\n                            /*integration by parts */\r\n                            var p = symbol.power.toString();\r\n                            if(isInt(p))\r\n                                depth = depth - p; //it needs more room to find the integral\r\n\r\n                            if(!arg.isComposite())\r\n                                retval = _.multiply(_.parse(m), __.integration.by_parts(symbol, dx, depth, opt));\r\n                            else {\r\n                                //integral u du\r\n                                var u = core.Utils.getU(symbol);\r\n                                var f = _.pow(_.parse(LOG + inBrackets(u)), new Symbol(p));\r\n                                var du = __.diff(arg, dx);\r\n                                var u_du = _.multiply(f, du);\r\n                                var integral = __.integrate(u_du, u, depth, opt);\r\n                                retval = _.multiply(_.parse(m), integral.sub(u, arg));\r\n                            }\r\n\r\n                        }\r\n                        else if(fname === TAN && symbol.power.lessThan(0)) {\r\n                            //convert to cotangent\r\n                            var sym = symbol.clone();\r\n                            sym.power.negate();\r\n                            sym.fname = COT;\r\n                            return _.multiply(_.parse(m), __.integrate(sym, dx, depth));\r\n                        }\r\n                        else {\r\n                            if(!a.contains(dx, true) && symbol.isLinear()) { //perform a deep search for safety\r\n                                //first handle the special cases \r\n                                if(fname === ABS) {\r\n                                    //REVISIT **TODO**\r\n                                    var x = _.divide(arg.clone(), a.clone());\r\n                                    if(x.group === S && !x.power.lessThan(0)) {\r\n                                        if(core.Utils.even(x.power)) {\r\n                                            retval = __.integrate(arg, dx, depth);\r\n                                        }\r\n                                        else {\r\n                                            var integrated = __.integrate(x, dx, depth);\r\n                                            integrated.power = integrated.power.subtract(new Frac(1));\r\n                                            retval = _.multiply(_.multiply(_.symfunction(ABS, [x.toLinear()]), integrated), a);\r\n                                        }\r\n                                    }\r\n                                    else\r\n                                        __.integration.stop();\r\n                                }\r\n                                else {\r\n                                    var ag = symbol.args[0].group,\r\n                                            decomposed = __.integration.decompose_arg(arg, dx);\r\n\r\n                                    if(!(ag === CP || ag === S || ag === CB) || !decomposed[1].power.equals(1) || arg.hasFunc())\r\n                                        __.integration.stop();\r\n                                    /**TODO**/ //ASIN, ACOS, ATAN\r\n                                    switch(fname) {\r\n                                        case COS:\r\n                                            retval = _.symfunction(SIN, [arg]);\r\n                                            break;\r\n                                        case SIN:\r\n                                            retval = _.symfunction(COS, [arg]);\r\n                                            retval.negate();\r\n                                            break;\r\n                                        case TAN:\r\n                                            retval = _.parse(format(Settings.LOG + '(sec({0}))', arg));\r\n                                            break;\r\n                                        case SEC:\r\n                                            retval = _.parse(format(Settings.LOG + '(tan({0})+sec({0}))', arg));\r\n                                            break;\r\n                                        case CSC:\r\n                                            retval = _.parse(format('-' + Settings.LOG + '(csc({0})+cot({0}))', arg));\r\n                                            break;\r\n                                        case COT:\r\n                                            retval = _.parse(format(Settings.LOG + '(sin({0}))', arg));\r\n                                            break;\r\n                                        case SINH:\r\n                                            retval = _.symfunction(COSH, [arg]);\r\n                                            break;\r\n                                        case COSH:\r\n                                            retval = _.symfunction(SINH, [arg]);\r\n                                            break;\r\n                                        case TANH:\r\n                                            retval = _.parse(format(Settings.LOG + '(cosh({0}))', arg));\r\n                                            break;\r\n                                        case ASEC:\r\n                                            retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                            break;\r\n                                        case ACSC:\r\n                                            retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                            break;\r\n                                        case ACOT:\r\n                                            retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                            break;\r\n                                            //inverse htrig\r\n                                        case ASECH:\r\n                                            retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                            break;\r\n                                        case ACSCH:\r\n                                            retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                            break;\r\n                                        case ACOTH:\r\n                                            retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                            break;\r\n                                            //end inverse htrig\r\n                                            //htrigh\r\n                                        case SECH:\r\n                                            retval = _.parse(format('atan(sinh({0}))', arg));\r\n                                            break;\r\n                                        case CSCH:\r\n                                            retval = _.parse(format(Settings.LOG + '(tanh(({0})/2))', arg));\r\n                                            break;\r\n                                        case COTH:\r\n                                            retval = _.parse(format(Settings.LOG + '(sinh({0}))', arg));\r\n                                            break;\r\n                                            //end htrig\r\n                                        case EXP:\r\n                                            retval = __.integrate(_.parse(format('e^({0})', arg)), dx, depth);\r\n                                            break;\r\n                                        case 'S':\r\n                                            var arg = symbol.args[0].clone(),\r\n                                                    dc = __.integration.decompose_arg(arg, dx),\r\n                                                    x_ = dc[1],\r\n                                                    a_ = dc[0];\r\n                                            var b_ = dc[3];\r\n                                            retval = _.parse(format('(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)', a_, b_, x));\r\n                                            break;\r\n                                        case 'C':\r\n                                            var arg = symbol.args[0].clone(),\r\n                                                    dc = __.integration.decompose_arg(arg, dx),\r\n                                                    x_ = dc[1],\r\n                                                    a_ = dc[0];\r\n                                            var b_ = dc[3];\r\n                                            retval = _.parse(format('(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)', a_, b_, x_));\r\n                                            break;\r\n                                        case 'erf':\r\n                                            var arg = symbol.args[0].clone(),\r\n                                                    dc = __.integration.decompose_arg(arg, dx),\r\n                                                    x_ = dc[1],\r\n                                                    a_ = dc[0];\r\n                                            retval = _.parse(format('e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))', a_, x_, arg));\r\n                                            break;\r\n                                        case 'sign':\r\n                                            retval = _.multiply(symbol.clone(), arg.clone());\r\n                                            break;\r\n                                        default:\r\n                                            __.integration.stop();\r\n                                    }\r\n\r\n                                    retval = _.divide(retval, a);\r\n                                }\r\n                            }\r\n                            else if(x.isLinear()) {\r\n                                if(fname === COS || fname === SIN) {\r\n                                    var p = Number(symbol.power);\r\n                                    //check to see if it's negative and then just transform it to sec or csc\r\n                                    if(p < 0) {\r\n                                        symbol.fname = fname === SIN ? CSC : SEC;\r\n                                        symbol.invert().updateHash();\r\n                                        retval = __.integrate(symbol, dx, depth);\r\n                                    }\r\n                                    else {\r\n                                        var arg = symbol.args[0],\r\n                                                rd = symbol.clone(), //cos^(n-1)\r\n                                                rd2 = symbol.clone(), //cos^(n-2)\r\n                                                q = new Symbol((p - 1) / p), //\r\n                                                na = _.multiply(a.clone(), new Symbol(p)).invert(); //1/(n*a)\r\n                                        rd.power = rd.power.subtract(new Frac(1));\r\n                                        rd2.power = rd2.power.subtract(new Frac(2));\r\n\r\n                                        var t = _.symfunction(fname === COS ? SIN : COS, [arg.clone()]);\r\n                                        if(fname === SIN)\r\n                                            t.negate();\r\n                                        retval = _.add(_.multiply(_.multiply(na, rd), t), _.multiply(q, __.integrate(_.parse(rd2), dx, depth)));\r\n                                    }\r\n                                }\r\n                                //tan(x)^n or cot(x)^n\r\n                                else if(fname === TAN || fname === COT) {\r\n                                    //http://www.sosmath.com/calculus/integration/moretrigpower/moretrigpower.html\r\n                                    if(symbol.args[0].isLinear(dx)) {\r\n                                        var n = symbol.power.subtract(new Frac(1)).toString(),\r\n                                                r = symbol.clone().toUnitMultiplier(),\r\n                                                w = _.parse(format((fname === COT ? '-' : '') + '1/({2}*{0})*{3}({1})^({0})', n, arg, a, fname));\r\n                                        r.power = r.power.subtract(new Frac(2));\r\n                                        if(r.power.equals(0))\r\n                                            r = _.parse(r);\r\n                                        retval = _.subtract(w, __.integrate(r, dx, depth));\r\n                                    }\r\n                                }\r\n                                //sec(x)^n or csc(x)^n\r\n                                else if(fname === SEC || fname === CSC) {\r\n                                    //http://www.sosmath.com/calculus/integration/moretrigpower/moretrigpower.html\r\n                                    var n1 = symbol.power.subtract(new Frac(1)).toString(),\r\n                                            n2 = symbol.power.subtract(new Frac(2)).toString(),\r\n                                            f2 = fname === SEC ? TAN : COT,\r\n                                            r = symbol.clone().toUnitMultiplier(),\r\n                                            parse_str = format((fname === CSC ? '-' : '') + '1/({0}*{1})*{4}({3})^({2})*{5}({3})', a, n1, n2, arg, fname, f2),\r\n                                            w = _.parse(parse_str);\r\n                                    r.power = r.power.subtract(new Frac(2));\r\n                                    if(r.power.equals(0))\r\n                                        r = _.parse(r);\r\n                                    retval = _.add(w, _.multiply(new Symbol(n2 / n1), __.integrate(r, dx, depth)));\r\n                                }\r\n                                else if((fname === COSH || fname === SINH) && symbol.power.equals(2)) {\r\n                                    retval = __.integrate(symbol.fnTransform(), dx, depth);\r\n                                }\r\n                                else\r\n                                    __.integration.stop();\r\n                            }\r\n                            else\r\n                                __.integration.stop();\r\n\r\n                            retval.multiplier = retval.multiplier.multiply(m);\r\n                        }\r\n                    }\r\n                    else if(g === PL) {\r\n                        retval = __.integration.partial_fraction(symbol, dx, depth);\r\n                    }\r\n                    else if(g === CB) {\r\n                        var den = symbol.getDenom();\r\n                        if(den.group === S)\r\n                            symbol = _.expand(symbol);\r\n\r\n                        //separate the coefficient since all we care about are symbols containing dx\r\n                        var coeff = symbol.stripVar(dx);\r\n                        //now get only those that apply\r\n                        var cfsymbol = _.divide(symbol.clone(), coeff.clone()); //a coeff free symbol\r\n                        //peform a correction for stripVar. This is a serious TODO!\r\n                        if(coeff.contains(dx)) {\r\n                            cfsymbol = _.multiply(cfsymbol, coeff);\r\n                            coeff = new Symbol(1);\r\n                        }\r\n\r\n                        //if we only have one symbol left then let's not waste time. Just pull the integral\r\n                        //and let the chips fall where they may\r\n                        if(cfsymbol.group !== CB) {\r\n                            if(cfsymbol.equals(1)) {\r\n                                return __.integrate(_.expand(symbol), dx, depth);\r\n                            }\r\n\r\n                            //only factor for multivariate which are polynomials\r\n                            if(cfsymbol.clone().toLinear().isPoly(true) && core.Utils.variables(cfsymbol).length > 1) {\r\n                                cfsymbol = core.Algebra.Factor.factor(cfsymbol);\r\n                            }\r\n\r\n                            retval = __.integrate(cfsymbol, dx, depth);\r\n                        }\r\n                        else {\r\n                            //we collect the symbols and sort them descending group, descending power, descending alpabethically\r\n                            var symbols = cfsymbol.collectSymbols().sort(function (a, b) {\r\n                                if(a.group === b.group) {\r\n                                    if(Number(a.power) === Number(b.power))\r\n                                        if(a < b)\r\n                                            return 1; //I want sin first\r\n                                        else\r\n                                            return -1;\r\n                                    return b.power - a.power; //descending power\r\n                                }\r\n                                return b.group - a.group; //descending groups\r\n                            }).map(function (x) {\r\n                                var unwrapped = Symbol.unwrapSQRT(x, true);\r\n                                if(unwrapped.fname === EXP) {\r\n                                    return _.parse(format('({1})*e^({0})', unwrapped.args[0], unwrapped.multiplier));\r\n                                }\r\n                                return unwrapped;\r\n                            });\r\n                            var l = symbols.length;\r\n                            if(symbol.power < 0) {\r\n                                if(l === 2) {\r\n                                    return __.integrate(_.expand(symbol), dx, depth, opt);\r\n                                }\r\n                            }\r\n                            //otherwise the denominator is one lumped together symbol \r\n                            else {\r\n                                //generate an image for \r\n                                if(l === 2) {\r\n                                    //try u substitution\r\n                                    try {\r\n                                        retval = __.integration.u_substitution(symbols, dx);\r\n                                    }\r\n                                    catch(e) {/* failed :`(*/\r\n                                        ;\r\n                                    }\r\n\r\n                                    if(!retval) {\r\n                                        //no success with u substitution so let's try known combinations\r\n                                        //are they two functions\r\n                                        var g1 = symbols[0].group,\r\n                                                g2 = symbols[1].group,\r\n                                                sym1 = symbols[0],\r\n                                                sym2 = symbols[1],\r\n                                                fn1 = sym1.fname,\r\n                                                fn2 = sym2.fname;\r\n                                        //reset the symbol minus the coeff\r\n                                        symbol = _.multiply(sym1.clone(), sym2.clone());\r\n                                        if(g1 === FN && g2 === FN) {\r\n                                            if(fn1 === LOG || fn2 === LOG) {\r\n                                                retval = __.integration.by_parts(symbol.clone(), dx, depth, opt);\r\n                                            }\r\n                                            else {\r\n                                                symbols.sort(function (a, b) {\r\n                                                    return b.fname > a.fname;\r\n                                                });\r\n                                                var arg1 = sym1.args[0];\r\n                                                //make sure the arguments are suitable. We don't know how to integrate non-linear arguments\r\n                                                if(!arg1.isLinear() || !(arg1.group === CP || arg1.group === CB || arg1.group === S))\r\n                                                    __.integration.stop();\r\n\r\n                                                var decomp = __.integration.decompose_arg(arg1, dx);\r\n                                                x = decomp[1],\r\n                                                        a = decomp[0];\r\n                                                if(!x.isLinear()) //again... linear arguments only wrt x\r\n                                                    __.integration.stop();\r\n\r\n                                                //they have to have the same arguments and then we have cleared all the check to \r\n                                                //make sure we can integrate FN & FN\r\n                                                var arg2 = sym2.args[0];\r\n                                                //make sure that their argument matches\r\n                                                if(arg1.equals(arg2)) {\r\n                                                    if(fn1 === SIN && fn2 === COS || fn1 === COS && fn2 === SIN) {\r\n                                                        if(sym1.power.lessThan(0))\r\n                                                            __.integration.stop();//we don't know how to handle, sin(x)^n/cos(x)^m where m > n,  yet\r\n                                                        //if it's in the form sin(x)^n*cos(x)^n then we can just return tan(x)^n which we know how to integrate\r\n                                                        if(fn1 === SIN && sym1.power.add(sym2.power).equals(0)) {\r\n                                                            sym1.fname = TAN;\r\n                                                            sym1.updateHash();\r\n                                                            retval = __.integrate(sym1, dx, depth);\r\n                                                        }\r\n                                                        else {\r\n                                                            if(even(sym1.power) && fn2 === COS && sym2.power.lessThan(0)) {\r\n                                                                //transform sin^(2*n) to (1-cos^2)^n\r\n                                                                var n = Number(sym1.power) / 2,\r\n                                                                        new_sym = _.parse(format('(1-cos({0})^2)^({1})', sym1.args[0], n));\r\n                                                                retval = __.integrate(_.expand(_.multiply(new_sym, sym2.clone())), dx, depth, opt);\r\n                                                            }\r\n                                                            else if(even(sym1.power) && fn2 === SIN && sym2.power.lessThan(0)) {\r\n                                                                //transform cos^(2*n) to (1-sin^2)^n\r\n                                                                var n = Number(sym1.power) / 2,\r\n                                                                        new_sym = _.parse(format('(1-sin({0})^2)^({1})', sym1.args[0], n));\r\n                                                                retval = __.integrate(_.expand(_.multiply(new_sym, sym2.clone())), dx, depth, opt);\r\n                                                            }\r\n                                                            else {\r\n                                                                var p1_even = core.Utils.even(sym1.power),\r\n                                                                        p2_even = core.Utils.even(sym2.power);\r\n                                                                retval = new Symbol(0);\r\n                                                                if(!p1_even || !p2_even) {\r\n                                                                    var u, r, trans;\r\n                                                                    //since cos(x) is odd it carries du. If sin was odd then it would be the other way around\r\n                                                                    //know that p1 satifies the odd portion in this case. If p2 did than it would contain r\r\n                                                                    if(!p1_even) {\r\n                                                                        //u = sin(x)\r\n                                                                        u = sym2;\r\n                                                                        r = sym1;\r\n                                                                    }\r\n                                                                    else {\r\n                                                                        u = sym1;\r\n                                                                        r = sym2;\r\n                                                                    }\r\n                                                                    //get the sign of du. In this case r carries du as stated before and D(cos(x),x) = -sin(x)\r\n                                                                    var sign = u.fname === COS ? -1 : 1,\r\n                                                                            n = r.power,\r\n                                                                            //remove the du e.g. cos(x)^2*sin(x)^3 dx -> cos(x)^2*sin(x)^2*sin(x). We're left with two \r\n                                                                            //even powers afterwards which can be transformed\r\n                                                                            k = (n - 1) / 2,\r\n                                                                            //make the transformation cos(x)^2 = 1 - sin(x)^2\r\n                                                                            trans = _.parse('(1-' + u.fname + core.Utils.inBrackets(arg1) + '^2)^' + k),\r\n                                                                            sym = _.expand(_.multiply(new Symbol(sign), _.multiply(u.clone(), trans)));\r\n                                                                    //we can now just loop through and integrate each since it's now just a polynomial with functions\r\n                                                                    sym.each(function (x) {\r\n                                                                        retval = _.add(retval, __.integration.poly_integrate(x.clone()));\r\n                                                                    });\r\n                                                                }\r\n                                                                else {\r\n                                                                    //performs double angle transformation\r\n                                                                    var double_angle = function (symbol) {\r\n                                                                        var p = symbol.power,\r\n                                                                                k = p / 2, e;\r\n                                                                        if(symbol.fname === COS)\r\n                                                                            e = '((1/2)+(cos(2*(' + symbol.args[0] + '))/2))^' + k;\r\n                                                                        else\r\n                                                                            e = '((1/2)-(cos(2*(' + symbol.args[0] + '))/2))^' + k;\r\n\r\n                                                                        return _.parse(e);\r\n                                                                    };\r\n                                                                    //they're both even so transform both using double angle identities and we'll just\r\n                                                                    //be able to integrate by the sum of integrals\r\n                                                                    var a = double_angle(sym1),\r\n                                                                            b = double_angle(sym2),\r\n                                                                            t = _.multiply(a, b);\r\n                                                                    var sym = _.expand(t);\r\n                                                                    sym.each(function (x) {\r\n                                                                        retval = _.add(retval, __.integrate(x, dx, depth));\r\n                                                                    });\r\n                                                                    return _.multiply(retval, coeff);\r\n                                                                }\r\n                                                            }\r\n                                                        }\r\n                                                    }\r\n                                                    //tan(x)*sec(x)^n \r\n                                                    else if(fn1 === SEC && fn2 === TAN && x.isLinear() && sym2.isLinear()) {\r\n                                                        retval = _.parse(format('sec({0})^({1})/({1})', sym1.args[0], sym1.power));\r\n                                                    }\r\n                                                    else if(fn1 === TAN && fn2 === SEC && x.isLinear()) {\r\n                                                        //remaining: tan(x)^3*sec(x)^6\r\n                                                        if(sym1.isLinear() && sym2.isLinear()) {\r\n                                                            retval = _.divide(_.symfunction(SEC, [arg1.clone()]), a);\r\n                                                        }\r\n                                                        else if(even(sym1.power)) {\r\n                                                            var p = Number(sym1.power) / 2;\r\n                                                            //transform tangent\r\n                                                            var t = _.parse(format('(sec({0})^2-1)^({1})', sym1.args[0], p));\r\n                                                            retval = __.integrate(_.expand(_.multiply(t, sym2)), dx, depth);\r\n                                                        }\r\n                                                        else\r\n                                                            __.integration.stop();\r\n                                                    }\r\n                                                    else if(fn1 === SEC && fn2 === COS) {\r\n                                                        sym1.fname = COS;\r\n                                                        sym1.invert().updateHash();\r\n                                                        retval = __.integrate(_.multiply(sym1, sym2), dx, depth);\r\n                                                    }\r\n                                                    else if(fn1 === SIN && fn2 === CSC) {\r\n                                                        sym2.fname = SIN;\r\n                                                        sym2.invert().updateHash();\r\n                                                        retval = __.integrate(_.multiply(sym1, sym2), dx, depth);\r\n                                                    }\r\n                                                    //tan/cos\r\n                                                    else if(fn1 === TAN && (fn2 === COS || fn2 === SIN) && sym2.power.lessThan(0)) {\r\n                                                        var t = _.multiply(sym1.fnTransform(), sym2);\r\n                                                        retval = __.integrate(_.expand(t), dx, depth);\r\n                                                    }\r\n                                                    else {\r\n                                                        var t = _.multiply(sym1.fnTransform(), sym2.fnTransform());\r\n                                                        retval = __.integrate(_.expand(t), dx, depth);\r\n                                                    }\r\n                                                }\r\n                                                //TODO: In progress\r\n                                                else if((fn1 === SIN || fn1 === COS) && (fn2 === SIN || fn2 === COS)) {\r\n\r\n                                                    if(sym1.isLinear() && sym2.isLinear()) {\r\n                                                        //if in the form cos(a*x)*sin(b*x)\r\n                                                        if(sym1.args[0].isLinear() && sym2.args[0].isLinear()) {\r\n                                                            //use identity (sin(b*x+a*x)+sin(b*x-a*x))/2\r\n                                                            var ax, bx;\r\n                                                            if(fn2 === SIN) {\r\n                                                                ax = sym1.args[0];\r\n                                                                bx = sym2.args[0];\r\n                                                            }\r\n                                                            else {\r\n                                                                bx = sym1.args[0];\r\n                                                                ax = sym2.args[0];\r\n                                                            }\r\n\r\n                                                            //make the transformation\r\n                                                            f = _.parse(format('(sin(({1})+({0}))+sin(({1})-({0})))/2', ax.toString(), bx.toString()));\r\n\r\n                                                            //integrate it\r\n                                                            retval = __.integrate(f, dx, depth);\r\n                                                        }\r\n                                                        else {\r\n                                                            var transformed = trigTransform(symbols);\r\n                                                            retval = __.integrate(_.expand(transformed), dx, depth);\r\n                                                        }\r\n                                                    }\r\n                                                    else {\r\n                                                        var transformed = new Symbol(1);\r\n                                                        symbols.map(function (sym) {\r\n                                                            var s = sym.fnTransform();\r\n                                                            transformed = _.multiply(transformed, s);\r\n                                                        });\r\n                                                        var t = _.expand(transformed);\r\n\r\n                                                        retval = __.integrate(t, dx, depth);\r\n\r\n                                                        if(retval.hasIntegral()) {\r\n                                                            retval = __.integrate(trigTransform(transformed.collectSymbols()), dx, depth);\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                                else {\r\n                                                    __.integration.stop();\r\n                                                }\r\n\r\n                                            }\r\n                                        }\r\n                                        else if(g1 === FN && g2 === S) {\r\n                                            var sym1_is_linear = sym1.isLinear();\r\n                                            if(sym1.fname === COS && sym1_is_linear && sym2.power.equals(-1))\r\n                                                retval = _.symfunction('Ci', [sym1.args[0]]);\r\n                                            else if(sym1.fname === COS && sym2.power.equals(-1)) {\r\n                                                retval = __.integrate(_.multiply(sym1.fnTransform(), sym2.clone()), dx, depth);\r\n                                            }\r\n                                            else if(sym1.fname === COSH && sym1_is_linear && sym2.power.equals(-1))\r\n                                                retval = _.symfunction('Chi', [sym1.args[0]]);\r\n                                            else if(sym1.fname === COSH && sym2.power.equals(-1)) {\r\n                                                retval = __.integrate(_.multiply(sym1.fnTransform(), sym2.clone()), dx, depth);\r\n                                            }\r\n                                            else if(sym1.fname === SIN && sym1_is_linear && sym2.power.equals(-1))\r\n                                                retval = _.symfunction('Si', [sym1.args[0]]);\r\n                                            else if(sym1.fname === SIN && sym2.power.equals(-1)) {\r\n                                                retval = __.integrate(_.multiply(sym1.fnTransform(), sym2.clone()), dx, depth);\r\n                                            }\r\n                                            else if(sym1.fname === SINH && sym1_is_linear && sym2.power.equals(-1))\r\n                                                retval = _.symfunction('Shi', [sym1.args[0]]);\r\n                                            else if(sym1.fname === SINH && sym2.power.equals(-1)) {\r\n                                                retval = __.integrate(_.multiply(sym1.fnTransform(), sym2.clone()), dx, depth);\r\n                                            }\r\n                                            else if(sym1.fname === LOG && sym2.power.equals(-1)) {\r\n                                                //log(x)^n/x = log(x)^(n+1)/(n+1)\r\n                                                retval = __.integration.poly_integrate(sym1, dx, depth);\r\n                                            }\r\n                                            else if(sym1.fname === 'erf') {\r\n                                                if(sym2.power.equals(1)) {\r\n                                                    var dc = __.integration.decompose_arg(sym1.args[0], dx),\r\n                                                            a_ = dc[0],\r\n                                                            x_ = dc[1],\r\n                                                            arg = sym1.args[0].toString();\r\n                                                    retval = _.parse(format('(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)', a_, x_, arg))\r\n                                                }\r\n                                            }\r\n                                            else {\r\n                                                //since group S is guaranteed convergence we need not worry about tracking depth of integration\r\n                                                retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                            }\r\n                                        }\r\n                                        else if(g1 === EX && g2 === S) {\r\n                                            var x = fn1 === LOG ? __.integration.decompose_arg(sym1.args[0], dx)[1] : null;\r\n                                            if(sym1.isE() && (sym1.power.group === S || sym1.power.group === CB) && sym2.power.equals(-1)) {\r\n                                                retval = _.symfunction('Ei', [sym1.power.clone()]);\r\n                                            }\r\n                                            else if(fn1 === LOG && x.value === sym2.value) {\r\n                                                retval = __.integration.poly_integrate(sym1, dx, depth);\r\n                                            }\r\n                                            else\r\n                                                retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                        }\r\n                                        else if(g1 === PL && g2 === S) {\r\n                                            //first try to reduce the top\r\n                                            if(sym2.value === sym1.value && sym1.power.equals(-1)) {\r\n                                                //find the lowest power in the denominator\r\n                                                var pd = Math.min.apply(null, core.Utils.keys(sym1.symbols));\r\n                                                //get the lowest common value between denominator and numerator\r\n                                                var pc = Math.min(pd, sym2.power);\r\n                                                //reduce both denominator and numerator by that factor\r\n                                                var factor = sym2.clone();\r\n                                                factor.power = new Frac(pc);\r\n                                                sym2 = _.divide(sym2, factor.clone()); //reduce the denominator\r\n                                                var t = new Symbol(0);\r\n                                                sym1.each(function (x) {\r\n                                                    t = _.add(t, _.divide(x.clone(), factor.clone()));\r\n                                                });\r\n                                                t.multiplier = sym1.multiplier;\r\n                                                symbol = _.divide(sym2, t);\r\n                                            }\r\n                                            else {\r\n                                                symbol = _.expand(symbol);\r\n                                            }\r\n                                            retval = __.integration.partial_fraction(symbol, dx, depth);\r\n                                        }\r\n                                        else if(g1 === CP && g2 === S) {\r\n                                            var f = sym1.clone().toLinear(),\r\n                                                    f_is_linear = core.Algebra.degree(f, _.parse(dx)).equals(1);\r\n                                            //handle cases x^(2*n)/sqrt(1-x^2)\r\n                                            if(sym1.power.equals(-1 / 2)) {\r\n                                                var decomp = __.integration.decompose_arg(sym1.clone().toLinear(), dx);\r\n                                                var a = decomp[0].negate(),\r\n                                                        x = decomp[1],\r\n                                                        b = decomp[3],\r\n                                                        p1 = Number(sym1.power),\r\n                                                        p2 = Number(sym2.power);\r\n                                                if(isInt(p2) && core.Utils.even(p2) && x.power.equals(2)) {\r\n                                                    //if the substitution \r\n                                                    var c = _.divide(_.multiply(_.pow(b.clone(), new Symbol(2)),\r\n                                                            _.symfunction(SQRT, [_.divide(b.clone(), a.clone())])),\r\n                                                            _.pow(a.clone(), new Symbol(2)));\r\n                                                    c = _.multiply(c, _.symfunction(SQRT, [b]).invert());\r\n                                                    var dummy = _.parse('sin(u)');\r\n                                                    dummy.power = dummy.power.multiply(sym2.power);\r\n                                                    var integral = __.integrate(dummy, 'u', depth);\r\n                                                    var bksub = _.parse(ASIN + '(' + SQRT + '(' + a + '/' + b + ')*' + dx + ')');\r\n                                                    retval = _.multiply(c, integral.sub(new Symbol('u'), bksub));\r\n                                                }\r\n                                                else if(p1 === -1 / 2) {\r\n                                                    var u_transform = function (f, u) {\r\n                                                        var integral = _.parse(__.integrate(f, dx, depth, opt).sub(dx, format(u, dx)));\r\n                                                        if(!integral.hasIntegral())\r\n                                                            return integral;\r\n                                                    }\r\n                                                    if(p2 === -1) {\r\n                                                        retval = u_transform(\r\n                                                                _.expand(_.expand(_.pow(_.multiply(sym1.invert(), sym2.invert()), new Symbol(2)))).invert(),\r\n                                                                'sqrt(1-1/({0})^2)'\r\n                                                                );\r\n                                                    }\r\n                                                    else if(p2 === -2) {\r\n                                                        //apply transformation to see if it matches asin(x)\r\n                                                        retval = u_transform(\r\n                                                                _.sqrt(_.expand(_.divide(_.pow(symbol, new Symbol(2)).invert(), _.pow(new Symbol(dx), new Symbol(2))).negate())).invert(),\r\n                                                                'sqrt(1-1/({0})^2)'\r\n                                                                );\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                            else if(sym1.power.equals(-1) && sym2.isLinear() && f_is_linear) {\r\n                                                retval = __.integration.partial_fraction(symbol, dx, depth);\r\n                                            }\r\n                                            else if(!sym1.power.lessThan(0) && isInt(sym1.power)) {\r\n                                                //sum of integrals\r\n                                                var expanded = _.expand(sym1);\r\n                                                retval = new Symbol(0);\r\n                                                expanded.each(function (x) {\r\n                                                    if(x.group === PL) {\r\n                                                        x.each(function (y) {\r\n                                                            retval = _.add(retval, __.integrate(_.multiply(sym2.clone(), y), dx, depth));\r\n                                                        });\r\n                                                    }\r\n                                                    else\r\n                                                        retval = _.add(retval, __.integrate(_.multiply(sym2.clone(), x), dx, depth));\r\n                                                });\r\n                                            }\r\n                                            else if(sym1.power.lessThan(-2)) {\r\n                                                retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                            }\r\n                                            else if(sym1.power.lessThan(0) && sym2.power.greaterThan(1)) {\r\n                                                var decomp = __.integration.decompose_arg(sym1.clone().toLinear(), dx),\r\n                                                        a = decomp[0].negate(),\r\n                                                        x = decomp[1],\r\n                                                        b = decomp[3],\r\n                                                        fn = sym1.clone().toLinear();\r\n\r\n                                                if(x.group !== PL && x.isLinear()) {\r\n                                                    var p = Number(sym2.power),\r\n                                                            du = '_u_',\r\n                                                            u = new Symbol(du),\r\n                                                            //pull the integral with the subsitution\r\n                                                            U = _.expand(_.divide(_.pow(_.subtract(u.clone(), b.clone()), new Symbol(p)), u.clone())),\r\n                                                            scope = {};\r\n\r\n                                                    //generate a scope for resubbing the symbol\r\n                                                    scope[du] = fn;\r\n                                                    var U2 = _.parse(U, scope);\r\n                                                    retval = __.integrate(U2, dx, 0);\r\n                                                }\r\n                                                else if(sym2.power.greaterThan(x.power) || sym2.power.equals(x.power)) {\r\n\r\n                                                    //factor out coefficients\r\n                                                    var factors = new core.Algebra.Classes.Factors();\r\n                                                    sym1 = core.Algebra.Factor.coeffFactor(sym1.invert(), factors);\r\n                                                    var div = core.Algebra.divide(sym2, sym1);\r\n                                                    //it assumed that the result will be of group CB\r\n                                                    if(div.group !== CB) {\r\n                                                        retval = new Symbol(0);\r\n                                                        div.each(function (t) {\r\n                                                            retval = _.add(retval, __.integrate(t, dx, depth));\r\n                                                        });\r\n                                                        //put back the factors\r\n                                                        factors.each(function (factor) {\r\n                                                            retval = _.divide(retval, factor);\r\n                                                        });\r\n\r\n                                                        retval = _.expand(retval);\r\n                                                    }\r\n                                                    else {\r\n                                                        //try something else\r\n                                                        retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                                    }\r\n                                                }\r\n                                                else\r\n                                                    retval = __.integration.partial_fraction(symbol, dx, depth);\r\n                                            }\r\n                                            else {\r\n                                                //handle cases such as (1-x^2)^(n/2)*x^(m) where n is odd ___ cracking knuckles... This can get a little hairy \r\n                                                if(sym1.power.den.equals(2)) {\r\n                                                    //assume the function is in the form (a^2-b*x^n)^(m/2)\r\n                                                    var dc = __.integration.decompose_arg(sym1.clone().toLinear(), dx),\r\n                                                            //using the above definition\r\n                                                            a = dc[3], x = dc[1], b = dc[0], bx = dc[2];\r\n                                                    if(x.power.equals(2) && b.lessThan(0)) { //if n is even && b is negative\r\n                                                        //make a equal 1 so we can do a trig sub\r\n                                                        if(!a.equals(1)) { //divide a out of everything\r\n                                                            //move a to the coeff\r\n                                                            coeff = _.multiply(coeff, _.pow(a, new Symbol(2)));\r\n                                                        }\r\n                                                        var u = dx;\r\n                                                        var c = _.divide(_.pow(b.clone().negate(), new Symbol(1 / 2)), _.pow(a, new Symbol(1 / 2))),\r\n                                                                du = _.symfunction(COS, [new Symbol(u)]),\r\n                                                                cosn = _.pow(_.symfunction(COS, [new Symbol(u)]), new Symbol(sym1.power.num)),\r\n                                                                X = _.pow(_.symfunction(SIN, [new Symbol(u)]), new Symbol(sym2.power)),\r\n                                                                val = _.multiply(_.multiply(cosn, du), X),\r\n                                                                integral = __.integrate(val, u, depth);\r\n                                                        //but remember that u = asin(sqrt(b)*a*x)\r\n                                                        retval = integral.sub(u, _.symfunction(ASIN, [_.multiply(new Symbol(dx), c)]));\r\n                                                    }\r\n                                                    else {\r\n                                                        retval = __.integration.partial_fraction(symbol, dx, depth, opt);\r\n                                                    }\r\n                                                }\r\n                                                else if(f_is_linear) {\r\n                                                    retval = __.integration.partial_fraction(symbol, dx, depth);\r\n                                                }\r\n                                            }\r\n\r\n                                        }\r\n                                        else if(sym1.isComposite() && sym2.isComposite()) {\r\n                                            //sum of integrals\r\n                                            retval = new Symbol(0);\r\n                                            if(sym1.power.greaterThan(0) && sym2.power.greaterThan(0)) {\r\n                                                //combine and pull the integral of each\r\n                                                var sym = _.expand(symbol);\r\n                                                sym.each(function (x) {\r\n                                                    retval = _.add(retval, __.integrate(x, dx, depth));\r\n                                                }, true);\r\n                                            }\r\n                                            else {\r\n                                                var p1 = Number(sym1.power),\r\n                                                        p2 = Number(sym2.power);\r\n                                                if(p1 < 0 && p2 > 0) {\r\n                                                    //swap\r\n                                                    var t = sym1;\r\n                                                    sym1 = sym2;\r\n                                                    sym2 = t;\r\n                                                }\r\n                                                if(p1 === -1 && p2 === -1) {\r\n                                                    retval = __.integration.partial_fraction(symbol, dx);\r\n                                                }\r\n                                                else {\r\n                                                    sym1.each(function (x) {\r\n                                                        var k = _.multiply(x, sym2.clone());\r\n                                                        var integral = __.integrate(k, dx, depth);\r\n                                                        retval = _.add(retval, integral);\r\n                                                    });\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                        else if(g1 === CP && symbols[0].power.greaterThan(0)) {\r\n                                            sym1 = _.expand(sym1);\r\n                                            retval = new Symbol(0);\r\n                                            sym1.each(function (x) {\r\n                                                retval = _.add(retval, __.integrate(_.multiply(x, sym2.clone()), dx, depth));\r\n                                            }, true);\r\n                                        }\r\n                                        else if(g1 === FN && g2 === EX && core.Utils.in_htrig(sym1.fname)) {\r\n                                            sym1 = sym1.fnTransform();\r\n                                            retval = __.integrate(_.expand(_.multiply(sym1, sym2)), dx, depth);\r\n                                        }\r\n                                        else if(g1 === FN && g2 === CP || g2 === FN && g1 === CP) {\r\n                                            if(g2 === FN && g1 === CP) {\r\n                                                var t = sym1;\r\n                                                sym1 = sym2;\r\n                                                sym2 = t; //swap\r\n                                            }\r\n                                            var du, sym2_clone, p, q, sa, sb;\r\n                                            du = Symbol.unwrapSQRT(__.diff(sym1.clone(), dx), true);\r\n                                            sym2_clone = Symbol.unwrapSQRT(sym2, true);\r\n                                            if(du.power.equals(sym2_clone.power)) {\r\n                                                p = new Symbol(sym2.power);\r\n                                                sa = du.clone().toLinear();\r\n                                                sb = sym2.clone().toLinear();\r\n                                                q = core.Algebra.divide(sa.toLinear(), sb);\r\n                                                if(q.isConstant()) {\r\n                                                    var nq = _.pow(q, p.negate());\r\n                                                    retval = _.multiply(nq, __.integration.poly_integrate(sym1.clone()));\r\n                                                }\r\n                                            }\r\n                                            else {\r\n                                                retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                            }\r\n                                        }\r\n                                        else {\r\n                                            var syma = sym1.clone().toLinear();\r\n                                            var symb = sym2.clone().toLinear();\r\n                                            if(g1 === EX && g2 === EX && sym1.power.contains(dx) && sym2.power.contains(dx)\r\n                                                    && !syma.contains(dx) && !symb.contains(dx)) {\r\n                                                retval = _.parse(format('(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))',\r\n                                                        syma.toString(),\r\n                                                        symb.toString(),\r\n                                                        sym1.power.multiplier.toString(),\r\n                                                        sym2.power.multiplier.toString(),\r\n                                                        dx\r\n                                                        ));\r\n                                            }\r\n                                            else\r\n                                                retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                        }\r\n                                    }\r\n                                }\r\n                                else if(l === 3 && (symbols[2].group === S && symbols[2].power.lessThan(2) || symbols[0].group === CP)) {\r\n                                    var first = symbols[0];\r\n                                    if(first.group === CP) { //TODO {support higher powers of x in the future}\r\n                                        if(first.power.greaterThan(1))\r\n                                            first = _.expand(first);\r\n                                        var r = _.multiply(symbols[1], symbols[2]);\r\n                                        retval = new Symbol(0);\r\n                                        first.each(function (x) {\r\n                                            var t = _.multiply(x, r.clone());\r\n                                            var intg = __.integrate(t, dx, depth);\r\n                                            retval = _.add(retval, intg);\r\n                                        }, true);\r\n                                    }\r\n                                    else {\r\n                                        //try integration by parts although technically it will never work\r\n                                        retval = __.integration.by_parts(symbol, dx, depth, opt);\r\n                                    }\r\n\r\n                                }\r\n                                else if(all_functions(symbols)) {\r\n                                    var t = new Symbol(1);\r\n                                    for(var i = 0, l = symbols.length; i < l; i++) {\r\n                                        t = _.multiply(t, symbols[i].fnTransform());\r\n                                    }\r\n                                    t = _.expand(t);\r\n                                    retval = __.integrate(t, dx, depth);\r\n                                }\r\n                                else {\r\n                                    //one more go\r\n                                    var transformed = trigTransform(symbols);\r\n                                    retval = __.integrate(_.expand(transformed), dx, depth);\r\n                                }\r\n                            }\r\n\r\n                        }\r\n\r\n                        retval = _.multiply(retval, coeff);\r\n                    }\r\n                    //if an integral was found then we return it\r\n                    if(retval)\r\n                        return retval;\r\n                }\r\n\r\n                catch(error) {\r\n                    //do nothing if it's a NoIntegralFound error otherwise let it bubble\r\n                    if(!(error instanceof NoIntegralFound || error instanceof core.exceptions.DivisionByZero))\r\n                        throw error;\r\n                }\r\n\r\n                //no symbol found so we return the integral again\r\n                return _.symfunction('integrate', [original_symbol, dt]);\r\n            }, false);\r\n        },\r\n        defint: function (symbol, from, to, dx) {\r\n            dx = dx || 'x'; //make x the default variable of integration\r\n            var get_value = function (integral, vars, point) {\r\n                try {\r\n                    return _.parse(integral, vars);\r\n                }\r\n                catch(e) {\r\n                    //it failed for some reason so return the limit\r\n                    var lim = __.Limit.limit(integral, dx, point);\r\n                    return lim;\r\n                }\r\n            };\r\n\r\n            var vars = core.Utils.variables(symbol),\r\n                    hasTrig = symbol.hasTrig();\r\n            var retval, integral;\r\n\r\n            // Fix #593 - Only assume the first variable if dx is not defined.\r\n            if(vars.length === 1 && !dx)\r\n                dx = vars[0];\r\n\r\n            if(!hasTrig) {\r\n                integral = __.integrate(symbol, dx);\r\n            }\r\n\r\n            if(!hasTrig && !integral.hasIntegral()) {\r\n                var upper = {},\r\n                        lower = {},\r\n                        a, b;\r\n                upper[dx] = to;\r\n                lower[dx] = from;\r\n\r\n                a = get_value(integral, upper, to, dx);\r\n                b = get_value(integral, lower, from, dx);\r\n                retval = _.subtract(a, b);\r\n            }\r\n            else if(vars.length === 1 && from.isConstant() && to.isConstant()) {\r\n\r\n                var f = core.Utils.build(symbol);\r\n                retval = new Symbol(core.Math2.num_integrate(f, Number(from), Number(to)));\r\n            }\r\n            else\r\n                retval = _.symfunction('defint', [symbol, from, to, dx]);\r\n            return retval;\r\n        },\r\n\r\n        Limit: {\r\n            interval: function (start, end) {\r\n                return _.parse(format('[{0}, {1}]', start, end));\r\n            },\r\n            diverges: function () {\r\n                return __.Limit.interval('-Infinity', 'Infinity');\r\n            },\r\n            divide: function (f, g, x, lim, depth) {\r\n                if(depth++ > Settings.max_lim_depth) {\r\n                    return;\r\n                }\r\n\r\n                var fin = f.clone(), gin = g.clone();\r\n\r\n                //But first a little \"cheating\". x/|x| ends up in an infinite loop since the d/dx |x| -> x/|x|\r\n                //To break this loop we simply provide the answer. Keep in mind that currently limit only provides\r\n                //the two-sided limit.\r\n                //Known limit\r\n                if(g.fname === ABS) {\r\n                    var sign = f.sign();\r\n                    var lim_sign = lim.sign();\r\n\r\n                    if(lim.isInfinity)\r\n                        return _.multiply(new Symbol(sign), new Symbol(lim_sign));\r\n\r\n                    else if(lim.equals(0)) {\r\n                        var fm = _.parse(f.multiplier);\r\n                        var gm = _.parse(g.multiplier);\r\n                        return _.divide(_.multiply(fm, __.Limit.interval('-1', '1')), gm);\r\n                    }\r\n                    else {\r\n                        //TODO: Support more limits\r\n                        __.Limit.diverges();\r\n                    }\r\n                }\r\n\r\n                var isInfinity = function (L) {\r\n                    if(core.Utils.isVector(L)) {\r\n                        for(var i = 0; i < L.elements.length; i++)\r\n                            if(!L.elements[i].isInfinity)\r\n                                return false;\r\n                        return true;\r\n                    }\r\n                    return L.isInfinity;\r\n                };\r\n\r\n                var equals = function (L, v) {\r\n                    if(core.Utils.isVector(L)) {\r\n                        return false;\r\n                    }\r\n                    return L.equals(v);\r\n                };\r\n\r\n                var retval;\r\n                do {\r\n                    var lim1 = evaluate(__.Limit.limit(f.clone(), x, lim, depth));\r\n                    var lim2 = evaluate(__.Limit.limit(g.clone(), x, lim, depth));\r\n\r\n                    //if it's in indeterminate form apply L'Hospital's rule\r\n                    var indeterminate = isInfinity(lim1) && isInfinity(lim2) || equals(lim1, 0) && equals(lim2, 0);\r\n                    //pull the derivatives\r\n                    if(indeterminate) {\r\n                        var ft = __.diff(f.clone(), x);\r\n                        var gt = __.diff(g.clone(), x);\r\n\r\n                        var t_symbol = _.expand(_.divide(ft, gt));\r\n                        f = t_symbol.getNum();\r\n                        g = t_symbol.getDenom();\r\n\r\n                    }\r\n                }\r\n                while(indeterminate)\r\n\r\n                //REMEMBER: \r\n                //- 1/cos(x)\r\n                //n/0 is still possible since we only checked for 0/0\r\n                var den_is_zero = lim2.equals(0);\r\n                var p = Number(gin.power);\r\n\r\n                if(lim.isConstant(true) && den_is_zero) {\r\n                    retval = Symbol.infinity(core.Utils.even(p) && lim1.lessThan(0) ? -1 : undefined);\r\n                }\r\n                else if(den_is_zero) {\r\n                    retval = __.Limit.diverges();\r\n                }\r\n                else {\r\n                    retval = _.divide(lim1, lim2);\r\n                }\r\n\r\n                return retval;\r\n            },\r\n            rewriteToLog: function (symbol) {\r\n                var p = symbol.power.clone();\r\n                symbol.toLinear();\r\n                return _.pow(new Symbol('e'), _.multiply(p, _.symfunction(Settings.LOG + '', [symbol])));\r\n            },\r\n            getSubbed: function (f, x, lim) {\r\n                var retval;\r\n                //1. rewrite EX with base e\r\n                if(f.group === EX) {\r\n                    f = __.rewriteToLog(f);\r\n                }\r\n                //2. try simple substitution\r\n                try {\r\n                    retval = f.sub(x, lim);\r\n                }\r\n                catch(e) {\r\n                    //Nope. No go, so just return the unsubbed function so we can test the limit instead.\r\n                    retval = f;\r\n                }\r\n\r\n                return retval;\r\n            },\r\n            isInterval: function (limit) {\r\n                return core.Utils.isVector(limit);\r\n            },\r\n            isConvergent: function (limit) {\r\n                //it's not convergent if it lies on the interval -Infinity to Infinity\r\n                if(\r\n                        //It lies on the interval -Infinity to Infinity\r\n                        __.Limit.isInterval(limit) && limit.elements[0].isInfinity && limit.elements[1].isInfinity ||\r\n                        //We weren't able to calculate the limit\r\n                        limit.containsFunction('limit')\r\n                        ) {\r\n                    return false; //Then no\r\n                }\r\n                return true; //It is\r\n            },\r\n            limit: function (symbol, x, lim, depth) {\r\n                //Simplify the symbol\r\n                if(symbol.isLinear() && symbol.isComposite()) {\r\n\r\n                    //Apply sum of limits\r\n                    var limit = new Symbol(0);\r\n                    symbol.each(function (s) {\r\n                        limit = _.add(limit, __.Limit.limit(s, x, lim, depth));\r\n                    }, true);\r\n\r\n                    return limit;\r\n                }\r\n                ;\r\n\r\n                symbol = core.Algebra.Simplify.simplify(symbol);\r\n\r\n                depth = depth || 1;\r\n\r\n                if(depth++ > Settings.max_lim_depth) {\r\n                    return;\r\n                }\r\n\r\n                //store the multiplier\r\n                var m = _.parse(symbol.multiplier);\r\n                //strip the multiplier\r\n                symbol.toUnitMultiplier();\r\n                try {\r\n                    //https://en.wikipedia.org/wiki/List_of_limits\r\n                    var retval;\r\n                    //we try the simplest option first where c is some limit\r\n                    //lim a as x->c = a where c \r\n                    if(symbol.isConstant(true)) {\r\n                        retval = symbol;\r\n                    }\r\n                    else {\r\n                        var point = {};\r\n                        point[x] = lim;\r\n                        //lim x as x->c = c where c\r\n\r\n                        try {\r\n\r\n                            //evaluate the function at the given limit\r\n                            var t = _.parse(symbol.sub(x, lim), point);\r\n\r\n                            //a constant or infinity is known so we're done\r\n                            if(t.isConstant(true) || t.isInfinity)\r\n                                retval = t;\r\n\r\n                        }\r\n                        catch(e) { /*Nothing. Maybe we tried to divide by zero.*/\r\n                        }\r\n                        ;\r\n\r\n                        if(!retval) {\r\n                            //split the symbol in the numerator and the denominator\r\n                            var num = symbol.getNum();\r\n                            var den = symbol.getDenom();\r\n\r\n                            if(den.isConstant(true)) {\r\n                                //We still don't have a limit so we generate tests.\r\n                                if(symbol.group === EX) {\r\n                                    //https://en.wikipedia.org/wiki/List_of_limits\r\n                                    //Speed boost for exponentials by detecting patterns\r\n                                    var f = symbol.clone().toLinear();\r\n                                    var p = symbol.power.clone();\r\n                                    var _num = f.getNum();\r\n                                    var _den = f.getDenom();\r\n                                    var fn = core.Utils.decompose_fn(_den, x, true);\r\n                                    //start detection of pattern (x/(x+1))^x\r\n                                    if(_num.group === S && _num.multiplier.isOne() && fn.ax.group === S && fn.b.isConstant(true) && fn.a.isOne() && fn.b.isConstant(true)) {\r\n                                        retval = _.parse(format('(1/e^({0}))', fn.b));\r\n                                    }\r\n                                    else {\r\n                                        var symbol_ = __.Limit.rewriteToLog(symbol.clone());\r\n                                        //get the base\r\n                                        var pow = symbol_.power.clone();\r\n                                        var base = symbol_.clone().toLinear();\r\n                                        var lim_base = __.Limit.limit(base, x, lim, depth);\r\n                                        var lim_pow = __.Limit.limit(pow, x, lim, depth);\r\n                                        retval = _.pow(lim_base, lim_pow);\r\n                                    }\r\n                                }\r\n                                else if(symbol.group === FN && symbol.args.length === 1) {\r\n                                    var evaluates;\r\n                                    //Squeeze theorem lim f(g(x)) = lim f(lim g))\r\n                                    var arg = __.Limit.limit(symbol.args[0], x, lim, depth);\r\n                                    if(core.Utils.isVector(arg)) {\r\n                                        //get the limit over that interval\r\n                                        retval = arg.map(function (e) {\r\n                                            var clone = symbol.clone();\r\n                                            clone.args[0] = e;\r\n                                            return __.Limit.limit(_.symfunction(symbol.fname, [e]), x, lim, depth);\r\n                                        });\r\n\r\n                                        return _.multiply(m, retval);\r\n                                    }\r\n                                    //if the argument is constant then we're done\r\n                                    else if(arg.isConstant(true)) {\r\n\r\n                                        //double check that it evaluates\r\n                                        var trial = _.symfunction(symbol.fname, [arg]);\r\n                                        //trial evaluation\r\n                                        try {\r\n                                            evaluate(trial);\r\n                                            evaluates = true;\r\n                                        }\r\n                                        catch(e) {\r\n\r\n                                            evaluates = false;\r\n                                        }\r\n                                    }\r\n                                    if(evaluates) {\r\n                                        retval = trial;\r\n                                    }\r\n                                    else {\r\n                                        //if the limit converges. We'll deal with non-convergent ones later\r\n                                        if(__.Limit.isConvergent(arg)) {\r\n                                            if(symbol.fname === LOG) {\r\n                                                switch(arg.toString()) {\r\n                                                    //lim -> 0\r\n                                                    case '0':\r\n                                                        retval = Symbol.infinity().negate();\r\n                                                        break;\r\n                                                    case 'Infinity':\r\n                                                        retval = Symbol.infinity();\r\n                                                        break;\r\n                                                    case '-Infinity':\r\n                                                        retval = Symbol.infinity();\r\n                                                        break;\r\n                                                }\r\n                                            }\r\n                                            else if((symbol.fname === COS || symbol.fname === SIN) && lim.isInfinity) {\r\n                                                retval = __.Limit.interval(-1, 1);\r\n                                            }\r\n                                            else if((symbol.fname === TAN)) {\r\n                                                var s_arg = symbol.args[0];\r\n                                                var n = s_arg.getNum();\r\n                                                var d = s_arg.getDenom();\r\n                                                var pi = n.toUnitMultiplier();\r\n                                                if(lim.isInfinity || pi.equals('pi') && d.equals(2)) {\r\n                                                    retval = divergent();\r\n                                                }\r\n                                            }\r\n                                            else if(symbol.fname === Settings.FACTORIAL) {\r\n                                                if(arg.isInfinity)\r\n                                                    return Symbol.infinity();\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                                else if(symbol.group === S) {\r\n                                    if(symbol.power > 0)\r\n                                        //these functions always converge to the limit\r\n                                        return _.parse(symbol, point);\r\n                                    else {\r\n                                        //we're dealing with 1/x^n but remember that infinity has already been dealt\r\n                                        //with by substitution\r\n                                        if(core.Utils.even(symbol.power)) {\r\n                                            //even powers converge to infinity\r\n                                            retval = Symbol.infinity();\r\n                                        }\r\n                                        else {\r\n                                            //odd ones don't\r\n                                            retval = __.Limit.diverges();\r\n                                        }\r\n                                    }\r\n                                }\r\n                                else if(symbol.group === CB) {\r\n\r\n                                    var lim1, lim2;\r\n                                    //loop through all the symbols\r\n                                    //thus => lim f*g*h = lim (f*g)*h = (lim f*g)*(lim h)\r\n                                    //symbols of lower groups are generally easier to differentiatee so get them to the right by first sorting\r\n                                    var symbols = symbol.collectSymbols().sort(function (a, b) {\r\n                                        return a.group - b.group;\r\n                                    });\r\n\r\n                                    var f = symbols.pop();\r\n                                    //calculate the first limit so we can keep going down the list\r\n                                    lim1 = evaluate(__.Limit.limit(f, x, lim, depth));\r\n\r\n                                    //reduces all the limits one at a time\r\n                                    while(symbols.length) {\r\n                                        //get the second limit\r\n                                        var g = symbols.pop();\r\n                                        //get the limit of g\r\n                                        lim2 = evaluate(__.Limit.limit(g, x, lim, depth));\r\n\r\n                                        //if the limit is in indeterminate form aplly L'Hospital by inverting g and then f/(1/g)\r\n                                        if((lim1.isInfinity || !__.Limit.isConvergent(lim1) && lim2.equals(0) || lim1.equals(0) && __.Limit.isConvergent(lim2))) {\r\n                                            if(g.containsFunction(LOG)) {\r\n                                                //swap them\r\n                                                g = [f, f = g][0];\r\n                                            }\r\n                                            //invert the symbol\r\n                                            g.invert();\r\n\r\n                                            // Product of infinities\r\n                                            if(lim1.isInfinity && lim2.isInfinity) {\r\n                                                lim1 = Symbol.infinity()\r\n                                            }\r\n                                            else {\r\n                                                lim1 = __.Limit.divide(f, g, x, lim, depth);\r\n                                            }\r\n                                        }\r\n                                        else {\r\n                                            //lim f*g = (lim f)*(lim g)\r\n                                            lim1 = _.multiply(lim1, lim2);\r\n                                            //let f*g equal f and h equal g \r\n                                            f = _.multiply(f, g);\r\n                                        }\r\n                                    }\r\n\r\n                                    //Done, lim1 is the limit we're looking for     \r\n                                    retval = lim1;\r\n                                }\r\n                                else if(symbol.isComposite()) {\r\n                                    var _lim;\r\n                                    if(!symbol.isLinear())\r\n                                        symbol = _.expand(symbol);\r\n                                    //Apply lim f+g = (lim f)+(lim g)\r\n                                    retval = new Symbol(0);\r\n\r\n                                    var symbols = symbol.collectSymbols().sort(function (a, b) {\r\n                                        return b.group - a.group;\r\n                                    });\r\n\r\n                                    var _symbols = [];\r\n                                    //Analyze the functions first\r\n                                    var fns = new Symbol(0);\r\n                                    for(var i = 0, l = symbols.length; i < l; i++) {\r\n                                        var sym = symbols[i].clone();\r\n                                        if(sym.group === FN || sym.group === CB && sym.hasFunc()) {\r\n                                            fns = _.add(fns, sym);\r\n                                        }\r\n                                        else\r\n                                            _symbols.push(sym);\r\n                                    }\r\n                                    _symbols.unshift(fns);\r\n\r\n                                    //make sure that we didn't just repackage the exact same symbol\r\n                                    if(_symbols.length !== 1) {\r\n                                        symbols = _symbols;\r\n                                    }\r\n\r\n                                    for(var i = 0, l = symbols.length; i < l; i++) {\r\n                                        var sym = symbols[i];\r\n                                        //If the addition of the limits is undefined then the limit diverges so return -infinity to infinity\r\n                                        try {\r\n                                            _lim = __.Limit.limit(sym, x, lim, depth);\r\n                                        }\r\n                                        catch(e) {\r\n                                            _lim = __.Limit.diverges();\r\n                                        }\r\n\r\n                                        try {\r\n                                            retval = _.add(retval, _lim);\r\n                                        }\r\n                                        catch(e) {\r\n                                            if(depth++ > Settings.max_lim_depth) {\r\n                                                return;\r\n                                            }\r\n                                            ;\r\n                                            retval = __.Limit.limit(__.diff(symbol, x), x, lim, depth);\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                            else {\r\n                                retval = __.Limit.divide(num, den, x, lim, depth);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    //if we still don't have a solution\r\n                    if(!retval)\r\n                        //return it symbolically\r\n                        retval = _.symfunction('limit', [symbol, x, lim]);\r\n                }\r\n                catch(e) {\r\n                    //if all else fails return the symbolic function\r\n                    retval = _.symfunction('limit', [symbol, x, lim]);\r\n                }\r\n\r\n                return _.multiply(m, retval);\r\n            }\r\n        },\r\n        Fresnel: {\r\n            S: function (x) {\r\n                if(x.isConstant(true)) {\r\n                    return __.defint(_.parse('sin(pi*x^2/2)'), Symbol(0), x, 'x');\r\n                }\r\n                return _.symfunction('S', arguments);\r\n            },\r\n            C: function (x) {\r\n                if(x.isConstant(true)) {\r\n                    return __.defint(_.parse('cos(pi*x^2/2)'), Symbol(0), x, 'x');\r\n                }\r\n                return _.symfunction('C', arguments);\r\n            }\r\n        }\r\n    };\r\n\r\n    nerdamer.register([\r\n        {\r\n            name: 'diff',\r\n            visible: true,\r\n            numargs: [1, 3],\r\n            build: function () {\r\n                return __.diff;\r\n            }\r\n        },\r\n        {\r\n            name: 'sum',\r\n            visible: true,\r\n            numargs: 4,\r\n            build: function () {\r\n                return __.sum;\r\n            }\r\n        },\r\n        {\r\n            name: 'product',\r\n            visible: true,\r\n            numargs: 4,\r\n            build: function () {\r\n                return __.product;\r\n            }\r\n        },\r\n        {\r\n            name: 'integrate',\r\n            visible: true,\r\n            numargs: [1, 2],\r\n            build: function () {\r\n                return __.integrate;\r\n            }\r\n        },\r\n        {\r\n            name: 'defint',\r\n            visible: true,\r\n            numargs: [3, 4],\r\n            build: function () {\r\n                return __.defint;\r\n            }\r\n        },\r\n        {\r\n            name: 'S',\r\n            visible: true,\r\n            numargs: 1,\r\n            build: function () {\r\n                return __.Fresnel.S;\r\n            }\r\n        },\r\n        {\r\n            name: 'C',\r\n            visible: true,\r\n            numargs: 1,\r\n            build: function () {\r\n                return __.Fresnel.C;\r\n            }\r\n        },\r\n        {\r\n            name: 'limit',\r\n            visible: true,\r\n            numargs: [3, 4],\r\n            build: function () {\r\n                return __.Limit.limit;\r\n            }\r\n        }\r\n    ]);\r\n    //link registered functions externally\r\n    nerdamer.updateAPI();\r\n\r\n})();","/*\r\n * Author : Martin Donk\r\n * Website : http://www.nerdamer.com\r\n * Email : martin.r.donk@gmail.com\r\n * License : MIT\r\n * Source : https://github.com/jiggzson/nerdamer\r\n */\r\n\r\n/* global module, Function */\r\n\r\nif((typeof module) !== 'undefined') {\r\n    var nerdamer = require('./nerdamer.core.js');\r\n    require('./Calculus.js');\r\n}\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    /*shortcuts*/\r\n    var core = nerdamer.getCore(),\r\n            _ = core.PARSER,\r\n            N = core.groups.N,\r\n            P = core.groups.P,\r\n            S = core.groups.S,\r\n            EX = core.groups.EX,\r\n            FN = core.groups.FN,\r\n            PL = core.groups.PL,\r\n            CP = core.groups.CP,\r\n            CB = core.groups.CB,\r\n            keys = core.Utils.keys,\r\n            even = core.Utils.even,\r\n            variables = core.Utils.variables,\r\n            format = core.Utils.format,\r\n            round = core.Utils.round,\r\n            Frac = core.Frac,\r\n            isInt = core.Utils.isInt,\r\n            Symbol = core.Symbol,\r\n            CONST_HASH = core.Settings.CONST_HASH,\r\n            math = core.Utils.importFunctions(),\r\n            evaluate = core.Utils.evaluate;\r\n    //*************** CLASSES ***************//\r\n    /**\r\n     * Converts a symbol into an equivalent polynomial arrays of \r\n     * the form [[coefficient_1, power_1],[coefficient_2, power_2], ... ]\r\n     * Univariate polymials only. \r\n     * @param {Symbol|Number} symbol\r\n     * @param {String} variable The variable name of the polynomial\r\n     * @param {int} order\r\n     */\r\n    function Polynomial(symbol, variable, order) {\r\n        if(core.Utils.isSymbol(symbol)) {\r\n            this.parse(symbol);\r\n            this.variable = this.variable || variable;\r\n        }\r\n        else if(!isNaN(symbol)) {\r\n            order = order || 0;\r\n            if(variable === undefined)\r\n                throw new core.exceptions.InvalidVariableNameError('Polynomial expects a variable name when creating using order');\r\n            this.coeffs = [];\r\n            this.coeffs[order] = symbol;\r\n            this.fill(symbol);\r\n        }\r\n        else if(typeof symbol === 'string') {\r\n            this.parse(_.parse(symbol));\r\n        }\r\n    }\r\n    /**\r\n     * Creates a Polynomial given an array of coefficients\r\n     * @param {int[]} arr\r\n     * @param {String} variable\r\n     * @returns {Polynomial}\r\n     */\r\n    Polynomial.fromArray = function (arr, variable) {\r\n        if(typeof variable === 'undefined')\r\n            throw new core.exceptions.InvalidVariableNameError('A variable name must be specified when creating polynomial from array');\r\n        var p = new Polynomial();\r\n        p.coeffs = arr;\r\n        p.variable = variable;\r\n        return p;\r\n    };\r\n\r\n    Polynomial.fit = function (c1, c2, n, base, p, variable) {\r\n        //after having looped through and mod 10 the number to get the matching factor\r\n        var terms = new Array(p + 1),\r\n                t = n - c2;\r\n        terms[0] = c2; //the constants is assumed to be correct\r\n        //constant for x^p is also assumed know so add\r\n        terms[p] = c1;\r\n        t -= c1 * Math.pow(base, p);\r\n        //start fitting\r\n        for(var i = p - 1; i > 0; i--) {\r\n            var b = Math.pow(base, i), //we want as many wholes as possible\r\n                    q = t / b,\r\n                    sign = Math.sign(q);\r\n            var c = sign * Math.floor(Math.abs(q));\r\n            t -= c * b;\r\n            terms[i] = c;\r\n        }\r\n        if(t !== 0)\r\n            return null;\r\n        for(var i = 0; i < terms.length; i++)\r\n            terms[i] = new Frac(terms[i]);\r\n\r\n        return Polynomial.fromArray(terms, variable);\r\n    };\r\n\r\n    Polynomial.prototype = {\r\n        /**\r\n         * Converts Symbol to Polynomial\r\n         * @param {Symbol} symbol\r\n         * @param {Array} c - a collector array\r\n         * @returns {Polynomial}\r\n         */\r\n        parse: function (symbol, c) {\r\n            this.variable = variables(symbol)[0];\r\n            if(!symbol.isPoly())\r\n                throw core.exceptions.NerdamerTypeError('Polynomial Expected! Received ' + core.Utils.text(symbol));\r\n            c = c || [];\r\n            if(!symbol.power.absEquals(1))\r\n                symbol = _.expand(symbol);\r\n\r\n            if(symbol.group === core.groups.N) {\r\n                c[0] = symbol.multiplier;\r\n            }\r\n            else if(symbol.group === core.groups.S) {\r\n                c[symbol.power.toDecimal()] = symbol.multiplier;\r\n            }\r\n            else {\r\n                for(var x in symbol.symbols) {\r\n                    var sub = symbol.symbols[x],\r\n                            p = sub.power;\r\n                    if(core.Utils.isSymbol(p))\r\n                        throw new core.exceptions.NerdamerTypeError('power cannot be a Symbol');\r\n\r\n                    p = sub.group === N ? 0 : p.toDecimal();\r\n                    if(sub.symbols) {\r\n                        this.parse(sub, c);\r\n                    }\r\n                    else {\r\n                        c[p] = sub.multiplier;\r\n                    }\r\n                }\r\n            }\r\n\r\n            this.coeffs = c;\r\n\r\n            this.fill();\r\n        },\r\n        /**\r\n         * Fills in the holes in a polynomial with zeroes\r\n         * @param {Number} x - The number to fill the holes with\r\n         */\r\n        fill: function (x) {\r\n            x = Number(x) || 0;\r\n            var l = this.coeffs.length;\r\n            for(var i = 0; i < l; i++) {\r\n                if(this.coeffs[i] === undefined) {\r\n                    this.coeffs[i] = new Frac(x);\r\n                }\r\n            }\r\n            return this;\r\n        },\r\n        /**\r\n         * Removes higher order zeros or a specific coefficient\r\n         * @returns {Array}\r\n         */\r\n        trim: function () {\r\n            var l = this.coeffs.length;\r\n            while(l--) {\r\n                var c = this.coeffs[l];\r\n                var equalsZero = c.equals(0);\r\n                if(c && equalsZero) {\r\n                    if(l === 0)\r\n                        break;\r\n                    this.coeffs.pop();\r\n                }\r\n                else\r\n                    break;\r\n            }\r\n\r\n            return this;\r\n        },\r\n        /*\r\n         * Returns polynomial mod p **currently fails**\r\n         * @param {Number} p\r\n         * @returns {Polynomial}\r\n         */\r\n        modP: function (p) {\r\n            var l = this.coeffs.length;\r\n            for(var i = 0; i < l; i++) {\r\n                var c = this.coeffs[i];\r\n                if(c < 0) { //go borrow\r\n                    var b; //a coefficient > 0\r\n                    for(var j = i; j < l; j++) {//starting from where we left off\r\n                        if(this.coeffs[j] > 0) {\r\n                            b = this.coeffs[j];\r\n                            break;\r\n                        }\r\n                    }\r\n\r\n                    if(b) { //if such a coefficient exists\r\n                        for(j; j > i; j--) { //go down the line and adjust using p\r\n                            this.coeffs[j] = this.coeffs[j].subtract(new Frac(1));\r\n                            this.coeffs[j - 1] = this.coeffs[j - 1].add(new Frac(p));\r\n                        }\r\n                        c = this.coeffs[i]; //reset c\r\n                    }\r\n                }\r\n\r\n                var d = c.mod(p);\r\n                var w = c.subtract(d).divide(p);\r\n                if(!w.equals(0)) {\r\n                    var up_one = i + 1;\r\n                    var next = this.coeffs[up_one] || new Frac(0);\r\n                    next = next.add(w);\r\n                    this.coeffs[up_one] = new Frac(next);\r\n                    this.coeffs[i] = new Frac(d);\r\n                }\r\n            }\r\n\r\n            return this;\r\n        },\r\n        /**\r\n         * Adds together 2 polynomials\r\n         * @param {Polynomial} poly\r\n         */\r\n        add: function (poly) {\r\n            var l = Math.max(this.coeffs.length, poly.coeffs.length);\r\n            for(var i = 0; i < l; i++) {\r\n                var a = (this.coeffs[i] || new Frac(0)),\r\n                        b = (poly.coeffs[i] || new Frac(0));\r\n                this.coeffs[i] = a.add(b);\r\n            }\r\n            return this;\r\n        },\r\n        /**\r\n         * Adds together 2 polynomials\r\n         * @param {Polynomial} poly\r\n         */\r\n        subtract: function (poly) {\r\n            var l = Math.max(this.coeffs.length, poly.coeffs.length);\r\n            for(var i = 0; i < l; i++) {\r\n                var a = (this.coeffs[i] || new Frac(0)),\r\n                        b = (poly.coeffs[i] || new Frac(0));\r\n                this.coeffs[i] = a.subtract(b);\r\n            }\r\n            return this;\r\n        },\r\n        divide: function (poly) {\r\n            var variable = this.variable,\r\n                    dividend = core.Utils.arrayClone(this.coeffs),\r\n                    divisor = core.Utils.arrayClone(poly.coeffs),\r\n                    n = dividend.length,\r\n                    mp = divisor.length - 1,\r\n                    quotient = [];\r\n\r\n            //loop through the dividend\r\n            for(var i = 0; i < n; i++) {\r\n                var p = n - (i + 1);\r\n                //get the difference of the powers\r\n                var d = p - mp;\r\n                //get the quotient of the coefficients\r\n                var q = dividend[p].divide(divisor[mp]);\r\n\r\n                if(d < 0)\r\n                    break;//the divisor is not greater than the dividend\r\n                //place it in the quotient\r\n                quotient[d] = q;\r\n\r\n                for(var j = 0; j <= mp; j++) {\r\n                    //reduce the dividend\r\n                    dividend[j + d] = dividend[j + d].subtract((divisor[j].multiply(q)));\r\n                }\r\n            }\r\n\r\n            //clean up\r\n            var p1 = Polynomial.fromArray(dividend, variable || 'x').trim(), //pass in x for safety\r\n                    p2 = Polynomial.fromArray(quotient, variable || 'x');\r\n            return [p2, p1];\r\n        },\r\n        multiply: function (poly) {\r\n            var l1 = this.coeffs.length, l2 = poly.coeffs.length,\r\n                    c = []; //array to be returned\r\n            for(var i = 0; i < l1; i++) {\r\n                var x1 = this.coeffs[i];\r\n                for(var j = 0; j < l2; j++) {\r\n                    var k = i + j, //add the powers together\r\n                            x2 = poly.coeffs[j],\r\n                            e = c[k] || new Frac(0); //get the existing term from the new array\r\n                    c[k] = e.add(x1.multiply(x2)); //multiply the coefficients and add to new polynomial array\r\n                }\r\n            }\r\n            this.coeffs = c;\r\n            return this;\r\n        },\r\n        /**\r\n         * Checks if a polynomial is zero\r\n         * @returns {Boolean}\r\n         */\r\n        isZero: function () {\r\n            var l = this.coeffs.length;\r\n            for(var i = 0; i < l; i++) {\r\n                var e = this.coeffs[i];\r\n                if(!e.equals(0))\r\n                    return false;\r\n            }\r\n            return true;\r\n        },\r\n        /** \r\n         * Substitutes in a number n into the polynomial p(n)\r\n         * @param {Number} n\r\n         * @returns {Frac}\r\n         */\r\n        sub: function (n) {\r\n            var sum = new Frac(0), l = this.coeffs.length;\r\n            for(var i = 0; i < l; i++) {\r\n                var t = this.coeffs[i];\r\n                if(!t.equals(0))\r\n                    sum = sum.add(t.multiply(new Frac(Math.pow(n, i))));\r\n            }\r\n            return sum;\r\n        },\r\n        /**\r\n         * Returns a clone of the polynomial\r\n         * @returns {Polynomial}\r\n         */\r\n        clone: function () {\r\n            var p = new Polynomial();\r\n            p.coeffs = this.coeffs;\r\n            p.variable = this.variable;\r\n            return p;\r\n        },\r\n        /**\r\n         * Gets the degree of the polynomial\r\n         * @returns {Number}\r\n         */\r\n        deg: function () {\r\n            this.trim();\r\n            return this.coeffs.length - 1;\r\n        },\r\n        /**\r\n         * Returns a lead coefficient\r\n         * @returns {Frac}\r\n         */\r\n        lc: function () {\r\n            return this.coeffs[this.deg()].clone();\r\n        },\r\n        /**\r\n         * Converts polynomial into a monic polynomial\r\n         * @returns {Polynomial}\r\n         */\r\n        monic: function () {\r\n            var lc = this.lc(), l = this.coeffs.length;\r\n            for(var i = 0; i < l; i++)\r\n                this.coeffs[i] = this.coeffs[i].divide(lc);\r\n            return this;\r\n        },\r\n        /**\r\n         * Returns the GCD of two polynomials\r\n         * @param {Polynomial} poly\r\n         * @returns {Polynomial}\r\n         */\r\n        gcd: function (poly) {\r\n            //get the maximum power of each\r\n            var mp1 = this.coeffs.length - 1,\r\n                    mp2 = poly.coeffs.length - 1,\r\n                    T;\r\n            //swap so we always have the greater power first\r\n            if(mp1 < mp2) {\r\n                return poly.gcd(this);\r\n            }\r\n            var a = this;\r\n\r\n            while(!poly.isZero()) {\r\n                var t = poly.clone();\r\n                a = a.clone();\r\n                T = a.divide(t);\r\n                poly = T[1];\r\n                a = t;\r\n            }\r\n\r\n            var gcd = core.Math2.QGCD.apply(null, a.coeffs);\r\n            if(!gcd.equals(1)) {\r\n                var l = a.coeffs.length;\r\n                for(var i = 0; i < l; i++) {\r\n                    a.coeffs[i] = a.coeffs[i].divide(gcd);\r\n                }\r\n            }\r\n            return a;\r\n        },\r\n        /**\r\n         * Differentiates the polynomial\r\n         * @returns {Polynomial}\r\n         */\r\n        diff: function () {\r\n            var new_array = [], l = this.coeffs.length;\r\n            for(var i = 1; i < l; i++)\r\n                new_array.push(this.coeffs[i].multiply(new Frac(i)));\r\n            this.coeffs = new_array;\r\n            return this;\r\n        },\r\n        /**\r\n         * Integrates the polynomial\r\n         * @returns {Polynomial} \r\n         */\r\n        integrate: function () {\r\n            var new_array = [0], l = this.coeffs.length;\r\n            for(var i = 0; i < l; i++) {\r\n                var c = new Frac(i + 1);\r\n                new_array[c] = this.coeffs[i].divide(c);\r\n            }\r\n            this.coeffs = new_array;\r\n            return this;\r\n        },\r\n        /**\r\n         * Returns the Greatest common factor of the polynomial\r\n         * @param {bool} toPolynomial - true if a polynomial is wanted\r\n         * @returns {Frac|Polynomial}\r\n         */\r\n        gcf: function (toPolynomial) {\r\n            //get the first nozero coefficient and returns its power\r\n            var fnz = function (a) {\r\n                for(var i = 0; i < a.length; i++)\r\n                    if(!a[i].equals(0))\r\n                        return i;\r\n            },\r\n                    ca = [];\r\n            for(var i = 0; i < this.coeffs.length; i++) {\r\n                var c = this.coeffs[i];\r\n                if(!c.equals(0) && ca.indexOf(c) === -1)\r\n                    ca.push(c);\r\n            }\r\n            var p = [core.Math2.QGCD.apply(undefined, ca), fnz(this.coeffs)].toDecimal();\r\n\r\n            if(toPolynomial) {\r\n                var parr = [];\r\n                parr[p[1] - 1] = p[0];\r\n                p = Polynomial.fromArray(parr, this.variable).fill();\r\n            }\r\n\r\n            return p;\r\n        },\r\n        /**\r\n         * Raises a polynomial P to a power p -> P^p. e.g. (x+1)^2\r\n         * @param {bool} incl_img - Include imaginary numbers \r\n         */\r\n        quad: function (incl_img) {\r\n            var roots = [];\r\n            if(this.coeffs.length > 3)\r\n                throw new Error('Cannot calculate quadratic order of ' + (this.coeffs.length - 1));\r\n            if(this.coeffs.length === 0)\r\n                throw new Error('Polynomial array has no terms');\r\n            var a = this.coeffs[2] || 0, b = this.coeffs[1] || 0, c = this.coeffs[0];\r\n            var dsc = b * b - 4 * a * c;\r\n            if(dsc < 0 && !incl_img)\r\n                return roots;\r\n            else {\r\n                roots[0] = (-b + Math.sqrt(dsc)) / (2 * a);\r\n                roots[1] = (-b - Math.sqrt(dsc)) / (2 * a);\r\n            }\r\n            return roots;\r\n        },\r\n        /**\r\n         * Makes polynomial square free\r\n         * @returns {Array}\r\n         */\r\n        squareFree: function () {\r\n\r\n            var a = this.clone(),\r\n                    i = 1,\r\n                    b = a.clone().diff(),\r\n                    c = a.clone().gcd(b),\r\n                    w = a.divide(c)[0];\r\n            var output = Polynomial.fromArray([new Frac(1)], a.variable);\r\n            while(!c.equalsNumber(1)) {\r\n                var y = w.gcd(c);\r\n                var z = w.divide(y)[0];\r\n                //one of the factors may have shown up since it's square but smaller than the \r\n                //one where finding\r\n                if(!z.equalsNumber(1) && i > 1) {\r\n                    var t = z.clone();\r\n                    for(var j = 1; j < i; j++)\r\n                        t.multiply(z.clone());\r\n                    z = t;\r\n                }\r\n                output = output.multiply(z);\r\n                i++;\r\n                w = y;\r\n                c = c.divide(y)[0];\r\n            }\r\n\r\n            return [output, w, i];\r\n        },\r\n        /**\r\n         * Converts polynomial to Symbol\r\n         * @returns {Symbol}\r\n         */\r\n        toSymbol: function () {\r\n            var l = this.coeffs.length,\r\n                    variable = this.variable;\r\n            if(l === 0)\r\n                return new core.Symbol(0);\r\n            var end = l - 1, str = '';\r\n\r\n            for(var i = 0; i < l; i++) {\r\n                //place the plus sign for all but the last one\r\n                var plus = i === end ? '' : '+',\r\n                        e = this.coeffs[i];\r\n                if(!e.equals(0))\r\n                    str += (e + '*' + variable + '^' + i + plus);\r\n            }\r\n            return _.parse(str);\r\n        },\r\n        /**\r\n         * Checks if polynomial is equal to a number\r\n         * @param {Number} x\r\n         * @returns {Boolean}\r\n         */\r\n        equalsNumber: function (x) {\r\n            this.trim();\r\n            return this.coeffs.length === 1 && this.coeffs[0].toDecimal() === String(x);\r\n        },\r\n        toString: function () {\r\n            return this.toSymbol().toString();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * TODO\r\n     * ===================================================================================\r\n     * THIS METHOD HAS A NASTY HIDDEN BUG. IT HAS INCONSISTENT RETURN TYPES PRIMARILY DUE TO \r\n     * WRONG ASSUMPTIONS AT THE BEGINNING. THE ASSUMPTION WAS THAT COEFFS WERE ALWAYS GOING BE NUMBERS\r\n     * NOT TAKING INTO ACCOUNT THAT IMAGINARY NUMBERS. FIXING THIS BREAKS WAY TOO MANY TESTS \r\n     * AT THEM MOMENT WHICH I DON'T HAVE TO FIX\r\n     * ===================================================================================\r\n     * If the symbols is of group PL or CP it will return the multipliers of each symbol\r\n     * as these are polynomial coefficients. CB symbols are glued together by multiplication\r\n     * so the symbol multiplier carries the coefficients for all contained symbols.\r\n     * For S it just returns it's own multiplier. This function doesn't care if it's a polynomial or not\r\n     * @param {Array} c The coefficient array\r\n     * @param {boolean} with_order \r\n     * @return {Array}\r\n     */\r\n    Symbol.prototype.coeffs = function (c, with_order) {\r\n        if(with_order && !this.isPoly(true))\r\n            _.error('Polynomial expected when requesting coefficients with order');\r\n        c = c || [];\r\n        var s = this.clone().distributeMultiplier();\r\n        if(s.isComposite()) {\r\n            for(var x in s.symbols) {\r\n                var sub = s.symbols[x];\r\n                if(sub.isComposite()) {\r\n                    sub.clone().distributeMultiplier().coeffs(c, with_order);\r\n                }\r\n                else {\r\n                    if(with_order)\r\n                        c[sub.isConstant() ? 0 : sub.power.toDecimal()] = sub.multiplier;\r\n                    else {\r\n                        c.push(sub.multiplier);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if(with_order)\r\n                c[s.isConstant(true) ? 0 : s.power.toDecimal()] = s.multiplier;\r\n            else {\r\n                if(s.group === CB && s.isImaginary()) {\r\n                    var m = new Symbol(s.multiplier);\r\n                    s.each(function (x) {\r\n                        //add the imaginary part\r\n                        if(x.isConstant(true) || x.imaginary)\r\n                            m = _.multiply(m, x);\r\n                    });\r\n                    c.push(m);\r\n                }\r\n                else\r\n                    c.push(s.multiplier);\r\n            }\r\n        }\r\n        //fill the holes\r\n        if(with_order) {\r\n            for(var i = 0; i < c.length; i++)\r\n                if(c[i] === undefined)\r\n                    c[i] = new Symbol(0);\r\n        }\r\n        return c;\r\n    };\r\n    Symbol.prototype.tBase = function (map) {\r\n        if(typeof map === 'undefined')\r\n            throw new Error('Symbol.tBase requires a map object!');\r\n        var terms = [];\r\n        var symbols = this.collectSymbols(null, null, null, true),\r\n                l = symbols.length;\r\n        for(var i = 0; i < l; i++) {\r\n            var symbol = symbols[i],\r\n                    g = symbol.group,\r\n                    nterm = new MVTerm(symbol.multiplier, [], map);\r\n            if(g === CB) {\r\n                for(var x in symbol.symbols) {\r\n                    var sym = symbol.symbols[x];\r\n                    nterm.terms[map[x]] = sym.power;\r\n                }\r\n            }\r\n            else {\r\n                nterm.terms[map[symbol.value]] = symbol.power;\r\n            }\r\n\r\n            terms.push(nterm.fill());\r\n            nterm.updateCount();\r\n        }\r\n        return terms;\r\n    };\r\n    Symbol.prototype.altVar = function (x) {\r\n        var m = this.multiplier.toString(), p = this.power.toString();\r\n        return (m === '1' ? '' : m + '*') + x + (p === '1' ? '' : '^' + p);\r\n    };\r\n    /**\r\n     * Checks to see if the symbols contain the same variables\r\n     * @param {Symbol} symbol\r\n     * @returns {Boolean}\r\n     */\r\n    Symbol.prototype.sameVars = function (symbol) {\r\n        if(!(this.symbols || this.group === symbol.group))\r\n            return false;\r\n        for(var x in this.symbols) {\r\n            var a = this.symbols[x], b = symbol.symbols[x];\r\n            if(!b)\r\n                return false;\r\n            if(a.value !== b.value)\r\n                return false;\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * Groups the terms in a symbol with respect to a variable\r\n     * For instance the symbol {a*b^2*x^2+a*b*x^2+x+6} returns [6,1,a*b+a*b^2]\r\n     * @returns {Factors}\r\n     */\r\n    Symbol.prototype.groupTerms = function (x) {\r\n        x = String(x);\r\n        var f, p, egrouped;\r\n        var grouped = [];\r\n        this.each(function (e) {\r\n            if(e.group === PL) {\r\n                egrouped = e.groupTerms(x);\r\n                for(var i = 0; i < egrouped.length; i++) {\r\n                    var el = egrouped[i];\r\n                    if(el)\r\n                        grouped[i] = el;\r\n                }\r\n            }\r\n            else {\r\n                f = core.Utils.decompose_fn(e, x, true);\r\n                p = f.x.value === x ? Number(f.x.power) : 0;\r\n                //check if there's an existing value\r\n                grouped[p] = _.add(grouped[p] || new Symbol(0), f.a);\r\n            }\r\n        });\r\n        return grouped;\r\n    };\r\n    /**\r\n     * Use this to collect Factors\r\n     * @returns {Symbol[]}\r\n     */\r\n    Symbol.prototype.collectFactors = function () {\r\n        var factors = [];\r\n        if(this.group === CB)\r\n            this.each(function (x) {\r\n                factors.push(x.clone());\r\n            });\r\n        else\r\n            factors.push(this.clone());\r\n        return factors;\r\n    };\r\n    /**\r\n     * A container class for factors\r\n     * @returns {Factors}\r\n     */\r\n    function Factors() {\r\n        this.factors = {};\r\n        this.length = 0;\r\n    }\r\n    ;\r\n    Factors.prototype.getNumberSymbolics = function () {\r\n        var n = 0;\r\n        this.each(function (x) {\r\n            if(!x.isConstant(true))\r\n                n++;\r\n        });\r\n        return n;\r\n    };\r\n    /**\r\n     * Adds the factors to the factor object\r\n     * @param {Symbo} s\r\n     * @returns {Factors}\r\n     */\r\n    Factors.prototype.add = function (s) {\r\n        if(s.equals(0))\r\n            return this; //nothing to add\r\n\r\n        //we don't want to carry -1 as a factor. If a factor already exists,\r\n        //then add the minus one to that factor and return.\r\n        if(s.equals(-1) && this.length > 0) {\r\n            var fo = core.Utils.firstObject(this.factors, null, true);\r\n            this.add(_.symfunction(core.Settings.PARENTHESIS, [fo.obj]).negate());\r\n            delete this.factors[fo.key];\r\n            this.length--;\r\n            return this;\r\n        }\r\n\r\n        if(s.group === CB) {\r\n            var factors = this;\r\n            if(!s.multiplier.equals(1))\r\n                factors.add(new Symbol(s.multiplier));\r\n            s.each(function (x) {\r\n                factors.add(x);\r\n            });\r\n        }\r\n        else {\r\n            if(this.preAdd) //if a preAdd function was defined call it to do prep\r\n                s = this.preAdd(s);\r\n            if(this.pFactor) //if the symbol isn't linear add back the power\r\n                s = _.pow(s, new Symbol(this.pFactor));\r\n\r\n            var is_constant = s.isConstant();\r\n            if(is_constant && s.equals(1))\r\n                return this; //don't add 1\r\n            var v = is_constant ? s.value : s.text();\r\n            if(v in this.factors) {\r\n                this.factors[v] = _.multiply(this.factors[v], s);\r\n                //did the addition cancel out the existing factor? If so remove it and decrement the length\r\n                if(this.factors[v].equals(1)) {\r\n                    delete this.factors[v];\r\n                    this.length--;\r\n                }\r\n            }\r\n            else {\r\n                this.factors[v] = s;\r\n                this.length++;\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * Converts the factor object to a Symbol\r\n     * @returns {Symbol}\r\n     */\r\n    Factors.prototype.toSymbol = function () {\r\n        var factored = new Symbol(1);\r\n        var factors = Object.values(this.factors).sort(function (a, b) {\r\n            return a.group > b.group;\r\n        });\r\n\r\n        for(var i = 0, l = factors.length; i < l; i++) {\r\n            var f = factors[i];\r\n\r\n            //don't wrap group S or FN\r\n            var factor = f.power.equals(1) && f.fname !== '' /* don't wrap it twice */ ?\r\n                    _.symfunction(core.PARENTHESIS, [f]) : f;\r\n\r\n            factored = _.multiply(factored, factor);\r\n        }\r\n        if(factored.fname === '')\r\n            factored = Symbol.unwrapPARENS(factored);\r\n        return factored;\r\n    };\r\n    /**\r\n     * Merges 2 factor objects into one\r\n     * @param {Factor} o\r\n     * @returns {Factors}\r\n     */\r\n    Factors.prototype.merge = function (o) {\r\n        for(var x in o) {\r\n            if(x in this.factors)\r\n                this.factors[x] = _.multiply(this.factors[x], o[x]);\r\n            else\r\n                this.factors[x] = o[x];\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * The iterator for the factor object\r\n     * @param {Function} f - callback\r\n     * @returns {Factor}\r\n     */\r\n    Factors.prototype.each = function (f) {\r\n        for(var x in this.factors) {\r\n            var factor = this.factors[x];\r\n            if(factor.fname === core.PARENTHESIS && factor.isLinear())\r\n                factor = factor.args[0];\r\n            f.call(this, factor, x);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * Return the number of factors contained in the factor object\r\n     * @returns {int}\r\n     */\r\n    Factors.prototype.count = function () {\r\n        return keys(this.factors).length;\r\n    };\r\n    /**\r\n     * Cleans up factors from -1\r\n     * @returns {undefined}\r\n     */\r\n    Factors.prototype.clean = function () {\r\n        try {\r\n            var h = core.Settings.CONST_HASH;\r\n            if(this.factors[h].lessThan(0)) {\r\n                if(this.factors[h].equals(-1))\r\n                    delete this.factors[h];\r\n                else\r\n                    this.factors[h].negate();\r\n                this.each(function (x) {\r\n                    x.negate();\r\n                });\r\n            }\r\n        }\r\n        catch(e) {\r\n        }\r\n        ;\r\n    };\r\n    Factors.prototype.toString = function () {\r\n        return this.toSymbol().toString();\r\n    };\r\n\r\n    //a wrapper for performing multivariate division\r\n    function MVTerm(coeff, terms, map) {\r\n        this.terms = terms || [];\r\n        this.coeff = coeff;\r\n        this.map = map; //careful! all maps are the same object\r\n        this.sum = new core.Frac(0);\r\n        this.image = undefined;\r\n    }\r\n    ;\r\n    MVTerm.prototype.updateCount = function () {\r\n        this.count = this.count || 0;\r\n        for(var i = 0; i < this.terms.length; i++) {\r\n            if(!this.terms[i].equals(0))\r\n                this.count++;\r\n        }\r\n        return this;\r\n    };\r\n    MVTerm.prototype.getVars = function () {\r\n        var vars = [];\r\n        for(var i = 0; i < this.terms.length; i++) {\r\n            var term = this.terms[i],\r\n                    rev_map = this.getRevMap();\r\n            if(!term.equals(0))\r\n                vars.push(this.rev_map[i]);\r\n        }\r\n        return vars.join(' ');\r\n    };\r\n    MVTerm.prototype.len = function () {\r\n        if(typeof this.count === 'undefined') {\r\n            this.updateCount();\r\n        }\r\n        return this.count;\r\n    };\r\n    MVTerm.prototype.toSymbol = function (rev_map) {\r\n        rev_map = rev_map || this.getRevMap();\r\n        var symbol = new Symbol(this.coeff);\r\n        for(var i = 0; i < this.terms.length; i++) {\r\n            var v = rev_map[i],\r\n                    t = this.terms[i];\r\n            if(t.equals(0) || v === CONST_HASH)\r\n                continue;\r\n            var mapped = new Symbol(v);\r\n            mapped.power = t;\r\n            symbol = _.multiply(symbol, mapped);\r\n        }\r\n        return symbol;\r\n    };\r\n    MVTerm.prototype.getRevMap = function () {\r\n        if(this.rev_map)\r\n            return this.rev_map;\r\n        var o = {};\r\n        for(var x in this.map)\r\n            o[this.map[x]] = x;\r\n        this.rev_map = o;\r\n        return o;\r\n    };\r\n    MVTerm.prototype.generateImage = function () {\r\n        this.image = this.terms.join(' ');\r\n        return this;\r\n    },\r\n            MVTerm.prototype.getImg = function () {\r\n                if(!this.image)\r\n                    this.generateImage();\r\n                return this.image;\r\n            },\r\n            MVTerm.prototype.fill = function () {\r\n                var l = this.map.length;\r\n                for(var i = 0; i < l; i++) {\r\n                    if(typeof this.terms[i] === 'undefined')\r\n                        this.terms[i] = new core.Frac(0);\r\n                    else {\r\n                        this.sum = this.sum.add(this.terms[i]);\r\n                    }\r\n                }\r\n                return this;\r\n            };\r\n    MVTerm.prototype.divide = function (mvterm) {\r\n        var c = this.coeff.divide(mvterm.coeff),\r\n                l = this.terms.length,\r\n                new_mvterm = new MVTerm(c, [], this.map);\r\n        for(var i = 0; i < l; i++) {\r\n            new_mvterm.terms[i] = this.terms[i].subtract(mvterm.terms[i]);\r\n            new_mvterm.sum = new_mvterm.sum.add(new_mvterm.terms[i]);\r\n        }\r\n        return new_mvterm;\r\n    };\r\n    MVTerm.prototype.multiply = function (mvterm) {\r\n        var c = this.coeff.multiply(mvterm.coeff),\r\n                l = this.terms.length,\r\n                new_mvterm = new MVTerm(c, [], this.map);\r\n        for(var i = 0; i < l; i++) {\r\n            new_mvterm.terms[i] = this.terms[i].add(mvterm.terms[i]);\r\n            new_mvterm.sum = new_mvterm.sum.add(new_mvterm.terms[i]);\r\n        }\r\n        return new_mvterm;\r\n    };\r\n    MVTerm.prototype.isZero = function () {\r\n        return this.coeff.equals(0);\r\n    };\r\n    MVTerm.prototype.toString = function () {\r\n        return '{ coeff: ' + this.coeff.toString() + ', terms: [' +\r\n                this.terms.join(',') + ']: sum: ' + this.sum.toString() + ', count: ' + this.count + '}';\r\n    };\r\n\r\n    core.Utils.toMapObj = function (arr) {\r\n        var c = 0, o = {};\r\n        for(var i = 0; i < arr.length; i++) {\r\n            var v = arr[i];\r\n            if(typeof o[v] === 'undefined') {\r\n                o[v] = c;\r\n                c++;\r\n            }\r\n        }\r\n        o.length = c;\r\n        return o;\r\n    };\r\n    core.Utils.filledArray = function (v, n, clss) {\r\n        var a = [];\r\n        while(n--) {\r\n            a[n] = clss ? new clss(v) : v;\r\n        }\r\n        return a;\r\n    };\r\n    core.Utils.arrSum = function (arr) {\r\n        var sum = 0, l = arr.length;\r\n        for(var i = 0; i < l; i++)\r\n            sum += arr[i];\r\n        return sum;\r\n    };\r\n    /**\r\n     * Determines if 2 arrays have intersecting elements.\r\n     * @param {Array} a\r\n     * @param {Array} b\r\n     * @returns {Boolean} True if a and b have intersecting elements.\r\n     */\r\n    core.Utils.haveIntersection = function (a, b) {\r\n        var t;\r\n        if(b.length > a.length)\r\n            t = b, b = a, a = t; // indexOf to loop over shorter\r\n        return a.some(function (e) {\r\n            return b.indexOf(e) > -1;\r\n        });\r\n    };\r\n    /**\r\n     * Substitutes out functions as variables so they can be used in regular algorithms\r\n     * @param {Symbol} symbol\r\n     * @param {Object} map\r\n     * @returns {String} The expression string\r\n     */\r\n    core.Utils.subFunctions = function (symbol, map) {\r\n        map = map || {};\r\n        var subbed = [];\r\n        symbol.each(function (x) {\r\n            if(x.group === FN || x.previousGroup === FN) {\r\n                //we need a new variable name so why not use one of the existing\r\n                var val = core.Utils.text(x, 'hash'), tvar = map[val];\r\n                if(!tvar) {\r\n                    //generate a unique enough name\r\n                    var t = x.fname + keys(map).length;\r\n                    map[val] = t;\r\n                    subbed.push(x.altVar(t));\r\n                }\r\n                else\r\n                    subbed.push(x.altVar(tvar));\r\n            }\r\n            else if(x.group === CB || x.group === PL || x.group === CP) {\r\n                subbed.push(core.Utils.subFunctions(x, map));\r\n            }\r\n            else\r\n                subbed.push(x.text());\r\n        });\r\n        if(symbol.group === CP || symbol.group === PL)\r\n            return symbol.altVar(core.Utils.inBrackets(subbed.join('+')));\r\n        ;\r\n        if(symbol.group === CB)\r\n            return symbol.altVar(core.Utils.inBrackets(subbed.join('*')));\r\n        return symbol.text();\r\n    };\r\n    core.Utils.getFunctionsSubs = function (map) {\r\n        var subs = {};\r\n        //prepare substitutions\r\n        for(var x in map)\r\n            subs[map[x]] = _.parse(x);\r\n        return subs;\r\n    };\r\n\r\n    var __ = core.Algebra = {\r\n        version: '1.4.6',\r\n        proots: function (symbol, decp) {\r\n            //the roots will be rounded up to 7 decimal places.\r\n            //if this causes trouble you can explicitly pass in a different number of places\r\n            //rarr for polynomial of power n is of format [n, coeff x^n, coeff x^(n-1), ..., coeff x^0]\r\n            decp = decp || 7;\r\n            var zeros = 0;\r\n            var known_roots = [];\r\n            var get_roots = function (rarr, powers, max) {\r\n                var roots = calcroots(rarr, powers, max).concat(known_roots);\r\n                for(var i = 0; i < zeros; i++)\r\n                    roots.unshift(0);\r\n                return roots;\r\n            };\r\n\r\n            if(symbol instanceof Symbol && symbol.isPoly()) {\r\n                symbol.distributeMultiplier();\r\n                //make it so the symbol has a constants as the lowest term\r\n                if(symbol.group === PL) {\r\n                    var lowest_pow = core.Utils.arrayMin(keys(symbol.symbols));\r\n                    var lowest_symbol = symbol.symbols[lowest_pow].clone().toUnitMultiplier();\r\n                    symbol = _.expand(_.divide(symbol, lowest_symbol));\r\n                    known_roots.push(0); //add zero since this is a known root\r\n                }\r\n                if(symbol.group === core.groups.S) {\r\n                    return [0];\r\n                }\r\n                else if(symbol.group === core.groups.PL) {\r\n                    var powers = keys(symbol.symbols),\r\n                            minpower = core.Utils.arrayMin(powers),\r\n                            symbol = core.PARSER.divide(symbol, core.PARSER.parse(symbol.value + '^' + minpower));\r\n                }\r\n\r\n                var variable = keys(symbol.symbols).sort().pop(),\r\n                        sym = symbol.group === core.groups.PL ? symbol.symbols : symbol.symbols[variable],\r\n                        g = sym.group,\r\n                        powers = g === S ? [sym.power.toDecimal()] : keys(sym.symbols),\r\n                        rarr = [],\r\n                        max = core.Utils.arrayMax(powers); //maximum power and degree of polynomial to be solved\r\n\r\n                // Prepare the data\r\n                for(var i = 1; i <= max; i++) {\r\n                    var c = 0; //if there is no power then the hole must be filled with a zero\r\n                    if(powers.indexOf(i + '') !== -1) {\r\n                        if(g === S) {\r\n                            c = sym.multiplier;\r\n                        }\r\n                        else {\r\n                            c = sym.symbols[i].multiplier;\r\n                        }\r\n                    }\r\n                    // Insert the coeffient but from the front\r\n                    rarr.unshift(c);\r\n                }\r\n\r\n                rarr.push(symbol.symbols[CONST_HASH].multiplier);\r\n\r\n                if(sym.group === S)\r\n                    rarr[0] = sym.multiplier;//the symbol maybe of group CP with one variable\r\n\r\n                return get_roots(rarr, powers, max);\r\n            }\r\n            else if(core.Utils.isArray(symbol)) {\r\n                var parr = symbol;\r\n                var rarr = [],\r\n                        powers = [],\r\n                        last_power = 0;\r\n                for(var i = 0; i < parr.length; i++) {\r\n\r\n                    var coeff = parr[i][0],\r\n                            pow = parr[i][1],\r\n                            d = pow - last_power - 1;\r\n                    //insert the zeros\r\n                    for(var j = 0; j < d; j++)\r\n                        rarr.unshift(0);\r\n\r\n                    rarr.unshift(coeff);\r\n                    if(pow !== 0)\r\n                        powers.push(pow);\r\n                    last_power = pow;\r\n                }\r\n                var max = Math.max.apply(undefined, powers);\r\n\r\n                return get_roots(rarr, powers, max);\r\n            }\r\n            else {\r\n                throw new core.exceptions.NerdamerTypeError('Cannot calculate roots. Symbol must be a polynomial!');\r\n            }\r\n\r\n            function calcroots(rarr, powers, max) {\r\n                var MAXDEGREE = 100; // Degree of largest polynomial accepted by this script.\r\n\r\n                // Make a clone of the coefficients before appending the max power\r\n                var p = rarr.slice(0);\r\n\r\n                // Divide the string up into its individual entries, which--presumably--are separated by whitespace\r\n                rarr.unshift(max);\r\n\r\n                if(max > MAXDEGREE) {\r\n                    throw new core.exceptions.ValueLimitExceededError(\"This utility accepts polynomials of degree up to \" + MAXDEGREE + \". \");\r\n                }\r\n\r\n                var zeroi = [], // Vector of imaginary components of roots\r\n                        degreePar = {};    // degreePar is a dummy variable for passing the parameter POLYDEGREE by reference\r\n                degreePar.Degree = max;\r\n\r\n                for(i = 0; i < max; i++) {\r\n                    zeroi.push(0);\r\n                }\r\n                var zeror = zeroi.slice(0); // Vector of real components of roots\r\n\r\n                // Find the roots\r\n                //--> Begin Jenkins-Traub\r\n\r\n                /*\r\n                 * A verbatim copy of Mr. David Binner's Jenkins-Traub port\r\n                 */\r\n                function QuadSD_ak1(NN, u, v, p, q, iPar) {\r\n                    // Divides p by the quadratic 1, u, v placing the quotient in q and the remainder in a, b\r\n                    // iPar is a dummy variable for passing in the two parameters--a and b--by reference\r\n                    q[0] = iPar.b = p[0];\r\n                    q[1] = iPar.a = -(u * iPar.b) + p[1];\r\n\r\n                    for(var i = 2; i < NN; i++) {\r\n                        q[i] = -(u * iPar.a + v * iPar.b) + p[i];\r\n                        iPar.b = iPar.a;\r\n                        iPar.a = q[i];\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                function calcSC_ak1(DBL_EPSILON, N, a, b, iPar, K, u, v, qk) {\r\n                    // This routine calculates scalar quantities used to compute the next K polynomial and\r\n                    // new estimates of the quadratic coefficients.\r\n                    // calcSC -\tinteger variable set here indicating how the calculations are normalized\r\n                    // to avoid overflow.\r\n                    // iPar is a dummy variable for passing in the nine parameters--a1, a3, a7, c, d, e, f, g, and h --by reference\r\n\r\n                    // sdPar is a dummy variable for passing the two parameters--c and d--into QuadSD_ak1 by reference\r\n                    var sdPar = new Object(),\r\n                            // TYPE = 3 indicates the quadratic is almost a factor of K\r\n                            dumFlag = 3;\r\n\r\n                    // Synthetic division of K by the quadratic 1, u, v\r\n                    sdPar.b = sdPar.a = 0.0;\r\n                    QuadSD_ak1(N, u, v, K, qk, sdPar);\r\n                    iPar.c = sdPar.a;\r\n                    iPar.d = sdPar.b;\r\n\r\n                    if(Math.abs(iPar.c) <= (100.0 * DBL_EPSILON * Math.abs(K[N - 1]))) {\r\n                        if(Math.abs(iPar.d) <= (100.0 * DBL_EPSILON * Math.abs(K[N - 2])))\r\n                            return dumFlag;\r\n                    }\r\n\r\n                    iPar.h = v * b;\r\n                    if(Math.abs(iPar.d) >= Math.abs(iPar.c)) {\r\n                        // TYPE = 2 indicates that all formulas are divided by d\r\n                        dumFlag = 2;\r\n                        iPar.e = a / (iPar.d);\r\n                        iPar.f = (iPar.c) / (iPar.d);\r\n                        iPar.g = u * b;\r\n                        iPar.a3 = (iPar.e) * ((iPar.g) + a) + (iPar.h) * (b / (iPar.d));\r\n                        iPar.a1 = -a + (iPar.f) * b;\r\n                        iPar.a7 = (iPar.h) + ((iPar.f) + u) * a;\r\n                    }\r\n                    else {\r\n                        // TYPE = 1 indicates that all formulas are divided by c;\r\n                        dumFlag = 1;\r\n                        iPar.e = a / (iPar.c);\r\n                        iPar.f = (iPar.d) / (iPar.c);\r\n                        iPar.g = (iPar.e) * u;\r\n                        iPar.a3 = (iPar.e) * a + ((iPar.g) + (iPar.h) / (iPar.c)) * b;\r\n                        iPar.a1 = -(a * ((iPar.d) / (iPar.c))) + b;\r\n                        iPar.a7 = (iPar.g) * (iPar.d) + (iPar.h) * (iPar.f) + a;\r\n                    }\r\n                    return dumFlag;\r\n                }\r\n\r\n                function nextK_ak1(DBL_EPSILON, N, tFlag, a, b, iPar, K, qk, qp) {\r\n                    // Computes the next K polynomials using the scalars computed in calcSC_ak1\r\n                    // iPar is a dummy variable for passing in three parameters--a1, a3, and a7\r\n                    var temp;\r\n                    if(tFlag == 3) {\t// Use unscaled form of the recurrence\r\n                        K[1] = K[0] = 0.0;\r\n                        for(var i = 2; i < N; i++) {\r\n                            K[i] = qk[i - 2];\r\n                        }\r\n                        return;\r\n                    }\r\n\r\n                    temp = ((tFlag == 1) ? b : a);\r\n                    if(Math.abs(iPar.a1) > (10.0 * DBL_EPSILON * Math.abs(temp))) {\r\n                        // Use scaled form of the recurrence\r\n                        iPar.a7 /= iPar.a1;\r\n                        iPar.a3 /= iPar.a1;\r\n                        K[0] = qp[0];\r\n                        K[1] = -(qp[0] * iPar.a7) + qp[1];\r\n                        for(var i = 2; i < N; i++)\r\n                            K[i] = -(qp[i - 1] * iPar.a7) + qk[i - 2] * iPar.a3 + qp[i];\r\n                    }\r\n                    else {\r\n                        // If a1 is nearly zero, then use a special form of the recurrence\r\n                        K[0] = 0.0;\r\n                        K[1] = -(qp[0] * iPar.a7);\r\n                        for(var i = 2; i < N; i++) {\r\n                            K[i] = -(qp[i - 1] * iPar.a7) + qk[i - 2] * iPar.a3;\r\n                        }\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                function newest_ak1(tFlag, iPar, a, a1, a3, a7, b, c, d, f, g, h, u, v, K, N, p) {\r\n                    // Compute new estimates of the quadratic coefficients using the scalars computed in calcSC_ak1\r\n                    // iPar is a dummy variable for passing in the two parameters--uu and vv--by reference\r\n                    // iPar.a = uu, iPar.b = vv\r\n\r\n                    var a4, a5, b1, b2, c1, c2, c3, c4, temp;\r\n                    iPar.b = iPar.a = 0.0;// The quadratic is zeroed\r\n\r\n                    if(tFlag != 3) {\r\n                        if(tFlag != 2) {\r\n                            a4 = a + u * b + h * f;\r\n                            a5 = c + (u + v * f) * d;\r\n                        }\r\n                        else {\r\n                            a4 = (a + g) * f + h;\r\n                            a5 = (f + u) * c + v * d;\r\n                        }\r\n\r\n                        // Evaluate new quadratic coefficients\r\n                        b1 = -(K[N - 1] / p[N]);\r\n                        b2 = -(K[N - 2] + b1 * p[N - 1]) / p[N];\r\n                        c1 = v * b2 * a1;\r\n                        c2 = b1 * a7;\r\n                        c3 = b1 * b1 * a3;\r\n                        c4 = -(c2 + c3) + c1;\r\n                        temp = -c4 + a5 + b1 * a4;\r\n                        if(temp != 0.0) {\r\n                            iPar.a = -((u * (c3 + c2) + v * (b1 * a1 + b2 * a7)) / temp) + u;\r\n                            iPar.b = v * (1.0 + c4 / temp);\r\n                        }\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                function Quad_ak1(a, b1, c, iPar) {\r\n                    // Calculates the zeros of the quadratic a*Z^2 + b1*Z + c\r\n                    // The quadratic formula, modified to avoid overflow, is used to find the larger zero if the\r\n                    // zeros are real and both zeros are complex. The smaller real zero is found directly from\r\n                    // the product of the zeros c/a.\r\n\r\n                    // iPar is a dummy variable for passing in the four parameters--sr, si, lr, and li--by reference\r\n\r\n                    var b, d, e;\r\n                    iPar.sr = iPar.si = iPar.lr = iPar.li = 0.0;\r\n\r\n                    if(a == 0) {\r\n                        iPar.sr = ((b1 != 0) ? -(c / b1) : iPar.sr);\r\n                        return;\r\n                    }\r\n                    if(c == 0) {\r\n                        iPar.lr = -(b1 / a);\r\n                        return;\r\n                    }\r\n\r\n                    // Compute discriminant avoiding overflow\r\n                    b = b1 / 2.0;\r\n                    if(Math.abs(b) < Math.abs(c)) {\r\n                        e = ((c >= 0) ? a : -a);\r\n                        e = -e + b * (b / Math.abs(c));\r\n                        d = Math.sqrt(Math.abs(e)) * Math.sqrt(Math.abs(c));\r\n                    }\r\n                    else {\r\n                        e = -((a / b) * (c / b)) + 1.0;\r\n                        d = Math.sqrt(Math.abs(e)) * (Math.abs(b));\r\n                    }\r\n\r\n                    if(e >= 0) {\r\n                        // Real zeros\r\n                        d = ((b >= 0) ? -d : d);\r\n                        iPar.lr = (-b + d) / a;\r\n                        iPar.sr = ((iPar.lr != 0) ? (c / (iPar.lr)) / a : iPar.sr);\r\n                    }\r\n                    else {\r\n                        // Complex conjugate zeros\r\n                        iPar.lr = iPar.sr = -(b / a);\r\n                        iPar.si = Math.abs(d / a);\r\n                        iPar.li = -(iPar.si);\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                function QuadIT_ak1(DBL_EPSILON, N, iPar, uu, vv, qp, NN, sdPar, p, qk, calcPar, K) {\r\n                    // Variable-shift K-polynomial iteration for a quadratic factor converges only if the\r\n                    // zeros are equimodular or nearly so.\r\n                    // iPar is a dummy variable for passing in the five parameters--NZ, lzi, lzr, szi, and szr--by reference\r\n                    // sdPar is a dummy variable for passing the two parameters--a and b--in by reference\r\n                    // calcPar is a dummy variable for passing the nine parameters--a1, a3, a7, c, d, e, f, g, and h --in by reference\r\n\r\n                    // qPar is a dummy variable for passing the four parameters--szr, szi, lzr, and lzi--into Quad_ak1 by reference\r\n                    var qPar = new Object(),\r\n                            ee, mp, omp, relstp, t, u, ui, v, vi, zm,\r\n                            i, j = 0, tFlag, triedFlag = 0;   // Integer variables\r\n\r\n                    iPar.NZ = 0;// Number of zeros found\r\n                    u = uu; // uu and vv are coefficients of the starting quadratic\r\n                    v = vv;\r\n\r\n                    do {\r\n                        qPar.li = qPar.lr = qPar.si = qPar.sr = 0.0;\r\n                        Quad_ak1(1.0, u, v, qPar);\r\n                        iPar.szr = qPar.sr;\r\n                        iPar.szi = qPar.si;\r\n                        iPar.lzr = qPar.lr;\r\n                        iPar.lzi = qPar.li;\r\n\r\n                        // Return if roots of the quadratic are real and not close to multiple or nearly\r\n                        // equal and of opposite sign.\r\n                        if(Math.abs(Math.abs(iPar.szr) - Math.abs(iPar.lzr)) > 0.01 * Math.abs(iPar.lzr))\r\n                            break;\r\n\r\n                        // Evaluate polynomial by quadratic synthetic division\r\n\r\n                        QuadSD_ak1(NN, u, v, p, qp, sdPar);\r\n\r\n                        mp = Math.abs(-((iPar.szr) * (sdPar.b)) + (sdPar.a)) + Math.abs((iPar.szi) * (sdPar.b));\r\n\r\n                        // Compute a rigorous bound on the rounding error in evaluating p\r\n\r\n                        zm = Math.sqrt(Math.abs(v));\r\n                        ee = 2.0 * Math.abs(qp[0]);\r\n                        t = -((iPar.szr) * (sdPar.b));\r\n\r\n                        for(i = 1; i < N; i++) {\r\n                            ee = ee * zm + Math.abs(qp[i]);\r\n                        }\r\n\r\n                        ee = ee * zm + Math.abs(t + sdPar.a);\r\n                        ee = (9.0 * ee + 2.0 * Math.abs(t) - 7.0 * (Math.abs((sdPar.a) + t) + zm * Math.abs((sdPar.b)))) * DBL_EPSILON;\r\n\r\n                        // Iteration has converged sufficiently if the polynomial value is less than 20 times this bound\r\n                        if(mp <= 20.0 * ee) {\r\n                            iPar.NZ = 2;\r\n                            break;\r\n                        }\r\n\r\n                        j++;\r\n                        // Stop iteration after 20 steps\r\n                        if(j > 20)\r\n                            break;\r\n                        if(j >= 2) {\r\n                            if((relstp <= 0.01) && (mp >= omp) && (!triedFlag)) {\r\n                                // A cluster appears to be stalling the convergence. Five fixed shift\r\n                                // steps are taken with a u, v close to the cluster.\r\n                                relstp = ((relstp < DBL_EPSILON) ? Math.sqrt(DBL_EPSILON) : Math.sqrt(relstp));\r\n                                u -= u * relstp;\r\n                                v += v * relstp;\r\n\r\n                                QuadSD_ak1(NN, u, v, p, qp, sdPar);\r\n                                for(i = 0; i < 5; i++) {\r\n                                    tFlag = calcSC_ak1(DBL_EPSILON, N, sdPar.a, sdPar.b, calcPar, K, u, v, qk);\r\n                                    nextK_ak1(DBL_EPSILON, N, tFlag, sdPar.a, sdPar.b, calcPar, K, qk, qp);\r\n                                }\r\n\r\n                                triedFlag = 1;\r\n                                j = 0;\r\n\r\n                            }\r\n                        }\r\n                        omp = mp;\r\n\r\n                        // Calculate next K polynomial and new u and v\r\n                        tFlag = calcSC_ak1(DBL_EPSILON, N, sdPar.a, sdPar.b, calcPar, K, u, v, qk);\r\n                        nextK_ak1(DBL_EPSILON, N, tFlag, sdPar.a, sdPar.b, calcPar, K, qk, qp);\r\n                        tFlag = calcSC_ak1(DBL_EPSILON, N, sdPar.a, sdPar.b, calcPar, K, u, v, qk);\r\n                        newest_ak1(tFlag, sdPar, sdPar.a, calcPar.a1, calcPar.a3, calcPar.a7, sdPar.b, calcPar.c, calcPar.d, calcPar.f, calcPar.g, calcPar.h, u, v, K, N, p);\r\n                        ui = sdPar.a;\r\n                        vi = sdPar.b;\r\n\r\n                        // If vi is zero, the iteration is not converging\r\n                        if(vi != 0) {\r\n                            relstp = Math.abs((-v + vi) / vi);\r\n                            u = ui;\r\n                            v = vi;\r\n                        }\r\n                    }\r\n                    while(vi != 0);\r\n                    return;\r\n                }\r\n\r\n                function RealIT_ak1(DBL_EPSILON, iPar, sdPar, N, p, NN, qp, K, qk) {\r\n                    // Variable-shift H-polynomial iteration for a real zero\r\n                    // sss\t- starting iterate = sdPar.a\r\n                    // NZ\t\t- number of zeros found = iPar.NZ\r\n                    // dumFlag\t- flag to indicate a pair of zeros near real axis, returned to iFlag\r\n\r\n                    var ee, kv, mp, ms, omp, pv, s, t,\r\n                            dumFlag, i, j, nm1 = N - 1;   // Integer variables\r\n\r\n                    iPar.NZ = j = dumFlag = 0;\r\n                    s = sdPar.a;\r\n\r\n                    for(; ; ) {\r\n                        pv = p[0];\r\n\r\n                        // Evaluate p at s\r\n                        qp[0] = pv;\r\n                        for(i = 1; i < NN; i++) {\r\n                            qp[i] = pv = pv * s + p[i];\r\n                        }\r\n                        mp = Math.abs(pv);\r\n\r\n                        // Compute a rigorous bound on the error in evaluating p\r\n                        ms = Math.abs(s);\r\n                        ee = 0.5 * Math.abs(qp[0]);\r\n                        for(i = 1; i < NN; i++) {\r\n                            ee = ee * ms + Math.abs(qp[i]);\r\n                        }\r\n\r\n                        // Iteration has converged sufficiently if the polynomial value is less than\r\n                        // 20 times this bound\r\n                        if(mp <= 20.0 * DBL_EPSILON * (2.0 * ee - mp)) {\r\n                            iPar.NZ = 1;\r\n                            iPar.szr = s;\r\n                            iPar.szi = 0.0;\r\n                            break;\r\n                        }\r\n                        j++;\r\n                        // Stop iteration after 10 steps\r\n                        if(j > 10)\r\n                            break;\r\n\r\n                        if(j >= 2) {\r\n                            if((Math.abs(t) <= 0.001 * Math.abs(-t + s)) && (mp > omp)) {\r\n                                // A cluster of zeros near the real axis has been encountered.\r\n                                // Return with iFlag set to initiate a quadratic iteration.\r\n                                dumFlag = 1;\r\n                                iPar.a = s;\r\n                                break;\r\n                            } // End if ((fabs(t) <= 0.001*fabs(s - t)) && (mp > omp))\r\n                        } //End if (j >= 2)\r\n\r\n                        // Return if the polynomial value has increased significantly\r\n                        omp = mp;\r\n\r\n                        // Compute t, the next polynomial and the new iterate\r\n                        qk[0] = kv = K[0];\r\n                        for(i = 1; i < N; i++) {\r\n                            qk[i] = kv = kv * s + K[i];\r\n                        }\r\n\r\n                        if(Math.abs(kv) > Math.abs(K[nm1]) * 10.0 * DBL_EPSILON) {\r\n                            // Use the scaled form of the recurrence if the value of K at s is non-zero\r\n                            t = -(pv / kv);\r\n                            K[0] = qp[0];\r\n                            for(i = 1; i < N; i++) {\r\n                                K[i] = t * qk[i - 1] + qp[i];\r\n                            }\r\n                        }\r\n                        else {\r\n                            // Use unscaled form\r\n                            K[0] = 0.0;\r\n                            for(i = 1; i < N; i++)\r\n                                K[i] = qk[i - 1];\r\n                        }\r\n\r\n                        kv = K[0];\r\n                        for(i = 1; i < N; i++) {\r\n                            kv = kv * s + K[i];\r\n                        }\r\n                        t = ((Math.abs(kv) > (Math.abs(K[nm1]) * 10.0 * DBL_EPSILON)) ? -(pv / kv) : 0.0);\r\n                        s += t;\r\n                    }\r\n                    return dumFlag;\r\n                }\r\n\r\n                function Fxshfr_ak1(DBL_EPSILON, MDP1, L2, sr, v, K, N, p, NN, qp, u, iPar) {\r\n\r\n                    // Computes up to L2 fixed shift K-polynomials, testing for convergence in the linear or\r\n                    // quadratic case. Initiates one of the variable shift iterations and returns with the\r\n                    // number of zeros found.\r\n                    // L2\tlimit of fixed shift steps\r\n                    // iPar is a dummy variable for passing in the five parameters--NZ, lzi, lzr, szi, and szr--by reference\r\n                    // NZ\tnumber of zeros found\r\n                    var sdPar = new Object(), // sdPar is a dummy variable for passing the two parameters--a and b--into QuadSD_ak1 by reference\r\n                            calcPar = new Object(),\r\n                            // calcPar is a dummy variable for passing the nine parameters--a1, a3, a7, c, d, e, f, g, and h --into calcSC_ak1 by reference\r\n\r\n                            qk = new Array(MDP1),\r\n                            svk = new Array(MDP1),\r\n                            a, b, betas, betav, oss, ots, otv, ovv, s, ss, ts, tss, tv, tvv, ui, vi, vv,\r\n                            fflag, i, iFlag = 1, j, spass, stry, tFlag, vpass, vtry;     // Integer variables\r\n\r\n                    iPar.NZ = 0;\r\n                    betav = betas = 0.25;\r\n                    oss = sr;\r\n                    ovv = v;\r\n\r\n                    //Evaluate polynomial by synthetic division\r\n                    sdPar.b = sdPar.a = 0.0;\r\n                    QuadSD_ak1(NN, u, v, p, qp, sdPar);\r\n                    a = sdPar.a;\r\n                    b = sdPar.b;\r\n                    calcPar.h = calcPar.g = calcPar.f = calcPar.e = calcPar.d = calcPar.c = calcPar.a7 = calcPar.a3 = calcPar.a1 = 0.0;\r\n                    tFlag = calcSC_ak1(DBL_EPSILON, N, a, b, calcPar, K, u, v, qk);\r\n\r\n                    for(j = 0; j < L2; j++) {\r\n                        fflag = 1;\r\n\r\n                        // Calculate next K polynomial and estimate v\r\n                        nextK_ak1(DBL_EPSILON, N, tFlag, a, b, calcPar, K, qk, qp);\r\n                        tFlag = calcSC_ak1(DBL_EPSILON, N, a, b, calcPar, K, u, v, qk);\r\n\r\n                        // Use sdPar for passing in uu and vv instead of defining a brand-new variable.\r\n                        // sdPar.a = ui, sdPar.b = vi\r\n                        newest_ak1(tFlag, sdPar, a, calcPar.a1, calcPar.a3, calcPar.a7, b, calcPar.c, calcPar.d, calcPar.f, calcPar.g, calcPar.h, u, v, K, N, p);\r\n                        ui = sdPar.a;\r\n                        vv = vi = sdPar.b;\r\n\r\n                        // Estimate s\r\n                        ss = ((K[N - 1] != 0.0) ? -(p[N] / K[N - 1]) : 0.0);\r\n                        ts = tv = 1.0;\r\n\r\n                        if((j != 0) && (tFlag != 3)) {\r\n                            // Compute relative measures of convergence of s and v sequences\r\n                            tv = ((vv != 0.0) ? Math.abs((vv - ovv) / vv) : tv);\r\n                            ts = ((ss != 0.0) ? Math.abs((ss - oss) / ss) : ts);\r\n\r\n                            // If decreasing, multiply the two most recent convergence measures\r\n                            tvv = ((tv < otv) ? tv * otv : 1.0);\r\n                            tss = ((ts < ots) ? ts * ots : 1.0);\r\n\r\n                            // Compare with convergence criteria\r\n                            vpass = ((tvv < betav) ? 1 : 0);\r\n                            spass = ((tss < betas) ? 1 : 0);\r\n\r\n                            if((spass) || (vpass)) {\r\n\r\n                                // At least one sequence has passed the convergence test.\r\n                                // Store variables before iterating\r\n\r\n                                for(i = 0; i < N; i++) {\r\n                                    svk[i] = K[i];\r\n                                }\r\n                                s = ss;\r\n\r\n                                // Choose iteration according to the fastest converging sequence\r\n\r\n                                stry = vtry = 0;\r\n\r\n                                for(; ; ) {\r\n                                    if((fflag && ((fflag = 0) == 0)) && ((spass) && (!vpass || (tss < tvv)))) {\r\n                                        ;// Do nothing. Provides a quick \"short circuit\".\r\n                                    }\r\n                                    else {\r\n                                        QuadIT_ak1(DBL_EPSILON, N, iPar, ui, vi, qp, NN, sdPar, p, qk, calcPar, K);\r\n                                        a = sdPar.a;\r\n                                        b = sdPar.b;\r\n\r\n                                        if((iPar.NZ) > 0)\r\n                                            return;\r\n\r\n                                        // Quadratic iteration has failed. Flag that it has been tried and decrease the\r\n                                        // convergence criterion\r\n                                        iFlag = vtry = 1;\r\n                                        betav *= 0.25;\r\n\r\n                                        // Try linear iteration if it has not been tried and the s sequence is converging\r\n                                        if(stry || (!spass)) {\r\n                                            iFlag = 0;\r\n                                        }\r\n                                        else {\r\n                                            for(i = 0; i < N; i++)\r\n                                                K[i] = svk[i];\r\n                                        }\r\n                                    }\r\n                                    //fflag = 0;\r\n                                    if(iFlag != 0) {\r\n                                        // Use sdPar for passing in s instead of defining a brand-new variable.\r\n                                        // sdPar.a = s\r\n                                        sdPar.a = s;\r\n                                        iFlag = RealIT_ak1(DBL_EPSILON, iPar, sdPar, N, p, NN, qp, K, qk);\r\n                                        s = sdPar.a;\r\n\r\n                                        if((iPar.NZ) > 0)\r\n                                            return;\r\n\r\n                                        // Linear iteration has failed. Flag that it has been tried and decrease the\r\n                                        // convergence criterion\r\n                                        stry = 1;\r\n                                        betas *= 0.25;\r\n\r\n                                        if(iFlag != 0) {\r\n                                            // If linear iteration signals an almost double real zero, attempt quadratic iteration\r\n                                            ui = -(s + s);\r\n                                            vi = s * s;\r\n                                            continue;\r\n\r\n                                        }\r\n                                    }\r\n\r\n                                    // Restore variables\r\n                                    for(i = 0; i < N; i++)\r\n                                        K[i] = svk[i];\r\n\r\n                                    // Try quadratic iteration if it has not been tried and the v sequence is converging\r\n                                    if(!vpass || vtry)\r\n                                        break;\t\t// Break out of infinite for loop\r\n\r\n                                }\r\n\r\n                                // Re-compute qp and scalar values to continue the second stage\r\n\r\n                                QuadSD_ak1(NN, u, v, p, qp, sdPar);\r\n                                a = sdPar.a;\r\n                                b = sdPar.b;\r\n\r\n                                tFlag = calcSC_ak1(DBL_EPSILON, N, a, b, calcPar, K, u, v, qk);\r\n                            }\r\n                        }\r\n                        ovv = vv;\r\n                        oss = ss;\r\n                        otv = tv;\r\n                        ots = ts;\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                function rpSolve(degPar, p, zeror, zeroi) {\r\n                    var N = degPar.Degree,\r\n                            RADFAC = 3.14159265358979323846 / 180, // Degrees-to-radians conversion factor = PI/180\r\n                            LB2 = Math.LN2, // Dummy variable to avoid re-calculating this value in loop below\r\n                            MDP1 = degPar.Degree + 1,\r\n                            K = new Array(MDP1),\r\n                            pt = new Array(MDP1),\r\n                            qp = new Array(MDP1),\r\n                            temp = new Array(MDP1),\r\n                            // qPar is a dummy variable for passing the four parameters--sr, si, lr, and li--by reference\r\n                            qPar = new Object(),\r\n                            // Fxshfr_Par is a dummy variable for passing parameters by reference : NZ, lzi, lzr, szi, szr);\r\n                            Fxshfr_Par = new Object(),\r\n                            bnd, DBL_EPSILON, df, dx, factor, ff, moduli_max, moduli_min, sc, x, xm,\r\n                            aa, bb, cc, sr, t, u, xxx,\r\n                            j, jj, l, NM1, NN, zerok;// Integer variables\r\n\r\n                    // Calculate the machine epsilon and store in the variable DBL_EPSILON.\r\n                    // To calculate this value, just use existing variables rather than create new ones that will be used only for this code block\r\n                    aa = 1.0;\r\n                    do {\r\n                        DBL_EPSILON = aa;\r\n                        aa /= 2;\r\n                        bb = 1.0 + aa;\r\n                    }\r\n                    while(bb > 1.0);\r\n\r\n                    var LO = Number.MIN_VALUE / DBL_EPSILON,\r\n                            cosr = Math.cos(94.0 * RADFAC), // = -0.069756474\r\n                            sinr = Math.sin(94.0 * RADFAC), // = 0.99756405\r\n                            xx = Math.sqrt(0.5), // = 0.70710678\r\n                            yy = -xx;\r\n\r\n                    Fxshfr_Par.NZ = j = 0;\r\n                    Fxshfr_Par.szr = Fxshfr_Par.szi = Fxshfr_Par.lzr = Fxshfr_Par.lzi = 0.0;\r\n\r\n                    // Remove zeros at the origin, if any\r\n                    while(p[N] == 0) {\r\n                        zeror[j] = zeroi[j] = 0;\r\n                        N--;\r\n                        j++;\r\n                    }\r\n                    NN = N + 1;\r\n\r\n                    // >>>>> Begin Main Loop <<<<<\r\n                    while(N >= 1) { // Main loop\r\n                        // Start the algorithm for one zero\r\n                        if(N <= 2) {\r\n                            // Calculate the final zero or pair of zeros\r\n                            if(N < 2) {\r\n                                zeror[degPar.Degree - 1] = -(p[1] / p[0]);\r\n                                zeroi[degPar.Degree - 1] = 0;\r\n                            }\r\n                            else {\r\n                                qPar.li = qPar.lr = qPar.si = qPar.sr = 0.0;\r\n                                Quad_ak1(p[0], p[1], p[2], qPar);\r\n                                zeror[degPar.Degree - 2] = qPar.sr;\r\n                                zeroi[degPar.Degree - 2] = qPar.si;\r\n                                zeror[degPar.Degree - 1] = qPar.lr;\r\n                                zeroi[degPar.Degree - 1] = qPar.li;\r\n                            }\r\n                            break;\r\n                        }\r\n\r\n                        // Find the largest and smallest moduli of the coefficients\r\n                        moduli_max = 0.0;\r\n                        moduli_min = Number.MAX_VALUE;\r\n\r\n                        for(i = 0; i < NN; i++) {\r\n                            x = Math.abs(p[i]);\r\n                            if(x > moduli_max)\r\n                                moduli_max = x;\r\n                            if((x != 0) && (x < moduli_min))\r\n                                moduli_min = x;\r\n                        }\r\n\r\n                        // Scale if there are large or very small coefficients\r\n                        // Computes a scale factor to multiply the coefficients of the polynomial. The scaling\r\n                        // is done to avoid overflow and to avoid undetected underflow interfering with the\r\n                        // convergence criterion.\r\n                        // The factor is a power of the base.\r\n                        sc = LO / moduli_min;\r\n\r\n                        if(((sc <= 1.0) && (moduli_max >= 10)) || ((sc > 1.0) && (Number.MAX_VALUE / sc >= moduli_max))) {\r\n                            sc = ((sc == 0) ? Number.MIN_VALUE : sc);\r\n                            l = Math.floor(Math.log(sc) / LB2 + 0.5);\r\n                            factor = Math.pow(2.0, l);\r\n                            if(factor != 1.0) {\r\n                                for(i = 0; i < NN; i++)\r\n                                    p[i] *= factor;\r\n                            }\r\n                        }\r\n\r\n                        // Compute lower bound on moduli of zeros\r\n                        for(var i = 0; i < NN; i++)\r\n                            pt[i] = Math.abs(p[i]);\r\n                        pt[N] = -(pt[N]);\r\n                        NM1 = N - 1;\r\n\r\n                        // Compute upper estimate of bound\r\n                        x = Math.exp((Math.log(-pt[N]) - Math.log(pt[0])) / N);\r\n\r\n                        if(pt[NM1] != 0) {\r\n                            // If Newton step at the origin is better, use it\r\n                            xm = -pt[N] / pt[NM1];\r\n                            x = ((xm < x) ? xm : x);\r\n                        }\r\n\r\n                        // Chop the interval (0, x) until ff <= 0\r\n                        xm = x;\r\n                        do {\r\n                            x = xm;\r\n                            xm = 0.1 * x;\r\n                            ff = pt[0];\r\n                            for(var i = 1; i < NN; i++) {\r\n                                ff = ff * xm + pt[i];\r\n                            }\r\n                        }\r\n                        while(ff > 0); // End do-while loop\r\n\r\n                        dx = x;\r\n                        // Do Newton iteration until x converges to two decimal places\r\n\r\n                        do {\r\n                            df = ff = pt[0];\r\n                            for(var i = 1; i < N; i++) {\r\n                                ff = x * ff + pt[i];\r\n                                df = x * df + ff;\r\n                            } // End for i\r\n                            ff = x * ff + pt[N];\r\n                            dx = ff / df;\r\n                            x -= dx;\r\n                        }\r\n                        while(Math.abs(dx / x) > 0.005); // End do-while loop\r\n\r\n                        bnd = x;\r\n\r\n                        // Compute the derivative as the initial K polynomial and do 5 steps with no shift\r\n                        for(var i = 1; i < N; i++)\r\n                            K[i] = (N - i) * p[i] / N;\r\n                        K[0] = p[0];\r\n                        aa = p[N];\r\n                        bb = p[NM1];\r\n                        zerok = ((K[NM1] == 0) ? 1 : 0);\r\n\r\n                        for(jj = 0; jj < 5; jj++) {\r\n                            cc = K[NM1];\r\n                            if(zerok) {\r\n                                // Use unscaled form of recurrence\r\n                                for(var i = 0; i < NM1; i++) {\r\n                                    j = NM1 - i;\r\n                                    K[j] = K[j - 1];\r\n                                } // End for i\r\n                                K[0] = 0;\r\n                                zerok = ((K[NM1] == 0) ? 1 : 0);\r\n                            }\r\n                            else {\r\n                                // Used scaled form of recurrence if value of K at 0 is nonzero\r\n                                t = -aa / cc;\r\n                                for(var i = 0; i < NM1; i++) {\r\n                                    j = NM1 - i;\r\n                                    K[j] = t * K[j - 1] + p[j];\r\n                                } // End for i\r\n                                K[0] = p[0];\r\n                                zerok = ((Math.abs(K[NM1]) <= Math.abs(bb) * DBL_EPSILON * 10.0) ? 1 : 0);\r\n                            }\r\n                        }\r\n\r\n                        // Save K for restarts with new shifts\r\n                        for(var i = 0; i < N; i++)\r\n                            temp[i] = K[i];\r\n\r\n                        // Loop to select the quadratic corresponding to each new shift\r\n                        for(jj = 1; jj <= 20; jj++) {\r\n\r\n                            // Quadratic corresponds to a double shift to a non-real point and its\r\n                            // complex conjugate. The point has modulus BND and amplitude rotated\r\n                            // by 94 degrees from the previous shift.\r\n\r\n                            xxx = -(sinr * yy) + cosr * xx;\r\n                            yy = sinr * xx + cosr * yy;\r\n                            xx = xxx;\r\n                            sr = bnd * xx;\r\n                            u = -(2.0 * sr);\r\n\r\n                            // Second stage calculation, fixed quadratic\r\n                            Fxshfr_ak1(DBL_EPSILON, MDP1, 20 * jj, sr, bnd, K, N, p, NN, qp, u, Fxshfr_Par);\r\n\r\n                            if(Fxshfr_Par.NZ != 0) {\r\n                                // The second stage jumps directly to one of the third stage iterations and\r\n                                // returns here if successful. Deflate the polynomial, store the zero or\r\n                                // zeros, and return to the main algorithm.\r\n                                j = degPar.Degree - N;\r\n                                zeror[j] = Fxshfr_Par.szr;\r\n                                zeroi[j] = Fxshfr_Par.szi;\r\n                                NN = NN - Fxshfr_Par.NZ;\r\n                                N = NN - 1;\r\n                                for(var i = 0; i < NN; i++)\r\n                                    p[i] = qp[i];\r\n                                if(Fxshfr_Par.NZ != 1) {\r\n                                    zeror[j + 1] = Fxshfr_Par.lzr;\r\n                                    zeroi[j + 1] = Fxshfr_Par.lzi;\r\n                                }\r\n                                break;\r\n                            }\r\n                            else {\r\n                                // If the iteration is unsuccessful, another quadratic is chosen after restoring K\r\n                                for(var i = 0; i < N; i++) {\r\n                                    K[i] = temp[i];\r\n                                }\r\n                            }\r\n                        }\r\n                        // Return with failure if no convergence with 20 shifts\r\n                        if(jj > 20) {\r\n                            degPar.Degree -= N;\r\n                            break;\r\n                        }\r\n                    }\r\n                    // >>>>> End Main Loop <<<<<\r\n                    return;\r\n                }\r\n                //--> End Jenkins-Traub\r\n                rpSolve(degreePar, p, zeror, zeroi);\r\n\r\n                var l = zeroi.length;\r\n                //format the output\r\n                for(i = 0; i < l; i++) {\r\n                    // We round the imaginary part to avoid having something crazy like 5.67e-16.\r\n                    var img = round(zeroi[i], decp + 8),\r\n                            real = round(zeror[i], decp + 8);\r\n                    // Did the rounding pay off? If the rounding did nothing more than chop off a few digits then no.\r\n                    // If the rounding results in a a number at least 3 digits shorter we'll keep it else we'll keep \r\n                    // the original otherwise the rounding was worth it.\r\n                    real = decp - String(real).length > 2 ? real : zeror[i];\r\n                    var sign = img < 0 ? '-' : '';\r\n\r\n                    // Remove the zeroes\r\n                    if(real === 0) {\r\n                        real = '';\r\n                    }\r\n                    if(img === 0) {\r\n                        img = '';\r\n                    }\r\n\r\n                    // Remove 1 as the multiplier and discard imaginary part if there isn't one.\r\n                    img = Math.abs(img) === 1 ? sign + 'i' : (img ? img + '*i' : '');\r\n\r\n                    var num = (real && img) ? real + '+' + img : real + img;\r\n                    zeror[i] = num.replace(/\\+\\-/g, '-');\r\n                }\r\n                return zeror;\r\n            }\r\n        },\r\n        roots: function (symbol) {\r\n\r\n            if(symbol.isConstant(true, true)) {\r\n                return core.Utils.nroots(symbol);\r\n            }\r\n            var roots = __.proots(symbol).map(function (x) {\r\n                return _.parse(x);\r\n            });\r\n            return core.Vector.fromArray(roots);\r\n        },\r\n        froot: function (f, guess, dx) {\r\n            var newtonraph = function (xn) {\r\n                var mesh = 1e-12,\r\n                        // If the derivative was already provided then don't recalculate.\r\n                        df = dx ? dx : core.Utils.build(core.Calculus.diff(f.clone())),\r\n                        // If the function was passed in as a function then don't recalculate.\r\n                        fn = f instanceof Function ? f : core.Utils.build(f),\r\n                        max = 10000,\r\n                        done = false,\r\n                        safety = 0;\r\n                while(!done) {\r\n                    var x = xn - (fn(xn) / df(xn));\r\n                    //absolute values for both x & xn ensures that we indeed have the radius    \r\n                    var r = Math.abs(x) - Math.abs(xn),\r\n                            delta = Math.abs(r);\r\n                    xn = x;\r\n\r\n                    if(delta < mesh)\r\n                        done = true;\r\n                    else if(safety > max) {\r\n                        xn = null;\r\n                        done = true;\r\n                    }\r\n\r\n                    safety++;\r\n                }\r\n                return xn;\r\n            };\r\n            return newtonraph(Number(guess));\r\n        },\r\n        quad: function (a, b, c) {\r\n            var q = function (a, b, c, sign) {\r\n                return _.parse('-(' + b + '+' + sign + '*sqrt((' + b + ')^2-4*(' + a + ')*(' + c + ')))/(2*' + a + ')');\r\n            };\r\n            return [q(a, b, c, 1), q(a, b, c, -1)];\r\n        },\r\n        sumProd: function (a, b) {\r\n            return __.quad(-b, a, -1).map(function (x) {\r\n                return x.invert();\r\n            });\r\n        },\r\n        coeffs: function (symbol, wrt, coeffs) {\r\n            wrt = String(wrt);\r\n            symbol = _.expand(symbol);\r\n            coeffs = coeffs || [new Symbol(0)];\r\n            //we cannot get coeffs for group EX\r\n            if(symbol.group === EX && symbol.contains(wrt, true))\r\n                _.error('Unable to get coefficients using expression ' + symbol.toString());\r\n            var vars = variables(symbol);\r\n            if(vars.length === 1 && vars[0] === wrt && !symbol.isImaginary()) {\r\n                var a = new Polynomial(symbol).coeffs.map(function (x) {\r\n                    return new Symbol(x);\r\n                });\r\n\r\n                for(var i = 0, l = a.length; i < l; i++) {\r\n                    var coeff = a[i],\r\n                            e = coeffs[i];\r\n                    if(e)\r\n                        coeff = _.add(e, coeff);\r\n                    coeffs[i] = coeff; //transfer it all over\r\n                }\r\n            }\r\n            else {\r\n                if(!wrt)\r\n                    _.error('Polynomial contains more than one variable. Please specify which variable is to be used!');\r\n                //if the variable isn't part of this polynomial then we're looking at x^0\r\n\r\n                if(vars.indexOf(wrt) === -1) {\r\n                    coeffs[0] = _.add(symbol, coeffs[0]);\r\n                }\r\n                else {\r\n                    coeffs = coeffs || [new Symbol(0)];\r\n                    if(symbol.group === CB) {\r\n                        var s = symbol.symbols[wrt];\r\n                        if(!s)\r\n                            _.error('Expression is not a polynomial!');\r\n                        var p = Number(s.power);\r\n                        coeff = _.divide(symbol.clone(), s.clone());\r\n                        if(coeff.contains(wrt, true) || p < 0 || !isInt(p))\r\n                            _.error('Expression is not a polynomial!');\r\n                        var e = coeffs[p];\r\n                        if(e)\r\n                            coeff = _.add(e, coeff);\r\n                        coeffs[p] = coeff;\r\n                    }\r\n                    else if(symbol.group === CP) {\r\n                        symbol.each(function (x) {\r\n                            __.coeffs(x.clone(), wrt, coeffs);\r\n                        }, true);\r\n                    }\r\n                }\r\n            }\r\n            //fill holes\r\n            for(var i = 0, l = coeffs.length; i < l; i++)\r\n                if(typeof coeffs[i] === 'undefined')\r\n                    coeffs[i] = new Symbol(0);\r\n\r\n            return coeffs;\r\n        },\r\n        /**\r\n         * Get's all the powers of a particular polynomial including the denominators. The denominators powers\r\n         * are returned as negative. All remaining polynomials are returned as zero order polynomials.\r\n         * for example polyPowers(x^2+1/x+y+t) will return [ '-1', 0, '2' ]\r\n         * @param {Symbol} e\r\n         * @param {String} for_variable\r\n         * @param {Array} powers\r\n         * @returns {Array} An array of the powers\r\n         */\r\n        //assumes you've already verified that it's a polynomial\r\n        polyPowers: function (e, for_variable, powers) {\r\n            powers = powers || [];\r\n            var g = g = e.group;\r\n            if(g === PL && for_variable === e.value) {\r\n                powers = powers.concat(keys(e.symbols));\r\n            }\r\n            else if(g === CP) {\r\n                for(var s in e.symbols) {\r\n                    var symbol = e.symbols[s];\r\n                    var g = symbol.group, v = symbol.value;\r\n                    if(g === S && for_variable === v)\r\n                        powers.push(symbol.power);\r\n                    else if(g === PL || g === CP)\r\n                        powers = __.polyPowers(symbol, for_variable, powers);\r\n                    else if(g === CB && symbol.contains(for_variable)) {\r\n                        var t = symbol.symbols[for_variable];\r\n                        if(t)\r\n                            powers.push((t.power));\r\n                    }\r\n                    else if(g === N || for_variable !== v)\r\n                        powers.push(0);\r\n                }\r\n            }\r\n            else if(g === CB && e.contains(for_variable)) {\r\n                powers.push(core.Utils.decompose_fn(e, for_variable, true).x.power);\r\n            }\r\n            return core.Utils.arrayUnique(powers).sort();\r\n        },\r\n        //The factor object\r\n        Factor: {\r\n            //splits the symbol in symbol and constant\r\n            split: function (symbol) {\r\n                var c = new Symbol(1); //the constants part\r\n                var s = new Symbol(1); //the symbolic part\r\n                __.Factor.factor(symbol, new Factors()).each(function (x) {\r\n                    var t = _.parse(x);\r\n                    if(x.isConstant(true)) {\r\n                        c = _.multiply(c, t);\r\n                    }\r\n                    else {\r\n                        s = _.multiply(s, t);\r\n                    }\r\n                });\r\n                return [c, s];\r\n            },\r\n            mix: function (o, include_negatives) {\r\n                var factors = keys(o);\r\n                var l = factors.length;\r\n                var m = [];//create a row which we'r going to be mixing\r\n                for(var i = 0; i < l; i++) {\r\n                    var factor = factors[i],\r\n                            p = o[factor];\r\n                    var ll = m.length;\r\n                    for(var j = 0; j < ll; j++) {\r\n                        var t = m[j] * factor;\r\n                        m.push(t);\r\n                        if(include_negatives)\r\n                            m.push(-t);\r\n                    }\r\n\r\n                    for(var j = 1; j <= p; j++)\r\n                        m.push(Math.pow(factor, j));\r\n                }\r\n                return m;\r\n            },\r\n            //TODO: this method is to replace common factoring\r\n            common: function (symbol, factors) {\r\n                try {\r\n                    if(symbol.group === CP) {\r\n                        //this may have the unfortunate side effect of expanding and factoring again\r\n                        //to only end up with the same result. \r\n                        //TODO: try to avoid this\r\n                        //collect the symbols and sort to have the longest first. Thinking is that the longest terms \r\n                        //has to contain the variable in order for it to be factorable\r\n                        var symbols = _.expand(symbol.clone(), true).collectSymbols(null, null, function (a, b) {\r\n                            return (b.length || 1) - (a.length || 1);\r\n                        });\r\n\r\n                        var map = {}; //create a map of common factors\r\n                        var coeffs = [];\r\n                        for(var i = 0; i < symbols.length; i++) {\r\n                            var sym = symbols[i];\r\n                            coeffs.push(sym.multiplier.clone());\r\n                            sym.each(function (x) {\r\n                                var p = Number(x.power);\r\n                                //This check exits since we have a symbolic power.\r\n                                //For the future... think about removing this check and modify for symbolic powers\r\n                                if(isNaN(p))\r\n                                    throw new Error('exiting');\r\n                                //loop through the symbols and lump together common terms\r\n                                if(x.value in map) {\r\n                                    if(p < map[x.value][0])\r\n                                        map[x.value][0] = p;\r\n                                    map[x.value][1].push(x);\r\n                                }\r\n                                else\r\n                                    map[x.value] = [p, [x]];\r\n                            });\r\n                        }\r\n                        //the factor\r\n                        var factor = new Symbol(1);\r\n                        for(var x in map) {\r\n                            //if this factor is found in all terms since the length of \r\n                            //matching variable terms matches the number of original terms\r\n                            if(map[x][1].length === symbols.length) {\r\n                                //generate a symbol and multiply into the factor\r\n                                factor = _.multiply(factor, _.pow(new Symbol(x), new Symbol(map[x][0])));\r\n                            }\r\n                        }\r\n                        //get coefficient factor\r\n                        var c = core.Math2.QGCD.apply(null, coeffs);\r\n\r\n                        if(!c.equals(1)) {\r\n                            factors.add(new Symbol(c));\r\n                            for(var i = 0; i < symbols.length; i++) {\r\n                                symbols[i].multiplier = symbols[i].multiplier.divide(c);\r\n                            }\r\n                        }\r\n\r\n                        //if we actuall found any factors\r\n                        if(!factor.equals(1)) {\r\n                            factors.add(factor);\r\n                            symbol = new Symbol(0);\r\n                            for(var i = 0; i < symbols.length; i++) {\r\n                                symbol = _.add(symbol, _.divide(symbols[i], factor.clone()));\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                catch(e) {\r\n                    ;\r\n                }\r\n\r\n                return symbol;\r\n            },\r\n            zeroes: function (symbol, factors) {\r\n                var exit = function () {\r\n                    throw new core.exceptions.ValueLimitExceededError('Exiting');\r\n                };\r\n                try {\r\n                    var vars, term, sum, p, e;\r\n                    symbol = _.expand(symbol.clone());\r\n                    e = symbol.toString();\r\n                    vars = variables(symbol);\r\n\r\n                    sum = new Symbol(0);\r\n\r\n                    var terms = [];\r\n                    var powers = [];\r\n\r\n                    //start setting each variable to zero\r\n                    for(var i = 0, l = vars.length; i < vars.length; i++) {\r\n                        var subs = {};\r\n                        //we want to create a subs object with all but the current variable set to zero\r\n                        for(var j = 0; j < l; j++)\r\n                            if(i !== j) //make sure we're not looking at the same variable\r\n                                subs[vars[j]] = 0;\r\n                        term = _.parse(e, subs);\r\n                        var tp = term.power;\r\n                        //the temporary power has to be an integer as well\r\n                        if(!isInt(tp))\r\n                            exit();\r\n                        terms.push(term);\r\n                        powers.push(term.power);\r\n                    }\r\n\r\n                    //get the gcd. This will be the p in (a^n+b^m)^p\r\n                    //if the gcd equals 1 meaning n = m then we need a tie breakder\r\n                    if(core.Utils.allSame(powers)) {\r\n                        //get p given x number of terms\r\n                        var n_terms = symbol.length;\r\n                        //the number of zeroes determines\r\n                        var n_zeroes = terms.length;\r\n                        if(n_zeroes === 2) {\r\n                            p = new Frac(powers[0] / (n_terms - 1));\r\n                        }\r\n                        if(n_zeroes === 3) {\r\n                            p = new Frac(powers[0] / Math.round((Math.sqrt(8 * n_terms - 1) - 3) / 2));\r\n                        }\r\n                        /*\r\n                         //get the lowest possible power\r\n                         //e.g. given b^4+2*a^2*b^2+a^4, the power we're looking for would be 2\r\n                         symbol.each(function(x) {\r\n                         if(x.group === CB)\r\n                         x.each(function(y) {\r\n                         if(!p || y.power.lessThan(p))\r\n                         //p = Number(y.power);\r\n                         p = y.power;\r\n                         });\r\n                         else if(!p || x.power.lessThan(p))\r\n                         //p = Number(x.power);\r\n                         p = x.power;\r\n                         });\r\n                         */\r\n                    }\r\n                    else\r\n                        //p is just the gcd of the powers\r\n                        p = core.Math2.QGCD.apply(null, powers);\r\n\r\n                    //if we don't have an integer then exit\r\n                    if(!isInt(p))\r\n                        exit();\r\n\r\n                    //build the factor\r\n                    for(var i = 0; i < terms.length; i++) {\r\n                        var t = terms[i];\r\n                        var n = t.power.clone().divide(p);\r\n                        t.multiplier = new Frac(Math.pow(t.multiplier, 1 / n));\r\n                        t.power = p.clone();\r\n                        sum = _.add(sum, t);\r\n                    }\r\n\r\n                    //by now we have the factor of zeroes. We'll know if we got it right because \r\n                    //we'll get a remainder of zero each time we divide by it\r\n                    if(sum.group !== CP)\r\n                        return symbol; //nothing to do\r\n\r\n                    while(true) {\r\n                        var d = __.div(symbol.clone(), sum.clone());\r\n                        if(d[1].equals(0)) {\r\n                            symbol = d[0];\r\n                            factors.add(sum.clone());\r\n                            if(symbol.equals(1)) //we've reached 1 so done.\r\n                                break;\r\n                        }\r\n                        else\r\n                            break;\r\n                    }\r\n                }\r\n                catch(e) {\r\n                }\r\n                ;\r\n\r\n                return symbol;\r\n            },\r\n            factor: function (symbol, factors) {\r\n                // Don't try to factor constants\r\n                if(symbol.isConstant()) {\r\n                    return core.Math2.factor(symbol);\r\n                }\r\n\r\n                var _symbol = _.parse(symbol);\r\n                var retval = __.Factor._factor(_symbol, factors);\r\n                if(retval.equals(symbol)) {\r\n                    return retval;\r\n                }\r\n\r\n                if(retval.group === CB) {\r\n                    var t = new Symbol(1);\r\n                    var p = _.parse(retval.power);\r\n                    //store the multiplier and strip it\r\n                    var m = _.parse(retval.multiplier);\r\n\r\n                    retval.toUnitMultiplier();\r\n\r\n                    /* \r\n                     * NOTE: for sign issues with factor START DEBUGGING HERE\r\n                     */\r\n                    //move the sign to t\r\n                    if(retval.multiplier.lessThan(0)) {\r\n                        t.negate();\r\n                        retval.negate();\r\n                    }\r\n\r\n                    retval.each(function (x) {\r\n                        // Related to #566. Since the symbol's group may not have been properly\r\n                        // updated, it's easier to just parse the symbol and have the parser \r\n                        // do the update for us.\r\n                        var factored = _.parse(__.Factor._factor(x));\r\n\r\n                        if(factored.group === CB) {\r\n                            // Include the multiplier\r\n                            m = _.multiply(m, Symbol.create(factored.multiplier));\r\n                            factored.each(function (y) {\r\n                                var _factored = _.parse(__.Factor._factor(y));\r\n                                t = _.multiply(t, _factored);\r\n                                if(_factored.group === CB) {\r\n                                    m = _.multiply(m, Symbol.create(_factored.multiplier));\r\n                                }\r\n                            });\r\n                        }\r\n                        else {\r\n                            t = _.multiply(t, factored);\r\n                        }\r\n                    });\r\n\r\n                    //put back the multiplier and power\r\n                    retval = _.pow(_.multiply(m, t), p);\r\n                }\r\n\r\n                return retval;\r\n            },\r\n            quadFactor: function (symbol, factors) {\r\n                if(symbol.isPoly() && __.degree(symbol.equals(2))) {\r\n                    //We've  already checked that we're dealing with a polynomial\r\n                    var v = core.Utils.variables(symbol)[0]; //get the variable\r\n                    var coeffs = __.coeffs(symbol, v);\r\n                    //factor the lead coefficient\r\n                    var cf = __.Factor._factor(coeffs[2].clone());\r\n                    //check if we have factors\r\n                    if(cf.group === CB) {\r\n                        var symbols = cf.collectSymbols();\r\n                        //if the factors are greater than 2 we're done so exit\r\n                        if(symbols.length > 2)\r\n                            return symbol;\r\n                        //if we have two factors then attempt to factor the polynomial\r\n                        //let the factors be f1 and f1\r\n                        //let the factors be (ax+b)(cx+d)\r\n                        //let the coefficients be c1x^2+c2x+c3\r\n                        //then a(x1)+c(x2)=c2 and x1*x2=c3\r\n                        //we can solve for x1 and x2\r\n                        var c = _.multiply(_.parse(coeffs[0]), _.parse(symbols[0]));\r\n                        var b = _.parse(coeffs[1]).negate();\r\n                        var a = _.parse(symbols[1]);\r\n                        //solve the system\r\n                        var root = __.quad(a, b, c).filter(function (x) {\r\n                            if(core.Utils.isInt(x))\r\n                                return x;\r\n                        });\r\n                        //if we have one root then find the other one by dividing the constant\r\n                        if(root.length === 1) {\r\n                            var root1 = root[0];\r\n                            var root2 = _.divide(coeffs[0], _.parse(root1));\r\n                            if(core.Utils.isInt(root2)) {\r\n                                //we found them both\r\n                                factors.add(_.parse(format('({0})*({1})+({2})', symbols[1], v, root2)));\r\n                                factors.add(_.parse(format('({0})*({1})+({2})', symbols[0], v, root1)));\r\n                                symbol = new Symbol(1);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return symbol;\r\n            },\r\n            cubeFactor: function (symbol, factors) {\r\n                if(symbol.isComposite()) {\r\n                    var symbols = symbol.collectSymbols();\r\n                    // The symbol should be in the form of a^3+-b^3. The length\r\n                    // should therefore only be two. If it's any different from this\r\n                    // then we're done\r\n                    if(symbols.length === 2) {\r\n                        // Store the signs and then strip them from the symbols\r\n                        var sign_a = symbols[0].sign();\r\n                        var a = symbols[0].clone().abs();\r\n                        var sign_b = symbols[1].sign();\r\n                        var b = symbols[1].clone().abs();\r\n                        // Check if they're cube\r\n                        if(a.isCube() && b.isCube()) {\r\n                            // Keep the negative sign on the right, meaning b is always negative.\r\n                            if(sign_a < sign_b) {\r\n                                // Swap the signs and then the values\r\n                                [sign_a, sign_b] = [sign_b, sign_a];\r\n                                [a, b] = [b, a];\r\n                            }\r\n\r\n                            // Get teh roots\r\n                            var m_root_a = _.parse(a.getNth(3));\r\n                            var m_root_b = _.parse(b.getNth(3));\r\n\r\n                            // Remove the cube for both\r\n                            var x = _.multiply(_.expand(_.pow(a.clone().toUnitMultiplier(), _.parse('1/3'))), m_root_a);\r\n                            var y = _.multiply(_.expand(_.pow(b.clone().toUnitMultiplier(), _.parse('1/3'))), m_root_b);\r\n\r\n                            if(sign_a === 1 && sign_b === -1) {\r\n                                // Apply difference of cubes rule\r\n                                factors.add(_.parse(format('(({0})-({1}))', x, y)));\r\n                                factors.add(_.parse(format('(({0})^2+({0})*({1})+({1})^2)', x, y)));\r\n                                symbol = Symbol(1);\r\n                            }\r\n                            else if(sign_a === 1 && sign_b === 1) {\r\n                                // Apply sum of cubes rule\r\n                                factors.add(_.parse(format('(({0})+({1}))', x, y)));\r\n                                factors.add(_.parse(format('(({0})^2-({0})*({1})+({1})^2)', x, y)));\r\n                                symbol = Symbol(1);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return symbol;\r\n            },\r\n            _factor: function (symbol, factors) {\r\n                var g = symbol.group;\r\n                //some items cannot be factored any further so return those right away\r\n                if(symbol.group === FN) {\r\n                    var arg = symbol.args[0];\r\n                    if(arg.group === S && arg.isSimple()) {\r\n                        return symbol;\r\n                    }\r\n                }\r\n                else if(symbol.group === S && symbol.isSimple()) {\r\n                    return symbol;\r\n                }\r\n\r\n                // Expand the symbol to get it in a predictable form. If this step\r\n                // is skipped some factors are missed.\r\n                //if(symbol.group === CP && !(even(symbol.power) && symbol.multiplier.lessThan(0))) {\r\n                if(symbol.group === CP) {\r\n                    symbol.distributeMultiplier(true);\r\n                    var t = new Symbol(0);\r\n                    symbol.each(function (x) {\r\n                        if((x.group === CP && x.power.greaterThan(1) || x.group === CB))\r\n                            x = _.expand(x);\r\n                        t = _.add(t, x);\r\n                    });\r\n                    t.power = symbol.power;\r\n\r\n                    symbol = t;\r\n                }\r\n\r\n                if(symbol.group === FN && symbol.fname !== 'sqrt') {\r\n                    symbol = core.Utils.evaluate(symbol);\r\n                }\r\n\r\n                //make a copy of the symbol to return if something goes wrong\r\n                var untouched = symbol.clone();\r\n                try {\r\n                    if(symbol.group === CB) {\r\n                        var p = _.parse(symbol.power);\r\n\r\n                        var den_array, num_array, den, num, dfact, nfact;\r\n                        //grab the denominator and strip the multiplier and power. Store them in an array\r\n                        den_array = __.Simplify.strip(symbol.getDenom());\r\n                        num_array = __.Simplify.strip(symbol.getNum());\r\n\r\n                        den = den_array.pop();\r\n                        num = num_array.pop();\r\n\r\n                        //if the numerator equals the symbol then we've hit the simplest form and then we're done\r\n                        if(num.equals(symbol)) {\r\n                            return symbol;\r\n                        }\r\n                        nfact = __.Factor.factor(num);\r\n                        dfact = __.Factor.factor(den);\r\n\r\n                        var n = __.Simplify.unstrip(num_array, nfact);\r\n                        var d = __.Simplify.unstrip(den_array, dfact);\r\n\r\n                        var retval = _.divide(n, d);\r\n\r\n                        return retval;\r\n                    }\r\n                    if(symbol.group === S) {\r\n                        return symbol; //absolutely nothing to do\r\n                    }\r\n\r\n                    if(symbol.isConstant()) {\r\n                        if(symbol.equals(1))\r\n                            return symbol.clone();\r\n                        var ret = core.Math2.factor(symbol);\r\n                        return ret;\r\n                    }\r\n\r\n                    var p = symbol.power.clone();\r\n\r\n                    if(isInt(p) && !(p.lessThan(0) && symbol.group === FN)) {\r\n                        var sign = p.sign();\r\n                        symbol.toLinear();\r\n                        factors = factors || new Factors();\r\n                        var map = {};\r\n                        symbol = _.parse(core.Utils.subFunctions(symbol, map));\r\n                        if(keys(map).length > 0) { //it might have functions\r\n                            factors.preAdd = function (factor) {\r\n                                var ret = _.parse(factor, core.Utils.getFunctionsSubs(map));\r\n                                return ret;\r\n                            };\r\n                        }\r\n\r\n                        //strip the power\r\n                        if(!symbol.isLinear()) {\r\n                            factors.pFactor = symbol.power.toString();\r\n                            symbol.toLinear();\r\n                        }\r\n\r\n                        var vars = variables(symbol);\r\n                        //bypass for imaginary. TODO: find a better solution\r\n                        if(symbol.isImaginary()) {\r\n                            vars.push(core.Settings.IMAGINARY);\r\n                        }\r\n                        var multiVar = vars.length > 1;\r\n\r\n                        //minor optimization. Seems to cut factor time by half in some cases.\r\n                        if(multiVar) {\r\n                            var all_S = true, all_unit = true;\r\n                            symbol.each(function (x) {\r\n                                if(x.group !== S)\r\n                                    all_S = false;\r\n                                if(!x.multiplier.equals(1))\r\n                                    all_unit = false;\r\n                            });\r\n\r\n                            if(all_S && all_unit) {\r\n                                return _.pow(_.parse(symbol, core.Utils.getFunctionsSubs(map)), _.parse(p));\r\n                            }\r\n                        }\r\n\r\n                        //factor the coefficients\r\n                        var coeff_factors = new Factors();\r\n\r\n                        symbol = __.Factor.coeffFactor(symbol, coeff_factors);\r\n\r\n                        coeff_factors.each(function (x) {\r\n                            // If the factor was negative but was within a square then it becomes positive\r\n                            if(even(p) && x.lessThan(0)) {\r\n                                x.negate();\r\n                            }\r\n\r\n                            if(sign < 0)\r\n                                x.invert();\r\n                            factors.add(x);\r\n                        });\r\n\r\n                        //factor the power\r\n                        var power_factors = new Factors();\r\n                        symbol = __.Factor.powerFactor(symbol, power_factors);\r\n                        power_factors.each(function (x) {\r\n                            if(sign < 0)\r\n                                x.invert();\r\n                            factors.add(x);\r\n                        });\r\n\r\n                        if(!multiVar) {\r\n                            //pass in vars[0] for safety\r\n                            var v = vars[0];\r\n\r\n                            symbol = __.Factor.squareFree(symbol, factors, v);\r\n\r\n                            var t_factors = new Factors();\r\n\r\n                            symbol = __.Factor.trialAndError(symbol, t_factors, v);\r\n\r\n                            //generate a symbol based off the last factors\r\n                            var tf_symbol = t_factors.toSymbol();\r\n                            //if nothing was factored then return the factors\r\n                            if(tf_symbol.equals(untouched)) {\r\n                                return tf_symbol;\r\n                            }\r\n\r\n                            for(var x in t_factors.factors) {\r\n                                //store the current factor in t_factor\r\n                                var t_factor = t_factors.factors[x];\r\n                                factors.add(_.pow(t_factor, _.parse(p)));\r\n                            }\r\n                            //if we still don't have a factor and it's quadratic then let's just do a quad factor\r\n                            if(symbol.equals(untouched)) {\r\n                                symbol = __.Factor.quadFactor(symbol, factors);\r\n                            }\r\n\r\n                        }\r\n                        else {\r\n                            // Try sum and difference of cubes\r\n                            symbol = __.Factor.cubeFactor(symbol, factors);\r\n\r\n                            symbol = __.Factor.mfactor(symbol, factors);\r\n\r\n                            //put back the sign of power\r\n                            factors.each(function (x) {\r\n                                if(sign < 0)\r\n                                    x.power.negate();\r\n                            });\r\n                        }\r\n\r\n                        //last minute clean up\r\n                        symbol = _.parse(symbol, core.Utils.getFunctionsSubs(map));\r\n                        \r\n                        var addPower = factors.length === 1;\r\n                        \r\n                        factors.add(_.pow(symbol, _.parse(p)));\r\n\r\n                        var retval = factors.toSymbol();\r\n                        \r\n                        // We may have only factored out the symbol itself so we end up with a factor of one \r\n                        // where the power needs to be placed back\r\n                        // e.g. factor((2*y+p)^2). Here we end up having a factor of 1 remaining and a p of 2.\r\n                        if(addPower && symbol.equals(1) && retval.isLinear()) {\r\n                            retval = _.pow(retval, _.parse(p));\r\n                        }\r\n                        \r\n                        return retval;\r\n                    }\r\n\r\n                    return symbol;\r\n                }\r\n                catch(e) {\r\n                    //no need to stop the show because something went wrong :). Just return the unfactored.\r\n                    return untouched;\r\n                }\r\n            },\r\n            reduce: function (symbol, factors) {\r\n                if(symbol.group === CP && symbol.length === 2) {\r\n                    var symbols = symbol.collectSymbols().sort(function (a, b) {\r\n                        return b.multiplier - a.multiplier;\r\n                    });\r\n                    if(symbols[0].power.equals(symbols[1].power)) {\r\n                        //x^n-a^n\r\n                        var n = _.parse(symbols[0].power),\r\n                                a = symbols[0].clone().toLinear(),\r\n                                b = symbols[1].clone().toLinear();\r\n\r\n                        //apply rule: (a-b)*sum(a^(n-i)*b^(i-1),1,n)\r\n                        factors.add(_.add(a.clone(), b.clone()));\r\n                        //flip the sign\r\n                        b.negate();\r\n                        //turn n into a number\r\n                        var nn = Number(n);\r\n                        //the remainder\r\n                        var result = new Symbol(0);\r\n                        for(var i = 1; i <= nn; i++) {\r\n                            var aa = _.pow(a.clone(), _.subtract(n.clone(), new Symbol(i))),\r\n                                    bb = _.pow(b.clone(), _.subtract(new Symbol(i), new Symbol(1)));\r\n                            result = _.add(result, _.multiply(aa, bb));\r\n                        }\r\n                        return result;\r\n                    }\r\n                }\r\n                return symbol;\r\n            },\r\n            /**\r\n             * Makes Symbol square free\r\n             * @param {Symbol} symbol\r\n             * @param {Factors} factors\r\n             * @@param {String} variable The variable which is being factored \r\n             * @returns {[Symbol, Factor]}\r\n             */\r\n            squareFree: function (symbol, factors, variable) {\r\n                if(symbol.isConstant() || symbol.group === S)\r\n                    return symbol;\r\n\r\n                var poly = new Polynomial(symbol, variable);\r\n                var sqfr = poly.squareFree();\r\n                var p = sqfr[2];\r\n                //if we found a square then the p entry in the array will be non-unit\r\n                if(p !== 1) {\r\n                    //make sure the remainder doesn't have factors\r\n                    var t = sqfr[1].toSymbol();\r\n                    t.power = t.power.multiply(new Frac(p));\r\n                    //send the factor to be fatored to be sure it's completely factored\r\n                    factors.add(__.Factor.factor(t));\r\n\r\n                    var retval = __.Factor.squareFree(sqfr[0].toSymbol(), factors);\r\n\r\n                    return retval;\r\n                }\r\n\r\n                return symbol;\r\n            },\r\n            /**\r\n             * Factors the powers such that the lowest power is a constant\r\n             * @param {Symbol} symbol\r\n             * @param {Factors} factors\r\n             * @returns {[Symbol, Factor]}\r\n             */\r\n            powerFactor: function (symbol, factors) {\r\n                //only PL need apply\r\n                if(symbol.group !== PL || symbol.previousGroup === EX)\r\n                    return symbol;\r\n                var k = keys(symbol.symbols);\r\n                //we expect only numeric powers so return all else\r\n                if(!core.Utils.allNumeric(k))\r\n                    return symbol;\r\n\r\n                var d = core.Utils.arrayMin(k);\r\n                var retval = new Symbol(0);\r\n                var q = _.parse(symbol.value + '^' + d);\r\n                symbol.each(function (x) {\r\n                    x = _.divide(x, q.clone());\r\n                    retval = _.add(retval, x);\r\n                });\r\n\r\n                factors.add(q);\r\n                return retval;\r\n            },\r\n            /**\r\n             * Removes GCD from coefficients\r\n             * @param {Symbol} symbol\r\n             * @param {Factor} factors\r\n             * @returns {Symbol}\r\n             */\r\n            coeffFactor: function (symbol, factors) {\r\n                if(symbol.isComposite()) {\r\n                    var gcd = core.Math2.QGCD.apply(null, symbol.coeffs());\r\n\r\n                    if(!gcd.equals(1)) {\r\n                        symbol.each(function (x) {\r\n                            if(x.isComposite()) {\r\n                                x.each(function (y) {\r\n                                    y.multiplier = y.multiplier.divide(gcd);\r\n                                });\r\n                            }\r\n                            else\r\n                                x.multiplier = x.multiplier.divide(gcd);\r\n                        });\r\n                        symbol.updateHash();\r\n                    }\r\n                    else {\r\n                        // TODO: This should probably go to the prototype\r\n                        var power = function (symbol) {\r\n                            var p;\r\n                            if(symbol.group === CB) {\r\n                                p = 0;\r\n                                symbol.each(function (x) {\r\n                                    p += x.power;\r\n                                });\r\n                            }\r\n                            else {\r\n                                p = Number(symbol.power);\r\n                            }\r\n                            return p;\r\n                        };\r\n                        // Factor out negatives from the lead term\r\n                        var terms = symbol.collectSymbols(null, null, null, true).sort(function (a, b) {\r\n                            // Push constants to the back\r\n                            if(a.isConstant(true))\r\n                                return 1;\r\n                            return b.power - a.power;\r\n                        });\r\n\r\n                        var LT = terms[0];\r\n\r\n                        // Check if the LT is indeed the greatest\r\n                        if(power(LT) > power(terms[1]) || terms[1].isConstant(true)) {\r\n                            if(LT.multiplier.lessThan(0)) {\r\n                                // Although the symbol should always be linear at this point, remove the negative for squares\r\n                                // to be safe.\r\n                                factors.add(new Symbol(-1));\r\n\r\n                                symbol.each(function (x) {\r\n                                    x.negate();\r\n                                }, true);\r\n                            }\r\n                        }\r\n\r\n                    }\r\n\r\n                    if(factors) {\r\n                        factors.add(new Symbol(gcd));\r\n                    }\r\n                }\r\n\r\n                return symbol;\r\n            },\r\n            /**\r\n             * The name says it all :)\r\n             * @param {Symbol} symbol\r\n             * @param {Factor} factors\r\n             * @@param {String} variable \r\n             * @returns {Symbol}\r\n             */\r\n            trialAndError: function (symbol, factors, variable) {\r\n                var untouched = symbol.clone();\r\n                try {\r\n                    // At temp holder for the factors. If all goes well then\r\n                    // they'll be moved to the actual factors.\r\n                    var factor_array = [];\r\n\r\n                    if(symbol.isConstant() || symbol.group === S)\r\n                        return symbol;\r\n                    var poly = new Polynomial(symbol, variable),\r\n                            cnst = poly.coeffs[0],\r\n                            cfactors = core.Math2.ifactor(cnst),\r\n                            roots = __.proots(symbol);\r\n                    for(var i = 0; i < roots.length; i++) {\r\n                        var r = roots[i],\r\n                                p = 1;\r\n                        if(!isNaN(r)) { //if it's a number\r\n                            for(var x in cfactors) {\r\n                                //check it's raised to a power\r\n                                var n = core.Utils.round(Math.log(x) / Math.log(Math.abs(r)), 8);\r\n                                if(isInt(n)) {\r\n                                    r = x; //x must be the root since n gave us a whole\r\n                                    p = n;\r\n                                    break;\r\n                                }\r\n                            }\r\n                            var root = new Frac(r),\r\n                                    terms = [new Frac(root.num).negate()];\r\n                            terms[p] = new Frac(root.den);\r\n                            //convert to Frac. The den is coeff of LT and the num is coeff of constant\r\n                            var div = Polynomial.fromArray(terms, poly.variable).fill(),\r\n                                    t = poly.divide(div);\r\n                            if(t[1].equalsNumber(0)) { //if it's zero we have a root and divide it out\r\n                                poly = t[0];\r\n                                // factors.add(div.toSymbol());\r\n                                factor_array.push(div.toSymbol());\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if(!poly.equalsNumber(1)) {\r\n                        poly = __.Factor.search(poly, factors);\r\n                    }\r\n\r\n                    // Move the factors over since all went well.\r\n                    factor_array.forEach(function (x) {\r\n                        factors.add(x);\r\n                    });\r\n\r\n                    return poly.toSymbol();\r\n                }\r\n                catch(e) {\r\n                    return untouched;\r\n                }\r\n            },\r\n            search: function (poly, factors, base) {\r\n                base = base || 10; //I like 10 because numbers exhibit similar behaviours at 10\r\n                var v = poly.variable; //the polynmial variable name\r\n                /**\r\n                 * Attempt to remove a root by division given a number by first creating\r\n                 * a polynomial fromt he given information\r\n                 * @param {int} c1 - coeffient for the constant\r\n                 * @param {int} c2 - coefficient for the LT\r\n                 * @param {int} n - the number to be used to construct the polynomial\r\n                 * @param {int} p - the power at which to create the polynomial\r\n                 * @returns {null|Polynomial} - returns polynomial if successful otherwise null\r\n                 */\r\n                var check = function (c1, c2, n, p) {\r\n                    var candidate = Polynomial.fit(c1, c2, n, base, p, v);\r\n                    if(candidate && candidate.coeffs.length > 1) {\r\n                        var t = poly.divide(candidate);\r\n                        if(t[1].equalsNumber(0)) {\r\n                            factors.add(candidate.toSymbol());\r\n                            return [t[0], candidate];\r\n                        }\r\n                    }\r\n                    return null;\r\n                };\r\n                var cnst = poly.coeffs[0];\r\n                var cfactors = core.Math2.ifactor(cnst);\r\n                var lc = poly.lc();\r\n                var ltfactors = core.Math2.ifactor(lc);\r\n                var subbed = poly.sub(base);\r\n                var isubbed = core.Math2.ifactor(subbed);\r\n                var nfactors = __.Factor.mix(isubbed, subbed < 0);\r\n                var cp = Math.ceil(poly.coeffs.length / 2);\r\n                var lc_is_neg = lc.lessThan(0);\r\n                var cnst_is_neg = cnst.lessThan(0);\r\n                ltfactors['1'] = 1;\r\n                cfactors['1'] = 1;\r\n                while(cp--) {\r\n                    for(var x in ltfactors) {\r\n                        for(var y in cfactors) {\r\n                            for(var i = 0; i < nfactors.length; i++) {\r\n                                var factor_found = check(x, y, nfactors[i], cp);\r\n                                if(factor_found) {\r\n                                    poly = factor_found[0];\r\n                                    if(!core.Utils.isPrime(poly.sub(base)))\r\n                                        poly = __.Factor.search(poly, factors);\r\n                                    return poly;\r\n                                }\r\n                                else if(!factor_found) {\r\n                                    if(lc_is_neg && cnst_is_neg)\r\n                                        factor_found = check(-x, -y, nfactors[i], cp);\r\n                                    else if(lc_is_neg)\r\n                                        factor_found = check(-x, y, nfactors[i], cp); //check a negative lc\r\n                                    else if(cnst_is_neg)\r\n                                        factor_found = check(x, -y, nfactors[i], cp); //check a negative constant\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return poly;\r\n            },\r\n            /**\r\n             * Equivalent of square free factor for multivariate polynomials\r\n             * @param {type} symbol\r\n             * @param {type} factors\r\n             * @returns {AlgebraL#18.Factor.mSqfrFactor.symbol|Array|AlgebraL#18.__.Factor.mSqfrFactor.d}\r\n             */\r\n            mSqfrFactor: function (symbol, factors) {\r\n                if(symbol.group !== FN) {\r\n                    var vars = variables(symbol).reverse();\r\n\r\n                    // Loop through all the variable and remove the partial derivatives\r\n                    for(var i = 0; i < vars.length; i++) {\r\n                        do {\r\n                            if(vars[i] === symbol.value) {\r\n                                //the derivative tells us nothing since this symbol is already the factor\r\n                                factors.add(symbol);\r\n                                symbol = new Symbol(1);\r\n                                continue;\r\n                            }\r\n\r\n                            var diff = core.Calculus.diff(symbol, vars[i]);\r\n\r\n                            var d = __.Factor.coeffFactor(diff);\r\n\r\n                            if(d.equals(0))\r\n                                break;\r\n\r\n                            //trial division to see if factors have whole numbers. \r\n                            //This can be optimized by stopping as soon as can_divide is false\r\n                            //this will also need utilize big number at some point\r\n                            var can_divide = true;\r\n                            if(d.isConstant() && symbol.isComposite()) {\r\n                                //check the coefficients\r\n\r\n                                symbol.each(function (x) {\r\n                                    if(x.multiplier % d !== 0)\r\n                                        can_divide = false;\r\n                                }, true);\r\n                            }\r\n\r\n                            //if we can divide then do so\r\n                            if(can_divide) {\r\n\r\n                                var div = __.div(symbol, d.clone()),\r\n                                        is_factor = div[1].equals(0);\r\n                                \r\n                                // Break infinite loop for factoring e^t*x-1\r\n                                if((symbol.equals(div[0]) && div[1].equals(0))) {\r\n                                    break;\r\n                                }\r\n                                \r\n                                if(div[0].isConstant()) {\r\n                                    factors.add(div[0]);\r\n                                    break;\r\n                                }\r\n                                \r\n                            }\r\n                            else\r\n                                is_factor = false;\r\n\r\n                            if(is_factor) {\r\n                                factors.add(div[0]);\r\n                                symbol = d;\r\n                            }\r\n                        }\r\n                        while(is_factor)\r\n                    }\r\n                }\r\n\r\n                return symbol;\r\n            },\r\n            //difference of squares factorization\r\n            sqdiff: function (symbol, factors) {\r\n                if(symbol.isConstant('all')) {\r\n                    // Nothing to do\r\n                    return symbol;\r\n                }\r\n\r\n                try {\r\n                    var remove_square = function (x) {\r\n                        return core.Utils.block('POSITIVE_MULTIPLIERS', function () {\r\n                            return Symbol.unwrapPARENS(math.sqrt(math.abs(x)));\r\n                        }, true);\r\n                    };\r\n                    var separated = core.Utils.separate(symbol.clone());\r\n\r\n                    var obj_array = [];\r\n\r\n                    //get the unique variables\r\n                    for(var x in separated) {\r\n                        if(x !== 'constants') {\r\n                            obj_array.push(separated[x]);\r\n                        }\r\n                    }\r\n                    obj_array.sort(function (a, b) {\r\n                        return b.power - a.power;\r\n                    });\r\n\r\n                    //if we have the same number of variables as unique variables then we can apply the difference of squares\r\n                    if(obj_array.length === 2) {\r\n                        var a, b;\r\n                        a = obj_array.pop();\r\n                        b = obj_array.pop();\r\n\r\n                        if(even(a.power) && even(b.power)\r\n                                && a.sign() === b.sign()\r\n                                && a.group === S && b.group === S) {\r\n                            throw new Error('Unable to factor');\r\n                        }\r\n                        ;\r\n\r\n                        if(a.isComposite() && b.power.equals(2)) {\r\n                            //remove the square from b\r\n                            b = remove_square(b);\r\n                            var f = __.Factor.factor(_.add(a, separated.constants));\r\n                            if(f.power.equals(2)) {\r\n                                f.toLinear();\r\n                                factors.add(_.subtract(f.clone(), b.clone()));\r\n                                factors.add(_.add(f, b));\r\n                                symbol = new Symbol(1);\r\n                            }\r\n                        }\r\n                        else {\r\n                            a = a.powSimp();\r\n                            b = b.powSimp();\r\n\r\n                            if((a.group === S || a.fname === '') && a.power.equals(2) && (b.group === S || b.fname === '') && b.power.equals(2) && !separated.constants) {\r\n                                if(a.multiplier.lessThan(0)) {\r\n                                    var t = b;\r\n                                    b = a;\r\n                                    a = t;\r\n                                }\r\n                                if(a.multiplier.greaterThan(0)) {\r\n                                    a = remove_square(a);\r\n                                    b = remove_square(b);\r\n                                }\r\n\r\n                                factors.add(_.subtract(a.clone(), b.clone()));\r\n                                factors.add(_.add(a, b));\r\n                                symbol = new Symbol(1);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                catch(e) {\r\n                    ;\r\n                }\r\n\r\n                return symbol;\r\n            },\r\n            //factoring for multivariate\r\n            mfactor: function (symbol, factors) {\r\n\r\n                if(symbol.group === FN) {\r\n                    if(symbol.fname === 'sqrt') {\r\n                        var factors2 = new Factors(),\r\n                                arg = __.Factor.common(symbol.args[0].clone(), factors2);\r\n                        arg = __.Factor.coeffFactor(arg, factors2);\r\n                        symbol = _.multiply(_.symfunction('sqrt', [arg]), _.parse(symbol.multiplier));\r\n                        factors2.each(function (x) {\r\n                            symbol = _.multiply(symbol, _.parse(core.Utils.format('sqrt({0})', x)));\r\n                        });\r\n                    }\r\n                    else\r\n                        factors.add(symbol);\r\n                }\r\n                else {\r\n\r\n                    //square free factorization\r\n                    symbol = __.Factor.mSqfrFactor(symbol, factors);\r\n\r\n                    //try factor out common factors\r\n                    //symbol = __.Factor.common(symbol, factors);\r\n\r\n                    var vars = variables(symbol),\r\n                            symbols = symbol.collectSymbols().map(function (x) {\r\n                        return Symbol.unwrapSQRT(x);\r\n                    }),\r\n                            sorted = {},\r\n                            maxes = {},\r\n                            l = vars.length, n = symbols.length;\r\n                    //take all the variables in the symbol and organize by variable name\r\n                    //e.g. a^2+a^2+b*a -> {a: {a^3, a^2, b*a}, b: {b*a}}\r\n\r\n                    for(var i = 0; i < l; i++) {\r\n                        var v = vars[i];\r\n                        sorted[v] = new Symbol(0);\r\n                        for(var j = 0; j < n; j++) {\r\n                            var s = symbols[j];\r\n                            if(s.contains(v)) {\r\n                                var p = s.value === v ? s.power.toDecimal() : s.symbols[v].power.toDecimal();\r\n                                if(!maxes[v] || p < maxes[v])\r\n                                    maxes[v] = p;\r\n                                sorted[v] = _.add(sorted[v], s.clone());\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    for(var x in sorted) {\r\n                        var r = _.parse(x + '^' + maxes[x]);\r\n                        var div = _.divide(sorted[x], r);\r\n                        var new_factor = _.expand(div);\r\n\r\n                        if(new_factor.equals(1))\r\n                            break; //why divide by one. Just move \r\n                        var divided = __.div(symbol.clone(), new_factor);\r\n\r\n                        if(divided[0].equals(0)) {\r\n                            //cant factor anymore\r\n                            break;\r\n                        }\r\n\r\n                        // We potentially ended up with fractional coefficients when the\r\n                        // trial division was performed. We need to remove \r\n                        // This check will more then likely become superfluous with improvements\r\n                        // to polynomial division\r\n                        if(divided[1].equals(0)) {\r\n                            var has_fractions = false;\r\n\r\n                            divided[0].each(function (x) {\r\n                                if(!isInt(x.multiplier)) {\r\n                                    has_fractions = true;\r\n                                }\r\n                            });\r\n\r\n                            // The factor isn't really a factor and needs to be put back\r\n                            if(has_fractions) {\r\n                                divided[1] = _.expand(_.multiply(divided[1], new_factor));\r\n                                // Since the new factor is not just one, we exit.\r\n                                break;\r\n                            }\r\n                        }\r\n\r\n                        var neg_numeric_factor = isInt(new_factor) && new_factor.lessThan(0);\r\n\r\n                        if(divided[1].equals(0) && !neg_numeric_factor) { //we found at least one factor\r\n\r\n                            //factors.add(new_factor);\r\n                            var d = __.div(symbol.clone(), divided[0].clone());\r\n                            var r = d[0];\r\n\r\n                            // Nothing left to do since we didn't get a reduction\r\n                            if(r.equals(0)) {\r\n                                return symbol;\r\n                            }\r\n\r\n                            symbol = d[1];\r\n                            //we don't want to just flip the sign. If the remainder is -1 then we accomplished nothing\r\n                            //and we just return the symbol;\r\n                            //If r equals zero then there's nothing left to do so we're done\r\n\r\n                            if(r.equals(-1) && !symbol.equals(0))\r\n                                return symbol;\r\n\r\n                            var factor = divided[0];\r\n\r\n                            if(symbol.equals(factor)) {\r\n                                var rem = __.Factor.reduce(factor, factors);\r\n\r\n                                if(!symbol.equals(rem))\r\n                                    return __.Factor.mfactor(rem, factors);\r\n\r\n                                return rem;\r\n                            }\r\n                            else {\r\n                                factors.add(factor);\r\n                                //if the remainder of the symbol is zero then we're done. TODO: Rethink this logic a bit.\r\n                                if(symbol.equals(0))\r\n                                    return r;\r\n                            }\r\n\r\n                            if(r.isConstant('all')) {\r\n                                factors.add(r);\r\n                                return r;\r\n                            }\r\n\r\n                            return __.Factor.mfactor(r, factors);\r\n                        }\r\n                    }\r\n\r\n                }\r\n\r\n                //difference of squares factorization\r\n                symbol = __.Factor.sqdiff(symbol, factors);\r\n\r\n                //factors by fishing for zeroes\r\n                symbol = __.Factor.zeroes(symbol, factors);\r\n\r\n                return symbol;\r\n            }\r\n        },\r\n        /**\r\n         * Checks to see if a set of \"equations\" is linear. \r\n         * @param {type} set\r\n         * @returns {Boolean}\r\n         */\r\n        allLinear: function (set) {\r\n            var l = set.length;\r\n            for(var i = 0; i < l; i++) {\r\n                if(!__.isLinear(set[i]))\r\n                    return false;\r\n            }\r\n            return true;\r\n        },\r\n        /*\r\n         * Checks to see if the \"equation\" is linear\r\n         * @param {Symbol} e\r\n         * @returns {boolean}\r\n         */\r\n        isLinear: function (e) {\r\n            var status = false, g = e.group;\r\n            if(g === PL || g === CP) {\r\n                status = true;\r\n                for(var s in e.symbols) {\r\n                    var symbol = e.symbols[s], sg = symbol.group;\r\n                    if(sg === FN || sg === EX) {\r\n                        status = false;\r\n                    }\r\n                    if(sg === CB) {\r\n                        //needs further checking since it might be imaginary\r\n                        status = variables(symbol).length === 1;\r\n                    }\r\n                    else {\r\n                        if(sg === PL || sg === CP)\r\n                            status = __.isLinear(symbol);\r\n                        else {\r\n                            if(symbol.group !== N && symbol.power.toString() !== '1') {\r\n                                status = false;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            else if(g === S && e.power === 1)\r\n                status = true;\r\n            return status;\r\n        },\r\n        gcd: function () {\r\n            var args;\r\n            if(arguments.length === 1 && arguments[0] instanceof core.Vector)\r\n                args = arguments[0].elements;\r\n            else\r\n                args = core.Utils.arguments2Array(arguments);\r\n\r\n            //short-circuit early\r\n            if(args.length === 0)\r\n                return new Symbol(1);\r\n            else if(args.length === 1)\r\n                return args[0];\r\n\r\n            var appeared = [], evaluate = false;\r\n            for(var i = 0; i < args.length; i++) {\r\n                if(args[i].group === FN && args[i].fname === 'gcd')\r\n                {\r\n                    //compress gcd(a,gcd(b,c)) into gcd(a,b,c)\r\n                    args = args.concat(arguments[i].args);\r\n                    //do not keep gcd in args\r\n                    args.splice(i, 1);\r\n                }\r\n                else\r\n                {\r\n                    //Look if there are any common variables such that\r\n                    //gcd(a,b) => gcd(a,b); gcd(a,a) => a\r\n                    var vars = variables(args[i]);\r\n                    if(core.Utils.haveIntersection(vars, appeared))\r\n                    {\r\n                        //Ok, there are common variables\r\n                        evaluate = true;\r\n                        break;\r\n                    }\r\n                    else\r\n                        appeared = appeared.concat(vars);\r\n                }\r\n            }\r\n\r\n            //appeared.length is 0 when all arguments are group N\r\n            if(evaluate || appeared.length === 0) {\r\n                //TODO: distribute exponent so that (a^-1*b^-1)^-1 => a*b\r\n                if(args.every(function (symbol) {\r\n                    return symbol.getDenom().equals(1)\r\n                })) {\r\n                    var aggregate = args[0];\r\n\r\n                    for(var i = 1; i < args.length; i++) {\r\n                        aggregate = __.gcd_(args[i], aggregate);\r\n                    }\r\n                    return aggregate;\r\n                }\r\n                else {\r\n                    //gcd_ cannot handle denominators correctly\r\n                    return _.divide(__.gcd.apply(null, args.map(function (symbol) {\r\n                        return symbol.getNum();\r\n                    })),\r\n                            __.lcm.apply(null, args.map(function (symbol) {\r\n                                return symbol.getDenom();\r\n                            })));\r\n                }\r\n            }\r\n            else\r\n                return _.symfunction('gcd', args);\r\n        },\r\n        gcd_: function (a, b) {\r\n            if(a.group === FN || a.group === P)\r\n                a = core.Utils.block('PARSE2NUMBER', function () {\r\n                    return _.parse(a);\r\n                });\r\n\r\n            if(b.group === FN)\r\n                b = core.Utils.block('PARSE2NUMBER', function () {\r\n                    return _.parse(b);\r\n                });\r\n\r\n            if(a.isConstant() && b.isConstant()) {\r\n                // return core.Math2.QGCD(new Frac(+a), new Frac(+b));\r\n                return new Symbol(core.Math2.QGCD(new Frac(+a), new Frac(+b)));\r\n            }\r\n\r\n            var den = _.multiply(a.getDenom() || new Symbol(1), b.getDenom() || new Symbol(1)).invert();\r\n            a = _.multiply(a.clone(), den.clone());\r\n            b = _.multiply(b.clone(), den.clone());\r\n\r\n            //feels counter intuitive but it works. Issue #123 (nerdamer(\"gcd(x+y,(x+y)^2)\"))\r\n            a = _.expand(a);\r\n            b = _.expand(b);\r\n\r\n            if(a.group === CB || b.group === CB) {\r\n                var q = _.divide(a.clone(), b.clone()); //get the quotient\r\n                var t = _.multiply(b.clone(), q.getDenom().invert());//multiply by the denominator\r\n                //if they have a common factor then the result will not equal one \r\n                if(!t.equals(1))\r\n                    return t;\r\n            }\r\n\r\n            //just take the gcd of each component when either of them is in group EX\r\n            if(a.group === EX || b.group === EX)\r\n            {\r\n                var gcd_m = new Symbol(core.Math2.GCD(a.multiplier, b.multiplier));\r\n                var gcd_v = __.gcd_(a.value === CONST_HASH ? new Symbol(1) : _.parse(a.value), b.value === CONST_HASH ? new Symbol(1) : _.parse(b.value));\r\n                var gcd_p = __.gcd_(_.parse(a.power), _.parse(b.power));\r\n                return _.multiply(gcd_m, _.pow(gcd_v, gcd_p));\r\n            }\r\n\r\n            if(a.length < b.length) { //swap'm\r\n                var t = a;\r\n                a = b;\r\n                b = t;\r\n            }\r\n            var vars_a = variables(a), vars_b = variables(b);\r\n            if((vars_a.length === vars_b.length && vars_a.length === 1 && vars_a[0] === vars_b[0])\r\n                    || vars_a.length === 1 && vars_b.length === 0\r\n                    || vars_a.length === 0 && vars_b.length === 1) {\r\n                a = new Polynomial(a);\r\n                b = new Polynomial(b);\r\n                return _.divide(a.gcd(b).toSymbol(), den);\r\n            }\r\n            else {\r\n                //get the gcd of the multipiers\r\n                //get rid of gcd in coeffs\r\n                var multipliers = [];\r\n                a.each(function (x) {\r\n                    multipliers.push(x.multiplier);\r\n                });\r\n                b.each(function (x) {\r\n                    multipliers.push(x.multiplier);\r\n                });\r\n\r\n                var T;\r\n                while(!b.equals(0)) {\r\n                    var t = b.clone();\r\n                    a = a.clone();\r\n                    T = __.div(a, t);\r\n\r\n                    b = T[1];\r\n                    if(T[0].equals(0)) {\r\n                        //return _.multiply(new Symbol(core.Math2.QGCD(a.multiplier, b.multiplier)), b);\r\n                        return _.divide(new Symbol(core.Math2.QGCD(a.multiplier, b.multiplier)), den);\r\n                    }\r\n                    a = t;\r\n                }\r\n\r\n                var gcd = core.Math2.QGCD.apply(undefined, multipliers);\r\n\r\n                if(!gcd.equals(1)) {\r\n                    a.each(function (x) {\r\n                        x.multiplier = x.multiplier.divide(gcd);\r\n                    });\r\n                }\r\n\r\n                //return symbolic function for gcd in indeterminate form\r\n                if(a.equals(1) && !a.isConstant() && !b.isConstant())\r\n                    return _.divide(_.symfunction('gcd', arguments), den);\r\n\r\n                return _.divide(a, den);\r\n            }\r\n        },\r\n        lcm: function () {\r\n            //https://math.stackexchange.com/a/319310\r\n            //generalization of the 2-variable formula of lcm\r\n\r\n            var args;\r\n            if(arguments.length === 1)\r\n                if(arguments[0] instanceof core.Vector)\r\n                    args = arguments[0].elements;\r\n                else\r\n                    _.error('lcm expects either 1 vector or 2 or more arguments');\r\n            else\r\n                args = core.Utils.arguments2Array(arguments);\r\n\r\n            //product of all arguments\r\n            //start with new Symbol(1) so that prev.clone() which makes unnessesary clones can be avoided\r\n            var numer = args.reduce(function (prev, curr) {\r\n                return _.multiply(prev, curr.clone())\r\n            }, new Symbol(1));\r\n\r\n            //gcd of complementary terms\r\n            var denom_args =\r\n                    //https://stackoverflow.com/a/18223072\r\n                //take all complementary terms, e.g.\r\n                //[a,b,c] => [a*b, b*c, a*c]\r\n                //[a,b,c,d] => [a*b*c, a*b*d, a*c*d, b*c*d]\r\n                (function (input, size) {\r\n                        size = Number(size);\r\n                        var results = [], result, mask, i, total = Math.pow(2, input.length);\r\n                        for(mask = size; mask < total; mask++) {\r\n                            result = [];\r\n                            i = input.length - 1;\r\n\r\n                            do {\r\n                                if((mask & (1 << i)) !== 0) {\r\n                                    result.push(input[i]);\r\n                                }\r\n                            }\r\n                            while(i--);\r\n\r\n                            if(result.length === size) {\r\n                                results.push(result);\r\n                            }\r\n                        }\r\n                        return results;\r\n                        //start with new Symbol(1) so that prev.clone() which makes unnessesary clones can be avoided\r\n                    })(arguments, arguments.length - 1).map(function (x) {\r\n                return x.reduce(function (prev, curr) {\r\n                    return _.multiply(prev, curr.clone())\r\n                }, new Symbol(1))\r\n            });\r\n\r\n            var denom;\r\n            //don't eat the gcd term if all arguments are symbols\r\n            if(args.every(function (x) {\r\n                return core.Utils.isVariableSymbol(x)\r\n            }))\r\n                denom = _.symfunction('gcd', core.Utils.arrayUnique(denom_args));\r\n            else\r\n                denom = __.gcd.apply(null, denom_args);\r\n            //divide product of all arguments by gcd of complementary terms\r\n            var div = _.divide(numer, denom);\r\n            return div;\r\n        },\r\n        /**\r\n         * Divides one expression by another\r\n         * @param {Symbol} symbol1\r\n         * @param {Symbol} symbol2\r\n         * @returns {Array}\r\n         */\r\n        divide: function (symbol1, symbol2) {\r\n            var result, remainder, factored, den;\r\n            factored = core.Algebra.Factor.factor(symbol1.clone());\r\n            den = factored.getDenom();\r\n            if(!den.isConstant('all')) {\r\n                symbol1 = _.expand(Symbol.unwrapPARENS(_.multiply(factored, den.clone())));\r\n            }\r\n            else\r\n                //reset the denominator since we're not dividing by it anymore\r\n                den = new Symbol(1);\r\n            result = __.div(symbol1, symbol2);\r\n            remainder = _.divide(result[1], symbol2);\r\n            return _.divide(_.add(result[0], remainder), den);\r\n        },\r\n        div: function (symbol1, symbol2) {\r\n            // If all else fails then assume that division failed with\r\n            // a remainder of zero and the original quotient\r\n            var fail = [new Symbol(0), symbol1.clone()];\r\n\r\n            try {\r\n\r\n                // Division by constants\r\n                if(symbol2.isConstant('all')) {\r\n                    symbol1.each(function (x) {\r\n                        x.multiplier = x.multiplier.divide(symbol2.multiplier);\r\n                    });\r\n                    return [symbol1, new Symbol(0)];\r\n                }\r\n                // So that factorized symbols don't affect the result\r\n                symbol1 = _.expand(symbol1);\r\n                symbol2 = _.expand(symbol2);\r\n                // Special case. May need revisiting\r\n                if(symbol1.group === S && symbol2.group === CP) {\r\n                    var x = symbol1.value;\r\n                    var f = core.Utils.decompose_fn(symbol2.clone(), x, true);\r\n                    if(symbol1.isLinear() && f.x && f.x.isLinear() && symbol2.isLinear()) {\r\n                        var k = Symbol.create(symbol1.multiplier);\r\n                        return [_.divide(k.clone(), f.a.clone()), _.divide(_.multiply(k, f.b), f.a).negate()];\r\n                    }\r\n                }\r\n                if(symbol1.group === S && symbol2.group === S) {\r\n                    var r = _.divide(symbol1.clone(), symbol2.clone());\r\n                    if(r.isConstant()) //we have a whole\r\n                        return [r, new Symbol(0)];\r\n                    return [new Symbol(0), symbol1.clone()];\r\n                }\r\n                var symbol1_has_func = symbol1.hasFunc(),\r\n                        symbol2_has_func = symbol2.hasFunc(),\r\n                        parse_funcs = false;\r\n\r\n                //substitute out functions so we can treat them as regular variables\r\n                if(symbol1_has_func || symbol2_has_func) {\r\n                    parse_funcs = true;\r\n                    var map = {},\r\n                            symbol1 = _.parse(core.Utils.subFunctions(symbol1, map)),\r\n                            symbol2 = _.parse(core.Utils.subFunctions(symbol2, map)),\r\n                            subs = core.Utils.getFunctionsSubs(map);\r\n                }\r\n                //get a list of the variables\r\n                var vars = core.Utils.arrayUnique(variables(symbol1).concat(variables(symbol2))),\r\n                        quot, rem;\r\n\r\n                //treat imaginary numbers as variables\r\n                if(symbol1.isImaginary() || symbol2.isImaginary()) {\r\n                    vars.push(core.Settings.IMAGINARY);\r\n                }\r\n\r\n                if(vars.length === 1) {\r\n                    var q = new Polynomial(symbol1).divide(new Polynomial(symbol2));\r\n                    quot = q[0].toSymbol();\r\n                    rem = q[1].toSymbol();\r\n                }\r\n                else {\r\n                    vars.push(CONST_HASH); //this is for the numbers\r\n                    var reconvert = function (arr) {\r\n                        var symbol = new Symbol(0);\r\n                        for(var i = 0; i < arr.length; i++) {\r\n                            var x = arr[i].toSymbol();\r\n                            symbol = _.add(symbol, x);\r\n                        }\r\n                        return symbol;\r\n                    };\r\n\r\n                    // Silly Martin. This is why you document. I don't remember now\r\n                    var get_unique_max = function (term, any) {\r\n                        var max = Math.max.apply(null, term.terms),\r\n                                count = 0, idx;\r\n\r\n                        if(!any) {\r\n                            for(var i = 0; i < term.terms.length; i++) {\r\n                                if(term.terms[i].equals(max)) {\r\n                                    idx = i;\r\n                                    count++;\r\n                                }\r\n                                if(count > 1)\r\n                                    return;\r\n                            }\r\n                        }\r\n                        if(any) {\r\n                            for(i = 0; i < term.terms.length; i++)\r\n                                if(term.terms[i].equals(max)) {\r\n                                    idx = i;\r\n                                    break;\r\n                                }\r\n                        }\r\n                        return [max, idx, term];\r\n                    };\r\n\r\n                    // Tries to find an LT in the dividend that will satisfy division\r\n                    var get_det = function (s, lookat) {\r\n                        lookat = lookat || 0;\r\n                        var det = s[lookat], l = s.length;\r\n                        if(!det)\r\n                            return;\r\n                        //eliminate the first term if it doesn't apply\r\n                        var umax = get_unique_max(det);\r\n                        for(var i = lookat + 1; i < l; i++) {\r\n                            var term = s[i],\r\n                                    is_equal = det.sum.equals(term.sum);\r\n                            if(!is_equal && umax) {\r\n                                break;\r\n                            }\r\n                            if(is_equal) {\r\n                                // Check the differences of their maxes. The one with the biggest difference governs\r\n                                // e.g. x^2*y^3 vs x^2*y^3 is unclear but this isn't the case in x*y and x^2\r\n                                var max1, max2, idx1, idx2, l2 = det.terms.length;\r\n                                for(var j = 0; j < l2; j++) {\r\n                                    var item1 = det.terms[j], item2 = term.terms[j];\r\n                                    if(typeof max1 === 'undefined' || item1.greaterThan(max1)) {\r\n                                        max1 = item1;\r\n                                        idx1 = j;\r\n                                    }\r\n                                    if(typeof max2 === 'undefined' || item2.greaterThan(max2)) {\r\n                                        max2 = item2;\r\n                                        idx2 = j;\r\n                                    }\r\n                                }\r\n                                //check their differences\r\n                                var d1 = max1.subtract(term.terms[idx1]),\r\n                                        d2 = max2.subtract(det.terms[idx2]);\r\n                                if(d2 > d1) {\r\n                                    umax = [max2, idx2, term];\r\n                                    break;\r\n                                }\r\n                                if(d1 > d2) {\r\n                                    umax = [max1, idx1, det];\r\n                                    break;\r\n                                }\r\n                            }\r\n                            else {\r\n                                //check if it's a suitable pick to determine the order\r\n                                umax = get_unique_max(term);\r\n                                //if(umax) return umax;\r\n                                if(umax)\r\n                                    break;\r\n                            }\r\n                            umax = get_unique_max(term); //calculate a new unique max\r\n                        }\r\n\r\n                        //if still no umax then any will do since we have a tie\r\n                        if(!umax)\r\n                            return get_unique_max(s[0], true);\r\n                        var e, idx;\r\n                        for(var i = 0; i < s2.length; i++) {\r\n                            var cterm = s2[i].terms;\r\n                            //confirm that this is a good match for the denominator\r\n                            idx = umax[1];\r\n                            if(idx === cterm.length - 1)\r\n                                return;\r\n                            e = cterm[idx];\r\n                            if(!e.equals(0))\r\n                                break;\r\n                        }\r\n                        if(e.equals(0))\r\n                            return get_det(s, ++lookat); //look at the next term\r\n\r\n                        return umax;\r\n                    };\r\n\r\n                    var t_map = core.Utils.toMapObj(vars);\r\n                    var init_sort = function (a, b) {\r\n                        return b.sum.subtract(a.sum);\r\n                    };\r\n                    var is_larger = function (a, b) {\r\n                        if(!a || !b)\r\n                            return false; //it's empty so...\r\n                        for(var i = 0; i < a.terms.length; i++) {\r\n                            if(a.terms[i].lessThan(b.terms[i]))\r\n                                return false;\r\n                        }\r\n                        return true;\r\n                    };\r\n\r\n                    var s1 = symbol1.tBase(t_map).sort(init_sort),\r\n                            s2 = symbol2.tBase(t_map).sort(init_sort);\r\n                    var target = is_larger(s1[0], s2[0]) && s1[0].count > s2[0].count ? s2 : s1; //since the num is already larger than we can get the det from denom\r\n                    var det = get_det(target);//we'll begin by assuming that this will let us know which term \r\n                    var quotient = [];\r\n                    if(det) {\r\n                        var lead_var = det[1];\r\n                        var can_divide = function (a, b) {\r\n                            if(a[0].sum.equals(b[0].sum))\r\n                                return a.length >= b.length;\r\n                            return true;\r\n                        };\r\n\r\n                        var try_better_lead_var = function (s1, s2, lead_var) {\r\n                            var checked = [];\r\n                            for(var i = 0; i < s1.length; i++) {\r\n                                var t = s1[i];\r\n                                for(var j = 0; j < t.terms.length; j++) {\r\n                                    var cf = checked[j], tt = t.terms[j];\r\n                                    if(i === 0)\r\n                                        checked[j] = tt; //add the terms for the first one\r\n                                    else if(cf && !cf.equals(tt))\r\n                                        checked[j] = undefined;\r\n                                }\r\n                            }\r\n                            for(var i = 0; i < checked.length; i++) {\r\n                                var t = checked[i];\r\n                                if(t && !t.equals(0))\r\n                                    return i;\r\n                            }\r\n                            return lead_var;\r\n                        };\r\n                        var sf = function (a, b) {\r\n                            var l1 = a.len(), l2 = b.len();\r\n                            var blv = b.terms[lead_var], alv = a.terms[lead_var];\r\n                            if(l2 > l1 && blv.greaterThan(alv))\r\n                                return l2 - l1;\r\n                            return blv.subtract(alv);\r\n                        };\r\n\r\n                        //check to see if there's a better lead_var\r\n                        lead_var = try_better_lead_var(s1, s2, lead_var);\r\n                        //reorder both according to the max power\r\n                        s1.sort(sf); //sort them both according to the leading variable power\r\n                        s2.sort(sf);\r\n\r\n                        //try to adjust if den is larger\r\n                        var fdt = s2[0], fnt = s1[0];\r\n\r\n                        var den = new MVTerm(new Frac(1), [], fnt.map);\r\n                        if(fdt.sum.greaterThan(fnt.sum) && fnt.len() > 1) {\r\n                            for(var i = 0; i < fnt.terms.length; i++) {\r\n                                var d = fdt.terms[i].subtract(fnt.terms[i]);\r\n                                if(!d.equals(0)) {\r\n                                    var nd = d.add(new Frac(1));\r\n                                    den.terms[i] = d;\r\n                                    for(var j = 0; j < s1.length; j++) {\r\n                                        s1[j].terms[i] = s1[j].terms[i].add(nd);\r\n                                    }\r\n                                }\r\n                                else\r\n                                    den.terms[i] = new Frac(0);\r\n                            }\r\n                        }\r\n\r\n                        var dividend_larger = is_larger(s1[0], s2[0]);\r\n\r\n                        var safety = 0;\r\n                        var max = 200;\r\n\r\n                        while(dividend_larger && can_divide(s1, s2)) {\r\n                            if(safety++ > max) {\r\n                                throw new core.exceptions.InfiniteLoopError('Unable to compute!');\r\n                            }\r\n\r\n                            var q = s1[0].divide(s2[0]);\r\n\r\n                            quotient.push(q); //add what's divided to the quotient\r\n                            s1.shift();//the first one is guaranteed to be gone so remove from dividend\r\n                            for(var i = 1; i < s2.length; i++) { //loop through the denominator\r\n                                var t = s2[i].multiply(q).generateImage(),\r\n                                        l2 = s1.length;\r\n                                //if we're subtracting from 0\r\n                                if(l2 === 0) {\r\n                                    t.coeff = t.coeff.neg();\r\n                                    s1.push(t);\r\n                                    s1.sort(sf);\r\n                                }\r\n\r\n                                for(var j = 0; j < l2; j++) {\r\n                                    var cur = s1[j];\r\n                                    if(cur.getImg() === t.getImg()) {\r\n                                        cur.coeff = cur.coeff.subtract(t.coeff);\r\n                                        if(cur.coeff.equals(0)) {\r\n                                            core.Utils.remove(s1, j);\r\n                                            j--; //adjust the iterator\r\n                                        }\r\n                                        break;\r\n                                    }\r\n                                    if(j === l2 - 1) {\r\n                                        t.coeff = t.coeff.neg();\r\n                                        s1.push(t);\r\n                                        s1.sort(sf);\r\n                                    }\r\n                                }\r\n                            }\r\n                            dividend_larger = is_larger(s1[0], s2[0]);\r\n\r\n                            if(!dividend_larger && s1.length >= s2.length) {\r\n                                //One more try since there might be a terms that is larger than the LT of the divisor\r\n                                for(var i = 1; i < s1.length; i++) {\r\n                                    dividend_larger = is_larger(s1[i], s2[0]);\r\n                                    if(dividend_larger) {\r\n                                        //take it from its current position and move it to the front\r\n                                        s1.unshift(core.Utils.remove(s1, i));\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    quot = reconvert(quotient);\r\n                    rem = reconvert(s1);\r\n\r\n                    if(typeof den !== 'undefined') {\r\n                        den = den.toSymbol();\r\n                        quot = _.divide(quot, den.clone());\r\n                        rem = _.divide(rem, den);\r\n                    }\r\n                }\r\n\r\n                //put back the functions\r\n                if(parse_funcs) {\r\n                    quot = _.parse(quot.text(), subs);\r\n                    rem = _.parse(rem.text(), subs);\r\n                }\r\n\r\n                return [quot, rem];\r\n            }\r\n            catch(e) {\r\n                return fail;\r\n            }\r\n\r\n        },\r\n        line: function (v1, v2, x) {\r\n            if(core.Utils.isArray(v1))\r\n                v1 = core.Utils.convertToVector(v1);\r\n            if(core.Utils.isArray(v2))\r\n                v2 = core.Utils.convertToVector(v2);\r\n            x = _.parse(x || 'x');\r\n            if(!core.Utils.isVector(v1) || !core.Utils.isVector(v2))\r\n                _.error('Line expects a vector! Received \"' + v1 + '\" & \"' + v2 + '\"');\r\n            var dx = _.subtract(v2.e(1).clone(), v1.e(1).clone()),\r\n                    dy = _.subtract(v2.e(2).clone(), v1.e(2).clone()),\r\n                    m = _.divide(dy, dx),\r\n                    a = _.multiply(x, m.clone()),\r\n                    b = _.multiply(v1.e(1).clone(), m);\r\n            return _.add(_.subtract(a, b), v1.e(2).clone());\r\n        },\r\n        PartFrac: {\r\n            createTemplate: function (den, denom_factors, f_array, v) {\r\n                //clean up the denominator function by factors so it reduces nicely\r\n                den = __.Factor.factor(den);\r\n\r\n                //clean up factors. This is so inefficient but factors are wrapped in parens for safety\r\n                den.each(function (x, key) {\r\n                    if(x.group === FN && x.fname === '' && x.args[0].group === S) {\r\n                        var y = x.args[0];\r\n                        if(this.symbols) {\r\n                            delete this.symbols[key];\r\n                            this.symbols[y.value] = y;\r\n                        }\r\n                        else {\r\n                            den = x.args[0];\r\n                        }\r\n                    }\r\n                });\r\n\r\n                var factors, factors_vec, f, p, deg, degrees, m;\r\n                factors = denom_factors.collectFactors();\r\n                factors_vec = []; //a vector for the template\r\n                degrees = [];\r\n                m = new Symbol(1);\r\n\r\n                for(var i = 0; i < factors.length; i++) { //loop through the factors\r\n                    var factor = Symbol.unwrapPARENS(factors[i]);\r\n                    //if in he for P^n where P is polynomial and n = integer\r\n                    if(factor.power.greaterThan(1)) {\r\n                        p = Number(factor.power);\r\n                        f = factor.clone().toLinear(); //remove the power so we have only the function\r\n                        deg = Number(__.degree(f, v)); //get the degree of f\r\n                        //expand the factor\r\n                        for(var j = 0; j < p; j++) {\r\n                            var efactor = _.pow(f.clone(), new Symbol(j + 1));\r\n                            f_array.push(efactor.clone());\r\n                            var d = _.divide(den.clone(), efactor.clone());\r\n                            degrees.push(deg);\r\n                            factors_vec.push(d);\r\n                        }\r\n                    }\r\n                    /*\r\n                     Possible bug.\r\n                     Removed: causes 1/(20+24*x+4*x^2) to result in (-1/64)*(5+x)^(-1)+(1/64)*(1+x)^(-1)\r\n                     else if(factor.isConstant('all')) {\r\n                     m = _.multiply(m, factor);\r\n                     }\r\n                     */\r\n                    else {\r\n                        //get the degree of the factor so we tack it on tot he factor. This should probably be an array\r\n                        //but for now we note it on the symbol\r\n                        deg = Number(__.degree(factor, v));\r\n                        f_array.push(factor);\r\n                        var d = _.divide(den.clone(), factor.clone());\r\n                        d = _.expand(Symbol.unwrapPARENS(d));\r\n                        degrees.push(deg);\r\n                        factors_vec.push(d);\r\n                    }\r\n                }\r\n                //put back the constant\r\n                f_array = f_array.map(function (x) {\r\n                    return _.multiply(x, m.clone());\r\n                });\r\n                return [f_array, factors_vec, degrees];\r\n            },\r\n            partfrac: function (symbol, v, as_array) {\r\n\r\n                var vars = variables(symbol);\r\n\r\n                v = v || _.parse(vars[0]); //make wrt optional and assume first variable\r\n                try {\r\n                    var num, den, factors, tfactors, ofactors, nterms, degrees,\r\n                            dterms, max, M, c, powers, div, r, factors_vec, ks,\r\n                            template, tfactors;\r\n                    num = _.expand(symbol.getNum());\r\n                    den = _.expand(symbol.getDenom().toUnitMultiplier());\r\n                    //move the entire multipier to the numerator\r\n                    num.multiplier = symbol.multiplier;\r\n                    //we only have a meaningful change if n factors > 1. This means that\r\n                    //the returned group will be a CB\r\n                    //collect the terms wrt the x\r\n                    nterms = num.groupTerms(v);\r\n                    //divide out wholes if top is larger\r\n                    if(Number(__.degree(num, v)) >= Number(__.degree(den, v))) {\r\n                        div = __.div(num.clone(), _.expand(den.clone()));\r\n                        r = div[0]; //remove the wholes\r\n                        num = div[1]; //work with the remainder\r\n                        nterms = num.groupTerms(v); //recalculate the nterms\r\n                    }\r\n                    else\r\n                        r = new Symbol(0);\r\n\r\n                    if(Number(__.degree(den, v)) === 1) {\r\n                        var q = _.divide(num, den);\r\n                        if(as_array)\r\n                            return [r, q];\r\n                        return _.add(r, q);\r\n                    }\r\n                    //first factor the denominator. This means that the strength of this\r\n                    //algorithm depends on how well we can factor the denominator. \r\n                    ofactors = __.Factor.factor(den);\r\n                    //create the template. This method will create the template for solving \r\n                    //the partial fractions. So given x/(x-1)^2 the template creates A/(x-1)+B/(x-1)^2\r\n                    template = __.PartFrac.createTemplate(den.clone(), ofactors, [], v);\r\n                    tfactors = template[0]; //grab the factors\r\n                    factors_vec = template[1]; //grab the factor vectors\r\n                    degrees = template[2]; //grab the degrees\r\n                    //make note of the powers of each term\r\n                    powers = [nterms.length];\r\n                    //create the dterms vector\r\n                    dterms = [];\r\n                    factors = [];\r\n                    ks = [];\r\n                    var factor, deg;\r\n                    factors_vec.map(function (x, idx) {\r\n                        factor = tfactors[idx];\r\n                        deg = degrees[idx];\r\n                        for(var i = 0; i < deg; i++) {\r\n                            factors.push(factor.clone());\r\n                            var k = Symbol.create(v, i);\r\n                            var t = _.expand(_.multiply(x, k.clone())).groupTerms(v);\r\n                            //make a note of the power which corresponds to the length of the array\r\n                            var p = t.length;\r\n                            powers.push(p);\r\n                            dterms.push(t);\r\n                            ks.push(k.clone());\r\n                        }\r\n                    });\r\n                    //get the max power\r\n                    max = core.Utils.arrayMax(powers);\r\n\r\n                    //fill the holes and create a matrix\r\n                    c = new core.Matrix(core.Utils.fillHoles(nterms, max)).transpose();\r\n                    //for each of the factors we do the same\r\n                    M = new core.Matrix();\r\n                    for(var i = 0; i < dterms.length; i++) {\r\n                        M.elements.push(core.Utils.fillHoles(dterms[i], max));\r\n                    }\r\n\r\n                    //solve the system of equations\r\n                    var partials = _.multiply(M.transpose().invert(), c);\r\n                    //the results are backwards to reverse it\r\n                    //partials.elements.reverse();\r\n                    //convert it all back\r\n                    var retval = as_array ? [r] : r;\r\n                    partials.each(function (e, i) {\r\n                        var term = _.multiply(ks[i], _.divide(e, factors[i]));\r\n                        if(as_array)\r\n                            retval.push(term);\r\n                        else\r\n                            retval = _.add(retval, term);\r\n                    });\r\n\r\n                    //done\r\n                    return retval;\r\n                }\r\n                catch(e) {\r\n                    //try to group symbols\r\n                    try {\r\n                        if(symbol.isComposite()) {\r\n                            //group denominators\r\n                            var denominators = {};\r\n\r\n                            symbol.each(function (x) {\r\n                                var d = x.getDenom();\r\n                                var n = x.getNum();\r\n                                var e = denominators[d];\r\n                                denominators[d] = e ? _.add(e, n) : n;\r\n                            });\r\n\r\n                            var t = new Symbol(0);\r\n\r\n                            for(var x in denominators) {\r\n                                t = _.add(t, _.divide(denominators[x], _.parse(x)));\r\n                            }\r\n\r\n                            symbol = t;\r\n                        }\r\n                    }\r\n                    catch(e2) {\r\n                    }\r\n                    ;\r\n                }\r\n                ;\r\n\r\n                return symbol;\r\n            }\r\n        },\r\n        degree: function (symbol, v, o) {\r\n            o = o || {\r\n                nd: [], //numeric\r\n                sd: [], //symbolic\r\n                depth: 0 //call depth\r\n            };\r\n\r\n            if(!v) {\r\n                var vars = variables(symbol);\r\n                //The user must specify the variable for multivariate\r\n                if(vars.length > 1)\r\n                    throw new Error('You must specify the variable for multivariate polynomials!');\r\n                //if it's empty then we're dealing with a constant\r\n                if(vars.length === 0)\r\n                    return new Symbol(0);\r\n                //assume the variable for univariate\r\n                v = _.parse(vars[0]);\r\n            }\r\n\r\n            //store the group\r\n            var g = symbol.group;\r\n            //we're going to trust the user and assume no EX. Calling isPoly \r\n            //would eliminate this but no sense in checking twice. \r\n            if(symbol.isComposite()) {\r\n                symbol = symbol.clone();\r\n                symbol.distributeExponent();\r\n                symbol.each(function (x) {\r\n                    o.depth++; //mark a depth increase\r\n                    __.degree(x, v, o);\r\n                    o.depth--; //we're back\r\n                });\r\n            }\r\n            else if(symbol.group === CB) {\r\n                symbol.each(function (x) {\r\n                    o.depth++;\r\n                    __.degree(x, v, o);\r\n                    o.depth++;\r\n                });\r\n            }\r\n            else if(g === EX && symbol.value === v.value) {\r\n                o.sd.push(symbol.power.clone());\r\n            }\r\n            else if(g === S && symbol.value === v.value) {\r\n                o.nd.push(_.parse(symbol.power));\r\n            }\r\n            else\r\n                o.nd.push(new Symbol(0));\r\n\r\n            //get the max out of the array\r\n            var deg = o.nd.length > 0 ? core.Utils.arrayMax(o.nd) : undefined;\r\n\r\n            if(o.depth === 0 && o.sd.length > 0) {\r\n                if(deg !== undefined)\r\n                    o.sd.unshift(deg);\r\n                return _.symfunction('max', o.sd);\r\n            }\r\n            if(!core.Utils.isSymbol(deg))\r\n                deg = _.parse(deg);\r\n            //return the degree\r\n            return deg;\r\n        },\r\n        /**\r\n         * Attempts to complete the square of a polynomial\r\n         * @param {type} symbol\r\n         * @param {type} v\r\n         * @param {type} raw\r\n         * @throws {Error} \r\n         * @returns {Object|Symbol[]}\r\n         */\r\n        sqComplete: function (symbol, v, raw) {\r\n            if(!core.Utils.isSymbol(v))\r\n                v = _.parse(v);\r\n            var stop = function (msg) {\r\n                msg = msg || 'Stopping';\r\n                throw new core.exceptions.ValueLimitExceededError(msg);\r\n            };\r\n            //if not CP then nothing to do\r\n            if(!symbol.isPoly(true))\r\n                stop('Must be a polynomial!');\r\n\r\n            //declare vars\r\n            var deg, a, b, c, d, e, coeffs, sign, br, sym, sqrt_a;\r\n\r\n            br = core.Utils.inBrackets;\r\n            //make a copy\r\n            symbol = symbol.clone();\r\n            deg = core.Algebra.degree(symbol, v); //get the degree of polynomial\r\n            //must be in form ax^2 +/- bx +/- c\r\n            if(!deg.equals(2))\r\n                stop('Cannot complete square for degree ' + deg);\r\n            //get the coeffs\r\n            coeffs = core.Algebra.coeffs(symbol, v);\r\n            a = coeffs[2];\r\n            //store the sign\r\n            sign = coeffs[1].sign();\r\n            //divide the linear term by two and square it\r\n            b = _.divide(coeffs[1], new Symbol(2));\r\n            //add the difference to the constant\r\n            c = _.pow(b.clone(), new Symbol(2));\r\n            if(raw)\r\n                return [a, b, d];\r\n            sqrt_a = math.sqrt(a);\r\n            e = _.divide(math.sqrt(c), sqrt_a.clone());\r\n            //calculate d which is the constant\r\n            d = _.subtract(coeffs[0], _.pow(e.clone(), new Symbol(2)));\r\n            //compute the square part\r\n            sym = _.parse(br(sqrt_a.clone() + '*' + v + (sign < 0 ? '-' : '+') + e));\r\n            return {\r\n                a: sym,\r\n                c: d,\r\n                f: _.add(_.pow(sym.clone(), new Symbol(2)), d.clone())\r\n            };\r\n        },\r\n        Simplify: {\r\n            strip: function (symbol) {\r\n                var c = _.parse(symbol.multiplier);\r\n                symbol.toUnitMultiplier();\r\n                var p = _.parse(symbol.power);\r\n                symbol.toLinear();\r\n                return [c, p, symbol];\r\n            },\r\n            unstrip: function (cp, symbol) {\r\n                var c = cp[0];\r\n                var p = cp[1];\r\n                return _.multiply(c, _.pow(symbol, p));\r\n            },\r\n            complexSimp: function (num, den) {\r\n                var ac, bd, bc, ad, cd, r1, r2, i1, i2;\r\n                r1 = num.realpart();\r\n                i1 = num.imagpart();\r\n                r2 = den.realpart();\r\n                i2 = den.imagpart();\r\n                //apply complex arithmatic rule\r\n                ac = _.multiply(r1.clone(), r2.clone());\r\n                bd = _.multiply(i1.clone(), i2.clone());\r\n                bc = _.multiply(r2.clone(), i1);\r\n                ad = _.multiply(r1, i2.clone());\r\n                cd = _.add(_.pow(r2, new Symbol(2)), _.pow(i2, new Symbol(2)));\r\n\r\n                return _.divide(_.add(_.add(ac, bd), _.multiply(_.subtract(bc, ad), Symbol.imaginary())), cd);\r\n            },\r\n            trigSimp: function (symbol) {\r\n                if(symbol.containsFunction(['cos', 'sin', 'tan'])) {\r\n                    symbol = symbol.clone();\r\n                    //remove power and multiplier\r\n                    var sym_array = __.Simplify.strip(symbol);\r\n                    symbol = sym_array.pop();\r\n                    //the default return value is the symbol\r\n                    var retval = symbol.clone();\r\n\r\n                    //rewrite the symbol\r\n                    if(symbol.group === CP) {\r\n                        var sym = new Symbol(0);\r\n                        symbol.each(function (x) {\r\n                            //rewrite the function\r\n                            var tr = __.Simplify.trigSimp(x.fnTransform());\r\n                            sym = _.add(sym, tr);\r\n                        }, true);\r\n\r\n                        //put back the power and multiplier and return\r\n                        retval = _.pow(_.multiply(new Symbol(symbol.multiplier), sym), new Symbol(symbol.power));\r\n                    }\r\n                    else if(symbol.group === CB) {\r\n\r\n                        var n = symbol.getNum();\r\n                        var d = symbol.getDenom();\r\n\r\n                        //try for tangent\r\n                        if(n.fname === 'sin' && d.fname === 'cos' && n.args[0].equals(d.args[0]) && n.power.equals(d.power)) {\r\n                            retval = _.parse(core.Utils.format('({0})*({1})*tan({2})^({3})', d.multiplier, n.multiplier, n.args[0], n.power));\r\n                        }\r\n                        if(retval.group === CB) {\r\n                            var t = new Symbol(1);\r\n                            retval.each(function (x) {\r\n                                if(x.fname === 'tan') {\r\n                                    x = _.parse(core.Utils.format('({0})*sin({1})^({2})/cos({1})^({2})', x.multiplier, __.Simplify.simplify(x.args[0]), x.power));\r\n                                }\r\n                                t = _.multiply(t, x);\r\n                            });\r\n                            retval = t;\r\n                        }\r\n                    }\r\n\r\n\r\n                    retval = __.Simplify.unstrip(sym_array, retval).distributeMultiplier();\r\n\r\n                    symbol = retval;\r\n                }\r\n\r\n                return symbol;\r\n            },\r\n            fracSimp: function (symbol) {\r\n                //try a quick simplify of imaginary numbers\r\n                var den = symbol.getDenom();\r\n                var num = symbol.getNum();\r\n\r\n                if(num.isImaginary() && den.isImaginary())\r\n                    symbol = __.Simplify.complexSimp(num, den);\r\n\r\n                if(symbol.isComposite()) {\r\n                    if(symbol.power > 1) {\r\n                        symbol = _.expand(symbol);\r\n                    }\r\n\r\n                    var symbols = symbol.collectSymbols();\r\n                    //assumption 1.\r\n                    //since it's a composite, it has a length of at least 1\r\n                    var retval, a, b, d1, d2, n1, n2, s, x, y, c, den, num;\r\n                    a = symbols.pop(); //grab the first symbol\r\n                    //loop through each term and make denominator common\r\n                    while(symbols.length) {\r\n                        b = symbols.pop(); //grab the second symbol\r\n                        d1 = _.parse(a.getDenom());\r\n                        d2 = _.parse(b.getDenom());\r\n                        n1 = a.getNum();\r\n                        n2 = b.getNum();\r\n                        c = _.multiply(d1.clone(), d2.clone());\r\n                        x = _.multiply(n1, d2);\r\n                        y = _.multiply(n2, d1);\r\n                        s = _.add(x, y);\r\n                        a = _.divide(s, c);\r\n                    }\r\n                    den = _.expand(a.getDenom());\r\n                    num = _.expand(a.getNum());\r\n                    //simplify imaginary\r\n                    if(num.isImaginary() && den.isImaginary()) {\r\n                        retval = __.Simplify.complexSimp(num, den);\r\n                    }\r\n                    else {\r\n                        retval = _.divide(num, den);\r\n                    }\r\n\r\n                    //we've already hit the simplest form so return that\r\n                    if(retval.equals(symbol)) {\r\n                        return symbol;\r\n                    }\r\n\r\n                    //otherwise simplify it some more\r\n                    return __.Simplify.simplify(retval);\r\n                }\r\n                return symbol;\r\n            },\r\n            ratSimp: function (symbol) {\r\n                if(symbol.group === CB) {\r\n                    var den = symbol.getDenom();\r\n                    var num = symbol.getNum().distributeMultiplier();\r\n                    var d = __.Simplify.fracSimp(den);\r\n                    var n = __.Simplify.fracSimp(num);\r\n                    symbol = _.divide(n, d);\r\n                }\r\n                return symbol;\r\n            },\r\n            sqrtSimp: function (symbol, sym_array) {\r\n                var retval;\r\n                if(symbol.isSQRT()) {\r\n                    var factored = __.Factor.factor(symbol.args[0].clone());\r\n                    var m = _.parse(factored.multiplier);\r\n                    var sign = m.sign();\r\n\r\n                    var retval = _.sqrt(m.abs());\r\n                    var arg;\r\n\r\n                    if(isInt(retval)) {\r\n\r\n                        if(factored.group === CB) {\r\n                            var rem = new Symbol(1);\r\n\r\n                            factored.each(function (x) {\r\n                                if(x.group === N) {\r\n                                    var trial = _.sqrt(x.clone());\r\n\r\n                                    // Multiply back sqrt if it's an integer otherwise just put back the number\r\n                                    if(isInt(trial)) {\r\n                                        retval = _.multiply(retval, trial);\r\n                                    }\r\n                                    else {\r\n                                        rem = _.multiply(rem, x);\r\n                                    }\r\n                                }\r\n                                else {\r\n                                    rem = _.multiply(rem, x);\r\n                                }\r\n\r\n                            });\r\n                            var t = _.multiply(rem, _.parse(sign));\r\n                            arg = _.sqrt(t.clone());\r\n\r\n                            // Expand if it's imaginary\r\n                            if(arg.isImaginary) {\r\n                                arg = _.sqrt(_.expand(t.clone()));\r\n                            }\r\n                        }\r\n                        else {\r\n                            // Strip the multiplier\r\n                            arg = _.sqrt(factored.clone().toUnitMultiplier());\r\n                        }\r\n                        return _.multiply(retval, arg);\r\n\r\n                    }\r\n\r\n                }\r\n                else if(symbol.isComposite() && symbol.isLinear()) {\r\n                    retval = new Symbol(0);\r\n                    symbol.each(function (x) {\r\n                        retval = _.add(retval, __.Simplify.sqrtSimp(x));\r\n                    }, true);\r\n                    // Put back the multiplier\r\n                    retval = _.multiply(retval, _.parse(symbol.multiplier));\r\n                }\r\n                else if(symbol.group === CB) {\r\n                    retval = _.parse(symbol.multiplier);\r\n                    symbol.each(function (x) {\r\n                        var simp = __.Simplify.sqrtSimp(x);\r\n                        retval = _.multiply(retval, simp);\r\n\r\n                    }, true);\r\n                    // Put back the power\r\n                    retval = _.pow(retval, _.parse(symbol.power));\r\n                }\r\n\r\n                return retval ? retval : _.parse(symbol);\r\n            },\r\n            /**\r\n             * Unused. The goal is to substitute out patterns but it currently doesn't work.\r\n             * @param {Symbol} symbol\r\n             * @return {Array} The symbol and the matched patterns\r\n             */\r\n            patternSub: function (symbol) {\r\n                var patterns = {};\r\n\r\n                var has_CP = function (symbol) {\r\n                    var found = false;\r\n                    symbol.each(function (x) {\r\n                        if(x.group === CP) {\r\n                            found = true;\r\n                        }\r\n                        else if(x.symbols) {\r\n                            found = has_CP(x);\r\n                        }\r\n                    });\r\n\r\n                    return found;\r\n                };\r\n\r\n                var collect = function (sym) {\r\n                    // We loop through each symbol looking for anything in the simplest\r\n                    // form of ax+byz+...\r\n                    sym.each(function (x) {\r\n                        // Items of group N,P,S, need to apply\r\n                        if(!x.symbols && x.group !== FN) {\r\n                            return;\r\n                        }\r\n\r\n                        // Check to see if it has any symbols of group CP\r\n                        // Get the patterns in that symbol instead if it has anything of group CP\r\n                        if(has_CP(x)) {\r\n                            collect(x);\r\n                        }\r\n                        else {\r\n                            if(!patterns[x.value]) {\r\n                                var u = core.Utils.getU(symbol);\r\n                                // Get a u value and mark it for subsitution\r\n                                patterns[x.value] = u;\r\n                                symbol = symbol.sub(x.value, u);\r\n                            }\r\n                        }\r\n                    }, true);\r\n                };\r\n\r\n                // Collect a list of patterns\r\n                collect(symbol);\r\n\r\n                return [symbol, patterns];\r\n            },\r\n            simplify: function (symbol) {\r\n                //remove the multiplier to make calculation easier;\r\n                var sym_array = __.Simplify.strip(symbol);\r\n                symbol = sym_array.pop();\r\n                //remove gcd from denominator\r\n                symbol = __.Simplify.fracSimp(symbol);\r\n                //nothing more to do\r\n                if(symbol.isConstant() || symbol.group === core.groups.S) {\r\n                    sym_array.push(symbol);\r\n                    var ret = __.Simplify.unstrip(sym_array, symbol);\r\n                    return ret;\r\n                }\r\n\r\n                //var patterns;\r\n\r\n                var simplified = symbol.clone(); //make a copy\r\n\r\n                //[simplified, patterns] = __.Simplify.patternSub(symbol);\r\n\r\n                // Simplify sqrt within the symbol\r\n//                simplified = __.Simplify.sqrtSimp(simplified, sym_array);\r\n\r\n                // Try trig simplificatons e.g. cos(x)^2+sin(x)^2\r\n                simplified = __.Simplify.trigSimp(simplified);\r\n\r\n                // Simplify common denominators\r\n                simplified = __.Simplify.ratSimp(simplified);\r\n\r\n                // First go for the \"cheapest\" simplification which may eliminate \r\n                // your problems right away. factor -> evaluate. Remember\r\n                // that there's no need to expand since factor already does that\r\n\r\n                simplified = __.Factor.factor(simplified);\r\n\r\n                //If the simplfied is a sum then we can make a few more simplifications\r\n                //e.g. simplify(1/(x-1)+1/(1-x)) as per issue #431\r\n                if(simplified.group === core.groups.CP && simplified.isLinear()) {\r\n                    var m = simplified.multiplier.clone();\r\n                    simplified.toUnitMultiplier(); //strip the multiplier\r\n                    var r = new Symbol(0);\r\n                    //return the sum of simplifications\r\n                    simplified.each(function (x) {\r\n                        var s = __.Simplify.simplify(x);\r\n                        r = _.add(r, s);\r\n                    });\r\n                    simplified = r;\r\n                    //put back the multiplier\r\n                    r.multiplier = r.multiplier.multiply(m);\r\n                }\r\n\r\n                //place back multiplier and return\r\n                var retval = __.Simplify.unstrip(sym_array, simplified);\r\n\r\n                // Back substitute\r\n                /*\r\n                 for(var x in patterns) {\r\n                 retval = retval.sub(patterns[x], x);\r\n                 }\r\n                 */\r\n\r\n                return retval;\r\n            }\r\n        },\r\n\r\n        Classes: {\r\n            Polynomial: Polynomial,\r\n            Factors: Factors,\r\n            MVTerm: MVTerm\r\n        }\r\n    };\r\n\r\n    // Add a link to simplify\r\n    core.Expression.prototype.simplify = function () {\r\n        return __.Simplify.simplify(this.symbol);\r\n    };\r\n\r\n    nerdamer.useAlgebraDiv = function () {\r\n        var divide = __.divideFn = _.divide;\r\n        var calls = 0; //keep track of how many calls were made\r\n        _.divide = function (a, b) {\r\n            calls++;\r\n            var ans;\r\n            if(calls === 1) //check if this is the first call. If it is use algebra divide\r\n                ans = core.Algebra.divide(a, b);\r\n            else //otherwise use parser divide\r\n                ans = divide(a, b);\r\n            calls = 0; //reset the number of calls back to none\r\n            return ans;\r\n        };\r\n    };\r\n\r\n    nerdamer.useParserDiv = function () {\r\n        if(__.divideFn)\r\n            _.divide = __.divideFn;\r\n        delete __.divideFn;\r\n    };\r\n\r\n    nerdamer.register([\r\n        {\r\n            name: 'factor',\r\n            visible: true,\r\n            numargs: 1,\r\n            build: function () {\r\n                return __.Factor.factor;\r\n            }\r\n        },\r\n        {\r\n            name: 'simplify',\r\n            visible: true,\r\n            numargs: 1,\r\n            build: function () {\r\n                return __.Simplify.simplify;\r\n            }\r\n        },\r\n        {\r\n            name: 'gcd',\r\n            visible: true,\r\n            numargs: [1, ],\r\n            build: function () {\r\n                return __.gcd;\r\n            }\r\n        },\r\n        {\r\n            name: 'lcm',\r\n            visible: true,\r\n            numargs: [1, ],\r\n            build: function () {\r\n                return __.lcm;\r\n            }\r\n        },\r\n        {\r\n            name: 'roots',\r\n            visible: true,\r\n            numargs: -1,\r\n            build: function () {\r\n                return __.roots;\r\n            }\r\n        },\r\n        {\r\n            name: 'divide',\r\n            visible: true,\r\n            numargs: 2,\r\n            build: function () {\r\n                return __.divide;\r\n            }\r\n        },\r\n        {\r\n            name: 'div',\r\n            visible: true,\r\n            numargs: 2,\r\n            build: function () {\r\n                return __.div;\r\n            }\r\n        },\r\n        {\r\n            name: 'partfrac',\r\n            visible: true,\r\n            numargs: [1, 2],\r\n            build: function () {\r\n                return __.PartFrac.partfrac;\r\n            }\r\n        },\r\n        {\r\n            name: 'deg',\r\n            visible: true,\r\n            numargs: [1, 2],\r\n            build: function () {\r\n                return __.degree;\r\n            }\r\n        },\r\n        {\r\n            name: 'coeffs',\r\n            visible: true,\r\n            numargs: [1, 2],\r\n            build: function () {\r\n                var f = function () {\r\n                    var coeffs = __.coeffs.apply(__, arguments);\r\n                    return new core.Vector(coeffs);\r\n                };\r\n                return f;\r\n            }\r\n        },\r\n        {\r\n            name: 'line',\r\n            visible: true,\r\n            numargs: [2, 3],\r\n            build: function () {\r\n                return __.line;\r\n            }\r\n        },\r\n        {\r\n            name: 'sqcomp',\r\n            visible: true,\r\n            numargs: [1, 2],\r\n            build: function () {\r\n                var f = function (x, v) {\r\n                    try {\r\n                        v = v || variables(x)[0];\r\n                        var sq = __.sqComplete(x.clone(), v);\r\n                        return sq.f;\r\n                    }\r\n                    catch(e) {\r\n                        return x;\r\n                    }\r\n                };\r\n                return f;\r\n            }\r\n        }\r\n    ]);\r\n    nerdamer.updateAPI();\r\n})();","/*\r\n * Author : Martin Donk\r\n * Website : http://www.nerdamer.com\r\n * Email : martin.r.donk@gmail.com\r\n * Source : https://github.com/jiggzson/nerdamer\r\n */\r\n/* global module */\r\n\r\nif((typeof module) !== 'undefined') {\r\n    var nerdamer = require('./nerdamer.core.js');\r\n    require('./Calculus.js');\r\n    require('./Algebra.js');\r\n}\r\n\r\n(function () {\r\n    //handle imports\r\n    var core = nerdamer.getCore(),\r\n            _ = core.PARSER,\r\n            _A = core.Algebra,\r\n            _C = core.Calculus,\r\n            explode = _C.integration.decompose_arg,\r\n            evaluate = core.Utils.evaluate,\r\n            remove = core.Utils.remove,\r\n            format = core.Utils.format,\r\n            build = core.Utils.build,\r\n            knownVariable = core.Utils.knownVariable,\r\n            Symbol = core.Symbol,\r\n            isSymbol = core.Utils.isSymbol,\r\n            variables = core.Utils.variables,\r\n            S = core.groups.S,\r\n            PL = core.groups.PL,\r\n            CB = core.groups.CB,\r\n            CP = core.groups.CP,\r\n            FN = core.groups.FN,\r\n            Settings = core.Settings,\r\n            range = core.Utils.range,\r\n            isArray = core.Utils.isArray;\r\n\r\n\r\n    // The search radius for the roots\r\n    core.Settings.SOLVE_RADIUS = 1000;\r\n    // The maximum number to fish for on each side of the zero\r\n    core.Settings.ROOTS_PER_SIDE = 10;\r\n    // Covert the number to multiples of pi if possible\r\n    core.Settings.make_pi_conversions = false;\r\n    // The step size\r\n    core.Settings.STEP_SIZE = 0.1;\r\n    // The epsilon size\r\n    core.Settings.EPSILON = 1e-13;\r\n    //the maximum iterations for Newton's method\r\n    core.Settings.MAX_NEWTON_ITERATIONS = 200;\r\n    //the maximum number of time non-linear solve tries another jump point\r\n    core.Settings.MAX_NON_LINEAR_TRIES = 12;\r\n    //the amount of iterations the function will start to jump at\r\n    core.Settings.NON_LINEAR_JUMP_AT = 50;\r\n    //the size of the jump\r\n    core.Settings.NON_LINEAR_JUMP_SIZE = 100;\r\n    //the original starting point for nonlinear solving\r\n    core.Settings.NON_LINEAR_START = 0.01;\r\n    //When points are generated as starting points for Newton's method, they are sliced into small\r\n    //slices to make sure that we have convergence on the right point. This defines the \r\n    //size of the slice\r\n    core.Settings.NEWTON_SLICES = 200;\r\n    //The epsilon used in Newton's iteration\r\n    core.Settings.NEWTON_EPSILON = Number.EPSILON * 2;\r\n    //The distance in which two solutions are deemed the same\r\n    core.Settings.SOLUTION_PROXIMITY = 1e-14;\r\n    //Indicate wheter to filter the solutions are not\r\n    core.Settings.FILTER_SOLUTIONS = true;\r\n    //the maximum number of recursive calls\r\n    core.Settings.MAX_SOLVE_DEPTH = 10;\r\n    // The tolerance that's considered close enough to zero\r\n    core.Settings.ZERO_EPSILON = 1e-9;\r\n    // The maximum iteration for the bisection method incase of some JS strangeness\r\n    core.Settings.MAX_BISECTION_ITER = 2000;\r\n    // The tolerance for the bisection method\r\n    core.Settings.BI_SECTION_EPSILON = 1e-12;\r\n\r\n\r\n    core.Symbol.prototype.hasTrig = function () {\r\n        return this.containsFunction(['cos', 'sin', 'tan', 'cot', 'csc', 'sec']);\r\n    };\r\n\r\n    core.Symbol.prototype.hasNegativeTerms = function () {\r\n        if(this.isComposite()) {\r\n            for(var x in this.symbols) {\r\n                var sym = this.symbols[x];\r\n                if(sym.group === PL && sym.hasNegativeTerms() || this.symbols[x].power.lessThan(0))\r\n                    return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    /* nerdamer version 0.7.x and up allows us to make better use of operator overloading\r\n     * As such we can have this data type be supported completely outside of the core.\r\n     * This is an equation that has a left hand side and a right hand side\r\n     */\r\n    function Equation(lhs, rhs) {\r\n        if(rhs.isConstant() && lhs.isConstant() && !lhs.equals(rhs) || lhs.equals(core.Settings.IMAGINARY) && rhs.isConstant(true) || rhs.equals(core.Settings.IMAGINARY) && lhs.isConstant(true))\r\n            throw new core.exceptions.NerdamerValueError(lhs.toString() + ' does not equal ' + rhs.toString());\r\n        this.LHS = lhs; //left hand side\r\n        this.RHS = rhs; //right and side\r\n    }\r\n    ;\r\n\r\n    //UTILS ##!!\r\n\r\n    Equation.prototype = {\r\n        toString: function () {\r\n            return this.LHS.toString() + '=' + this.RHS.toString();\r\n        },\r\n        text: function (option) {\r\n            return this.LHS.text(option) + '=' + this.RHS.text(option);\r\n        },\r\n        toLHS: function (expand) {\r\n            expand = typeof expand === 'undefined' ? true : false;\r\n            var eqn;\r\n            if(!expand) {\r\n                eqn = this.clone();\r\n            }\r\n            else {\r\n                eqn = this.removeDenom();\r\n            }\r\n            var a = eqn.LHS;\r\n            var b = eqn.RHS;\r\n            \r\n            if(a.isConstant(true) && !b.isConstant(true)) {\r\n                // Swap them to avoid confusing parser and cause an infinite loop\r\n                [a, b] = [b, a];\r\n            }\r\n            var _t = _.subtract(a, b);\r\n            var retval = expand ? _.expand(_t) : _t;\r\n            \r\n            // Quick workaround for issue #636\r\n            // This basically borrows the removeDenom method from the Equation class. \r\n            // TODO: Make this function a stand-alone function\r\n            retval = new Equation(retval, new Symbol(0)).removeDenom().LHS;\r\n            \r\n            return retval;\r\n        },\r\n        removeDenom: function () {\r\n            var a = this.LHS.clone();\r\n            var b = this.RHS.clone();\r\n            //remove the denominator on both sides\r\n            var den = _.multiply(a.getDenom(), b.getDenom());\r\n            a = _.expand(_.multiply(a, den.clone()));\r\n            b = _.expand(_.multiply(b, den));\r\n            //swap the groups\r\n            if(b.group === CP && b.group !== CP) {\r\n                var t = a;\r\n                a = b;\r\n                b = t; //swap\r\n            }\r\n\r\n            //scan to eliminate denominators\r\n            if(a.group === CB) {\r\n                var t = new Symbol(a.multiplier),\r\n                        newRHS = b.clone();\r\n                a.each(function (y) {\r\n                    if(y.power.lessThan(0))\r\n                        newRHS = _.divide(newRHS, y);\r\n                    else\r\n                        t = _.multiply(t, y);\r\n                });\r\n                a = t;\r\n                b = newRHS;\r\n\r\n            }\r\n            else if(a.group === CP) {\r\n                //the logic: loop through each and if it has a denominator then multiply it out on both ends\r\n                //and then start over\r\n                for(var x in a.symbols) {\r\n                    var sym = a.symbols[x];\r\n                    if(sym.group === CB) {\r\n                        for(var y in sym.symbols) {\r\n                            var sym2 = sym.symbols[y];\r\n                            if(sym2.power.lessThan(0)) {\r\n                                return new Equation(\r\n                                        _.expand(_.multiply(sym2.clone().toLinear(), a)),\r\n                                        _.expand(_.multiply(sym2.clone().toLinear(), b))\r\n                                        );\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            return new Equation(a, b);\r\n        },\r\n        clone: function () {\r\n            return new Equation(this.LHS.clone(), this.RHS.clone());\r\n        },\r\n        sub: function (x, y) {\r\n            var clone = this.clone();\r\n            clone.LHS = clone.LHS.sub(x.clone(), y.clone());\r\n            clone.RHS = clone.RHS.sub(x.clone(), y.clone());\r\n            return clone;\r\n        },\r\n        isZero: function () {\r\n            return core.Utils.evaluate(this.toLHS()).equals(0);\r\n        },\r\n        latex: function (option) {\r\n            return [this.LHS.latex(option), this.RHS.latex(option)].join('=');\r\n        }\r\n    };\r\n    //overwrite the equals function\r\n    _.equals = function (a, b) {\r\n        return new Equation(a, b);\r\n    };\r\n\r\n    // Extend simplify\r\n    (function () {\r\n        var simplify = _.functions.simplify[0];\r\n        _.functions.simplify[0] = function (symbol) {\r\n            if(symbol instanceof Equation) {\r\n                symbol.LHS = simplify(symbol.LHS);\r\n                symbol.RHS = simplify(symbol.RHS);\r\n                return symbol;\r\n            }\r\n            // Just call the original simplify\r\n            return simplify(symbol);\r\n        };\r\n    })();\r\n\r\n    /**\r\n     * Sets two expressions equal\r\n     * @param {Symbol} symbol\r\n     * @returns {Expression}\r\n     */\r\n    core.Expression.prototype.equals = function (symbol) {\r\n        if(symbol instanceof core.Expression)\r\n            symbol = symbol.symbol; //grab the symbol if it's an expression\r\n        var eq = new Equation(this.symbol, symbol);\r\n        return eq;\r\n    };\r\n\r\n    core.Expression.prototype.solveFor = function (x) {\r\n        var symbol;\r\n        if(this.symbol instanceof Equation) {\r\n            //exit right away if we already have the answer\r\n            //check the LHS\r\n            if(this.symbol.LHS.isConstant() && this.symbol.RHS.equals(x))\r\n                return new core.Expression(this.symbol.LHS);\r\n\r\n            //check the RHS\r\n            if(this.symbol.RHS.isConstant() && this.symbol.LHS.equals(x))\r\n                return new core.Expression(this.symbol.RHS);\r\n\r\n            //otherwise just bring it to LHS\r\n            symbol = this.symbol.toLHS();\r\n        }\r\n        else {\r\n            symbol = this.symbol;\r\n        }\r\n\r\n        return solve(symbol, x).map(function (x) {\r\n            return new core.Expression(x);\r\n        });\r\n    };\r\n\r\n    core.Expression.prototype.expand = function () {\r\n        if(this.symbol instanceof Equation) {\r\n            var clone = this.symbol.clone();\r\n            clone.RHS = _.expand(clone.RHS);\r\n            clone.LHS = _.expand(clone.LHS);\r\n            return new core.Expression(clone);\r\n        }\r\n        return new core.Expression(_.expand(this.symbol));\r\n    };\r\n\r\n    core.Expression.prototype.variables = function () {\r\n        if(this.symbol instanceof Equation)\r\n            return core.Utils.arrayUnique(variables(this.symbol.LHS).concat(variables(this.symbol.RHS)));\r\n        return variables(this.symbol);\r\n    };\r\n\r\n\r\n\r\n    var setEq = function (a, b) {\r\n        return _.equals(a, b);\r\n    };\r\n\r\n    //link the Equation class back to the core\r\n    core.Equation = Equation;\r\n\r\n    //Loops through an array and attempts to fails a test. Stops if manages to fail.\r\n    var checkAll = core.Utils.checkAll = function (args, test) {\r\n        for(var i = 0; i < args.length; i++)\r\n            if(test(args[i]))\r\n                return false;\r\n        return true;\r\n    };\r\n\r\n    //version solve\r\n    var __ = core.Solve = {\r\n        version: '2.0.3',\r\n        solutions: [],\r\n        solve: function (eq, variable) {\r\n            var solution = solve(eq, String(variable));\r\n            return new core.Vector(solution);\r\n            //return new core.Vector(solve(eq.toString(), variable ? variable.toString() : variable));\r\n        },\r\n        /**\r\n         * Brings the equation to LHS. A string can be supplied which will be converted to an Equation\r\n         * @param {Equation|String} eqn\r\n         * @returns {Symbol}\r\n         */\r\n        toLHS: function (eqn, expand) {\r\n            if(isSymbol(eqn))\r\n                return eqn;\r\n            //If it's an equation then call its toLHS function instead\r\n            if(!(eqn instanceof Equation)) {\r\n                var es = eqn.split('=');\r\n                //convert falsey values to zero\r\n                es[1] = es[1] || '0';\r\n                eqn = new Equation(_.parse(es[0]), _.parse(es[1]));\r\n            }\r\n            return eqn.toLHS(expand);\r\n        },\r\n//        getSystemVariables: function(eqns) {\r\n//            vars = variables(eqns[0], null, null, true);\r\n//\r\n//            //get all variables\r\n//            for (var i = 1, l=eqns.length; i < l; i++)\r\n//                vars = vars.concat(variables(eqns[i]));\r\n//            //remove duplicates\r\n//            vars = core.Utils.arrayUnique(vars).sort();\r\n//            \r\n//            //done\r\n//            return vars;\r\n//        },\r\n        /**\r\n         * Solve a set of circle equations. \r\n         * @param {Symbol[]} eqns\r\n         * @returns {Array}\r\n         */\r\n        solveCircle: function (eqns, vars) {\r\n            // Convert the variables to symbols\r\n            var svars = vars.map(function (x) {\r\n                return _.parse(x)\r\n            });\r\n\r\n            var deg = [];\r\n\r\n            var solutions = [];\r\n\r\n            // Get the degree for the equations\r\n            for(var i = 0; i < eqns.length; i++) {\r\n                var d = [];\r\n                for(var j = 0; j < svars.length; j++) {\r\n                    d.push(Number(core.Algebra.degree(eqns[i], svars[j])));\r\n                }\r\n                // Store the total degree\r\n                d.push(core.Utils.arraySum(d, true));\r\n                deg.push(d);\r\n            }\r\n\r\n            var a = eqns[0];\r\n            var b = eqns[1];\r\n\r\n            if(deg[0][2] > deg[1][2]) {\r\n                [b, a] = [a, b];\r\n                [deg[1], deg[0]] = [deg[0], deg[1]];\r\n            }\r\n\r\n            // Only solve it's truly a circle\r\n            if(deg[0][0] === 1 && deg[0][2] === 2 && deg[1][0] === 2 && deg[1][2] === 4) {\r\n                // For clarity we'll refer to the variables as x and y\r\n                var x = vars[0];\r\n                var y = vars[1];\r\n\r\n                // We can now get the two points for y\r\n                var y_points = solve(_.parse(b, knownVariable(x, solve(_.parse(a), x)[0])), y).map(function (x) {\r\n                    return x.toString();\r\n                });\r\n\r\n                // Since we now know y we can get the two x points from the first equation\r\n                var x_points = [\r\n                    solve(_.parse(a, knownVariable(y, y_points[0])))[0].toString()\r\n                ];\r\n\r\n                if(y_points[1]) {\r\n                    x_points.push(solve(_.parse(a, knownVariable(y, y_points[1])))[0].toString());\r\n                }\r\n\r\n                if(Settings.SOLUTIONS_AS_OBJECT) {\r\n                    var solutions = {};\r\n                    solutions[x] = x_points;\r\n                    solutions[y] = y_points;\r\n                }\r\n                else {\r\n                    y_points.unshift(y);\r\n                    x_points.unshift(x);\r\n                    solutions = [x_points, y_points];\r\n                }\r\n            }\r\n\r\n            return solutions;\r\n        },\r\n        /**\r\n         * Solve a system of nonlinear equations\r\n         * @param {Symbol[]} eqns The array of equations\r\n         * @param {number} tries The maximum number of tries\r\n         * @param {number} start The starting point where to start looking for solutions\r\n         * @returns {Array}\r\n         */\r\n        solveNonLinearSystem: function (eqns, tries, start) {\r\n            if(tries < 0) {\r\n                return [];//can't find a solution\r\n            }\r\n\r\n            start = typeof start === 'undefined' ? core.Settings.NON_LINEAR_START : start;\r\n\r\n            //the maximum number of times to jump\r\n            var max_tries = core.Settings.MAX_NON_LINEAR_TRIES;\r\n\r\n            //halfway through the tries\r\n            var halfway = Math.floor(max_tries / 2);\r\n\r\n            //initialize the number of tries to 10 if not specified\r\n            tries = typeof tries === 'undefined' ? max_tries : tries;\r\n\r\n            //a point at which we check to see if we're converging. By inspection it seems that we can\r\n            //use around 20 iterations to see if we're converging. If not then we retry a jump of x\r\n            var jump_at = core.Settings.NON_LINEAR_JUMP_AT;\r\n\r\n            //we jump by this many points at each pivot point\r\n            var jump = core.Settings.NON_LINEAR_JUMP_SIZE;\r\n\r\n            //used to check if we actually found a solution or if we gave up. Assume we will find a solution.\r\n            var found = true;\r\n\r\n            var create_subs = function (vars, matrix) {\r\n                return vars.map(function (x, i) {\r\n                    return Number(matrix.get(i, 0));\r\n                });\r\n            };\r\n\r\n            var vars = core.Utils.arrayGetVariables(eqns);\r\n            var jacobian = core.Matrix.jacobian(eqns, vars, function (x) {\r\n                return build(x, vars);\r\n            }, true);\r\n\r\n            var max_iter = core.Settings.MAX_NEWTON_ITERATIONS;\r\n            var o, y, iters, xn1, norm, lnorm, xn, d;\r\n\r\n            var f_eqns = eqns.map(function (eq) {\r\n                return build(eq, vars);\r\n            });\r\n\r\n            var J = jacobian.map(function (e) {\r\n                return build(e, vars);\r\n            }, true);\r\n            //initial values\r\n            xn1 = core.Matrix.cMatrix(0, vars);\r\n\r\n            //initialize the c matrix with something close to 0. \r\n            var c = core.Matrix.cMatrix(start, vars);\r\n\r\n            iters = 0;\r\n\r\n            //start of algorithm\r\n            do {\r\n                //if we've reached the max iterations then exit\r\n                if(iters > max_iter) {\r\n                    break;\r\n                    found = false;\r\n                }\r\n\r\n                //set the substitution object\r\n                o = create_subs(vars, c);\r\n\r\n                //set xn\r\n                xn = c.clone();\r\n\r\n                //make all the substitutions for each of the equations\r\n                f_eqns.forEach(function (f, i) {\r\n                    c.set(i, 0, f.apply(null, o));\r\n                });\r\n\r\n                var m = new core.Matrix();\r\n                J.each(function (fn, i, j) {\r\n                    var ans = fn.apply(null, o);\r\n                    m.set(i, j, ans);\r\n                });\r\n\r\n                m = m.invert();\r\n\r\n                //preform the elimination\r\n                y = _.multiply(m, c).negate();\r\n\r\n                //the callback is to avoid overflow in the coeffient denonimator\r\n                //it converts it to a decimal and then back to a fraction. Some precision\r\n                //is lost be it's better than overflow. \r\n                d = y.subtract(xn1, function (x) {\r\n                    return _.parse(Number(x));\r\n                });\r\n\r\n                xn1 = xn.add(y, function (x) {\r\n                    return _.parse(Number(x));\r\n                });\r\n\r\n                //move c is now xn1\r\n                c = xn1;\r\n\r\n                //get the norm\r\n\r\n                //the expectation is that we're converging to some answer as this point regardless of where we start\r\n                //this may have to be adjusted at some point because of erroneous assumptions\r\n                if(iters >= jump_at) {\r\n                    //check the norm. If the norm is greater than one then it's time to try another point\r\n                    if(norm > 1) {\r\n                        //reset the start point at halway\r\n                        if(tries === halfway)\r\n                            start = 0;\r\n                        var sign = tries > halfway ? 1 : -1; //which side are we incrementing\r\n                        //we increment +n at one side and -n at the other. \r\n                        n = (tries % Math.floor(halfway)) + 1;\r\n                        //adjust the start point\r\n                        start += (sign * n * jump);\r\n                        //call restart\r\n                        return __.solveNonLinearSystem(eqns, --tries, start);\r\n                    }\r\n                }\r\n                lnorm = norm;\r\n                iters++;\r\n                norm = d.max();\r\n\r\n                //exit early. Revisit if we get bugs\r\n                if(Number(norm) === Number(lnorm)) {\r\n                    break;\r\n                }\r\n            }\r\n            while(Number(norm) >= Number.EPSILON)\r\n\r\n            //return a blank set if nothing was found;\r\n            if(!found)\r\n                return [];\r\n\r\n            //return c since that's the answer\r\n            return __.systemSolutions(c, vars, true, function (x) {\r\n                return core.Utils.round(Number(x), 14);\r\n            });\r\n        },\r\n        systemSolutions: function (result, vars, expand_result, callback) {\r\n            var solutions = core.Settings.SOLUTIONS_AS_OBJECT ? {} : [];\r\n\r\n            result.each(function (e, idx) {\r\n                var solution = (expand_result ? _.expand(e) : e).valueOf();\r\n                if(callback)\r\n                    solution = callback.call(e, solution);\r\n                var variable = vars[idx];\r\n                if(core.Settings.SOLUTIONS_AS_OBJECT) {\r\n                    solutions[variable] = solution;\r\n                }\r\n                else\r\n                    solutions.push([variable, solution]); /*NO*/\r\n            });\r\n            //done\r\n            return solutions;\r\n        },\r\n        /**\r\n         * Solves a system of equations by substitution. This is useful when\r\n         * no distinct solution exists. e.g. a line, plane, etc.\r\n         * @param {Array} eqns\r\n         * @returns {Array}\r\n         */\r\n        solveSystemBySubstitution: function (eqns) {\r\n            // Assume at least 2 equations. The function variables will just return an empty array if undefined is provided\r\n            var vars_a = variables(eqns[0]);\r\n            var vars_b = variables(eqns[1]);\r\n            // Check if it's a circle equation\r\n            if(eqns.length === 2 && vars_a.length === 2 && core.Utils.arrayEqual(vars_a, vars_b)) {\r\n                return __.solveCircle(eqns, vars_a);\r\n            }\r\n\r\n            return []; // return an empty set\r\n        },\r\n\r\n        //https://www.lakeheadu.ca/sites/default/files/uploads/77/docs/RemaniFinal.pdf\r\n        /**\r\n         * Solves a systems of equations\r\n         * @param {Array} eqns An array of equations\r\n         * @param {Array} var_array An array of variables\r\n         * @returns {Array|object}\r\n         */\r\n        solveSystem: function (eqns, var_array) {\r\n            //check if a var_array was specified\r\n            //nerdamer.clearVars();// this deleted ALL variables: not what we want\r\n            //parse all the equations to LHS. Remember that they come in as strings\r\n            for(var i = 0; i < eqns.length; i++)\r\n                eqns[i] = __.toLHS(eqns[i]);\r\n\r\n            var l = eqns.length,\r\n                    m = new core.Matrix(),\r\n                    c = new core.Matrix(),\r\n                    expand_result = false,\r\n                    vars;\r\n\r\n            if(typeof var_array === 'undefined') {\r\n                //check to make sure that all the equations are linear\r\n                if(!_A.allLinear(eqns)) {\r\n                    try {\r\n                        return __.solveNonLinearSystem(eqns);\r\n                    }\r\n                    catch(e) {\r\n                        if(e instanceof core.exceptions.DivisionByZero) {\r\n                            return __.solveSystemBySubstitution(eqns);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                vars = core.Utils.arrayGetVariables(eqns);\r\n                \r\n                // If the system only has one variable then we solve for the first one and \r\n                // then test the remaining equations with that solution. If any of the remaining\r\n                // equation fails then the system has no solution\r\n                if(vars.length === 1) {\r\n                    var n = 0,\r\n                        sol, e;\r\n                    do {\r\n                        var e = eqns[n].clone();\r\n                        \r\n                        if(n > 0) {\r\n                            e = e.sub(vars[0], sol[0]);\r\n                        }\r\n\r\n                        sol = solve(e, vars[0]);\r\n                        // Skip the first one\r\n                        if(n === 0) \r\n                            continue;\r\n                    }\r\n                    while(++n < eqns.length)\r\n                        \r\n                    // Format the output\r\n                    var solutions;\r\n                    if(Settings.SOLUTIONS_AS_OBJECT) {\r\n                        solutions = {};\r\n                        solutions[vars[0]] = sol;\r\n                    }\r\n                    else if(sol.length === 0) {\r\n                        solutions = sol; // No solutions\r\n                    }\r\n                    else {\r\n                        solutions = [vars[0], sol];\r\n                    }\r\n                        \r\n                    return solutions;\r\n                }\r\n                \r\n                // Deal with redundant equations as expressed in #562\r\n                // The fix is to remove all but the number of equations equal to the number\r\n                // of variables. We then solve those and then evaluate the remaining equations\r\n                // with those solutions. If the all equal true then those are just redundant\r\n                // equations and we can return the solution set.\r\n                if(vars.length < eqns.length) {\r\n                    var reduced = [];\r\n                    var n = eqns.length;\r\n                    for(var i = 0; i < n - 1; i++) {\r\n                        reduced.push(_.parse(eqns[i]));\r\n                    }\r\n\r\n                    var knowns = {};\r\n                    var solutions = __.solveSystem(reduced, vars);\r\n                    // The solutions may have come back as an array\r\n                    if(Array.isArray(solutions)) {\r\n                        solutions.forEach(function (sol) {\r\n                            knowns[sol[0]] = sol[1];\r\n                        });\r\n                    }\r\n                    else {\r\n                        knowns = solutions;\r\n                    }\r\n\r\n                    // Start by assuming they will all evaluate to zero. If even one fails\r\n                    // then all zero will be false\r\n                    var all_zero = true;\r\n                    // Check if the last solution evalutes to zero given these solutions\r\n                    for(var i = n - 1; i < n; i++) {\r\n                        if(!_.parse(eqns[i], knowns).equals(0)) {\r\n                            all_zero = false;\r\n                        }\r\n                    }\r\n\r\n                    if(all_zero) {\r\n                        return solutions;\r\n                    }\r\n                }\r\n\r\n                // deletes only the variables of the linear equations in the nerdamer namespace\r\n                for(var i = 0; i < vars.length; i++) {\r\n                    nerdamer.setVar(vars[i], \"delete\");\r\n                }\r\n                // TODO: move this to cMatrix or something similar\r\n                // populate the matrix\r\n                for(var i = 0; i < l; i++) {\r\n                    var e = eqns[i]; //store the expression\r\n                    // Iterate over the columns\r\n                    for(var j = 0; j < vars.length; j++) {\r\n                        var v = vars[j];\r\n                        var coeffs = [];\r\n                        e.each(function (x) {\r\n                            if(x.contains(v)) {\r\n                                coeffs = coeffs.concat(x.coeffs());\r\n                            }\r\n                        });\r\n\r\n                        var cf = core.Utils.arraySum(coeffs);\r\n                        m.set(i, j, cf);\r\n                    }\r\n\r\n                    //strip the variables from the symbol so we're left with only the zeroth coefficient\r\n                    //start with the symbol and remove each variable and its coefficient\r\n                    var num = e.clone();\r\n                    vars.map(function (e) {\r\n                        num = num.stripVar(e, true);\r\n                    });\r\n                    c.set(i, 0, num.negate());\r\n                }\r\n            }\r\n            else {\r\n                /**\r\n                 * The idea is that we loop through each equation and then expand it. Afterwards we loop\r\n                 * through each term and see if and check to see if it matches one of the variables.\r\n                 * When a match is found we mark it. No other match should be found for that term. If it\r\n                 * is we stop since it's not linear.\r\n                 */\r\n                vars = var_array;\r\n                expand_result = true;\r\n                for(i = 0; i < l; i++) {\r\n                    //prefill\r\n                    c.set(i, 0, new Symbol(0));\r\n                    var e = _.expand(eqns[i]).collectSymbols(); //expand and store\r\n                    //go trough each of the variables\r\n                    for(var j = 0; j < var_array.length; j++) {\r\n                        m.set(i, j, new Symbol(0));\r\n                        var v = var_array[j];\r\n                        //go through the terms and sort the variables\r\n                        for(var k = 0; k < e.length; k++) {\r\n                            var term = e[k],\r\n                                    check = false;\r\n                            for(var z = 0; z < var_array.length; z++) {\r\n                                //check to see if terms contain multiple variables\r\n                                if(term.contains(var_array[z])) {\r\n                                    if(check)\r\n                                        core.err('Multiple variables found for term ' + term);\r\n                                    check = true;\r\n                                }\r\n                            }\r\n                            //we made sure that every term contains one variable so it's safe to assume that if the\r\n                            //variable is found then the remainder is the coefficient.\r\n                            if(term.contains(v)) {\r\n                                var tparts = explode(remove(e, k), v);\r\n                                m.set(i, j, _.add(m.get(i, j), tparts[0]));\r\n                            }\r\n                        }\r\n                    }\r\n                    //all the remaining terms go to the c matrix\r\n                    for(k = 0; k < e.length; k++) {\r\n                        c.set(i, 0, _.add(c.get(i, 0), e[k]));\r\n                    }\r\n                }\r\n                //consider case (a+b)*I+u\r\n            }\r\n\r\n            //check if the system has a distinct solution\r\n            if(vars.length !== eqns.length || m.determinant().equals(0)) {\r\n                // solve the system by hand\r\n                //return __.solveSystemBySubstitution(eqns, vars, m, c);\r\n                throw new core.exceptions.SolveError('System does not have a distinct solution');\r\n            }\r\n\r\n            // Use M^-1*c to solve system\r\n            m = m.invert();\r\n            var result = m.multiply(c);\r\n            //correct the sign as per issue #410\r\n            if(core.Utils.isArray(var_array))\r\n                result.each(function (x) {\r\n                    return x.negate();\r\n                });\r\n\r\n            return __.systemSolutions(result, vars, expand_result);\r\n        },\r\n        /**\r\n         * The quadratic function but only one side.\r\n         * @param {Symbol} c\r\n         * @param {Symbol} b\r\n         * @param {Symbol} a\r\n         * @returns {Symbol}\r\n         */\r\n        quad: function (c, b, a) {\r\n            var discriminant = _.subtract(_.pow(b.clone(), Symbol(2)), _.multiply(_.multiply(a.clone(), c.clone()), Symbol(4)))/*b^2 - 4ac*/;\r\n            // Fix for #608\r\n            discriminant = _.expand(discriminant);\r\n            var det = _.pow(discriminant, Symbol(0.5));\r\n            var den = _.parse(_.multiply(new Symbol(2), a.clone()));\r\n            var retval = [\r\n                _.parse(format('(-({0})+({1}))/({2})', b, det, den)),\r\n                _.parse(format('(-({0})-({1}))/({2})', b, det, den))\r\n            ];\r\n\r\n            return retval;\r\n        },\r\n        /**\r\n         * The cubic equation\r\n         * http://math.stackexchange.com/questions/61725/is-there-a-systematic-way-of-solving-cubic-equations\r\n         * @param {Symbol} d_o\r\n         * @param {Symbol} c_o\r\n         * @param {Symbol} b_o\r\n         * @param {Symbol} a_o\r\n         * @returns {Array}\r\n         */\r\n        cubic: function (d_o, c_o, b_o, a_o) {\r\n            //convert everything to text\r\n            var a = a_o.text(), b = b_o.text(), c = c_o.text(), d = d_o.text();\r\n\r\n            var t = `(-(${b})^3/(27*(${a})^3)+(${b})*(${c})/(6*(${a})^2)-(${d})/(2*(${a})))`;\r\n            var u = `((${c})/(3*(${a}))-(${b})^2/(9*(${a})^2))`;\r\n            var v = `(${b})/(3*(${a}))`;\r\n            var x = `((${t})+sqrt((${t})^2+(${u})^3))^(1/3)+((${t})-sqrt((${t})^2+(${u})^3))^(1/3)-(${v})`;\r\n\r\n            // Convert a to one\r\n            var w = '1/2+sqrt(3)/2*i'; // Cube root of unity\r\n\r\n            return [\r\n                _.parse(x),\r\n                _.parse(`(${x})(${w})`),\r\n                _.parse(`(${x})(${w})^2`)\r\n            ];\r\n        },\r\n        /**\r\n         * The quartic equation\r\n         * @param {Symbol} e\r\n         * @param {Symbol} d\r\n         * @param {Symbol} c\r\n         * @param {Symbol} b\r\n         * @param {Symbol} a\r\n         * @returns {Array}\r\n         */\r\n        quartic: function (e, d, c, b, a) {\r\n            var scope = {};\r\n            core.Utils.arrayUnique(variables(a).concat(variables(b))\r\n                    .concat(variables(c)).concat(variables(d)).concat(variables(e)))\r\n                    .map(function (x) {\r\n                        scope[x] = 1;\r\n                    });\r\n            a = a.toString();\r\n            b = b.toString();\r\n            c = c.toString();\r\n            d = d.toString();\r\n            e = e.toString();\r\n            var p, q, D, D0, D1, Q, x1, x2, x3, x4;\r\n            /*var D = core.Utils.block('PARSE2NUMBER', function() {\r\n             return _.parse(format(\"256*({0})^3*({4})^3-192*({0})^2*({1})*({3})*({4})^2-128*({0})^2*({2})^2*({4})^2+144*({0})^2*({2})*({3})^2*({4})\"+\r\n             \"-27*({0})^2*({3})^4+144*({0})*({1})^2*({2})*({4})^2-6*({0})*({1})^2*({3})^2*({4})-80*({0})*({1})*({2})^2*({3})*({4})+18*({0})*({1})*({2})*({3})^3\"+\r\n             \"+16*({0})*({2})^4*({4})-4*({0})*({2})^3*({3})^2-27*({1})^4*({4})^2+18*({1})^3*({2})*({3})*({4})-4*({1})^3*({3})^3-4*({1})^2*({2})^3*({4})+({1})^2*({2})^2*({3})^2\", \r\n             a, b, c, d, e), scope);\r\n             });*/\r\n\r\n            p = _.parse(format(\"(8*({0})*({2})-3*({1})^2)/(8*({0})^2)\", a, b, c)).toString(); //a, b, c\r\n            q = _.parse(format(\"(({1})^3-4*({0})*({1})*({2})+8*({0})^2*({3}))/(8*({0})^3)\", a, b, c, d)).toString();//a, b, c, d, e\r\n            D0 = _.parse(format(\"12*({0})*({4})-3*({1})*({3})+({2})^2\", a, b, c, d, e)).toString(); //a, b, c, d, e\r\n            D1 = _.parse(format(\"2*({2})^3-9*({1})*({2})*({3})+27*({1})^2*({4})+27*({0})*({3})^2-72*({0})*({2})*({4})\", a, b, c, d, e)).toString(); //a, b, c, d, e\r\n            Q = _.parse(format(\"((({1})+(({1})^2-4*({0})^3)^(1/2))/2)^(1/3)\", D0, D1)).toString(); //D0, D1\r\n            S = _.parse(format(\"(1/2)*(-(2/3)*({1})+(1/(3*({0}))*(({2})+(({3})/({2})))))^(1/2)\", a, p, Q, D0)).toString(); //a, p, Q, D0\r\n            x1 = _.parse(format(\"-(({1})/(4*({0})))-({4})+(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))\", a, b, p, q, S)); //a, b, p, q, S\r\n            x2 = _.parse(format(\"-(({1})/(4*({0})))-({4})-(1/2)*sqrt(-4*({4})^2-2*({2})+(({3})/({4})))\", a, b, p, q, S)); //a, b, p, q, S\r\n            x3 = _.parse(format(\"-(({1})/(4*({0})))+({4})+(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))\", a, b, p, q, S)); //a, b, p, q, S\r\n            x4 = _.parse(format(\"-(({1})/(4*({0})))+({4})-(1/2)*sqrt(-4*({4})^2-2*({2})-(({3})/({4})))\", a, b, p, q, S)); //a, b, p, q, S\r\n            return [x1, x2, x3, x4];\r\n        },\r\n        /**\r\n         * Breaks the equation up in its factors and tries to solve the smaller parts\r\n         * @param {Symbol} symbol\r\n         * @param {String} solve_for\r\n         * @returns {Array}\r\n         */\r\n        divideAndConquer: function (symbol, solve_for) {\r\n            var sols = [];\r\n            //see if we can solve the factors\r\n            var factors = core.Algebra.Factor.factor(symbol);\r\n            if(factors.group === CB) {\r\n                factors.each(function (x) {\r\n                    x = Symbol.unwrapPARENS(x);\r\n                    sols = sols.concat(solve(x, solve_for));\r\n                });\r\n            }\r\n            return sols;\r\n        },\r\n        /**\r\n         * Attempts to solve the equation assuming it's a polynomial with numeric coefficients\r\n         * @param {Symbol} eq\r\n         * @param {String} solve_for\r\n         * @returns {Array}\r\n         */\r\n        csolve: function (eq, solve_for) {\r\n            return core.Utils.block('IGNORE_E', function () {\r\n                var f, p, pn, n, pf, r, theta, sr, sp, roots;\r\n                roots = [];\r\n                f = core.Utils.decompose_fn(eq, solve_for, true);\r\n                if(f.x.group === S) {\r\n                    p = _.parse(f.x.power);\r\n                    pn = Number(p);\r\n                    n = _.pow(_.divide(f.b.negate(), f.a), p.invert());\r\n                    pf = Symbol.toPolarFormArray(n);\r\n                    r = pf[0];\r\n                    theta = pf[1];\r\n                    sr = r.toString();\r\n                    sp = p.toString();\r\n                    var k, root, str;\r\n                    for(var i = 0; i < pn; i++) {\r\n                        k = i;\r\n                        str = format('({0})*e^(2*{1}*pi*{2}*{3})', sr, k, p, core.Settings.IMAGINARY);\r\n                        root = _.parse(str);\r\n                        roots.push(root);\r\n                    }\r\n                }\r\n                return roots;\r\n            }, true);\r\n        },\r\n        /**\r\n         * Generates starting points for the Newton solver given an expression at zero.\r\n         * It beings by check if zero is a good point and starts expanding by a provided step size. \r\n         * Builds on the fact that if the sign changes over an interval then a zero\r\n         * must exist on that interval\r\n         * @param {Symbol} symbol\r\n         * @param {Number} step\r\n         * @param {Array} points\r\n         * @returns {Array}\r\n         */\r\n        getPoints: function (symbol, step, points) {\r\n            step = step || 0.01;\r\n            points = points || [];\r\n            var f = build(symbol);\r\n            var x0 = 0;\r\n\r\n            var start = Math.round(x0),\r\n                    last = f(start),\r\n                    last_sign = last / Math.abs(last),\r\n                    rside = core.Settings.ROOTS_PER_SIDE, // the max number of roots on right side\r\n                    lside = rside; // the max number of roots on left side\r\n            // check around the starting point\r\n            points.push(Math.floor(start / 2)); //half way from zero might be a good start\r\n            points.push(Math.abs(start)); //|f(0)| could be a good start\r\n            points.push(start);//|f(0)| could be a good start\r\n            //adjust for log. A good starting point to include for log is 0.1\r\n            symbol.each(function (x) {\r\n                if(x.containsFunction(core.Settings.LOG))\r\n                    points.push(0.1);\r\n            });\r\n\r\n            var left = range(-core.Settings.SOLVE_RADIUS, start, step),\r\n                    right = range(start, core.Settings.SOLVE_RADIUS, step);\r\n\r\n            var test_side = function (side, num_roots) {\r\n                var xi, val, sign;\r\n                var hits = [];\r\n                for(var i = 0, l = side.length; i < l; i++) {\r\n                    xi = side[i]; //the point being evaluated\r\n                    val = f(xi);\r\n                    sign = val / Math.abs(val);\r\n                    //Don't add non-numeric values\r\n                    if(isNaN(val) || !isFinite(val) || hits.length > num_roots) {\r\n                        continue;\r\n                    }\r\n\r\n                    //compare the signs. The have to be different if they cross a zero\r\n                    if(sign !== last_sign) {\r\n                        hits.push(xi); //take note of the possible zero location\r\n                    }\r\n                    last_sign = sign;\r\n                }\r\n\r\n                points = points.concat(hits);\r\n            };\r\n\r\n            test_side(left, lside);\r\n            test_side(right, rside);\r\n\r\n            return points;\r\n        },\r\n        /**\r\n         * Implements the bisection method. Returns undefined in no solution is found\r\n         * @param {number} point\r\n         * @param {function} f\r\n         * @returns {undefined | number}\r\n         */\r\n        bisection: function (point, f) {\r\n            var left = point - 1;\r\n            var right = point + 1;\r\n            // First test if this point is even worth evaluating. It should\r\n            // be crossing the x axis so the signs should be different\r\n            if(Math.sign(f(left)) !== Math.sign(f(right))) {\r\n                var safety = 0;\r\n\r\n                var epsilon, middle;\r\n\r\n                do {\r\n                    epsilon = Math.abs(right - left);\r\n                    // Safety against an infinite loop\r\n                    if(safety++ > core.Settings.MAX_BISECTION_ITER || isNaN(epsilon)) {\r\n                        return;\r\n                    }\r\n                    // Calculate the middle point\r\n                    middle = (left + right) / 2;\r\n\r\n                    if(f(left) * f(middle) > 0) {\r\n                        left = middle;\r\n                    }\r\n                    else {\r\n                        right = middle;\r\n                    }\r\n                }\r\n                while(epsilon >= Settings.EPSILON);\r\n\r\n                var solution = (left + right) / 2;\r\n\r\n                // Test the solution to make sure that it's within tolerance\r\n                var x_point = f(solution);\r\n\r\n                if(!isNaN(x_point) && Math.abs(x_point) <= core.Settings.BI_SECTION_EPSILON) {\r\n                    // Returns too many junk solutions if not rounded at 13th place.\r\n                    return core.Utils.round(solution, 13);\r\n                }\r\n            }\r\n        },\r\n        /**\r\n         * Implements Newton's iterations. Returns undefined if no solutions if found\r\n         * @param {number} point\r\n         * @param {function} f\r\n         * @param {function} fp\r\n         * @returns {undefined|number}\r\n         */\r\n        Newton: function (point, f, fp) {\r\n            var maxiter = core.Settings.MAX_NEWTON_ITERATIONS,\r\n                    iter = 0;\r\n            //first try the point itself. If it's zero viola. We're done\r\n            var x0 = point, x;\r\n            do {\r\n                var fx0 = f(x0); //store the result of the function\r\n                //if the value is zero then we're done because 0 - (0/d f(x0)) = 0\r\n                if(x0 === 0 && fx0 === 0) {\r\n                    x = 0;\r\n                    break;\r\n                }\r\n\r\n                iter++;\r\n                if(iter > maxiter)\r\n                    return; //naximum iterations reached\r\n\r\n                x = x0 - fx0 / fp(x0);\r\n                var e = Math.abs(x - x0);\r\n                x0 = x;\r\n            }\r\n            while(e > Settings.NEWTON_EPSILON)\r\n\r\n            //check if the number is indeed zero. 1e-13 seems to give the most accurate results\r\n            if(Math.abs(f(x)) <= Settings.EPSILON)\r\n                return x;\r\n        },\r\n        rewrite: function (rhs, lhs, for_variable) {\r\n            lhs = lhs || new Symbol(0);\r\n            if(rhs.isComposite() && rhs.isLinear()) {\r\n                //try to isolate the square root\r\n                //container for the square roots\r\n                var sqrts = [];\r\n                //all else\r\n                var rem = [];\r\n                rhs.each(function (x) {\r\n                    x = x.clone();\r\n                    if(x.fname === 'sqrt' && x.contains(for_variable)) {\r\n                        sqrts.push(x);\r\n                    }\r\n                    else {\r\n                        rem.push(x);\r\n                    }\r\n                }, true);\r\n\r\n                if(sqrts.length === 1) {\r\n                    //move the remainder to the RHS\r\n                    lhs = _.expand(_.pow(_.subtract(lhs, core.Utils.arraySum(rem)), new Symbol(2)));\r\n                    //square both sides\r\n                    rhs = _.expand(_.pow(Symbol.unwrapSQRT(sqrts[0]), new Symbol(2)));\r\n                }\r\n            }\r\n            else {\r\n                rhs = Symbol.unwrapSQRT(_.expand(rhs)); //expand the term expression go get rid of quotients when possible\r\n            }\r\n\r\n            var c = 0, //a counter to see if we have all terms with the variable\r\n                    l = rhs.length;\r\n            //try to rewrite the whole thing\r\n            if(rhs.group === CP && rhs.contains(for_variable) && rhs.isLinear()) {\r\n                rhs.distributeMultiplier();\r\n                var t = new Symbol(0);\r\n                //first bring all the terms containing the variable to the lhs\r\n                rhs.each(function (x) {\r\n                    if(x.contains(for_variable)) {\r\n                        c++;\r\n                        t = _.add(t, x.clone());\r\n                    }\r\n                    else\r\n                        lhs = _.subtract(lhs, x.clone());\r\n                });\r\n                rhs = t;\r\n\r\n                //if not all the terms contain the variable so it's in the form\r\n                //a*x^2+x\r\n                if(c !== l) {\r\n                    return __.rewrite(rhs, lhs, for_variable);\r\n                }\r\n                else {\r\n                    return [rhs, lhs];\r\n                }\r\n            }\r\n            else if(rhs.group === CB && rhs.contains(for_variable) && rhs.isLinear()) {\r\n                if(rhs.multiplier.lessThan(0)) {\r\n                    rhs.multiplier = rhs.multiplier.multiply(new core.Frac(-1));\r\n                    lhs.multiplier = lhs.multiplier.multiply(new core.Frac(-1));\r\n                }\r\n                if(lhs.equals(0))\r\n                    return new Symbol(0);\r\n                else {\r\n                    var t = new Symbol(1);\r\n                    rhs.each(function (x) {\r\n                        if(x.contains(for_variable))\r\n                            t = _.multiply(t, x.clone());\r\n                        else\r\n                            lhs = _.divide(lhs, x.clone());\r\n                    });\r\n                    rhs = t;\r\n                    return __.rewrite(rhs, lhs, for_variable);\r\n\r\n                }\r\n            }\r\n            else if(!rhs.isLinear() && rhs.contains(for_variable)) {\r\n                var p = _.parse(rhs.power.clone().invert());\r\n                rhs = _.pow(rhs, p.clone());\r\n                lhs = _.pow(_.expand(lhs), p.clone());\r\n                return __.rewrite(rhs, lhs, for_variable);\r\n            }\r\n            else if(rhs.group === FN || rhs.group === S || rhs.group === PL) {\r\n                return [rhs, lhs];\r\n            }\r\n        },\r\n        sqrtSolve: function (symbol, v) {\r\n            var sqrts = new Symbol(0);\r\n            var rem = new Symbol(0);\r\n            if(symbol.isComposite()) {\r\n                symbol.each(function (x) {\r\n                    if(x.fname === 'sqrt' && x.contains(v)) {\r\n                        sqrts = _.add(sqrts, x.clone());\r\n                    }\r\n                    else {\r\n                        rem = _.add(rem, x.clone());\r\n                    }\r\n                });\r\n                //quick and dirty ATM\r\n                if(!sqrts.equals(0)) {\r\n                    var t = _.expand(_.multiply(_.parse(symbol.multiplier), _.subtract(_.pow(rem, new Symbol(2)), _.pow(sqrts, new Symbol(2)))));\r\n                    //square both sides\r\n                    var solutions = solve(t, v);\r\n                    //test the points. The dumb way of getting the answers\r\n                    solutions = solutions.filter(function (e) {\r\n                        if(e.isImaginary())\r\n                            return e;\r\n                        var subs = {};\r\n                        subs[v] = e;\r\n                        var point = evaluate(symbol, subs);\r\n                        if(point.equals(0))\r\n                            return e;\r\n                    });\r\n                    return solutions;\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    /*\r\n     * \r\n     * @param {String[]|String|Equation} eqns\r\n     * @param {String} solve_for\r\n     * @param {Array} solutions\r\n     * @param {Number} depth\r\n     * @param {String|Equation} fn\r\n     * @returns {Array}\r\n     */\r\n    var solve = function (eqns, solve_for, solutions, depth, fn) {\r\n        depth = depth || 0;\r\n\r\n        if(depth++ > Settings.MAX_SOLVE_DEPTH) {\r\n            return solutions;\r\n        }\r\n\r\n        //make preparations if it's an Equation\r\n        if(eqns instanceof Equation) {\r\n            //if it's zero then we're done\r\n            if(eqns.isZero()) {\r\n                return [new Symbol(0)];\r\n            }\r\n            //if the lhs = x then we're done\r\n            if(eqns.LHS.equals(solve_for) && !eqns.RHS.contains(solve_for)) {\r\n                return [eqns.RHS];\r\n            }\r\n            //if the rhs = x then we're done\r\n            if(eqns.RHS.equals(solve_for) && !eqns.LHS.contains(solve_for)) {\r\n                return [eqns.LHS];\r\n            }\r\n        }\r\n\r\n        //unwrap the vector since what we want are the elements\r\n        if(eqns instanceof core.Vector)\r\n            eqns = eqns.elements;\r\n        solve_for = solve_for || 'x'; //assumes x by default\r\n        //If it's an array then solve it as a system of equations\r\n        if(isArray(eqns)) {\r\n            return __.solveSystem.apply(undefined, arguments);\r\n        }\r\n\r\n        // Parse out functions. Fix for issue #300\r\n        // eqns = core.Utils.evaluate(eqns);\r\n        solutions = solutions || [];\r\n        //mark existing solutions as not to have duplicates\r\n        var existing = {};\r\n\r\n        // Easy fail. If it's a rational function and the denominator is zero\r\n        // the we're done. Issue #555\r\n        var known = {};\r\n        known[solve_for] = 0;\r\n        if(isSymbol(eqns) && evaluate(eqns.getDenom(), known).equals(0) === true) {\r\n            return solutions;\r\n        }\r\n\r\n        // Is usued to add solutions to set. \r\n        // TODO: Set is now implemented and should be utilized\r\n        var add_to_result = function (r, has_trig) {\r\n            var r_is_symbol = isSymbol(r);\r\n            if(r === undefined || typeof r === 'number' && isNaN(r))\r\n                return;\r\n            if(isArray(r)) {\r\n                r.forEach(function (sol) {\r\n                    add_to_result(sol);\r\n                });\r\n            }\r\n            else {\r\n                if(r.valueOf() !== 'null') {\r\n                    // Call the pre-add function if defined. This could be useful for rounding\r\n                    if(typeof core.Settings.PRE_ADD_SOLUTION === 'function') {\r\n                        r = core.Settings.PRE_ADD_SOLUTION(r);\r\n                    }\r\n\r\n                    if(!r_is_symbol) {\r\n                        r = _.parse(r);\r\n                    }\r\n                    // try to convert the number to multiples of pi\r\n                    if(core.Settings.make_pi_conversions && has_trig) {\r\n                        var temp = _.divide(r.clone(), new Symbol(Math.PI)),\r\n                                m = temp.multiplier,\r\n                                a = Math.abs(m.num),\r\n                                b = Math.abs(m.den);\r\n                        if(a < 10 && b < 10)\r\n                            r = _.multiply(temp, new Symbol('pi'));\r\n                    }\r\n\r\n                    // And check if we get a number otherwise we might be throwing out symbolic solutions.\r\n                    var r_str = r.toString();\r\n\r\n                    if(!existing[r_str]) {\r\n                        solutions.push(r);\r\n                    }\r\n                    // Mark the answer as seen\r\n                    existing[r_str] = true;\r\n                }\r\n            }\r\n        };\r\n\r\n        // Maybe we get lucky. Try the point at the function. If it works we have a point\r\n        // If not it failed\r\n        if(eqns.group === S && eqns.contains(solve_for)) {\r\n            try {\r\n                var o = {};\r\n                o[solve_for] = 0;\r\n                evaluate(fn, o, 'numer');\r\n                add_to_result(new Symbol(0));\r\n            }\r\n            catch(e) {\r\n                // Do nothing;\r\n            }\r\n\r\n            return solutions;\r\n        }\r\n        if(eqns.group === CB) {\r\n            // It suffices to solve for the numerator\r\n            var num = eqns.getNum();\r\n\r\n            if(num.group === CB) {\r\n                var sf = String(solve_for); //everything else belongs to the coeff\r\n                //get the denominator and make sure it doesn't have x since we don't know how to solve for those\r\n                num.each(function (x) {\r\n                    if(x.contains(sf))\r\n                        solve(x, solve_for, solutions, depth, eqns);\r\n                });\r\n\r\n                return solutions;\r\n            }\r\n\r\n            return solve(num, solve_for, solutions, depth, fn);\r\n        }\r\n\r\n        if(eqns.group === FN && eqns.fname === 'sqrt') {\r\n            eqns = _.pow(Symbol.unwrapSQRT(eqns), new Symbol(2));\r\n        }\r\n        //pass in false to not expand equations such as (x+y)^5.\r\n        //It suffices to solve for the numerator since there's no value in the denominator which yields a zero for the function\r\n        var eq = (core.Utils.isSymbol(eqns) ? eqns : __.toLHS(eqns, false)).getNum(),\r\n                vars = core.Utils.variables(eq), //get a list of all the variables\r\n                numvars = vars.length;//how many variables are we dealing with\r\n\r\n        //it sufficient to solve (x+y) if eq is (x+y)^n since 0^n\r\n        if(core.Utils.isInt(eq.power) && eq.power > 0) {\r\n            eq = _.parse(eq).toLinear();\r\n        }\r\n\r\n        //if we're dealing with a single variable then we first check if it's a \r\n        //polynomial (including rationals).If it is then we use the Jenkins-Traubb algorithm.     \r\n        //Don't waste time\r\n        if(eq.group === S || eq.group === CB && eq.contains(solve_for)) {\r\n            return [new Symbol(0)];\r\n        }\r\n        //force to polynomial. We go through each and then we look at what it would \r\n        //take for its power to be an integer\r\n        //if the power is a fractional we divide by the fractional power\r\n        var fractionals = {},\r\n                cfact;\r\n\r\n        var correct_denom = function (symbol) {\r\n            symbol = _.expand(symbol, {\r\n                expand_denominator: true,\r\n                expand_functions: true\r\n            });\r\n            var original = symbol.clone(); //preserve the original\r\n\r\n            if(symbol.symbols) {\r\n                for(var x in symbol.symbols) {\r\n                    var sym = symbol.symbols[x];\r\n\r\n                    //get the denominator of the sub-symbol\r\n                    var den = sym.getDenom();\r\n\r\n                    if(!den.isConstant(true) && symbol.isComposite()) {\r\n                        var t = new Symbol(0);\r\n                        symbol.each(function (e) {\r\n                            t = _.add(t, _.multiply(e, den.clone()));\r\n                        });\r\n\r\n                        return correct_denom(_.multiply(_.parse(symbol.multiplier), t));\r\n                    }\r\n\r\n                    var parts = explode(sym, solve_for);\r\n                    var is_sqrt = parts[1].fname === core.Settings.SQRT;\r\n                    var v = Symbol.unwrapSQRT(parts[1]);\r\n                    var p = v.power.clone();\r\n                    //circular logic with sqrt. Since sqrt(x) becomes x^(1/2) which then becomes sqrt(x), this continues forever\r\n                    //this needs to be terminated if p = 1/2\r\n                    if(!isSymbol(p) && !p.equals(1 / 2)) {\r\n                        if(p.den.gt(1)) {\r\n                            if(is_sqrt) {\r\n                                symbol = _.subtract(symbol, sym.clone());\r\n                                symbol = _.add(symbol, _.multiply(parts[0].clone(), v));\r\n                                return correct_denom(symbol);\r\n                            }\r\n                            var c = fractionals[p.den];\r\n                            fractionals[p.den] = c ? c++ : 1;\r\n                        }\r\n                        else if(p.sign() === -1) {\r\n                            var factor = _.parse(solve_for + '^' + Math.abs(p)); //this\r\n                            //unwrap the symbol's denoniator\r\n                            symbol.each(function (y, index) {\r\n                                if(y.contains(solve_for)) {\r\n                                    symbol.symbols[index] = _.multiply(y, factor.clone());\r\n                                }\r\n                            });\r\n                            fractionals = {};\r\n                            return correct_denom(_.parse(symbol));\r\n                        }\r\n                        else if(sym.group === PL) {\r\n                            var min_p = core.Utils.arrayMin(core.Utils.keys(sym.symbols));\r\n                            if(min_p < 0) {\r\n                                var factor = _.parse(solve_for + '^' + Math.abs(min_p));\r\n                                var corrected = new Symbol(0);\r\n                                original.each(function (x) {\r\n                                    corrected = _.add(corrected, _.multiply(x.clone(), factor.clone()));\r\n                                }, true);\r\n                                return corrected;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            return symbol;\r\n        };\r\n\r\n\r\n        //separate the equation\r\n        var separate = function (eq) {\r\n            var lhs = new Symbol(0),\r\n                    rhs = new Symbol(0);\r\n            eq.each(function (x) {\r\n                if(x.contains(solve_for, true))\r\n                    lhs = _.add(lhs, x.clone());\r\n                else\r\n                    rhs = _.subtract(rhs, x.clone());\r\n            });\r\n            return [lhs, rhs];\r\n        };\r\n\r\n        __.inverseFunctionSolve = function (name, lhs, rhs) {\r\n            //ax+b comes back as [a, x, ax, b];\r\n            var parts = explode(lhs.args[0], solve_for);\r\n            //check if x is by itself\r\n            var x = parts[1];\r\n            if(x.group === S) {\r\n                return _.divide(_.symfunction(name, [_.divide(rhs, _.parse(lhs.multiplier))]), parts[0]);\r\n            }\r\n\r\n        };\r\n\r\n        //first remove any denominators\r\n        eq = correct_denom(eq);\r\n\r\n        if(eq.equals(0))\r\n            return [eq];\r\n        //correct fractionals. I can only handle one type right now\r\n        var fkeys = core.Utils.keys(fractionals);\r\n        if(fkeys.length === 1) {\r\n            //make a note of the factor\r\n            cfact = fkeys[0];\r\n            eq.each(function (x, index) {\r\n                if(x.contains(solve_for)) {\r\n                    var parts = explode(x, solve_for);\r\n                    var v = parts[1];\r\n                    var p = v.power;\r\n                    if(p.den.gt(1)) {\r\n                        v.power = p.multiply(new core.Frac(cfact));\r\n                        eq.symbols[index] = _.multiply(v, parts[0]);\r\n                    }\r\n                }\r\n            });\r\n            eq = _.parse(eq);\r\n        }\r\n\r\n        //try for nested sqrts as per issue #486\r\n        add_to_result(__.sqrtSolve(eq, solve_for));\r\n\r\n        //polynomial single variable\r\n        if(numvars === 1) {\r\n            if(eq.isPoly(true)) {\r\n                //try to factor and solve\r\n                var factors = new core.Algebra.Classes.Factors();\r\n\r\n                core.Algebra.Factor.factor(eq, factors);\r\n                //if the equation has more than one symbolic factor then solve those individually\r\n                if(factors.getNumberSymbolics() > 1) {\r\n                    for(var x in factors.factors) {\r\n                        add_to_result(solve(factors.factors[x], solve_for));\r\n                    }\r\n                }\r\n                else {\r\n                    var coeffs = core.Utils.getCoeffs(eq, solve_for),\r\n                            deg = coeffs.length - 1,\r\n                            was_calculated = false;\r\n                    if(vars[0] === solve_for) {\r\n                        //check to see if all the coefficients are constant\r\n                        if(checkAll(coeffs, function (x) {\r\n                            return x.group !== core.groups.N;\r\n                        })) {\r\n                            var roots = core.Algebra.proots(eq);\r\n                            //if all the roots are integers then return those\r\n                            if(checkAll(roots, function (x) {\r\n                                return !core.Utils.isInt(x);\r\n                            })) {\r\n                                //roots have been calculates\r\n                                was_calculated = true;\r\n                                roots.map(function (x) {\r\n                                    add_to_result(new Symbol(x));\r\n                                });\r\n                            }\r\n                        }\r\n\r\n                        if(!was_calculated) {\r\n                            eqns = _.parse(eqns);\r\n                            if(eqns instanceof core.Equation)\r\n                                eqns = eqns.toLHS();\r\n\r\n                            //we can solve algebraically for degrees 1, 2, 3. The remainder we switch to Jenkins-\r\n                            if(deg === 1)\r\n                                add_to_result(_.divide(coeffs[0], coeffs[1].negate()));\r\n                            else if(deg === 2) {\r\n                                add_to_result(_.expand(__.quad.apply(undefined, coeffs)));\r\n                            }\r\n\r\n                            else if(deg === 3) {\r\n                                var solutions = []; //set to blank\r\n                                //first try to factor and solve\r\n                                var factored = core.Algebra.Factor.factor(eqns);\r\n\r\n                                //if it was successfully factored\r\n                                var solutions = [];\r\n                                if(solutions.length > 0)\r\n                                    add_to_result(solutions);\r\n                                else\r\n                                    add_to_result(__.cubic.apply(undefined, coeffs));\r\n                            }\r\n\r\n                            else {\r\n                                /*\r\n                                 var sym_roots = csolve(eq, solve_for); \r\n                                 if(sym_roots.length === 0)\r\n                                 sym_roots = divnconsolve(eq, solve_for);\r\n                                 if(sym_roots.length > 0) \r\n                                 add_to_result(sym_roots);\r\n                                 else\r\n                                 */\r\n                                _A.proots(eq).map(add_to_result);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                try {\r\n                    // Attempt Newton\r\n                    // Since it's not a polynomial then we'll try to look for a solution using Newton's method\r\n                    var has_trig = eq.hasTrig();\r\n                    // we get all the points where a possible zero might exist.\r\n                    var points1 = __.getPoints(eq, 0.1);\r\n                    var points2 = __.getPoints(eq, 0.05);\r\n                    var points3 = __.getPoints(eq, 0.01);\r\n                    var points = core.Utils.arrayUnique(points1.concat(points2).concat(points3)).sort(function (a, b) {\r\n                        return a - b;\r\n                    });\r\n                    var i, point, solution;\r\n\r\n                    // Compile the function\r\n                    var f = build(eq.clone());\r\n\r\n                    // First try to eliminate some points using bisection\r\n                    var t_points = [];\r\n                    for(i = 0; i < points.length; i++) {\r\n                        point = points[i];\r\n\r\n                        // See if there's a solution at this point\r\n                        solution = __.bisection(point, f);\r\n\r\n                        // If there's no solution then add it to the array for further investigation\r\n                        if(typeof solution === 'undefined') {\r\n                            t_points.push(point);\r\n                            continue;\r\n                        }\r\n\r\n                        // Add the solution to the solution set\r\n                        add_to_result(solution, has_trig);\r\n                    }\r\n\r\n                    // Reset the points to the remaining points\r\n                    points = t_points;\r\n\r\n                    // Build the derivative and compile a function\r\n                    var d = _C.diff(eq.clone());\r\n                    var fp = build(d);\r\n                    for(i = 0; i < points.length; i++) {\r\n                        point = points[i];\r\n\r\n                        add_to_result(__.Newton(point, f, fp), has_trig);\r\n                    }\r\n                    solutions.sort();\r\n                }\r\n                catch(e) {\r\n                    console.log(e);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            //The idea here is to go through the equation and collect the coefficients\r\n            //place them in an array and call the quad or cubic function to get the results\r\n            if(!eq.hasFunc(solve_for) && eq.isComposite()) {\r\n                try {\r\n                    var factored = core.Algebra.Factor.factor(eq.clone());\r\n\r\n                    if(factored.group === CB) {\r\n                        factored.each(function (x) {\r\n                            add_to_result(solve(x, solve_for));\r\n                        });\r\n                    }\r\n                    else {\r\n                        var coeffs = core.Utils.getCoeffs(eq, solve_for);\r\n\r\n                        var l = coeffs.length,\r\n                                deg = l - 1; //the degree of the polynomial\r\n                        //get the denominator and make sure it doesn't have x\r\n\r\n                        //handle the problem based on the degree\r\n                        switch(deg) {\r\n                            case 0:\r\n                                var separated = separate(eq);\r\n                                var lhs = separated[0],\r\n                                        rhs = separated[1];\r\n                                \r\n                                if(lhs.group === core.groups.EX) {\r\n                                    var log = core.Settings.LOG;\r\n                                    var expr_str = `${log}((${rhs})/(${lhs.multiplier}))/${log}(${lhs.value})/${lhs.power.multiplier}`;\r\n                                    add_to_result(_.parse(expr_str));\r\n                                }\r\n                                break;\r\n                            case 1:\r\n                                //nothing to do but to return the quotient of the constant and the LT\r\n                                //e.g. 2*x-1\r\n                                add_to_result(_.divide(coeffs[0], coeffs[1].negate()));\r\n                                break;\r\n                            case 2:\r\n                                add_to_result(__.quad.apply(undefined, coeffs));\r\n                                break;\r\n                            case 3:\r\n                                add_to_result(__.cubic.apply(undefined, coeffs));\r\n                                break;\r\n                            case 4:\r\n                                add_to_result(__.quartic.apply(undefined, coeffs));\r\n                                break;\r\n                            default:\r\n                                add_to_result(__.csolve(eq, solve_for));\r\n                                if(solutions.length === 0)\r\n                                    add_to_result(__.divideAndConquer(eq, solve_for));\r\n                        }\r\n\r\n                        if(solutions.length === 0) {\r\n                            //try factoring\r\n                            add_to_result(solve(factored, solve_for, solutions, depth));\r\n                        }\r\n                    }\r\n\r\n                }\r\n                catch(e) { /*something went wrong. EXITING*/\r\n                    ;\r\n                }\r\n            }\r\n            else {\r\n                try {\r\n                    var rw = __.rewrite(eq, null, solve_for);\r\n                    var lhs = rw[0];\r\n                    var rhs = rw[1];\r\n                    if(lhs.group === FN) {\r\n                        if(lhs.fname === 'abs') {\r\n                            add_to_result([rhs.clone(), rhs.negate()]);\r\n                        }\r\n                        else if(lhs.fname === 'sin') {\r\n                            //asin\r\n                            add_to_result(__.inverseFunctionSolve('asin', lhs, rhs));\r\n                        }\r\n                        else if(lhs.fname === 'cos') {\r\n                            //asin\r\n                            add_to_result(__.inverseFunctionSolve('acos', lhs, rhs));\r\n                        }\r\n                        else if(lhs.fname === 'tan') {\r\n                            //asin\r\n                            add_to_result(__.inverseFunctionSolve('atan', lhs, rhs));\r\n                        }\r\n                        else if(lhs.fname === core.Settings.LOG) {\r\n                            //ax+b comes back as [a, x, ax, b];\r\n                            var parts = explode(lhs.args[0], solve_for);\r\n                            //check if x is by itself\r\n                            var x = parts[1];\r\n                            if(x.group === S) {\r\n                                rhs = _.divide(_.subtract(_.pow(lhs.args.length > 1 ? lhs.args[1] : new Symbol('e'), _.divide(rhs, _.parse(lhs.multiplier))), parts[3]), parts[0]);\r\n                                var eq = new Equation(x, rhs).toLHS();\r\n                                add_to_result(solve(eq, solve_for));\r\n                            }\r\n                        }\r\n                        else\r\n                            add_to_result(_.subtract(lhs, rhs));\r\n                    }\r\n                    else {\r\n                        var neq = new Equation(lhs, rhs).toLHS(); //create a new equation\r\n\r\n                        if(neq.equals(eq))\r\n                            throw new Error('Stopping. No stop condition exists');\r\n                        add_to_result(solve(neq, solve_for));\r\n                    }\r\n                }\r\n                catch(error) {\r\n                    //Let's try this another way\r\n                    try {\r\n                        //1. if the symbol is in the form a*b*c*... then the solution is zero if \r\n                        //either a or b or c is zero.\r\n                        if(eq.group === CB)\r\n                            add_to_result(0);\r\n                        else if(eq.group === CP) {\r\n                            var separated = separate(eq);\r\n                            var lhs = separated[0],\r\n                                    rhs = separated[1];\r\n\r\n                            //reduce the equation\r\n                            if(lhs.group === core.groups.EX && lhs.value === solve_for) {\r\n                                //change the base of both sides\r\n                                var p = lhs.power.clone().invert();\r\n                                add_to_result(_.pow(rhs, p));\r\n                            }\r\n                        }\r\n                    }\r\n                    catch(error) {\r\n                        ;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if(cfact) {\r\n            solutions = solutions.map(function (x) {\r\n                return _.pow(x, new Symbol(cfact));\r\n            });\r\n        }\r\n\r\n        // Perform some cleanup but don't do it agains arrays, etc\r\n        // Check it actually evaluates to zero\r\n        if(isSymbol(eqns)) {\r\n            var knowns = {};\r\n            solutions = solutions.filter(function (x) {\r\n                try {\r\n                    knowns[solve_for] = x;\r\n                    var zero = Number(evaluate(eqns, knowns));\r\n\r\n                    // Allow symbolic answers\r\n                    if(isNaN(zero)) {\r\n                        return true;\r\n                    }\r\n                    return true;\r\n                }\r\n                catch(e) {\r\n                    return false;\r\n                }\r\n            });\r\n        }\r\n\r\n        return solutions;\r\n    };\r\n\r\n    //Register the functions for external use\r\n    nerdamer.register([\r\n        {\r\n            name: 'solveEquations',\r\n            parent: 'nerdamer',\r\n            numargs: -1,\r\n            visible: true,\r\n            build: function () {\r\n                return solve; //comment out to return a vector\r\n                /*\r\n                 return function() {\r\n                 return core.Utils.convertToVector(solve.apply(null, arguments));\r\n                 };\r\n                 */\r\n            }\r\n        },\r\n        {\r\n            name: 'solve',\r\n            parent: 'Solve',\r\n            numargs: 2,\r\n            visible: true,\r\n            build: function () {\r\n                return core.Solve.solve;\r\n            }\r\n        },\r\n        {\r\n            name: 'setEquation',\r\n            parent: 'Solve',\r\n            visible: true,\r\n            build: function () {\r\n                return setEq;\r\n            }\r\n        }\r\n    ]);\r\n    nerdamer.updateAPI();\r\n})();","/*\r\n * Author : Martin Donk\r\n * Website : http://www.nerdamer.com\r\n * Email : martin.r.donk@gmail.com\r\n * License : MIT\r\n * Source : https://github.com/jiggzson/nerdamer\r\n */\r\n\r\n/* global module */\r\n\r\nif((typeof module) !== 'undefined') {\r\n    var nerdamer = require('./nerdamer.core.js');\r\n    require('./Calculus');\r\n    require('./Algebra');\r\n}\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    var core = nerdamer.getCore(),\r\n            _ = core.PARSER,\r\n            Symbol = core.Symbol,\r\n            format = core.Utils.format,\r\n            isVector = core.Utils.isVector,\r\n            isArray = core.Utils.isArray,\r\n            Vector = core.Vector,\r\n            S = core.groups.S,\r\n            EX = core.groups.EX,\r\n            CP = core.groups.CP,\r\n            CB = core.groups.CB,\r\n            FN = core.groups.FN;\r\n    core.Settings.Laplace_integration_depth = 40;\r\n\r\n\r\n    Symbol.prototype.findFunction = function (fname) {\r\n        //this is what we're looking for\r\n        if(this.group === FN && this.fname === fname)\r\n            return this.clone();\r\n        var found;\r\n        if(this.symbols)\r\n            for(var x in this.symbols) {\r\n                found = this.symbols[x].findFunction(fname);\r\n                if(found)\r\n                    break;\r\n            }\r\n\r\n        return found;\r\n    };\r\n\r\n    var __ = core.Extra = {\r\n        version: '1.4.2',\r\n        //http://integral-table.com/downloads/LaplaceTable.pdf\r\n        //Laplace assumes all coefficients to be positive\r\n        LaPlace: {\r\n            //Using: integral_0^oo f(t)*e^(-s*t) dt\r\n            transform: function (symbol, t, s) {\r\n                symbol = symbol.clone();\r\n\r\n                t = t.toString();\r\n                //First try a lookup for a speed boost\r\n                symbol = Symbol.unwrapSQRT(symbol, true);\r\n                var retval,\r\n                        coeff = symbol.stripVar(t),\r\n                        g = symbol.group;\r\n\r\n                symbol = _.divide(symbol, coeff.clone());\r\n\r\n                if(symbol.isConstant() || !symbol.contains(t, true)) {\r\n                    retval = _.parse(format('({0})/({1})', symbol, s));\r\n                }\r\n                else if(g === S && core.Utils.isInt(symbol.power)) {\r\n                    var n = String(symbol.power);\r\n                    retval = _.parse(format('factorial({0})/({1})^({0}+1)', n, s));\r\n                }\r\n                else if(symbol.group === S && symbol.power.equals(1 / 2)) {\r\n                    retval = _.parse(format('sqrt(pi)/(2*({0})^(3/2))', s));\r\n                }\r\n                else if(symbol.isComposite()) {\r\n                    retval = new Symbol(0);\r\n                    symbol.each(function (x) {\r\n                        retval = _.add(retval, __.LaPlace.transform(x, t, s));\r\n                    }, true);\r\n                }\r\n                else if(symbol.isE() && (symbol.power.group === S || symbol.power.group === CB)) {\r\n                    var a = symbol.power.stripVar(t);\r\n                    retval = _.parse(format('1/(({1})-({0}))', a, s));\r\n                }\r\n                else {\r\n                    var fns = ['sin', 'cos', 'sinh', 'cosh'];\r\n                    //support for symbols in fns with arguments in the form a*t or n*t where a = symbolic and n = Number\r\n                    if(symbol.group === FN && fns.indexOf(symbol.fname) !== -1 && (symbol.args[0].group === S || symbol.args[0].group === CB)) {\r\n                        var a = symbol.args[0].stripVar(t);\r\n\r\n                        switch(symbol.fname) {\r\n                            case 'sin':\r\n                                retval = _.parse(format('({0})/(({1})^2+({0})^2)', a, s));\r\n                                break;\r\n                            case 'cos':\r\n                                retval = _.parse(format('({1})/(({1})^2+({0})^2)', a, s));\r\n                                break;\r\n                            case 'sinh':\r\n                                retval = _.parse(format('({0})/(({1})^2-({0})^2)', a, s));\r\n                                break;\r\n                            case 'cosh':\r\n                                retval = _.parse(format('({1})/(({1})^2-({0})^2)', a, s));\r\n                                break;\r\n                        }\r\n\r\n                    }\r\n                    else {\r\n                        //Try to integrate for a solution\r\n                        //we need at least the Laplace integration depth\r\n                        var depth_is_lower = core.Settings.integration_depth < core.Settings.Laplace_integration_depth;\r\n\r\n                        if(depth_is_lower) {\r\n                            var integration_depth = core.Settings.integration_depth; //save the depth\r\n                            core.Settings.integration_depth = core.Settings.Laplace_integration_depth; //transforms need a little more room\r\n                        }\r\n\r\n                        core.Utils.block('PARSE2NUMBER', function () {\r\n                            var u = t;\r\n                            var sym = symbol.sub(t, u);\r\n                            var integration_expr = _.parse('e^(-' + s + '*' + u + ')*' + sym);\r\n                            retval = core.Calculus.integrate(integration_expr, u);\r\n                            if(retval.hasIntegral())\r\n                                return _.symfunction('laplace', arguments);\r\n//                                _.error('Unable to compute transform');\r\n                            retval = retval.sub(t, 0);\r\n                            retval = _.expand(_.multiply(retval, new Symbol(-1)));\r\n                            retval = retval.sub(u, t);\r\n                        }, false);\r\n\r\n                        retval = core.Utils.block('PARSE2NUMBER', function () {\r\n                            return _.parse(retval);\r\n                        }, true);\r\n\r\n                        if(depth_is_lower)//put the integration depth as it was\r\n                            core.Settings.integration_depth = integration_depth;\r\n                    }\r\n\r\n                }\r\n\r\n                return _.multiply(retval, coeff);\r\n            },\r\n            inverse: function (symbol, s_, t) {\r\n                var input_symbol = symbol.clone();\r\n                return core.Utils.block('POSITIVE_MULTIPLIERS', function () {\r\n                    //expand and get partial fractions\r\n                    if(symbol.group === CB) {\r\n                        symbol = core.Algebra.PartFrac.partfrac(_.expand(symbol), s_);\r\n                    }\r\n\r\n                    if(symbol.group === S || symbol.group === CB || symbol.isComposite()) {\r\n                        var finalize = function () {\r\n                            //put back the numerator\r\n                            retval = _.multiply(retval, num);\r\n                            retval.multiplier = retval.multiplier.multiply(symbol.multiplier);\r\n                            //put back a\r\n                            retval = _.divide(retval, f.a);\r\n                        };\r\n                        var num, den, s, retval, f, p, m, den_p, fe;\r\n                        //remove the multiplier\r\n                        m = symbol.multiplier.clone();\r\n                        symbol.toUnitMultiplier();\r\n                        //get the numerator and denominator\r\n                        num = symbol.getNum();\r\n                        den = symbol.getDenom().toUnitMultiplier();\r\n\r\n                        //TODO: Make it so factor doesn't destroy pi\r\n                        //num = core.Algebra.Factor.factor(symbol.getNum());\r\n                        //den = core.Algebra.Factor.factor(symbol.getDenom().invert(null, true));\r\n\r\n                        if(den.group === CP) {\r\n                            den_p = den.power.clone();\r\n                            den.toLinear();\r\n                        }\r\n                        else {\r\n                            den_p = new core.Frac(1);\r\n                        }\r\n\r\n                        //convert s to a string\r\n                        s = s_.toString();\r\n                        //split up the denominator if in the form ax+b\r\n                        f = core.Utils.decompose_fn(den, s, true);\r\n                        //move the multiplier to the numerator\r\n                        fe = core.Utils.decompose_fn(_.expand(num.clone()), s, true);\r\n                        num.multiplier = num.multiplier.multiply(m);\r\n                        //store the parts in variables for easy recognition \r\n                        //check if in the form t^n where n = integer\r\n                        if((den.group === S || den.group === CB) && f.x.value === s && f.b.equals(0) && core.Utils.isInt(f.x.power)) {\r\n                            var fact, p;\r\n                            p = f.x.power - 1;\r\n                            fact = core.Math2.factorial(p);\r\n                            //  n!/s^(n-1)\r\n                            retval = _.divide(_.pow(t, new Symbol(p)), new Symbol(fact));\r\n                            //wrap it up\r\n                            finalize();\r\n                        }\r\n                        else if(den.group === CP && den_p.equals(1)) {\r\n                            if(f.x.group === core.groups.PL && core.Algebra.degree(den).equals(2)) {\r\n                                // Possibly in the form 1/(s^2+2*s+1)\r\n                                // Try factoring to get it in a more familiar form{\r\n                                // Apply inverse of F(s-a)\r\n                                var completed = core.Algebra.sqComplete(den, s);\r\n                                var u = core.Utils.getU(den);\r\n                                // Get a for the function above\r\n                                var a = core.Utils.decompose_fn(completed.a, s, true).b;\r\n                                var tf = __.LaPlace.inverse(_.parse(`1/((${u})^2+(${completed.c}))`), u, t);\r\n                                retval = _.multiply(tf, _.parse(`(${m})*e^(-(${a})*(${t}))`));\r\n                            }\r\n                            else {\r\n                                // a/(b*s-c) -> ae^(-bt)\r\n                                if(f.x.isLinear() && !num.contains(s)) {\r\n                                    t = _.divide(t, f.a.clone());\r\n\r\n                                    // Don't add factorial of one or zero\r\n                                    var p = den_p - 1;\r\n                                    var fact = p === 0 || p === 1 ? '1' : `(${den_p}-1)!`\r\n                                    retval = _.parse(format('(({0})^({3}-1)*e^(-(({2})*({0}))/({1})))/(({4})*({1})^({3}))', t, f.a, f.b, den_p, fact));\r\n                                    //wrap it up\r\n                                    finalize();\r\n                                }\r\n                                else {\r\n                                    if(f.x.group === S && f.x.power.equals(2)) {\r\n                                        if(!num.contains(s)) {\r\n                                            retval = _.parse(format('(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/sqrt(({2})*({3}))', t, num, f.a, f.b));\r\n                                        }\r\n                                        // a*s/(b*s^2+c^2)\r\n                                        else {\r\n                                            var a = new Symbol(1);\r\n                                            if(num.group === CB) {\r\n                                                var new_num = new Symbol(1);\r\n                                                num.each(function (x) {\r\n                                                    if(x.contains(s))\r\n                                                        new_num = _.multiply(new_num, x);\r\n                                                    else\r\n                                                        a = _.multiply(a, x);\r\n                                                });\r\n                                                num = new_num;\r\n                                            }\r\n\r\n                                            //we need more information about the denominator to decide\r\n                                            var f2 = core.Utils.decompose_fn(num, s, true);\r\n                                            var fn1, fn2, a_has_sin, b_has_cos, a_has_cos, b_has_sin;\r\n                                            fn1 = f2.a;\r\n                                            fn2 = f2.b;\r\n                                            a_has_sin = fn1.containsFunction('sin');\r\n                                            a_has_cos = fn1.containsFunction('cos');\r\n                                            b_has_cos = fn2.containsFunction('cos');\r\n                                            b_has_sin = fn2.containsFunction('sin');\r\n                                            if(f2.x.value === s && f2.x.isLinear() && !((a_has_sin && b_has_cos) || (a_has_cos || b_has_sin))) {\r\n                                                retval = _.parse(format('(({1})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})', t, f2.a, f.a, f.b));\r\n                                            }\r\n                                            else {\r\n                                                if(a_has_sin && b_has_cos) {\r\n                                                    var sin, cos;\r\n                                                    sin = fn1.findFunction('sin');\r\n                                                    cos = fn2.findFunction('cos');\r\n                                                    //who has the s?\r\n                                                    if(sin.args[0].equals(cos.args[0]) && !sin.args[0].contains(s)) {\r\n                                                        var b, c, d, e;\r\n                                                        b = _.divide(fn2, cos.toUnitMultiplier()).toString();\r\n                                                        c = sin.args[0].toString();\r\n                                                        d = f.b;\r\n                                                        e = _.divide(fn1, sin.toUnitMultiplier());\r\n                                                        exp = '(({1})*({2})*cos({3})*sin(sqrt({4})*({0})))/sqrt({4})+({1})*sin({3})*({5})*cos(sqrt({4})*({0}))';\r\n                                                        retval = _.parse(format(exp, t, a, b, c, d, e));\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        else if(f.x.power.num && f.x.power.num.equals(3) && f.x.power.den.equals(2) && num.contains('sqrt(pi)') && !num.contains(s) && num.isLinear()) {\r\n                            var b = _.divide(num.clone(), _.parse('sqrt(pi)'));\r\n                            retval = _.parse(format('(2*({2})*sqrt({0}))/({1})', t, f.a, b, num));\r\n                        }\r\n                        else if(den_p.equals(2) && f.x.power.equals(2)) {\r\n                            var a, d, exp;\r\n                            if(!num.contains(s)) {\r\n                                a = _.divide(num, new Symbol(2));\r\n                                exp = '(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({3})*sqrt(({2})*({3})))-(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*({3}))';\r\n                                retval = _.parse(format(exp, t, a, f.a, f.b));\r\n                            }\r\n                            else {\r\n                                // Decompose the numerator to check value of s\r\n                                f2 = core.Utils.decompose_fn(_.expand(num.clone()), s, true);\r\n                                if(f2.x.isComposite()) {\r\n                                    var s_terms = [];\r\n                                    //first collect the factors e.g. (a)(bx)(cx^2+d)\r\n                                    var symbols = num.collectSymbols(function (x) {\r\n                                        x = Symbol.unwrapPARENS(x);\r\n                                        var t = core.Utils.decompose_fn(x, s, true);\r\n                                        t.symbol = x;\r\n                                        return t;\r\n                                    }).\r\n                                            //then sort them by power hightest to lowest\r\n                                            sort(function (a, b) {\r\n                                                var p1, p2;\r\n                                                p1 = a.x.value !== s ? 0 : a.x.power;\r\n                                                p2 = b.x.value !== s ? 0 : b.x.power;\r\n                                                return p2 - p1;\r\n                                            });\r\n                                    a = new Symbol(-1);\r\n                                    // Grab only the ones which have s\r\n                                    for(var i = 0; i < symbols.length; i++) {\r\n                                        var fc = symbols[i];\r\n                                        if(fc.x.value === s)\r\n                                            s_terms.push(fc);\r\n                                        else\r\n                                            a = _.multiply(a, fc.symbol);\r\n                                    }\r\n                                    // The following 2 assumptions are made\r\n                                    // 1. since the numerator was factored above then each s_term has a unique power\r\n                                    // 2. because the terms are sorted by descending powers then the first item \r\n                                    //    has the highest power\r\n                                    // We can now check for the next type s(s^2-a^2)/(s^2+a^2)^2\r\n                                    if(s_terms[0].x.power.equals(2) && s_terms[1].x.power.equals(1) && s_terms[1].b.equals(0) && !s_terms[0].b.equals(0)) {\r\n                                        b = s_terms[0].a.negate();\r\n                                        exp = '-(({1})*({2})*({5})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/' +\r\n                                                '(2*({4})^2*sqrt(({4})*({5})))-(({1})*({3})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))' +\r\n                                                '/(2*({4})*sqrt(({4})*({5})))+(({1})*({2})*cos((sqrt(({4})*({5}))*({0}))/({4})))/({4})^2';\r\n                                        retval = _.parse(format(exp, t, a, b, s_terms[0].b, f.a, f.b));\r\n                                    }\r\n                                }\r\n                                else {\r\n                                    if(f2.x.isLinear()) {\r\n                                        a = _.divide(f2.a, new Symbol(2));\r\n                                        exp = '(({1})*({0})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))';\r\n                                        retval = _.parse(format(exp, t, a, f.a, f.b));\r\n                                    }\r\n                                    else if(f2.x.power.equals(2)) {\r\n                                        if(f2.b.equals(0)) {\r\n                                            a = _.divide(f2.a, new Symbol(2));\r\n                                            exp = '(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2';\r\n                                            retval = _.parse(format(exp, t, a, f.a, f.b));\r\n                                        }\r\n                                        else {\r\n                                            a = _.divide(f2.a, new Symbol(2));\r\n                                            d = f2.b.negate();\r\n                                            exp = '-((({2})*({4})-2*({1})*({3}))*sin((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3})*sqrt(({2})*({3})))+' +\r\n                                                    '(({4})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3}))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2';\r\n                                            retval = _.parse(format(exp, t, a, f.a, f.b, d));\r\n\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        else if(symbol.isComposite()) {\r\n                            // 1/(s+1)^2\r\n                            if(den_p.equals(2) && f.x.group === S) {\r\n                                retval = _.parse(`(${m})*(${t})*e^(-(${f.b})*(${t}))`);\r\n                            }\r\n                            else {\r\n                                retval = new Symbol(0);\r\n\r\n                                symbol.each(function (x) {\r\n                                    retval = _.add(retval, __.LaPlace.inverse(x, s_, t));\r\n                                }, true);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if(!retval) {\r\n                        retval = _.symfunction('ilt', [input_symbol, s_, t]);\r\n                    }\r\n\r\n                    return retval;\r\n                }, true);\r\n            }\r\n        },\r\n        Statistics: {\r\n            frequencyMap: function (arr) {\r\n                var map = {};\r\n                //get the frequency map\r\n                for(var i = 0, l = arr.length; i < l; i++) {\r\n                    var e = arr[i],\r\n                            key = e.toString();\r\n                    if(!map[key]) //default it to zero\r\n                        map[key] = 0;\r\n                    map[key]++; //increment\r\n                }\r\n                return map;\r\n            },\r\n            sort: function (arr) {\r\n                return arr.sort(function (a, b) {\r\n                    if(!a.isConstant() || !b.isConstant())\r\n                        _.error('Unable to sort! All values must be numeric');\r\n                    return a.multiplier.subtract(b.multiplier);\r\n                });\r\n            },\r\n            count: function (arr) {\r\n                return new Symbol(arr.length);\r\n            },\r\n            sum: function (arr, x_) {\r\n                var sum = new Symbol(0);\r\n                for(var i = 0, l = arr.length; i < l; i++) {\r\n                    var xi = arr[i].clone();\r\n                    if(x_) {\r\n                        sum = _.add(_.pow(_.subtract(xi, x_.clone()), new Symbol(2)), sum);\r\n                    }\r\n                    else\r\n                        sum = _.add(xi, sum);\r\n                }\r\n\r\n                return sum;\r\n            },\r\n            mean: function () {\r\n                var args = [].slice.call(arguments);\r\n                //handle arrays\r\n                if(isVector(args[0]))\r\n                    return __.Statistics.mean.apply(this, args[0].elements);\r\n                return  _.divide(__.Statistics.sum(args), __.Statistics.count(args));\r\n            },\r\n            median: function () {\r\n                var args = [].slice.call(arguments), retval;\r\n                //handle arrays\r\n                if(isVector(args[0]))\r\n                    return __.Statistics.median.apply(this, args[0].elements);\r\n                try {\r\n                    var sorted = __.Statistics.sort(args);\r\n                    var l = args.length;\r\n                    if(core.Utils.even(l)) {\r\n                        var mid = l / 2;\r\n                        retval = __.Statistics.mean(sorted[mid - 1], sorted[mid]);\r\n                    }\r\n                    else\r\n                        retval = sorted[Math.floor(l / 2)];\r\n                }\r\n                catch(e) {\r\n                    retval = _.symfunction('median', args);\r\n                }\r\n                return retval;\r\n            },\r\n            mode: function () {\r\n                var args = [].slice.call(arguments),\r\n                        retval;\r\n                //handle arrays\r\n                if(isVector(args[0]))\r\n                    return __.Statistics.mode.apply(this, args[0].elements);\r\n\r\n                var map = __.Statistics.frequencyMap(args);\r\n\r\n                //the mode of 1 item is that item as per issue #310 (verified by Happypig375). \r\n                if(core.Utils.keys(map).length === 1)\r\n                    retval = args[0];\r\n                else {\r\n                    //invert by arraning them according to their frequency\r\n                    var inverse = {};\r\n                    for(var x in map) {\r\n                        var freq = map[x];\r\n                        //check if it's in the inverse already\r\n                        if(!(freq in inverse))\r\n                            inverse[freq] = x;\r\n                        else {\r\n                            var e = inverse[freq];\r\n                            //if it's already an array then just add it\r\n                            if(isArray(e))\r\n                                e.push(x);\r\n                            //convert it to and array\r\n                            else\r\n                                inverse[freq] = [x, inverse[freq]];\r\n                        }\r\n                    }\r\n                    //the keys now represent the maxes. We want the max of those keys\r\n                    var max = inverse[Math.max.apply(null, core.Utils.keys(inverse))];\r\n                    //check it's an array. If it is then map over the results and convert \r\n                    //them to Symbol\r\n                    if(isArray(max)) {\r\n                        retval = _.symfunction('mode', max.sort());\r\n                    }\r\n                    else\r\n                        retval = _.parse(max);\r\n                }\r\n\r\n                return retval;\r\n            },\r\n            gVariance: function (k, args) {\r\n                var x_ = __.Statistics.mean.apply(__.Statistics, args),\r\n                        sum = __.Statistics.sum(args, x_);\r\n                return _.multiply(k, sum);\r\n            },\r\n            variance: function () {\r\n                var args = [].slice.call(arguments);\r\n                //handle arrays\r\n                if(isVector(args[0]))\r\n                    return __.Statistics.variance.apply(this, args[0].elements);\r\n                var k = _.divide(new Symbol(1), __.Statistics.count(args));\r\n                return __.Statistics.gVariance(k, args);\r\n            },\r\n            sampleVariance: function () {\r\n                var args = [].slice.call(arguments);\r\n                //handle arrays\r\n                if(isVector(args[0]))\r\n                    return __.Statistics.sampleVariance.apply(this, args[0].elements);\r\n\r\n                var k = _.divide(new Symbol(1), _.subtract(__.Statistics.count(args), new Symbol(1)));\r\n                return __.Statistics.gVariance(k, args);\r\n            },\r\n            standardDeviation: function () {\r\n                var args = [].slice.call(arguments);\r\n                //handle arrays\r\n                if(isVector(args[0]))\r\n                    return __.Statistics.standardDeviation.apply(this, args[0].elements);\r\n                return _.pow(__.Statistics.variance.apply(__.Statistics, args), new Symbol(1 / 2));\r\n            },\r\n            sampleStandardDeviation: function () {\r\n                var args = [].slice.call(arguments);\r\n                //handle arrays\r\n                if(isVector(args[0]))\r\n                    return __.Statistics.sampleStandardDeviation.apply(this, args[0].elements);\r\n                return _.pow(__.Statistics.sampleVariance.apply(__.Statistics, args), new Symbol(1 / 2));\r\n            },\r\n            zScore: function (x, mean, stdev) {\r\n                return _.divide(_.subtract(x, mean), stdev);\r\n            }\r\n        },\r\n        Units: {\r\n            table: {\r\n                foot: '12 inch',\r\n                meter: '100 cm',\r\n                decimeter: '10 cm',\r\n\r\n            }\r\n        }\r\n    };\r\n\r\n    nerdamer.register([\r\n        {\r\n            name: 'laplace',\r\n            visible: true,\r\n            numargs: 3,\r\n            build: function () {\r\n                return __.LaPlace.transform;\r\n            }\r\n        },\r\n        {\r\n            name: 'ilt',\r\n            visible: true,\r\n            numargs: 3,\r\n            build: function () {\r\n                return __.LaPlace.inverse;\r\n            }\r\n        },\r\n        //statistical\r\n        {\r\n            name: 'mean',\r\n            visible: true,\r\n            numargs: -1,\r\n            build: function () {\r\n                return __.Statistics.mean;\r\n            }\r\n        },\r\n        {\r\n            name: 'median',\r\n            visible: true,\r\n            numargs: -1,\r\n            build: function () {\r\n                return __.Statistics.median;\r\n            }\r\n        },\r\n        {\r\n            name: 'mode',\r\n            visible: true,\r\n            numargs: -1,\r\n            build: function () {\r\n                return __.Statistics.mode;\r\n            }\r\n        },\r\n        {\r\n            name: 'smpvar',\r\n            visible: true,\r\n            numargs: -1,\r\n            build: function () {\r\n                return __.Statistics.sampleVariance;\r\n            }\r\n        },\r\n        {\r\n            name: 'variance',\r\n            visible: true,\r\n            numargs: -1,\r\n            build: function () {\r\n                return __.Statistics.variance;\r\n            }\r\n        },\r\n        {\r\n            name: 'smpstdev',\r\n            visible: true,\r\n            numargs: -1,\r\n            build: function () {\r\n                return __.Statistics.sampleStandardDeviation;\r\n            }\r\n        },\r\n        {\r\n            name: 'stdev',\r\n            visible: true,\r\n            numargs: -1,\r\n            build: function () {\r\n                return __.Statistics.standardDeviation;\r\n            }\r\n        },\r\n        {\r\n            name: 'zscore',\r\n            visible: true,\r\n            numargs: 3,\r\n            build: function () {\r\n                return __.Statistics.zScore;\r\n            }\r\n        }\r\n    ]);\r\n\r\n    //link registered functions externally\r\n    nerdamer.updateAPI();\r\n}());\r\n\r\n// Added for all.min.js\r\nif((typeof module) !== 'undefined') {\r\n    module.exports = nerdamer;\r\n};","/*\r\n * Author : Martin Donk\r\n * Website : http://www.nerdamer.com\r\n * Email : martin.r.donk@gmail.com\r\n * Source : https://github.com/jiggzson/nerdamer\r\n * Can be used to load all add-ons with one require\r\n */\r\n\r\nvar nerdamer = require('./nerdamer.core.js');\r\nrequire('./Algebra.js');\r\nrequire('./Calculus.js');\r\nrequire('./Solve.js');\r\nrequire('./Extra.js');\r\n\r\n//export nerdamer\r\nmodule.exports = nerdamer;\r\n","// https://stackoverflow.com/questions/610406/javascript-equivalent-to-printf-string-format\n\nexport function patch_unicorn() {\n    String.prototype.formatUnicorn = String.prototype.formatUnicorn ||\n        function () {\n            \"use strict\";\n            let str = this.toString();\n            if (arguments.length) {\n                const t = typeof arguments[0];\n                let key;\n                const args = (\"string\" === t || \"number\" === t) ?\n                    Array.prototype.slice.call(arguments)\n                    : arguments[0];\n\n                for (key in args) {\n                    str = str.replace(new RegExp(\"\\\\{\" + key + \"\\\\}\", \"gi\"), args[key]);\n                }\n            }\n\n            return str;\n        };\n}","import * as _nerdamer from 'nerdamer/all';\nimport {patch_unicorn} from \"./stackoverflow\";\n\npatch_unicorn(); // add string.formatUnicorn\n\nexport let nerdamer = _nerdamer;\n\nexport function round(n, d) {\n    const f = 10 ** d;\n    return Math.round(n * f) / f;\n}\n\nexport function float(str) {\n    return +str;\n}\n\nexport function int(str){\n    return Math.floor(float(str))\n}\n\n// skip 'e' and 'i'!\nconst letters = ['a', 'b', 'c', 'd', 'f', 'g', 'h', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'v', 'w', 'x', 'y', 'z'];\n\nfunction empty_string_to_undefined(val) {\n    return val === '' ? undefined : val;\n}\n\n/**\n *\n * @param {Object} args\n * @param {array} rules\n * @param {int} r - rounding to n digits\n * @return {*}\n */\nexport function magic(args, rules, r = 2) {\n\n    let idx = 0;\n\n    let reverse = {};\n\n    for (let [key, value] of Object.entries(args)) {\n        // replace undefined with a letter\n        args[key] = empty_string_to_undefined(value) ?? letters[idx++];\n\n        // includes ignorable 'value's, but useful 'letter's\n        reverse[args[key]] = key;\n    }\n\n    let equations = rules.map(rule => rule.formatUnicorn(args));\n\n    let solutions = nerdamer.solveEquations(equations);\n\n    for (let [key, value] of solutions) {\n        args[reverse[key]] = round(value, r);\n    }\n\n    // args is now modified.\n    return args;\n}\n\nexport async function amagic(args, rules, r = 2) {\n    return magic(args, rules, r);\n}","import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal/index.mjs';\nexport { get_store_value as get } from '../internal/index.mjs';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = new Set();\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (const subscriber of subscribers) {\n                    subscriber[1]();\n                    subscriber_queue.push(subscriber, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.add(subscriber);\n        if (subscribers.size === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            subscribers.delete(subscriber);\n            if (subscribers.size === 0) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let inited = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (inited) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        inited = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n        };\n    });\n}\n\nexport { derived, readable, writable };\n","export { identity as linear } from '../internal/index.mjs';\n\n/*\nAdapted from https://github.com/mattdesl\nDistributed under MIT License https://github.com/mattdesl/eases/blob/master/LICENSE.md\n*/\nfunction backInOut(t) {\n    const s = 1.70158 * 1.525;\n    if ((t *= 2) < 1)\n        return 0.5 * (t * t * ((s + 1) * t - s));\n    return 0.5 * ((t -= 2) * t * ((s + 1) * t + s) + 2);\n}\nfunction backIn(t) {\n    const s = 1.70158;\n    return t * t * ((s + 1) * t - s);\n}\nfunction backOut(t) {\n    const s = 1.70158;\n    return --t * t * ((s + 1) * t + s) + 1;\n}\nfunction bounceOut(t) {\n    const a = 4.0 / 11.0;\n    const b = 8.0 / 11.0;\n    const c = 9.0 / 10.0;\n    const ca = 4356.0 / 361.0;\n    const cb = 35442.0 / 1805.0;\n    const cc = 16061.0 / 1805.0;\n    const t2 = t * t;\n    return t < a\n        ? 7.5625 * t2\n        : t < b\n            ? 9.075 * t2 - 9.9 * t + 3.4\n            : t < c\n                ? ca * t2 - cb * t + cc\n                : 10.8 * t * t - 20.52 * t + 10.72;\n}\nfunction bounceInOut(t) {\n    return t < 0.5\n        ? 0.5 * (1.0 - bounceOut(1.0 - t * 2.0))\n        : 0.5 * bounceOut(t * 2.0 - 1.0) + 0.5;\n}\nfunction bounceIn(t) {\n    return 1.0 - bounceOut(1.0 - t);\n}\nfunction circInOut(t) {\n    if ((t *= 2) < 1)\n        return -0.5 * (Math.sqrt(1 - t * t) - 1);\n    return 0.5 * (Math.sqrt(1 - (t -= 2) * t) + 1);\n}\nfunction circIn(t) {\n    return 1.0 - Math.sqrt(1.0 - t * t);\n}\nfunction circOut(t) {\n    return Math.sqrt(1 - --t * t);\n}\nfunction cubicInOut(t) {\n    return t < 0.5 ? 4.0 * t * t * t : 0.5 * Math.pow(2.0 * t - 2.0, 3.0) + 1.0;\n}\nfunction cubicIn(t) {\n    return t * t * t;\n}\nfunction cubicOut(t) {\n    const f = t - 1.0;\n    return f * f * f + 1.0;\n}\nfunction elasticInOut(t) {\n    return t < 0.5\n        ? 0.5 *\n            Math.sin(((+13.0 * Math.PI) / 2) * 2.0 * t) *\n            Math.pow(2.0, 10.0 * (2.0 * t - 1.0))\n        : 0.5 *\n            Math.sin(((-13.0 * Math.PI) / 2) * (2.0 * t - 1.0 + 1.0)) *\n            Math.pow(2.0, -10.0 * (2.0 * t - 1.0)) +\n            1.0;\n}\nfunction elasticIn(t) {\n    return Math.sin((13.0 * t * Math.PI) / 2) * Math.pow(2.0, 10.0 * (t - 1.0));\n}\nfunction elasticOut(t) {\n    return (Math.sin((-13.0 * (t + 1.0) * Math.PI) / 2) * Math.pow(2.0, -10.0 * t) + 1.0);\n}\nfunction expoInOut(t) {\n    return t === 0.0 || t === 1.0\n        ? t\n        : t < 0.5\n            ? +0.5 * Math.pow(2.0, 20.0 * t - 10.0)\n            : -0.5 * Math.pow(2.0, 10.0 - t * 20.0) + 1.0;\n}\nfunction expoIn(t) {\n    return t === 0.0 ? t : Math.pow(2.0, 10.0 * (t - 1.0));\n}\nfunction expoOut(t) {\n    return t === 1.0 ? t : 1.0 - Math.pow(2.0, -10.0 * t);\n}\nfunction quadInOut(t) {\n    t /= 0.5;\n    if (t < 1)\n        return 0.5 * t * t;\n    t--;\n    return -0.5 * (t * (t - 2) - 1);\n}\nfunction quadIn(t) {\n    return t * t;\n}\nfunction quadOut(t) {\n    return -t * (t - 2.0);\n}\nfunction quartInOut(t) {\n    return t < 0.5\n        ? +8.0 * Math.pow(t, 4.0)\n        : -8.0 * Math.pow(t - 1.0, 4.0) + 1.0;\n}\nfunction quartIn(t) {\n    return Math.pow(t, 4.0);\n}\nfunction quartOut(t) {\n    return Math.pow(t - 1.0, 3.0) * (1.0 - t) + 1.0;\n}\nfunction quintInOut(t) {\n    if ((t *= 2) < 1)\n        return 0.5 * t * t * t * t * t;\n    return 0.5 * ((t -= 2) * t * t * t * t + 2);\n}\nfunction quintIn(t) {\n    return t * t * t * t * t;\n}\nfunction quintOut(t) {\n    return --t * t * t * t * t + 1;\n}\nfunction sineInOut(t) {\n    return -0.5 * (Math.cos(Math.PI * t) - 1);\n}\nfunction sineIn(t) {\n    const v = Math.cos(t * Math.PI * 0.5);\n    if (Math.abs(v) < 1e-14)\n        return 1;\n    else\n        return 1 - v;\n}\nfunction sineOut(t) {\n    return Math.sin((t * Math.PI) / 2);\n}\n\nexport { backIn, backInOut, backOut, bounceIn, bounceInOut, bounceOut, circIn, circInOut, circOut, cubicIn, cubicInOut, cubicOut, elasticIn, elasticInOut, elasticOut, expoIn, expoInOut, expoOut, quadIn, quadInOut, quadOut, quartIn, quartInOut, quartOut, quintIn, quintInOut, quintOut, sineIn, sineInOut, sineOut };\n","import { writable } from '../store/index.mjs';\nimport { now, loop, assign } from '../internal/index.mjs';\nimport { linear } from '../easing/index.mjs';\n\nfunction is_date(obj) {\n    return Object.prototype.toString.call(obj) === '[object Date]';\n}\n\nfunction tick_spring(ctx, last_value, current_value, target_value) {\n    if (typeof current_value === 'number' || is_date(current_value)) {\n        // @ts-ignore\n        const delta = target_value - current_value;\n        // @ts-ignore\n        const velocity = (current_value - last_value) / (ctx.dt || 1 / 60); // guard div by 0\n        const spring = ctx.opts.stiffness * delta;\n        const damper = ctx.opts.damping * velocity;\n        const acceleration = (spring - damper) * ctx.inv_mass;\n        const d = (velocity + acceleration) * ctx.dt;\n        if (Math.abs(d) < ctx.opts.precision && Math.abs(delta) < ctx.opts.precision) {\n            return target_value; // settled\n        }\n        else {\n            ctx.settled = false; // signal loop to keep ticking\n            // @ts-ignore\n            return is_date(current_value) ?\n                new Date(current_value.getTime() + d) : current_value + d;\n        }\n    }\n    else if (Array.isArray(current_value)) {\n        // @ts-ignore\n        return current_value.map((_, i) => tick_spring(ctx, last_value[i], current_value[i], target_value[i]));\n    }\n    else if (typeof current_value === 'object') {\n        const next_value = {};\n        for (const k in current_value) {\n            // @ts-ignore\n            next_value[k] = tick_spring(ctx, last_value[k], current_value[k], target_value[k]);\n        }\n        // @ts-ignore\n        return next_value;\n    }\n    else {\n        throw new Error(`Cannot spring ${typeof current_value} values`);\n    }\n}\nfunction spring(value, opts = {}) {\n    const store = writable(value);\n    const { stiffness = 0.15, damping = 0.8, precision = 0.01 } = opts;\n    let last_time;\n    let task;\n    let current_token;\n    let last_value = value;\n    let target_value = value;\n    let inv_mass = 1;\n    let inv_mass_recovery_rate = 0;\n    let cancel_task = false;\n    function set(new_value, opts = {}) {\n        target_value = new_value;\n        const token = current_token = {};\n        if (value == null || opts.hard || (spring.stiffness >= 1 && spring.damping >= 1)) {\n            cancel_task = true; // cancel any running animation\n            last_time = now();\n            last_value = new_value;\n            store.set(value = target_value);\n            return Promise.resolve();\n        }\n        else if (opts.soft) {\n            const rate = opts.soft === true ? .5 : +opts.soft;\n            inv_mass_recovery_rate = 1 / (rate * 60);\n            inv_mass = 0; // infinite mass, unaffected by spring forces\n        }\n        if (!task) {\n            last_time = now();\n            cancel_task = false;\n            task = loop(now => {\n                if (cancel_task) {\n                    cancel_task = false;\n                    task = null;\n                    return false;\n                }\n                inv_mass = Math.min(inv_mass + inv_mass_recovery_rate, 1);\n                const ctx = {\n                    inv_mass,\n                    opts: spring,\n                    settled: true,\n                    dt: (now - last_time) * 60 / 1000\n                };\n                const next_value = tick_spring(ctx, last_value, value, target_value);\n                last_time = now;\n                last_value = value;\n                store.set(value = next_value);\n                if (ctx.settled) {\n                    task = null;\n                }\n                return !ctx.settled;\n            });\n        }\n        return new Promise(fulfil => {\n            task.promise.then(() => {\n                if (token === current_token)\n                    fulfil();\n            });\n        });\n    }\n    const spring = {\n        set,\n        update: (fn, opts) => set(fn(target_value, value), opts),\n        subscribe: store.subscribe,\n        stiffness,\n        damping,\n        precision\n    };\n    return spring;\n}\n\nfunction get_interpolator(a, b) {\n    if (a === b || a !== a)\n        return () => a;\n    const type = typeof a;\n    if (type !== typeof b || Array.isArray(a) !== Array.isArray(b)) {\n        throw new Error('Cannot interpolate values of different type');\n    }\n    if (Array.isArray(a)) {\n        const arr = b.map((bi, i) => {\n            return get_interpolator(a[i], bi);\n        });\n        return t => arr.map(fn => fn(t));\n    }\n    if (type === 'object') {\n        if (!a || !b)\n            throw new Error('Object cannot be null');\n        if (is_date(a) && is_date(b)) {\n            a = a.getTime();\n            b = b.getTime();\n            const delta = b - a;\n            return t => new Date(a + t * delta);\n        }\n        const keys = Object.keys(b);\n        const interpolators = {};\n        keys.forEach(key => {\n            interpolators[key] = get_interpolator(a[key], b[key]);\n        });\n        return t => {\n            const result = {};\n            keys.forEach(key => {\n                result[key] = interpolators[key](t);\n            });\n            return result;\n        };\n    }\n    if (type === 'number') {\n        const delta = b - a;\n        return t => a + t * delta;\n    }\n    throw new Error(`Cannot interpolate ${type} values`);\n}\nfunction tweened(value, defaults = {}) {\n    const store = writable(value);\n    let task;\n    let target_value = value;\n    function set(new_value, opts) {\n        if (value == null) {\n            store.set(value = new_value);\n            return Promise.resolve();\n        }\n        target_value = new_value;\n        let previous_task = task;\n        let started = false;\n        let { delay = 0, duration = 400, easing = linear, interpolate = get_interpolator } = assign(assign({}, defaults), opts);\n        if (duration === 0) {\n            if (previous_task) {\n                previous_task.abort();\n                previous_task = null;\n            }\n            store.set(value = target_value);\n            return Promise.resolve();\n        }\n        const start = now() + delay;\n        let fn;\n        task = loop(now => {\n            if (now < start)\n                return true;\n            if (!started) {\n                fn = interpolate(value, new_value);\n                if (typeof duration === 'function')\n                    duration = duration(value, new_value);\n                started = true;\n            }\n            if (previous_task) {\n                previous_task.abort();\n                previous_task = null;\n            }\n            const elapsed = now - start;\n            if (elapsed > duration) {\n                store.set(value = new_value);\n                return false;\n            }\n            // @ts-ignore\n            store.set(value = fn(easing(elapsed / duration)));\n            return true;\n        });\n        return task.promise;\n    }\n    return {\n        set,\n        update: (fn, opts) => set(fn(target_value, value), opts),\n        subscribe: store.subscribe\n    };\n}\n\nexport { spring, tweened };\n","<script>\n    import {debouncer} from \"./debounce\";\n    import {tweened} from \"svelte/motion\";\n    import {float} from \"./magic.js\";\n    import {expoOut} from \"svelte/easing\";\n    import {round} from \"./magic\";\n\n    export let input_value;\n    export let calculated_value;\n    export let name;\n    export let grouped = false;\n\n    let _input_value = input_value;\n\n\n    const debounce = debouncer(200);\n\n    $: {\n        debounce(_ => {\n            input_value = _input_value;\n        });\n    }\n\n    let animated = tweened(0, {\n        duration: 1000,\n        easing: expoOut,\n    });\n\n    $: {\n        animated.set(float(calculated_value));\n    }\n</script>\n\n<style>\n    div.grouped {\n        display: inline-block;\n    }\n\n    input {\n        color: darkred;\n    }\n</style>\n\n<div class:grouped={grouped}>\n    <label for=\"{name}\">{name}</label>\n    <!---->\n    <input id=\"{name}\"\n           type=\"number\"\n           bind:value={_input_value}\n           placeholder=\"{round($animated, 2)}\">\n</div>","export function debouncer(duration) {\n        let timer;\n\n        function debounce(fn) {\n            clearTimeout(timer);\n            timer = setTimeout(fn, duration);\n        }\n\n        return debounce;\n    }","<style>\n    div {\n        /* center */\n        width: max-content;\n        margin: auto;\n    }\n</style>\n\n<div>\n    <slot/>\n</div>","<script>\n    import {magic, nerdamer} from './magic';\n    import Field from \"./Field.svelte\";\n    import Center from \"./Center.svelte\";\n    // import {spring} from \"svelte/motion\";\n\n\n    export let values;\n\n    let feedback = '';\n    let rules = [];\n\n    rules.push(`{dag} = {uur} * {uren_per_dag}`);\n    rules.push(`{uren_per_week} = {uren_per_dag} * {dagen_per_week}`);\n    rules.push(`{week} = {dag} * {dagen_per_week}`);\n\n    // 174 uur ~= avg fulltime maand ; uren_per_week / 40 * 174 = part time maand\n    rules.push(`{maand} = {uur} * (174 / 40 * {uren_per_week})`);\n    // rules.push(`{naive_maand} = {week} * 4`)\n    rules.push(`{jaar} = {maand} * 12`); // 12 maanden jwz\n\n    let _uur, _dag, _week, _maand, _jaar, _uren_per_dag, _dagen_per_week, _uren_per_week;\n\n    let {uur, dag, week, maand, jaar, uren_per_dag, dagen_per_week, uren_per_week} = values;\n\n    $: { // update on each var change\n        let args = {\n            uren_per_dag,\n            dagen_per_week,\n            uren_per_week,\n\n            uur,\n            dag,\n            week,\n            maand,\n            jaar,\n        };\n        try {\n            feedback = 'calculating...';\n            magic(args, rules);\n\n            _uur = args.uur;\n            _dag = args.dag;\n            _week = args.week;\n            _maand = args.maand;\n            _jaar = args.jaar;\n\n            values = args;\n\n            _uren_per_dag = args.uren_per_dag;\n            _uren_per_week = args.uren_per_week;\n            _dagen_per_week = args.dagen_per_week;\n\n            feedback = '';\n        } catch (e) {\n            feedback = e;\n        }\n\n    }\n\n</script>\n\n<style>\n    p {\n        color: darkred;\n    }\n\n</style>\n\n<Center>\n    <Field grouped=\"1\" bind:input_value={uren_per_dag} bind:calculated_value={_uren_per_dag} name=\"Uur per dag\" />\n    <Field grouped=\"1\" bind:input_value={uren_per_week} bind:calculated_value={_uren_per_week} name=\"Uur per week\" />\n    <Field grouped=\"1\" bind:input_value={dagen_per_week} bind:calculated_value={_dagen_per_week}\n           name=\"Dagen per week\" />\n\n    <br />\n\n    <Field grouped=\"1\" bind:input_value={uur} bind:calculated_value={_uur} name=\"Per Uur\" />\n    <!--<Field bind:input_value={dag} bind:calculated_value={_dag} name=\"Per Dag\" />-->\n    <!--<Field bind:input_value={week} bind:calculated_value={_week} name=\"Per Week\" />-->\n    <Field grouped=\"1\" bind:input_value={maand} bind:calculated_value={_maand} name=\"Per Maand\" />\n    <Field grouped=\"1\" bind:input_value={jaar} bind:calculated_value={_jaar} name=\"Per Jaar\" />\n</Center>\n\n<p>{feedback}</p>","<script>\n    import Field from \"./Field.svelte\";\n    import Center from \"./Center.svelte\";\n\n    export let values;\n\n    $: {\n        console.table(values);\n    }\n\n</script>\n\n<Center>\n    <h1>Totaal:</h1>\n    <Field grouped=\"1\" bind:calculated_value={values.uren_per_dag} name=\"Uur per dag\" />\n    <Field grouped=\"1\" bind:calculated_value={values.uren_per_week} name=\"Uur per week\" />\n    <Field grouped=\"1\" bind:calculated_value={values.dagen_per_week}\n           name=\"Dagen per week\" />\n\n    <br />\n\n    <Field grouped=\"1\" bind:calculated_value={values.uur} name=\"Per Uur\" />\n    <Field grouped=\"1\" bind:calculated_value={values.maand} name=\"Per Maand\" />\n    <Field grouped=\"1\" bind:calculated_value={values.jaar} name=\"Per Jaar\" />\n</Center>","<script>\n    import Center from \"./Center.svelte\";\n</script>\n\n<style>\n    img {\n        height: 100px;\n        margin-top: 20px;\n        margin-bottom: 25px;\n    }\n</style>\n<Center>\n    <a href=\"https://trialandsuccess.nl\" target=\"_blank\">\n        <img src=\"https://trialandsuccess.nl/TaS/static/images/logo.png\" alt=\"Trial and Success\" />\n    </a>\n</Center>","<script>\n    import Group from \"./Group.svelte\";\n    import GroupReadonly from \"./GroupReadonly.svelte\";\n    import Center from \"./Center.svelte\";\n    import Logo from \"./Logo.svelte\";\n\n    function generate_defaults() {\n        // initial:\n        return {\n            uren_per_dag: 8,\n            dagen_per_week: 5,\n            uur: 15,\n        };\n    }\n\n    let values = [generate_defaults()];\n    let sum = {};\n\n    function add_value() {\n        values = [...values, generate_defaults()];\n    }\n\n    function remove_value() {\n        // removing specific index didn't work, so we just remove the last one now:\n        values.pop();\n        values = values;\n    }\n\n    const gemiddeld = ['uren_per_dag', 'uur'];\n    $: {\n        const _sum = {};\n\n        for (let val of values) {\n            for (let [key, value] of Object.entries(val)) {\n                _sum[key] = (_sum[key] || 0) + value;\n            }\n        }\n\n        for (let key of gemiddeld) {\n            _sum[key] = _sum[key] / values.length;\n        }\n\n        sum = _sum;\n    }\n\n</script>\n\n<style>\n    button {\n        float: right;\n    }\n\n    :global(body) {\n        background: url('https://trialandsuccess.nl/TaS/static/images/banner.png');\n        background-size: cover;\n        backdrop-filter: brightness(0.75);\n    }\n\n    hr {\n        border: 1px dashed white;\n        border-top-width: 0;\n    }\n\n    button {\n        width: 40px;\n        height: 40px;\n        border-radius: 180px;\n        margin: 5px;\n    }\n</style>\n\n<Logo />\n\n<div>\n    <button on:click={remove_value}>-</button>\n    <button on:click={add_value}>+</button>\n</div>\n\n<div>\n    {#each values as value}\n        <div>\n            <Group bind:values={value} />\n            <hr />\n        </div>\n    {/each}\n</div>\n\n\n{#if values.length > 1}\n    <GroupReadonly values={sum} />\n{/if}","import App from './App.svelte';\n\nconst app = new App({\n\ttarget: document.body,\n\tprops: {}\n});\n\nexport default app;"],"names":["noop","identity","x","assign","tar","src","k","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","component_subscribe","component","store","callback","$$","on_destroy","push","callbacks","unsub","subscribe","unsubscribe","get_slot_context","definition","ctx","$$scope","slice","is_client","window","now","performance","Date","raf","cb","requestAnimationFrame","tasks","Set","run_tasks","task","c","delete","f","size","append","target","node","appendChild","insert","anchor","insertBefore","detach","parentNode","removeChild","element","name","document","createElement","text","data","createTextNode","space","listen","event","handler","options","addEventListener","removeEventListener","attr","attribute","value","removeAttribute","getAttribute","setAttribute","to_number","set_data","wholeText","set_input_value","input","toggle_class","toggle","classList","current_component","set_current_component","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","add_render_callback","add_flush_callback","seen_callbacks","flushidx","flush","saved_component","length","update","pop","i","has","add","clear","fragment","before_update","dirty","p","after_update","outroing","outros","group_outros","r","check_outros","transition_in","block","local","transition_out","o","d","bind","index","props","undefined","bound","create_component","mount_component","customElement","on_mount","m","new_on_destroy","map","filter","destroy_component","detaching","make_dirty","then","fill","init","instance","create_fragment","not_equal","append_styles","parent_component","on_disconnect","context","Map","skip_bound","root","ready","ret","rest","hydrate","nodes","Array","from","childNodes","children","l","intro","SvelteComponent","$destroy","this","$on","type","indexOf","splice","$set","$$props","obj","$$set","keys","bigInt","nerdamer","imports","_","Parser","bigDec","set","precision","Groups","PRIMES","CUSTOM_OPERATORS","Settings","callPeekers","init_primes","exclude","suppress_errors","PARSE2NUMBER","SAFE","IMAGINARY","FUNCTION_MODULES","Math","ALLOW_CHARS","USE_MULTICHARACTER_VARS","POWER_OPERATOR","VALIDATION_REGEX","IMPLIED_MULTIPLICATION_REGEX","ALIASES","POSITIVE_MULTIPLIERS","CACHE","SILENCE_WARNINGS","PRECISION","EXPRESSION_DECP","DEFAULT_DECP","VECTOR","PARENTHESIS","SQRT","ABS","FACTORIAL","DOUBLEFACTORIAL","LONG_PI","LONG_E","PI","E","LOG","LOG10","LOG10_LATEX","MAX_EXP","SCIENTIFIC_MAX_DECIMAL_PLACES","SCIENTIFIC_IGNORE_ZERO_EXPONENTS","roots","j","nthpow","pow","N","P","S","EX","FN","PL","CB","CP","CONST_HASH","EXPRESSIONS","VARS","RESERVED","WARNINGS","err","msg","ErrorObj","Error","customError","message","error","stack","prototype","isReserved","allSame","arr","last","equals","warn","SHOW_WARNINGS","console","validateName","typ","test","InvalidVariableNameError","scientificToDecimal","num","nsign","sign","abs","parts","String","toLowerCase","split","e","coeff_array","zero","join","dec","isPrime","n","q","floor","sqrt","isNumber","isFraction","isSymbol","multiplier","toDecimal","Symbol","isExpression","Expression","variables","poly","vars","isNaN","group","prevgroup","previousGroup","power","symbols","firstObject","args","sort","separate","symbol","expand","key","sym","clone","each","isConstant","fname","isVector","Vector","isMatrix","Matrix","isSet","isNumericSymbol","isArray","isInt","toString","isNegative","lessThan","stringify","inBrackets","str","format","call","arguments","shift","new_str","replace","match","arg","both","setFunction","params_array","body","parse","functions","mapped_function","params","arrayMin","min","apply","decompose_fn","wrt","as_obj","ax","t","stripVar","subtract","divide","nround","s","Number","MAX_VALUE","round","hasOwnProperty","even","evenFraction","arrayUnique","item","removeDuplicates","condition","conditionType","seen","temp","reserveNames","remove","indexOrKey","result","setting","opt","current_setting","retval","arguments2Array","evaluate","convertToVector","vector","elements","generatePrimes","upto","allNumbers","allConstants","isPi","isE","mix","isComposite","isLinear","y","term","multiply","expanded","DivisionByZero","ParseError","UndefinedError","OutOfFunctionDomainError","MaximumIterationsReached","NerdamerTypeError","ParityError","OperatorError","OutOfRangeError","DimensionError","ValueLimitExceededError","NerdamerValueError","SolveError","InfiniteLoopError","UnexpectedTokenError","exceptions","Math2","csc","sin","sec","cos","cot","tan","acsc","asin","asec","acos","acot","atan","erf","exp","diff","h","median","values","half","fromContinued","contd","fractions","whole","continuedFraction","w","absn","ni","done","EPSILON","idx","bigpow","Frac","isInteger","den","nthroot","gamma","z","C","g","bigfactorial","times","bigLog","quick","invert","factorial","is_int","NaN","dfactorial","GCD","QGCD","gcd","negate","LCM","factor","ifactors","ifactor","factors","updateHash","sfactor","prime","lt","safety","rho","xf","cz","mod","minus","sm","boxfactor","max","fib","integer_part","simpson","step","get_value","side","v","dx","xi","num_integrate","tol","maxdepth","adsimp","fa","fm","fb","V0","depth","state","nanEncountered","f1","f2","sl","sr","s2","V1","V2","maxDepthCount","integrate","Ci","sum","n2","log","Si","Ei","Infinity","Shi","Chi","cosh","Li","gamma_incomplete","rect","sinc","tri","A","dk","dk0","d0","xk","powb","dk_dec","gte","xn","ld","same_delta","delta","decimal","option","useGroup","decp","asHash","wrapCondition","asDecimal","valueOf","frac","exec","negative","quotient","digits","passed","numer","denom","divmod","remainder","operator","Scientific","om","collectSymbols","txt","pg","pwg","E_TO_EXP","charAt","cv","parens","primeFactors","startsWith","substr","isScientific","fromScientific","convert","simple","Fraction","quickConversion","isInfinity","imaginary","bin","preprocessors","names","actions","Slice","upper","lower","start","end","Collection","Token","node_type","column","OPERATOR","operators","FUNCTION","precedence","MAX_PRECEDENCE","leftAssoc","getItems","pretty_print","collection","is_prefix","VARIABLE_OR_LITERAL","UNIT","KEYWORD","classes","complex","prec","re","im","sinh","removeDen","sq","squared","fromArray","infinity","tanh","sech","csch","coth","acosh","asinh","atanh","asech","acsch","acoth","realpart","imagpart","hyp","phi","USE_BIG","atan2","symfunction","greaterThan","trig","isImaginary","getQuadrant","dividedBy","gt","trigh","units","action","prefix","postfix","operation","overloaded","overloadAction","overloadLeftAssoc","plus","vectorFn","brackets","id","is_open","is_close","maps_to","arccos","arcsin","arctan","log10","radians","degrees","SYMBOLIC_MIN_MAX","symMinMax","ceil","trunc","fact","continued_fraction","_symbol","cf","scientific","sigfigs","pfactor","matrix","imatrix","cbrt","expand_denominator","expand_functions","mat","determinant","cols","rows","transpose","dot","vec1","vec2","cross","vecget","vecset","vectrim","tolerance","matget","matset","matgetrow","matsetrow","M","matgetcol","col_index","matsetcol","col","rationalize","IF","is_in","l2","conjugate","polarform","theta","toPolarFormArray","rectform","original","getDenom","getNum","getval","aval","bval","union","set1","set2","contains","intersection","difference","intersects","is_subset","print","ostr","override","which","with_what","restore","what","extend","force_call","fn_name","callfunction","allowed_args","fn_settings","num_allowed_args","is_array","min_args","max_args","num_args","error_msg","numericArgs","fmodules","fmodule","findFunction","bigConvert","operator_filter_regex","RegExp","setOperator","postif","getOperator","aliasOperator","getOperators","getBrackets","Node","token","left","right","initConstants","CONSTANTS","peekers","pre_operator","post_operator","pre_function","post_function","tokenize","trim","regex","L","lpos","tokens","scopes","open_brackets","has_space","addScope","scope_type","new_scope","goUp","get_operator_str","start_at","substring","chunkify","operator_str","_operators","ch","add_token","at","add_function","set_last_position","position","last_token_is_numeric","bracket","pair","prev","nxt","is_operator","toRPN","output","prefixes","collapse","destination","next","previous","next_is_operator","last_on_stack","parseRPN","rpn","substitutions","pi","Q","is_comma","fromSet","ans","parent","fn_args","getter","il","subbed","isUnit","toHTML","indent","tab","repeat","html","tree","location","group1","group2","before","g1","g2","prepare_expression","toObject","expression_string","objectify","isConversion","chunkAtCommas","chunks","rem_brackets","ms","distributeMultiplier","toUnitMultiplier","V","symbol1","symbol2","retnum","retden","is_negative","img","setPower","qa","tw","nn","unwrapPARENS","toLinear","rem","isOne","asbig","numVal","base","log_sym","log_base","img_part","sIsConstant","toExponential","isFinite","rank","testSQRT","absEquals","toTeX","expression_or_obj","decimals","TeX","cdot","narr","next_is_array","next_is_minus","unshift","before_last","remove_redundant_powers","nobj","LaTeX","braces","expr","argSplit","latex","clean","new_num","new_den","getFunction","addPreprocessor","order","shift_cells","PreprocessorError","getPreprocessors","removePreprocessor","subs","aIsSymbol","bIsSymbol","unit","Unit","aneg","bneg","inf","ap","bp","h1","h2","powEQ","v1","v2","aIsComposite","bIsComposite","PN","PNEQ","valEQ","attach","shell","canIterate","bothPL","bIsMatrix","eachElement","row","dimensions","toFixed","bnum","bden","a_pow","a_multiplier","ONN","u","distributeExponent","combine","bm","p1","p2","isSymbolP1","isSymbolP2","toEX","logV","n1","ndiv","ddiv","ps","isMatrixB","isMatrixA","isVectorA","isVectorB","raised","aIsZero","bIsZero","nre","nim","bIsConstant","aIsConstant","bIsInt","multiplyPower","sgn","aa","_a","_b","a1","log_a","b1","c1","neg_num","nr","tn","evenr","evenp","evennp","_result","fct","testPow","isEX","pt","IGNORE_E","comma","percent","function_assign","bool2Symbol","eq","lte","LOG10E","getExpression","expression_number","asType","expression","text_","first_arg","buildFunction","Build","build","isPolynomial","isPoly","sub","for_symbol","otype","numerator","denominator","hasFunction","containsFunction","variable","coeff","exponent","removeLeadingZeroes","removeTrailingZeroes","dot_location","zeroes","leadingZeroes","wholes","copy","rounded","next_two","ed","is_neg","isFrac","m_dc","simplify","neg","qcompare","isnegative","lcm","div","unwrapSQRT","all","getNth","isToNth","nthPower","nthMultiplier","isSquare","isCube","isSimple","powSimp","powers","mfactors","out_","in_","xt","multivariate","exclude_x","toArray","hasFunc","fn_group","same_pow","a_is_unit_multiplier","find","needle","nargs","isMonomial","isSQRT","check_all","check_symbols","retainSign","isSymbolic","isInverse","properties","keepSign","deep","power_only","is_one","cp","isImgSymbol","keyForGroup","existing","hash","contents","is_parens","sort_fn","expand_symbol","collected","concat","isCombination","opts","qc","fullConversion","nparts","stripSign","cparts","d1","d2","parser","keep","LaTeXArray","rowTeX","m_array","v_array","formatFrac","p_array","greek","alpha","beta","epsilon","zeta","eta","iota","kappa","lambda","mu","nu","omnikron","sigma","tau","upsilon","chi","psi","omega","Gamma","Delta","Epsilon","Theta","Lambda","Xi","Pi","Sigma","Phi","Psi","Omega","ker","limsup","deg","lg","ln","Pr","sup","det","hom","lim","LN","dim","liminf","inverted","formatSubscripts","t_varray","den_map","num_map","num_c","den_c","setBrackets","container","counter","laTex","combine_power","isBracketed","formatP","tp","merge","mn","md","vn","vd","top","bottom","glue","is_pow","square","brace","angle","filterTokens","filtered","next_token","raw_tokens","infty","parse_next","get","items","lw","rl","el","arrayPrefill","val","custom","modulus","eql","toUnitVector","angleFrom","mod1","mod2","product","theta_val","isParallelTo","isAntiparallelTo","isPerpendicularTo","B","magnitude","tex","F","zeroMatrix","raw_values","raw","nc","toRightTriangular","isSingular","augment","np","els","divisor","new_element","ki","kp","inverse_elements","nel","nj","canMultiplyFromLeft","sameSize","MM","kj","toVector","newline","to_decimal","row_tex","_union","_intersection","dependencies","_rename","reformat","deps","getProperName","compileDependencies","dep_string","replacements","components","getArgsDeps","arg_array","supplements","ftext","xports","ftext_complex","cc","ft","ftext_function","bn","f_array","alias","Function","LOG_FNS","Utils","allNumeric","arrayAddSlices","slices","arrayClone","new_array","arrayMax","arrayEqual","arr1","arr2","arrayGetVariables","arraySum","toNumber","clearU","indx","comboSort","combined","na","nb","compare","sym1","sym2","comparison","scope","random","customType","fillHoles","getCoeffs","info","coeffs","getU","importFunctions","isVariableSymbol","knownVariable","nroots","_roots","range","sameSign","stringReplace","to","with_str","groups","PARSER","libExports","fndec","convertToLaTeX","convertFromLaTeX","version","add_on","getWarnings","setConstant","constant","getConstant","getCore","getEquation","reserved","asArray","equation_number","keep_EXPRESSIONS_fixed","expressions","asObject","asLaTeX","register","core","parent_obj","visible","numargs","validVarName","varname","supported","numEquations","numExpressions","setVar","getVar","clearVars","load","loader","getVars","updateAPI","linker","replaceFunction","new_num_args","withOperator","htmlTree","addPeeker","removePeeker","BASE","MAX_INT","MAX_INT_ARR","smallToArray","LOG_MAX_INT","Integer","radix","parseValue","parseBase","BigInteger","isSmall","SmallInteger","isPrecise","arrayToSmall","compareAbs","createArray","truncate","l_a","l_b","carry","addAny","addSmall","a_l","b_l","borrow","subtractSmall","multiplyLong","a_i","multiplySmall","shiftLeft","multiplyKaratsuba","ac","bd","abcd","multiplySmallAndArray","divModSmall","divModAny","self","quotientDigit","divisorMostSignificantDigit","divMod1","guess","xlen","highx","highy","check","part","reverse","divMod2","qSign","mSign","isBasicPrime","isEven","isDivisibleBy","lesser","millerRabinTest","nPrev","modPow","subtractAny","small","l1","_multiplyBySmall","over","isZero","isPositive","isOdd","compareTo","notEquals","neq","greater","greaterOrEquals","geq","lesserOrEquals","leq","strict","bits","bitLength","logN","isProbablePrime","iterations","randBetween","modInv","lastT","lastR","newT","one","newR","powersOfTwo","powers2Length","highestPower2","shift_isSmall","bitwise","xSign","ySign","xRem","not","yRem","xDigit","yDigit","xDivMod","yDivMod","toJSNumber","shiftRight","remQuo","and","or","xor","LOBMASK_I","roughLOB","integerLogarithm","tmp","absBase","charCodeAt","parseInt","charCode","parseBaseFromArray","digit","toBase","out","toBaseString","parseStringValue","decimalPlace","parseNumberValue","toJSON","minusOne","isInstance","low","restricted","module","exports","rounding","modulo","toExpNeg","toExpPos","minE","maxE","crypto","O","D","absoluteValue","constructor","comparedTo","cmp","cosine","sd","J","G","cubeRoot","Z","decimalPlaces","dp","dividedToIntegerBy","divToInt","greaterThanOrEqualTo","hyperbolicCosine","hyperbolicSine","hyperbolicTangent","inverseCosine","isNeg","U","inverseHyperbolicCosine","inverseHyperbolicSine","inverseHyperbolicTangent","inverseSine","inverseTangent","isPos","lessThanOrEqualTo","logarithm","T","naturalExponential","naturalLogarithm","negated","sine","squareRoot","tangent","mul","toBinary","K","toDecimalPlaces","toDP","R","toFraction","toHexadecimal","toHex","toNearest","toOctal","toPower","LN10","toPrecision","toSignificantDigits","toSD","truncated","I","H","$","search","W","X","Y","en","rn","sn","on","un","cn","an","defaults","getRandomValues","randomBytes","hn","dn","pn","gn","wn","Nn","En","yn","Mn","qn","On","Dn","Uint32Array","Fn","An","Sn","Zn","Pn","Rn","Ln","Tn","Un","ROUND_UP","ROUND_DOWN","ROUND_CEIL","ROUND_FLOOR","ROUND_HALF_UP","ROUND_HALF_DOWN","ROUND_HALF_EVEN","ROUND_HALF_CEIL","ROUND_HALF_FLOOR","EUCLID","config","isDecimal","hypot","log2","default","Decimal","iterator","for","toStringTag","noConflict","require$$0","SIN","COS","TAN","SEC","CSC","COT","ASIN","ACOS","ATAN","ASEC","ACSC","ACOT","SINH","COSH","TANH","CSCH","SECH","COTH","ASECH","ACSCH","ACOTH","NoIntegralFound","hasIntegral","fnTransform","double_angle","transformed","hasTrig","in_trig","in_inverse_trig","toCommonDenominator","Algebra","in_htrig","jacobian","eqns","Calculus","cMatrix","all_functions","cosAsinBtransform","cosAsinBtranform","cosAsinAtransform","cosAsinAtranform","sinAsinBtransform","trigTransform","integration_depth","max_lim_depth","__","modifier","nth","sp","derive","polydiff","df","product_rule","qdiff","x_","y_","altVal","integration","u_substitution","try_combo","do_fn_sub","poly_integrate","dc","decompose_arg","xp","dc2","new_val","by_parts","integrated","Factor","stop","partial_fraction","partial_fractions","PartFrac","partfrac","get_udv","setSymbol","dv","trig_sub","du","integral","udv","vdu","uv","integral_vdu","vdu_s","is_cyclic","original_symbol","dt","decomp","b_is_positive","unwrapAbs","L1","L2","br","sqrt_a","sqrt_ax","sqa","sqb","aob","bsqi","was_factored","degree","fx","sqComplete","u_du","ag","decomposed","a_","b_","rd","rd2","parse_str","cfsymbol","unwrapped","fn1","fn2","arg1","arg2","new_sym","p1_even","p2_even","trans","bx","sym1_is_linear","pd","pc","f_is_linear","dummy","bksub","u_transform","U2","Classes","Factors","coeffFactor","cosn","sym2_clone","sa","sb","nq","syma","symb","first","intg","defint","point","Limit","limit","interval","diverges","gin","lim_sign","gm","lim1","lim2","indeterminate","t_symbol","den_is_zero","rewriteToLog","getSubbed","isInterval","isConvergent","Simplify","_num","_den","symbol_","lim_base","lim_pow","evaluates","trial","s_arg","divergent","_lim","_symbols","Fresnel","math","Polynomial","MVTerm","terms","image","fit","c2","equalsZero","modP","up_one","dividend","mp","x1","x2","lc","monic","gcf","toPolynomial","ca","fnz","parr","quad","incl_img","dsc","squareFree","equalsNumber","toSymbol","with_order","tBase","nterm","updateCount","altVar","sameVars","groupTerms","egrouped","grouped","collectFactors","getNumberSymbolics","fo","preAdd","pFactor","is_constant","factored","count","getRevMap","rev_map","len","mapped","generateImage","getImg","mvterm","new_mvterm","toMapObj","filledArray","clss","arrSum","haveIntersection","some","subFunctions","tvar","getFunctionsSubs","proots","known_roots","get_roots","rarr","calcroots","lowest_pow","lowest_symbol","minpower","last_power","zeroi","degreePar","Degree","zeror","QuadSD_ak1","NN","iPar","calcSC_ak1","DBL_EPSILON","qk","sdPar","dumFlag","a3","a7","nextK_ak1","tFlag","qp","newest_ak1","a4","a5","b2","c3","c4","Quad_ak1","si","lr","li","QuadIT_ak1","uu","vv","calcPar","ee","omp","relstp","ui","vi","zm","qPar","triedFlag","NZ","szr","szi","lzr","lzi","RealIT_ak1","kv","pv","nm1","Fxshfr_ak1","MDP1","betas","betav","oss","ots","otv","ovv","ss","ts","tss","tv","tvv","fflag","spass","stry","vpass","vtry","svk","iFlag","degPar","bnd","ff","moduli_max","moduli_min","sc","xm","bb","xxx","jj","NM1","zerok","RADFAC","LB2","LN2","Fxshfr_Par","LO","MIN_VALUE","cosr","sinr","xx","yy","rpSolve","real","froot","newtonraph","sumProd","polyPowers","for_variable","include_negatives","ll","common","exit","n_terms","n_zeroes","_factor","_factored","quadFactor","root1","root2","cubeFactor","sign_a","sign_b","m_root_a","m_root_b","untouched","den_array","num_array","dfact","nfact","strip","unstrip","multiVar","all_S","all_unit","coeff_factors","power_factors","powerFactor","mfactor","t_factors","trialAndError","tf_symbol","t_factor","addPower","reduce","sqfr","LT","factor_array","cnst","cfactors","candidate","ltfactors","isubbed","nfactors","lc_is_neg","cnst_is_neg","factor_found","mSqfrFactor","can_divide","is_factor","sqdiff","remove_square","separated","obj_array","constants","factors2","sorted","maxes","new_factor","divided","has_fractions","neg_numeric_factor","allLinear","status","sg","appeared","every","aggregate","gcd_","gcd_m","gcd_v","gcd_p","vars_a","vars_b","multipliers","curr","denom_args","mask","results","total","fail","symbol1_has_func","symbol2_has_func","parse_funcs","quot","reconvert","get_unique_max","any","get_det","lookat","umax","is_equal","max1","max2","idx1","idx2","item1","item2","cterm","t_map","init_sort","is_larger","s1","lead_var","sf","blv","alv","checked","tt","try_better_lead_var","fdt","fnt","nd","dividend_larger","cur","line","dy","createTemplate","denom_factors","factors_vec","efactor","as_array","ofactors","nterms","dterms","ks","template","tfactors","partials","denominators","e2","complexSimp","bc","ad","cd","r1","r2","i1","i2","trigSimp","sym_array","tr","fracSimp","ratSimp","sqrtSimp","simp","patternSub","patterns","has_CP","found","collect","simplified","useAlgebraDiv","divideFn","calls","useParserDiv","_A","_C","explode","Equation","lhs","rhs","LHS","RHS","SOLVE_RADIUS","ROOTS_PER_SIDE","make_pi_conversions","STEP_SIZE","MAX_NEWTON_ITERATIONS","MAX_NON_LINEAR_TRIES","NON_LINEAR_JUMP_AT","NON_LINEAR_JUMP_SIZE","NON_LINEAR_START","NEWTON_SLICES","NEWTON_EPSILON","SOLUTION_PROXIMITY","FILTER_SOLUTIONS","MAX_SOLVE_DEPTH","ZERO_EPSILON","MAX_BISECTION_ITER","BI_SECTION_EPSILON","hasNegativeTerms","toLHS","eqn","removeDenom","_t","newRHS","solveFor","solve","setEq","checkAll","Solve","solutions","solution","es","solveCircle","svars","y_points","x_points","SOLUTIONS_AS_OBJECT","solveNonLinearSystem","tries","max_tries","halfway","iters","xn1","norm","lnorm","jump_at","jump","create_subs","max_iter","f_eqns","systemSolutions","expand_result","solveSystemBySubstitution","solveSystem","var_array","sol","reduced","knowns","all_zero","tparts","discriminant","cubic","d_o","c_o","b_o","a_o","quartic","D0","D1","divideAndConquer","solve_for","sols","csolve","getPoints","points","last_sign","rside","lside","test_side","num_roots","hits","bisection","middle","x_point","Newton","fp","maxiter","iter","x0","fx0","rewrite","sqrts","sqrtSolve","known","add_to_result","has_trig","r_is_symbol","PRE_ADD_SOLUTION","r_str","numvars","cfact","fractionals","correct_denom","is_sqrt","min_p","corrected","inverseFunctionSolve","fkeys","was_calculated","points1","points2","points3","t_points","expr_str","rw","Laplace_integration_depth","Extra","LaPlace","transform","depth_is_lower","integration_expr","inverse","s_","input_symbol","den_p","finalize","completed","tf","a_has_sin","b_has_cos","a_has_cos","b_has_sin","s_terms","fc","Statistics","frequencyMap","mean","mid","mode","freq","gVariance","variance","sampleVariance","standardDeviation","sampleStandardDeviation","zScore","stdev","Units","table","foot","meter","decimeter","formatUnicorn","_nerdamer","letters","subscriber_queue","expoOut","is_date","get_interpolator","bi","getTime","interpolators","tweened","subscribers","new_value","run_queue","subscriber","invalidate","writable","target_value","previous_task","started","delay","duration","easing","linear","interpolate","abort","promise","fulfill","loop","elapsed","label","input_value","calculated_value","_input_value","debounce","timer","clearTimeout","setTimeout","debouncer","animated","$$invalidate","slot_ctx","slot","slot_definition","slot_changes","get_slot_context_fn","slot_context","lets","merged","_uur","_dag","_week","_maand","_jaar","_uren_per_dag","_dagen_per_week","_uren_per_week","feedback","rules","uur","dag","week","maand","jaar","uren_per_dag","dagen_per_week","uren_per_week","entries","equations","rule","solveEquations","magic","field0_props","field1_props","field2_props","field3_props","field4_props","field5_props","field0_changes","field1_changes","field2_changes","field3_changes","field4_changes","field5_changes","$$self","hr","create_if_block","div0","button0","button1","div1","each_blocks","gemiddeld","_sum"],"mappings":"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K,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC7H,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnH,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnH,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnH,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACnH,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,KAAM,KAAM,KAAM,KAClH,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClH,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClH,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClH,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClH,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClH,KAAM,KAAM,KAAM,KAAM,KA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"}